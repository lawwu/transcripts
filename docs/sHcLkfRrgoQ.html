<html><head><title>Lesson 6: Deep Learning 2018</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 6: Deep Learning 2018</h2><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ"><img src="https://i.ytimg.com/vi_webp/sHcLkfRrgoQ/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=290">4:50</a> LearnModel<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=620">10:20</a> Return a variable<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=930">15:30</a> Zip function<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1230">20:30</a> PCA<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1485">24:45</a> Entity embedding layers<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1751">29:11</a> Map of Germany<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1835">30:35</a> Embeddings<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2145">35:45</a> Fake Tasks<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2255">37:35</a> Autoencoder<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2464">41:4</a> Russell<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2796">46:36</a> Russell kernels<br><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2944">49:4</a> Columnar model data<br><br><div style="text-align: left;"><a href="./sHcLkfRrgoQ.html">Whisper Transcript</a> | <a href="./transcript_sHcLkfRrgoQ.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">So this is our penultimate lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=14" target="_blank">00:00:14.360</a></span> | <span class="t">Couple of weeks ago, in lesson 4, I mentioned I was going to share that lesson with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=18" target="_blank">00:00:18.820</a></span> | <span class="t">terrific NLP researcher, Sebastian Rutter, which I did, and he said he loved it and he's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=25" target="_blank">00:00:25.220</a></span> | <span class="t">gone on to yesterday release this new post he called Optimization for Deep Learning Highlights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=31" target="_blank">00:00:31.600</a></span> | <span class="t">in 2017 in which he covered basically everything that we talked about in that lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=39" target="_blank">00:00:39.720</a></span> | <span class="t">And with some very nice shoutouts to some of the work that some of the students here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=43" target="_blank">00:00:43.280</a></span> | <span class="t">have done, including when he talked about the separation of weight decay from the momentum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=56" target="_blank">00:00:56.120</a></span> | <span class="t">term, and so he actually mentions here the opportunities in terms of improved software</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=64" target="_blank">00:01:04.240</a></span> | <span class="t">decoupling this allows, and actually links to the commit from Anand Sahar actually showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=72" target="_blank">00:01:12.720</a></span> | <span class="t">how to implement this in fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=74" target="_blank">00:01:14.840</a></span> | <span class="t">So fastai's code is actually being used as a bit of a role model now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=80" target="_blank">00:01:20.320</a></span> | <span class="t">He then covers some of these learning rate training techniques that we've talked about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=88" target="_blank">00:01:28.520</a></span> | <span class="t">This is the SGDR schedule, it looks a bit different to what you're used to seeing because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=94" target="_blank">00:01:34.600</a></span> | <span class="t">this is on a log curve, this is the way that they show it on the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=98" target="_blank">00:01:38.720</a></span> | <span class="t">And for more information, again, links to two blog posts, the one from Vitaly about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=106" target="_blank">00:01:46.880</a></span> | <span class="t">this topic, and again Anand Sahar's blog post on this topic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=113" target="_blank">00:01:53.360</a></span> | <span class="t">So it's great to see that some of the work from fastai students is already getting noticed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=119" target="_blank">00:01:59.680</a></span> | <span class="t">and picked up and shared, and this blog post went on to get on the front page of Hacker</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=123" target="_blank">00:02:03.320</a></span> | <span class="t">News, so that's pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=127" target="_blank">00:02:07.760</a></span> | <span class="t">And hopefully more and more of this work will be picked up once this is released publicly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=136" target="_blank">00:02:16.080</a></span> | <span class="t">So last week we were doing a deep dive into collaborative filtering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=146" target="_blank">00:02:26.240</a></span> | <span class="t">Let's remind ourselves of what our final model looked like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=155" target="_blank">00:02:35.240</a></span> | <span class="t">So in the end we ended up rebuilding the model that's actually in the fastai library, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=165" target="_blank">00:02:45.760</a></span> | <span class="t">we had an embedding, so we had this little get embedding function that grabbed an embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=171" target="_blank">00:02:51.840</a></span> | <span class="t">and randomly initialized the weights, for the users, and for the items, that's the kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=180" target="_blank">00:03:00.280</a></span> | <span class="t">of generic term in our case, the items of movies, the bias for the users, the bias for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=184" target="_blank">00:03:04.560</a></span> | <span class="t">the items, and we had n factors embedding size for each one, of course the biases just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=192" target="_blank">00:03:12.120</a></span> | <span class="t">had a single one, and then we grabbed the users and item embeddings, multiplied them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=196" target="_blank">00:03:16.600</a></span> | <span class="t">together, summed it up for each row, and added on the bias terms, popped that through a sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=203" target="_blank">00:03:23.880</a></span> | <span class="t">to put it into the range that we wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=206" target="_blank">00:03:26.680</a></span> | <span class="t">So that was our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=211" target="_blank">00:03:31.840</a></span> | <span class="t">One of you asked if we can interpret this information in some way, and I promised this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=217" target="_blank">00:03:37.080</a></span> | <span class="t">week we would see how to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=218" target="_blank">00:03:38.800</a></span> | <span class="t">So let's take a look. We're going to start with the model we built here where we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=224" target="_blank">00:03:44.540</a></span> | <span class="t">used that fastai library, collab filter data set from CSV, and then that .get learner, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=232" target="_blank">00:03:52.080</a></span> | <span class="t">then we fitted it in three epochs, 19 seconds, we've got a pretty good result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=241" target="_blank">00:04:01.440</a></span> | <span class="t">So what we can now do is to analyze that model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=247" target="_blank">00:04:07.720</a></span> | <span class="t">So you may remember right back when we started, we read in the movies.csv file, but that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=255" target="_blank">00:04:15.600</a></span> | <span class="t">just a mapping from the ID of the movie to the name of the movie. So we're just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=260" target="_blank">00:04:20.040</a></span> | <span class="t">to use that for display purposes so we can see what we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=265" target="_blank">00:04:25.640</a></span> | <span class="t">Because not all of us have watched every movie, I'm just going to limit this to the top 500</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=270" target="_blank">00:04:30.920</a></span> | <span class="t">3,000 most popular movies, so we might have more chance of recognizing the movies we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=277" target="_blank">00:04:37.880</a></span> | <span class="t">looking at, and then I'll go ahead and change it from the movie IDs from MovieLens to those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=284" target="_blank">00:04:44.000</a></span> | <span class="t">unique IDs that we're using, the contiguous IDs, because that's what our model has.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=290" target="_blank">00:04:50.420</a></span> | <span class="t">So inside the Learn object that we create inside a learner, we can always grab the PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=302" target="_blank">00:05:02.680</a></span> | <span class="t">model itself just by saying "learn.model", and I'm going to show you more and more of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=310" target="_blank">00:05:10.440</a></span> | <span class="t">the code at the moment, so let's take a look at the definition of model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=318" target="_blank">00:05:18.800</a></span> | <span class="t">And so model is a property, so if you haven't seen a property before, a property is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=322" target="_blank">00:05:22.600</a></span> | <span class="t">something in Python which looks like a method when you define it, but you can call it without</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=329" target="_blank">00:05:29.800</a></span> | <span class="t">parentheses as we do here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=333" target="_blank">00:05:33.040</a></span> | <span class="t">And so it kind of looks when you call it like it's a regular attribute, but it looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=336" target="_blank">00:05:36.800</a></span> | <span class="t">when you define it like it's a method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=338" target="_blank">00:05:38.640</a></span> | <span class="t">So every time you call it, it actually runs this code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=342" target="_blank">00:05:42.380</a></span> | <span class="t">And so in this case it's just a shortcut to grab something called .models.model, so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=348" target="_blank">00:05:48.760</a></span> | <span class="t">may be interested to know what that looks like, learn.models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=354" target="_blank">00:05:54.240</a></span> | <span class="t">And so the fastai model type is a very thin wrapper for PyTorch models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=363" target="_blank">00:06:03.200</a></span> | <span class="t">So we could take a look at this, collab.filter.model, and see what that is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=373" target="_blank">00:06:13.240</a></span> | <span class="t">It's only one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=376" target="_blank">00:06:16.200</a></span> | <span class="t">And we'll talk more about these in part 2, but basically there's this very thin wrapper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=383" target="_blank">00:06:23.960</a></span> | <span class="t">and one of the main things that fastai does is we have this concept of layer groups where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=388" target="_blank">00:06:28.840</a></span> | <span class="t">basically when you say here there are different learning rates and they get applied to different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=392" target="_blank">00:06:32.680</a></span> | <span class="t">sets of layers, then that's something that's not in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=395" target="_blank">00:06:35.960</a></span> | <span class="t">So when you say I want to use this PyTorch model, there's one thing we have to do which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=401" target="_blank">00:06:41.440</a></span> | <span class="t">is to say I want to run layer groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=403" target="_blank">00:06:43.840</a></span> | <span class="t">So the details aren't terribly important, but in general if you want to create a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=408" target="_blank">00:06:48.400</a></span> | <span class="t">wrapper for some other PyTorch model, you could just write something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=415" target="_blank">00:06:55.600</a></span> | <span class="t">So to get inside that, to grab the actual PyTorch model itself, it's models.model, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=422" target="_blank">00:07:02.280</a></span> | <span class="t">the PyTorch model, and then the learn object has a shortcut to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=427" target="_blank">00:07:07.680</a></span> | <span class="t">So we're going to set m to be the PyTorch model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=432" target="_blank">00:07:12.520</a></span> | <span class="t">And so when you print out a PyTorch model, it prints it out basically by listing out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=438" target="_blank">00:07:18.400</a></span> | <span class="t">all of the layers that you created in the constructor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=443" target="_blank">00:07:23.400</a></span> | <span class="t">It's quite nifty actually when you think about the way this works thanks to some very handy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=450" target="_blank">00:07:30.720</a></span> | <span class="t">stuff in Python, we're actually able to use standard Python OO to define these modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=459" target="_blank">00:07:39.120</a></span> | <span class="t">and these layers and they basically automatically register themselves with PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=465" target="_blank">00:07:45.040</a></span> | <span class="t">So back in our embedding.bias, we just had a bunch of things where we said each of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=471" target="_blank">00:07:51.040</a></span> | <span class="t">things are equal to these things and it automatically knows how to represent that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=477" target="_blank">00:07:57.400</a></span> | <span class="t">So you can see there's the name is u, and so the name is just literally whatever we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=482" target="_blank">00:08:02.080</a></span> | <span class="t">called it here, u.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=485" target="_blank">00:08:05.560</a></span> | <span class="t">And then the definition is it's this kind of layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=490" target="_blank">00:08:10.920</a></span> | <span class="t">So that's our PyTorch model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=494" target="_blank">00:08:14.760</a></span> | <span class="t">So we can look inside that, basically use that, so if we say m.ib, then that's referring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=503" target="_blank">00:08:23.440</a></span> | <span class="t">to the embedding layer for an item which is the bias layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=509" target="_blank">00:08:29.720</a></span> | <span class="t">So an item bias in this case is the movie bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=512" target="_blank">00:08:32.940</a></span> | <span class="t">So each movie, there are 9,000 of them, has a single bias element.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=519" target="_blank">00:08:39.600</a></span> | <span class="t">Now the really nice thing about PyTorch layers and models is that they all look the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=528" target="_blank">00:08:48.600</a></span> | <span class="t">To use them, you call them as if they were a function. So we can go m.ib, and that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=536" target="_blank">00:08:56.080</a></span> | <span class="t">says I want you to return the value of that layer, and that layer could be a full-on model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=544" target="_blank">00:09:04.000</a></span> | <span class="t">So to actually get a prediction from a PyTorch model, I would go m and pass in my variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=552" target="_blank">00:09:12.320</a></span> | <span class="t">And so in this case, m.ib and pass in my top movie indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=559" target="_blank">00:09:19.880</a></span> | <span class="t">Now models remember layers, they require variables, not tensors, because it needs to keep track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=568" target="_blank">00:09:28.760</a></span> | <span class="t">of the derivatives, and so we use this capital V to turn the tensor into a variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=576" target="_blank">00:09:36.720</a></span> | <span class="t">Now it's just announced this week that PyTorch 0.4, which is the version after the one that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=583" target="_blank">00:09:43.760</a></span> | <span class="t">just about to be released, is going to get rid of variables and we'll actually be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=589" target="_blank">00:09:49.160</a></span> | <span class="t">to use tensors directly to keep track of derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=592" target="_blank">00:09:52.440</a></span> | <span class="t">So if you're watching this on the MOOC and you're looking at 0.4, then you'll probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=596" target="_blank">00:09:56.640</a></span> | <span class="t">notice that the code doesn't have this V in it anymore, so that will be pretty exciting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=602" target="_blank">00:10:02.320</a></span> | <span class="t">when that happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=603" target="_blank">00:10:03.320</a></span> | <span class="t">For now, we have to remember if we're going to pass something into a model to turn it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=606" target="_blank">00:10:06.480</a></span> | <span class="t">into a variable first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=608" target="_blank">00:10:08.160</a></span> | <span class="t">And remember, a variable has a strict superset of the API of a tensor, so anything you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=613" target="_blank">00:10:13.800</a></span> | <span class="t">do to a tensor, you can do to a variable, like add it up or take its log or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=620" target="_blank">00:10:20.080</a></span> | <span class="t">So that's going to return a variable which consists of going through each of these movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=625" target="_blank">00:10:25.120</a></span> | <span class="t">IDs, putting it through this embedding layer to get its bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=631" target="_blank">00:10:31.240</a></span> | <span class="t">And that's going to return a variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=636" target="_blank">00:10:36.280</a></span> | <span class="t">Let's take a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=642" target="_blank">00:10:42.720</a></span> | <span class="t">So before I press Shift + Enter here, you can have a think about what I'm going to have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=648" target="_blank">00:10:48.000</a></span> | <span class="t">I've got a list of 3000 movies going in, turning it into a variable, putting it through this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=653" target="_blank">00:10:53.440</a></span> | <span class="t">embedding layer, so just have a think about what you expect to come out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=659" target="_blank">00:10:59.800</a></span> | <span class="t">And we have a variable of size 3000 by 1, hopefully that doesn't surprise you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=664" target="_blank">00:11:04.760</a></span> | <span class="t">We had 3000 movies that we were looking up, each one had a one long embedding, so there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=670" target="_blank">00:11:10.920</a></span> | <span class="t">our 3000 long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=672" target="_blank">00:11:12.240</a></span> | <span class="t">You'll notice it's a variable, which is not surprising because we've fed it a variable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=675" target="_blank">00:11:15.920</a></span> | <span class="t">so we've got a variable back, and it's a variable that's on the GPU, dot CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=682" target="_blank">00:11:22.700</a></span> | <span class="t">So we have a little shortcut in fast.ai because we very often want to take variables, turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=689" target="_blank">00:11:29.840</a></span> | <span class="t">them into tensors, and move them back to the CPU so we can play with them more easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=694" target="_blank">00:11:34.400</a></span> | <span class="t">So 2mp is to NumPy, and that does all of those things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=699" target="_blank">00:11:39.420</a></span> | <span class="t">It works regardless of whether it's a tensor or a variable, it works regardless of whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=703" target="_blank">00:11:43.400</a></span> | <span class="t">it's on the CPU or GPU, it'll end up giving you a NumPy array from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=710" target="_blank">00:11:50.160</a></span> | <span class="t">So if we do that, that gives us exactly the same thing as we just looked at, but now in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=716" target="_blank">00:11:56.660</a></span> | <span class="t">NumPy form.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=718" target="_blank">00:11:58.680</a></span> | <span class="t">So that's a super handy thing to use when you're playing around with PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=723" target="_blank">00:12:03.600</a></span> | <span class="t">My approach to things is I try to use NumPy for everything, except when I explicitly need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=733" target="_blank">00:12:13.080</a></span> | <span class="t">something to run on the GPU, or I need its derivatives, in which case I use PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=739" target="_blank">00:12:19.840</a></span> | <span class="t">I find NumPy's often easier to work with, it's been around many years longer than PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=749" target="_blank">00:12:29.920</a></span> | <span class="t">And lots of things like the Python imaging library, OpenCV, and lots and lots of stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=755" target="_blank">00:12:35.880</a></span> | <span class="t">like Pandas, it works with NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=760" target="_blank">00:12:40.040</a></span> | <span class="t">So my approach is do as much as I can in NumPy land, finally when I'm ready to do something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=766" target="_blank">00:12:46.400</a></span> | <span class="t">on the GPU or take its derivative to PyTorch, and then as soon as I can, I put it back in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=771" target="_blank">00:12:51.760</a></span> | <span class="t">NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=772" target="_blank">00:12:52.760</a></span> | <span class="t">And you'll see that the FastAI library really works this way, like all the transformations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=777" target="_blank">00:12:57.080</a></span> | <span class="t">and stuff happen in NumPy, which is different to most PyTorch computer vision libraries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=783" target="_blank">00:13:03.840</a></span> | <span class="t">which tend to do it all as much as possible in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=787" target="_blank">00:13:07.160</a></span> | <span class="t">I try to do as much as possible in NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=793" target="_blank">00:13:13.280</a></span> | <span class="t">So let's say we wanted to build a model in the GPU with the GPU and train it, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=798" target="_blank">00:13:18.820</a></span> | <span class="t">we want to bring this to production.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=801" target="_blank">00:13:21.300</a></span> | <span class="t">So would we call to NumPy on the model itself, or would we have to iterate through all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=807" target="_blank">00:13:27.640</a></span> | <span class="t">different layers and then call to NPE?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=810" target="_blank">00:13:30.480</a></span> | <span class="t">Yeah, good question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=811" target="_blank">00:13:31.480</a></span> | <span class="t">So it's very likely that you want to do inference on a CPU rather than a GPU, it's more scalable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=817" target="_blank">00:13:37.920</a></span> | <span class="t">you don't have to worry about putting things in batches, so on and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=822" target="_blank">00:13:42.560</a></span> | <span class="t">So you can move a model onto the CPU just by typing m.CPU, and that model is now on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=832" target="_blank">00:13:52.120</a></span> | <span class="t">CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=833" target="_blank">00:13:53.280</a></span> | <span class="t">And therefore you can also then put your variable on the CPU by doing exactly the same thing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=839" target="_blank">00:13:59.880</a></span> | <span class="t">so you can say like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=845" target="_blank">00:14:05.840</a></span> | <span class="t">Now having said that, if your server doesn't have a GPU, you don't have to do this because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=852" target="_blank">00:14:12.720</a></span> | <span class="t">it won't put it on the GPU at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=855" target="_blank">00:14:15.120</a></span> | <span class="t">So for inferencing on the server, if you're running it on some T2 instance or something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=863" target="_blank">00:14:23.440</a></span> | <span class="t">it'll work fine and it'll all run on the CPU automatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=868" target="_blank">00:14:28.280</a></span> | <span class="t">So if we train the model on the GPU and then we save those embeddings and the weights,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=877" target="_blank">00:14:37.520</a></span> | <span class="t">would we have to do anything special to load it onto the CPU?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=880" target="_blank">00:14:40.520</a></span> | <span class="t">No, you won't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=883" target="_blank">00:14:43.360</a></span> | <span class="t">We have something, well it kind of depends on how much of fast AI you're using, so I'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=888" target="_blank">00:14:48.080</a></span> | <span class="t">show you how you can do that in case you have to do it manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=892" target="_blank">00:14:52.920</a></span> | <span class="t">One of the students figured this out, which is very handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=896" target="_blank">00:14:56.240</a></span> | <span class="t">When we -- there's a load model function, and you'll see what it does, but it does torch.load,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=907" target="_blank">00:15:07.320</a></span> | <span class="t">is that basically this is like some magic incantation that normally it has to load it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=912" target="_blank">00:15:12.440</a></span> | <span class="t">onto the same GPU it's saved on, but this will load it into whatever's available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=917" target="_blank">00:15:17.720</a></span> | <span class="t">So that was a handy discovery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=923" target="_blank">00:15:23.800</a></span> | <span class="t">Thanks for the great questions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=929" target="_blank">00:15:29.600</a></span> | <span class="t">To put that back on the GPU, I'll need to say .cuda and now I can run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=940" target="_blank">00:15:40.040</a></span> | <span class="t">So it's really important to know about the zip function in Python, which iterates through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=947" target="_blank">00:15:47.060</a></span> | <span class="t">a number of lists at the same time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=950" target="_blank">00:15:50.360</a></span> | <span class="t">So in this case, I want to grab each movie along with its bias term so that I can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=956" target="_blank">00:15:56.240</a></span> | <span class="t">pop it into a list of tuples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=958" target="_blank">00:15:58.200</a></span> | <span class="t">So if I just go zip like that, that's going to iterate through each movie ID and each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=963" target="_blank">00:16:03.240</a></span> | <span class="t">bias term.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=965" target="_blank">00:16:05.680</a></span> | <span class="t">And so then I can use that in a list comprehension to grab the name of each movie along with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=970" target="_blank">00:16:10.480</a></span> | <span class="t">its bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=972" target="_blank">00:16:12.800</a></span> | <span class="t">So having done that, I can then sort, and so here I told you the John Travolta Scientology</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=983" target="_blank">00:16:23.160</a></span> | <span class="t">movie at the most negative of -- quite by a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=986" target="_blank">00:16:26.800</a></span> | <span class="t">If this was a Kaggle competition, Battlefield Earth would have won by miles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=990" target="_blank">00:16:30.560</a></span> | <span class="t">Look at this, 77796.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=994" target="_blank">00:16:34.880</a></span> | <span class="t">So here is the worst movie of all time, according to IMDB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=998" target="_blank">00:16:38.960</a></span> | <span class="t">It's interesting when you think about what this means, because this is a much more authentic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1003" target="_blank">00:16:43.440</a></span> | <span class="t">way to find out how bad this movie is, because some people are just more negative about movies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1010" target="_blank">00:16:50.680</a></span> | <span class="t">And if more of them watch your movie, like a highly critical audience, they're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1015" target="_blank">00:16:55.160</a></span> | <span class="t">to rate it badly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1016" target="_blank">00:16:56.160</a></span> | <span class="t">So if you take an average, it's not quite fair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1021" target="_blank">00:17:01.120</a></span> | <span class="t">And so what this is doing is saying once we remove the fact that different people have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1027" target="_blank">00:17:07.840</a></span> | <span class="t">different overall positive or negative experiences, and different people watch different kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1031" target="_blank">00:17:11.640</a></span> | <span class="t">of movies, and we correct for all that, this is the worst movie of all time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1037" target="_blank">00:17:17.200</a></span> | <span class="t">So that's a good thing to know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1042" target="_blank">00:17:22.580</a></span> | <span class="t">So this is how we can look inside our model and interpret the bias vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1050" target="_blank">00:17:30.760</a></span> | <span class="t">You'll see here I've sorted by the zeroth element of each tuple by using a lambda.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1058" target="_blank">00:17:38.780</a></span> | <span class="t">Originally I used this special item getter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1062" target="_blank">00:17:42.200</a></span> | <span class="t">This is part of Python's operator library, and this creates a function that returns the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1067" target="_blank">00:17:47.360</a></span> | <span class="t">zeroth element of something in order to save time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1071" target="_blank">00:17:51.760</a></span> | <span class="t">And then I actually realized that the lambda is only one more character to write than the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1076" target="_blank">00:17:56.720</a></span> | <span class="t">item getter, so maybe we don't need to know this after all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1079" target="_blank">00:17:59.680</a></span> | <span class="t">So really useful to make sure you know how to write lambdas in Python, so this is a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1087" target="_blank">00:18:07.560</a></span> | <span class="t">And so the sort is going to call this function every time it decides is this thing higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1092" target="_blank">00:18:12.840</a></span> | <span class="t">or lower than that other thing, and this is going to return the zeroth element.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1100" target="_blank">00:18:20.000</a></span> | <span class="t">So here's the same thing in item getter format, and here is the reverse and Shawshank redemption</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1107" target="_blank">00:18:27.320</a></span> | <span class="t">right at the top, I'll definitely agree with that, godfather, usual suspects, these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1111" target="_blank">00:18:31.320</a></span> | <span class="t">all pretty great movies, 12 angry men, absolutely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1117" target="_blank">00:18:37.160</a></span> | <span class="t">So there you go, there's how we can look at the bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1122" target="_blank">00:18:42.480</a></span> | <span class="t">So then the second piece to look at would be the embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1129" target="_blank">00:18:49.200</a></span> | <span class="t">So we can do the same thing, so remember i was the item embeddings, rather than ib was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1134" target="_blank">00:18:54.320</a></span> | <span class="t">the item bias, we can pass in our list of movies as a variable, turn it into numpy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1140" target="_blank">00:19:00.700</a></span> | <span class="t">and here's our movie embeddings, so for each of the 3000 most popular movies, here are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1147" target="_blank">00:19:07.080</a></span> | <span class="t">its 50 embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1150" target="_blank">00:19:10.160</a></span> | <span class="t">So it's very hard, unless you're Jeffrey Hinton, to visualize a 50-dimensional space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1156" target="_blank">00:19:16.560</a></span> | <span class="t">So what we'll do is we'll turn it into a 3-dimensional space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1161" target="_blank">00:19:21.000</a></span> | <span class="t">So we can compress high-dimensional spaces down into lower-dimensional spaces using lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1166" target="_blank">00:19:26.520</a></span> | <span class="t">of different techniques, perhaps one of the most common and popular is called PCA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1171" target="_blank">00:19:31.360</a></span> | <span class="t">PCA stands for Principal Components Analysis, it's a linear technique, but linear techniques</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1179" target="_blank">00:19:39.920</a></span> | <span class="t">generally work fine for this kind of embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1184" target="_blank">00:19:44.240</a></span> | <span class="t">I'm not going to teach you about PCA now, but I will say in Rachel's Computational Linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1188" target="_blank">00:19:48.840</a></span> | <span class="t">Algebra class, which you can get to from fast.ai, we cover PCA in a lot of detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1197" target="_blank">00:19:57.320</a></span> | <span class="t">And it's a really important technique, it turns out to be almost identical to something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1201" target="_blank">00:20:01.520</a></span> | <span class="t">called Singular Value Decomposition, which is a type of matrix decomposition which actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1208" target="_blank">00:20:08.180</a></span> | <span class="t">does turn up in deep learning a little bit from time to time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1212" target="_blank">00:20:12.840</a></span> | <span class="t">So it's kind of somewhat worth knowing if you were going to dig more into linear algebra,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1219" target="_blank">00:20:19.200</a></span> | <span class="t">SPD and PCA, along with eigenvalues and eigenvectors, which are all slightly different versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1225" target="_blank">00:20:25.720</a></span> | <span class="t">of this kind of the same thing, are all worth knowing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1229" target="_blank">00:20:29.560</a></span> | <span class="t">But for now, just know that you can grab PCA from sklearn.decomposition, say how much you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1236" target="_blank">00:20:36.280</a></span> | <span class="t">want to reduce the dimensionality to, so I want to find 3 components, and what this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1241" target="_blank">00:20:41.340</a></span> | <span class="t">going to do is find 3 linear combinations of the 50 dimensions which capture as much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1249" target="_blank">00:20:49.240</a></span> | <span class="t">as the variation as possible, but are as different to each other as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1255" target="_blank">00:20:55.820</a></span> | <span class="t">So we would call this a lower rank approximation of our matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1263" target="_blank">00:21:03.040</a></span> | <span class="t">So then we can grab the components, so that's going to be the 3 dimensions, so once we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1268" target="_blank">00:21:08.080</a></span> | <span class="t">done that, we've now got 3 by 3000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1273" target="_blank">00:21:13.320</a></span> | <span class="t">And so we can now take a look at the first of them, and we'll do the same thing of using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1277" target="_blank">00:21:17.600</a></span> | <span class="t">zip to look at each one along with its movie.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1280" target="_blank">00:21:20.960</a></span> | <span class="t">And so here's the thing, we don't know ahead of time what this PCA thing is, it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1289" target="_blank">00:21:29.960</a></span> | <span class="t">a bunch of latent factors, it's kind of the main axis in this space of latent factors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1299" target="_blank">00:21:39.460</a></span> | <span class="t">And so what we can do is look at it and see if we can figure out what it's about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1306" target="_blank">00:21:46.760</a></span> | <span class="t">So given that Police Academy 4 is high up here along with Waterworld, where El Spago,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1314" target="_blank">00:21:54.040</a></span> | <span class="t">Pulp Fiction and Godfeather are high up here, I'm going to guess that a high value is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1319" target="_blank">00:21:59.880</a></span> | <span class="t">going to represent critically acclaimed movies or serious watching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1325" target="_blank">00:22:05.440</a></span> | <span class="t">So I called this "easy watching vs. serious", but this is kind of how you have to interpret</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1333" target="_blank">00:22:13.280</a></span> | <span class="t">your embeddings, take a look at what they seem to be showing and decide what you think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1339" target="_blank">00:22:19.120</a></span> | <span class="t">it means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1340" target="_blank">00:22:20.120</a></span> | <span class="t">So this is the principal axis in this set of embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1345" target="_blank">00:22:25.520</a></span> | <span class="t">So we can look at the next one, so do the same thing and look at the first index 1 embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1353" target="_blank">00:22:33.640</a></span> | <span class="t">This one's a little bit harder to figure out what's going on, but with things like Mulholland</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1357" target="_blank">00:22:37.700</a></span> | <span class="t">Drive and Purple Rose of Cairo, these look more kind of dialog-y ones, or else things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1364" target="_blank">00:22:44.400</a></span> | <span class="t">like Lord of the Rings and Aladdin and Star Wars, these look more like modern CGI-y ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1369" target="_blank">00:22:49.720</a></span> | <span class="t">So you can imagine that on that pair of dimensions, it probably represents a lot of differences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1377" target="_blank">00:22:57.960</a></span> | <span class="t">between how people rate movies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1380" target="_blank">00:23:00.320</a></span> | <span class="t">Some people like Purple Rise of Cairo type movies, Woody Allen kind of classic, and some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1389" target="_blank">00:23:09.920</a></span> | <span class="t">people like these big Hollywood spectacles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1395" target="_blank">00:23:15.240</a></span> | <span class="t">Some people presumably like Police Academy 4 more than they like Fargo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1402" target="_blank">00:23:22.720</a></span> | <span class="t">So you can kind of get the idea of what's happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1414" target="_blank">00:23:34.560</a></span> | <span class="t">For a model which was literally multiply two things together in atom hub, it's learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1422" target="_blank">00:23:42.200</a></span> | <span class="t">quite a lot, which is kind of cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1427" target="_blank">00:23:47.380</a></span> | <span class="t">So that's what we can do with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1432" target="_blank">00:23:52.380</a></span> | <span class="t">And then we could plot them if we wanted to, I just grabbed a small subset to plot on those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1440" target="_blank">00:24:00.320</a></span> | <span class="t">first two axes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1442" target="_blank">00:24:02.160</a></span> | <span class="t">Alright, so that's that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1445" target="_blank">00:24:05.280</a></span> | <span class="t">So I wanted to next dig in a layer deeper into what actually happens when we say fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1456" target="_blank">00:24:16.680</a></span> | <span class="t">So when we said learn.fit, what's it doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1465" target="_blank">00:24:25.200</a></span> | <span class="t">For something like the store model, is it a way to interpret the embeddings?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1469" target="_blank">00:24:29.920</a></span> | <span class="t">For something like the Rustman one?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1472" target="_blank">00:24:32.960</a></span> | <span class="t">Yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1473" target="_blank">00:24:33.960</a></span> | <span class="t">We'll see that in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1474" target="_blank">00:24:34.960</a></span> | <span class="t">Well let's jump straight there, what the hell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1485" target="_blank">00:24:45.400</a></span> | <span class="t">So for the Rustman, how much are we going to sell at each store on each date model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1503" target="_blank">00:25:03.580</a></span> | <span class="t">This is from the paper, Guar and Birkan.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1506" target="_blank">00:25:06.040</a></span> | <span class="t">It's a great paper, by the way, well worth it, pretty accessible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1510" target="_blank">00:25:10.720</a></span> | <span class="t">I think any of you would at this point be able to at least get the gist of it, and much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1516" target="_blank">00:25:16.960</a></span> | <span class="t">of the detail as well, particularly as you've also done the machine learning course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1522" target="_blank">00:25:22.240</a></span> | <span class="t">And they actually make this point in the paper, this is in the paper, that the equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1526" target="_blank">00:25:26.960</a></span> | <span class="t">of what they call entity embedding layers, an embedding of a categorical variable, is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1532" target="_blank">00:25:32.200</a></span> | <span class="t">identical to a one-hot encoding followed by a matrix multiplier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1539" target="_blank">00:25:39.080</a></span> | <span class="t">So they're basically saying if you've got three embeddings, that's the same as doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1543" target="_blank">00:25:43.380</a></span> | <span class="t">three one-hot encodings, putting each one through a matrix multiplier, and then put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1548" target="_blank">00:25:48.280</a></span> | <span class="t">that through a dense layer, or what PyTorch would call a linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1556" target="_blank">00:25:56.980</a></span> | <span class="t">One of the nice things here is because this is kind of like, well they thought it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1560" target="_blank">00:26:00.360</a></span> | <span class="t">the first paper, it was actually the second, I think, paper to show the idea of using categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1564" target="_blank">00:26:04.560</a></span> | <span class="t">embeddings for this kind of dataset, they really go into quite a lot of detail, right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1571" target="_blank">00:26:11.200</a></span> | <span class="t">back to the detailed stuff that we learned about, so it's kind of a second cut at thinking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1576" target="_blank">00:26:16.880</a></span> | <span class="t">about what embeddings are doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1581" target="_blank">00:26:21.200</a></span> | <span class="t">So one of the interesting things that they did was they said after we've trained a neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1585" target="_blank">00:26:25.760</a></span> | <span class="t">net with these embeddings, what else could we do with it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1593" target="_blank">00:26:33.520</a></span> | <span class="t">So they got a winning result with a neural network with entity embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1601" target="_blank">00:26:41.120</a></span> | <span class="t">But then they said hey you know what, we could take those entity embeddings and replace each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1605" target="_blank">00:26:45.780</a></span> | <span class="t">categorical variable with the learned entity embeddings, and then feed that into a GBM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1614" target="_blank">00:26:54.080</a></span> | <span class="t">So in other words, rather than passing into the GBM a one-hot encoded version, or an ordinal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1619" target="_blank">00:26:59.600</a></span> | <span class="t">version, let's actually replace the categorical variable with its embedding for the appropriate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1627" target="_blank">00:27:07.680</a></span> | <span class="t">level for that row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1629" target="_blank">00:27:09.680</a></span> | <span class="t">So it's actually a way of feature engineering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1634" target="_blank">00:27:14.200</a></span> | <span class="t">And so the main average percent error without that for GBMs using just one-hot encodings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1643" target="_blank">00:27:23.440</a></span> | <span class="t">was 0.15, but with that it was 0.11.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1648" target="_blank">00:27:28.880</a></span> | <span class="t">Random forests without that was 0.16, with that 0.108 nearly as good as the neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1657" target="_blank">00:27:37.440</a></span> | <span class="t">So this is kind of an interesting technique because what it means is in your organization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1663" target="_blank">00:27:43.520</a></span> | <span class="t">you can train a neural net that has an embedding of stores, and an embedding of product types,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1669" target="_blank">00:27:49.880</a></span> | <span class="t">and an embedding of whatever kind of high cardinality or even medium cardinality categorical variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1675" target="_blank">00:27:55.920</a></span> | <span class="t">you have, and then everybody else in the organization can now chuck those into their GBM or random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1683" target="_blank">00:28:03.120</a></span> | <span class="t">forest or whatever and use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1687" target="_blank">00:28:07.000</a></span> | <span class="t">And what this is saying is they won't get, in fact you can even use k-nearest neighbors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1692" target="_blank">00:28:12.480</a></span> | <span class="t">with this technique and get nearly as good a result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1695" target="_blank">00:28:15.680</a></span> | <span class="t">So this is a good way of giving the power of neural nets to everybody in your organization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1702" target="_blank">00:28:22.600</a></span> | <span class="t">without having them do the fast AI deep learning course first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1706" target="_blank">00:28:26.760</a></span> | <span class="t">They can just use whatever sklearn or R or whatever that they're used to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1711" target="_blank">00:28:31.240</a></span> | <span class="t">And those embeddings could literally be in a database table because if you think about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1716" target="_blank">00:28:36.320</a></span> | <span class="t">an embedding as just an index lookup, which is the same as an inner join in SQL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1723" target="_blank">00:28:43.480</a></span> | <span class="t">So if you've got a table of each product along with its embedding vector, then you can literally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1728" target="_blank">00:28:48.560</a></span> | <span class="t">do an inner join, and now you have every row in your table along with its product embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1733" target="_blank">00:28:53.480</a></span> | <span class="t">vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1736" target="_blank">00:28:56.120</a></span> | <span class="t">This is a really useful idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1739" target="_blank">00:28:59.280</a></span> | <span class="t">And GBMs and random forests learn a lot quicker than neural nets do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1752" target="_blank">00:29:12.080</a></span> | <span class="t">So here's what happened when they took the various different states of Germany and plotted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1757" target="_blank">00:29:17.360</a></span> | <span class="t">the first two principal components of their embedding vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1761" target="_blank">00:29:21.200</a></span> | <span class="t">And they basically here is where they were in that 2D space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1765" target="_blank">00:29:25.240</a></span> | <span class="t">And wackily enough, I've circled in red 3 cities, and I've circled here the 3 cities in Germany.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1772" target="_blank">00:29:32.720</a></span> | <span class="t">And here I've circled in purple, sorry blue, here are the blue, here's the green, here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1777" target="_blank">00:29:37.960</a></span> | <span class="t">the green.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1778" target="_blank">00:29:38.960</a></span> | <span class="t">So it's actually drawn a map of Germany, even though it never was told anything about how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1786" target="_blank">00:29:46.920</a></span> | <span class="t">far these states are away from each other or the very concept of geography didn't exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1792" target="_blank">00:29:52.200</a></span> | <span class="t">So that's pretty crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1796" target="_blank">00:29:56.640</a></span> | <span class="t">So that was from their paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1798" target="_blank">00:29:58.320</a></span> | <span class="t">So I went ahead and looked -- here's another thing, I think this is also from their paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1804" target="_blank">00:30:04.440</a></span> | <span class="t">They took every pair of places and they looked at how far away they are on a map versus how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1813" target="_blank">00:30:13.480</a></span> | <span class="t">far away are they in embedding space, and they got this beautiful correlation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1820" target="_blank">00:30:20.600</a></span> | <span class="t">So again, apparently stores that are nearby each other physically have similar characteristics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1831" target="_blank">00:30:31.340</a></span> | <span class="t">in terms of when people buy more or less stuff from them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1835" target="_blank">00:30:35.680</a></span> | <span class="t">So I looked at the same thing for days of the week, so here's an embedding of the days</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1841" target="_blank">00:30:41.320</a></span> | <span class="t">of the week from our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1843" target="_blank">00:30:43.640</a></span> | <span class="t">And I just joined up Monday, Tuesday, Wednesday, Tuesday, Thursday, Friday, Saturday, Sunday.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1847" target="_blank">00:30:47.080</a></span> | <span class="t">I did the same thing for the months of the year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1851" target="_blank">00:30:51.240</a></span> | <span class="t">You can say, here's winter, here's summer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1857" target="_blank">00:30:57.160</a></span> | <span class="t">So I think visualizing embeddings can be interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1863" target="_blank">00:31:03.040</a></span> | <span class="t">It's good to first of all check you can see things you would expect to see, and then you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1869" target="_blank">00:31:09.680</a></span> | <span class="t">could try and see maybe things you didn't expect to see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1873" target="_blank">00:31:13.000</a></span> | <span class="t">So you could try all kinds of clusterings or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1880" target="_blank">00:31:20.680</a></span> | <span class="t">And this is not something which has been widely studied at all, so I'm not going to tell you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1885" target="_blank">00:31:25.720</a></span> | <span class="t">what the limitations are of this technique or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1889" target="_blank">00:31:29.200</a></span> | <span class="t">I've heard of other ways to generate embeddings like skip-grams, I was wondering if you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1899" target="_blank">00:31:39.120</a></span> | <span class="t">say is there one better than the other using neural networks or skip-grams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1904" target="_blank">00:31:44.240</a></span> | <span class="t">So skip-grams is quite specific to NLP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1906" target="_blank">00:31:46.920</a></span> | <span class="t">I'm not sure if we'll cover it in this course, but basically the original Word2vec approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1918" target="_blank">00:31:58.480</a></span> | <span class="t">to generating embeddings was to say, we don't actually have a labeled dataset, all we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1932" target="_blank">00:32:12.240</a></span> | <span class="t">is like Google Maps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1934" target="_blank">00:32:14.200</a></span> | <span class="t">And so they have an unsupervised learning problem, unlabeled problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1938" target="_blank">00:32:18.200</a></span> | <span class="t">And so the best way in my opinion to turn an unlabeled problem into a labeled problem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1942" target="_blank">00:32:22.520</a></span> | <span class="t">is to kind of invent some labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1945" target="_blank">00:32:25.000</a></span> | <span class="t">And so what they did in the Word2vec case was they said okay, here's a sentence with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1949" target="_blank">00:32:29.720</a></span> | <span class="t">11 words in it, and then they said okay, let's delete the middle word and replace it with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1960" target="_blank">00:32:40.560</a></span> | <span class="t">a random word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1962" target="_blank">00:32:42.720</a></span> | <span class="t">And so originally it said cat, and they said no, let's replace that with justice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1974" target="_blank">00:32:54.160</a></span> | <span class="t">So before it said the cute little cat sat on the fuzzy mat, and now it says the cute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1979" target="_blank">00:32:59.360</a></span> | <span class="t">little justice sat on the fuzzy mat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1982" target="_blank">00:33:02.480</a></span> | <span class="t">And what they do is they do that so they have one sentence where they keep exactly as is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1992" target="_blank">00:33:12.200</a></span> | <span class="t">and then they make a copy of it and they do the replacement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=1996" target="_blank">00:33:16.080</a></span> | <span class="t">And so then they have a label where they say it's a 1 if it was unchanged, it was the original,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2003" target="_blank">00:33:23.040</a></span> | <span class="t">and 0 otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2006" target="_blank">00:33:26.640</a></span> | <span class="t">And so basically then you now have something you can build a machine learning model on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2012" target="_blank">00:33:32.120</a></span> | <span class="t">and so they went and built a machine learning model on this, so the model was like try and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2015" target="_blank">00:33:35.960</a></span> | <span class="t">find the faked sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2020" target="_blank">00:33:40.760</a></span> | <span class="t">Not because they were interested in a fake sentence finder, but because as a result they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2024" target="_blank">00:33:44.960</a></span> | <span class="t">now have embeddings that just like we discussed you can now use for other purposes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2029" target="_blank">00:33:49.280</a></span> | <span class="t">And that became Word2vec.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2030" target="_blank">00:33:50.600</a></span> | <span class="t">Now it turns out that if you do this effectively like a single matrix multiplier rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2039" target="_blank">00:33:59.520</a></span> | <span class="t">making a deep neural net, you can train this super quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2044" target="_blank">00:34:04.520</a></span> | <span class="t">And so that's basically what they did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2046" target="_blank">00:34:06.800</a></span> | <span class="t">They decided we're going to make a pretty crappy model, like a shallow learning model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2052" target="_blank">00:34:12.320</a></span> | <span class="t">rather than a deep model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2054" target="_blank">00:34:14.920</a></span> | <span class="t">With the downside it's a less powerful model, but a number of upsides.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2058" target="_blank">00:34:18.760</a></span> | <span class="t">The first thing is we can train it on a really large dataset, and then also really importantly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2063" target="_blank">00:34:23.720</a></span> | <span class="t">we're going to end up with embeddings which have really very linear characteristics, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2069" target="_blank">00:34:29.800</a></span> | <span class="t">we can add them together and subtract them and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2075" target="_blank">00:34:35.840</a></span> | <span class="t">So there's a lot of stuff we can learn about there for other types of embedding, like categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2082" target="_blank">00:34:42.560</a></span> | <span class="t">embeddings, specifically if we want categorical embeddings which we can kind of draw nicely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2089" target="_blank">00:34:49.720</a></span> | <span class="t">and expect us to be able to add and subtract them and behave linearly, probably if we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2095" target="_blank">00:34:55.840</a></span> | <span class="t">to use them in k-nearest neighbors and stuff, we should probably use shallow learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2102" target="_blank">00:35:02.580</a></span> | <span class="t">If we want something that's going to be more predictive, we probably want to use a neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2107" target="_blank">00:35:07.320</a></span> | <span class="t">net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2108" target="_blank">00:35:08.840</a></span> | <span class="t">And so actually in NLP, I'm really pushing the idea that we need to move past Word2vec</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2117" target="_blank">00:35:17.000</a></span> | <span class="t">and GloVe, these linear-based methods, because it turns out that those embeddings are way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2122" target="_blank">00:35:22.180</a></span> | <span class="t">less predictive than embeddings learned from deep models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2126" target="_blank">00:35:26.240</a></span> | <span class="t">And so the language model that we learned about which ended up getting a state-of-the-art</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2129" target="_blank">00:35:29.680</a></span> | <span class="t">on sentiment analysis didn't use GloVe or Word2vec, but instead we pre-trained a deeper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2135" target="_blank">00:35:35.360</a></span> | <span class="t">current neural network, and we ended up with not just pre-trained Word vectors but a full</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2140" target="_blank">00:35:40.600</a></span> | <span class="t">pre-trained model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2143" target="_blank">00:35:43.400</a></span> | <span class="t">So it looks like to create embeddings for entities we need a dummy task, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2151" target="_blank">00:35:51.040</a></span> | <span class="t">Not necessarily a dummy task, like in this case we had a real task, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2154" target="_blank">00:35:54.480</a></span> | <span class="t">So we created the embeddings for Rossman by trying to predict store sales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2162" target="_blank">00:36:02.120</a></span> | <span class="t">This isn't just for learning embeddings, for learning any kind of feature space, you either</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2169" target="_blank">00:36:09.660</a></span> | <span class="t">need labeled data, or you need to invent some kind of fake task.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2176" target="_blank">00:36:16.840</a></span> | <span class="t">So does a task matter, like if I choose a task and train embeddings, if I choose another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2181" target="_blank">00:36:21.240</a></span> | <span class="t">task and train embeddings, like which one is?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2186" target="_blank">00:36:26.200</a></span> | <span class="t">It's a great question, and it's not something that's been studied nearly enough, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2190" target="_blank">00:36:30.800</a></span> | <span class="t">I'm not sure that many people even quite understand that when they say unsupervised learning nowadays,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2198" target="_blank">00:36:38.000</a></span> | <span class="t">they almost nearly always mean fake task labeled learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2204" target="_blank">00:36:44.280</a></span> | <span class="t">And so the idea of what makes a good fake task, I don't know that I've seen a paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2209" target="_blank">00:36:49.600</a></span> | <span class="t">on that, but intuitively, we need something where the kinds of relationships it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2218" target="_blank">00:36:58.080</a></span> | <span class="t">to learn are likely to be the kinds of relationships that you probably care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2223" target="_blank">00:37:03.520</a></span> | <span class="t">So for example, in computer vision, one kind of fake task people use is to say let's take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2235" target="_blank">00:37:15.200</a></span> | <span class="t">some images and use some kind of unreal and unreasonable data augmentation, like recolor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2242" target="_blank">00:37:22.200</a></span> | <span class="t">them too much or whatever, and then we'll ask the neural net to predict which one was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2247" target="_blank">00:37:27.320</a></span> | <span class="t">the augmented and which one was not the augmented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2256" target="_blank">00:37:36.680</a></span> | <span class="t">I think it's a fascinating area, and one which would be really interesting for people, maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2263" target="_blank">00:37:43.160</a></span> | <span class="t">some of the students here to look into further, is take some interesting semi-supervised or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2267" target="_blank">00:37:47.260</a></span> | <span class="t">unsupervised data sets and try and come up with some more clever fake tasks and see does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2275" target="_blank">00:37:55.680</a></span> | <span class="t">it matter, how much does it matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2278" target="_blank">00:37:58.800</a></span> | <span class="t">In general, if you can't come up with a fake task that you think seems great, I would say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2283" target="_blank">00:38:03.520</a></span> | <span class="t">use it the best you can, it's often surprising how little you need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2290" target="_blank">00:38:10.120</a></span> | <span class="t">The ultimately crappy fake task is called the autoencoder, and the autoencoder is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2297" target="_blank">00:38:17.240</a></span> | <span class="t">thing which won the claims prediction competition that just finished on Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2302" target="_blank">00:38:22.720</a></span> | <span class="t">They had lots of examples of insurance policies where we knew this was how much was claimed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2309" target="_blank">00:38:29.080</a></span> | <span class="t">and then lots of examples of insurance policies where I guess they must have been still open,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2314" target="_blank">00:38:34.040</a></span> | <span class="t">we didn't yet know how much they claimed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2316" target="_blank">00:38:36.600</a></span> | <span class="t">So what they did was they said let's basically start off by grabbing every policy, and we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2324" target="_blank">00:38:44.040</a></span> | <span class="t">take a single policy and we'll put it through a neural net, and we'll try and have it reconstruct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2332" target="_blank">00:38:52.680</a></span> | <span class="t">itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2335" target="_blank">00:38:55.600</a></span> | <span class="t">But in these intermediate layers, at least one of those intermediate layers, we'll make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2339" target="_blank">00:38:59.680</a></span> | <span class="t">sure there's less activations than there were inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2343" target="_blank">00:39:03.080</a></span> | <span class="t">So let's say if there was 100 variables on the insurance policy, we'll have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2348" target="_blank">00:39:08.440</a></span> | <span class="t">in the middle that only has 20 activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2352" target="_blank">00:39:12.880</a></span> | <span class="t">And so when you basically are saying hey, reconstruct your own input, it's not a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2358" target="_blank">00:39:18.000</a></span> | <span class="t">kind of model, it doesn't require any special code, it's literally just passing, you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2364" target="_blank">00:39:24.160</a></span> | <span class="t">use any standard PyTorch or fastai learner, you just say my output equals my input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2371" target="_blank">00:39:31.200</a></span> | <span class="t">And that's the most uncreative, invented task you can create.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2377" target="_blank">00:39:37.560</a></span> | <span class="t">That's called an autoencoder, and it works surprisingly well, in fact to the point that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2382" target="_blank">00:39:42.000</a></span> | <span class="t">it literally just won a Kaggle competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2384" target="_blank">00:39:44.640</a></span> | <span class="t">They took the features that it learned and chucked it into another neural net and won.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2393" target="_blank">00:39:53.800</a></span> | <span class="t">Maybe if we have enough students taking an interest in this, then we'll be able to cover</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2400" target="_blank">00:40:00.560</a></span> | <span class="t">unsupervised learning in more detail in Part 2, especially given this Kaggle win.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2406" target="_blank">00:40:06.440</a></span> | <span class="t">I think this may be related to the previous question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2416" target="_blank">00:40:16.800</a></span> | <span class="t">Is the language model for example trained on the archive data?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2419" target="_blank">00:40:19.160</a></span> | <span class="t">Is that useful at all in the movie lens, the IMDB data?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2425" target="_blank">00:40:25.000</a></span> | <span class="t">Great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2426" target="_blank">00:40:26.000</a></span> | <span class="t">I was just talking to Sebastian about this, Sebastian wrote about this this week, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2431" target="_blank">00:40:31.560</a></span> | <span class="t">we thought we'd try and do some research on this in January.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2435" target="_blank">00:40:35.560</a></span> | <span class="t">Again, it's not well known.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2437" target="_blank">00:40:37.120</a></span> | <span class="t">We know that in computer vision, it's shockingly effective to train on cats and dogs, and use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2444" target="_blank">00:40:44.320</a></span> | <span class="t">that pre-trained network to do lung cancer diagnosis in CT scans.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2449" target="_blank">00:40:49.680</a></span> | <span class="t">In the NLP world, nobody much seems to have tried this, the NLP researchers I've spoken</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2455" target="_blank">00:40:55.600</a></span> | <span class="t">to, other than Sebastian, about this assume that it wouldn't work and they generally haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2460" target="_blank">00:41:00.240</a></span> | <span class="t">bothered trying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2461" target="_blank">00:41:01.240</a></span> | <span class="t">I think it would work great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2464" target="_blank">00:41:04.400</a></span> | <span class="t">Since we're talking about Rustman, I'll just mention during the week, I was interested</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2473" target="_blank">00:41:13.080</a></span> | <span class="t">to see how good this solution actually was, because I noticed that on the public leaderboard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2480" target="_blank">00:41:20.340</a></span> | <span class="t">it didn't look like it was going to be that great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2483" target="_blank">00:41:23.280</a></span> | <span class="t">I also thought it would be good to see what does it actually take to use a test set properly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2489" target="_blank">00:41:29.400</a></span> | <span class="t">with this kind of structured data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2491" target="_blank">00:41:31.280</a></span> | <span class="t">So if you have a look at Rustman now, I've pushed some changes that actually run the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2495" target="_blank">00:41:35.080</a></span> | <span class="t">test set through as well, so you can get a sense of how to do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2498" target="_blank">00:41:38.720</a></span> | <span class="t">So you'll see basically every line appears twice, one for test and one for train when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2505" target="_blank">00:41:45.840</a></span> | <span class="t">we get the test, train, test, train, test, train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2508" target="_blank">00:41:48.840</a></span> | <span class="t">Obviously you could do this in a lot fewer lines of code by putting all of the steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2513" target="_blank">00:41:53.120</a></span> | <span class="t">into a method and then pass either the train data set or the test data frame to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2518" target="_blank">00:41:58.600</a></span> | <span class="t">In this case, for teaching purposes you'd be able to see each step and experiment to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2525" target="_blank">00:42:05.160</a></span> | <span class="t">see what each step looks like, but you can certainly simplify this code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2532" target="_blank">00:42:12.040</a></span> | <span class="t">So we do this for every data frame, and then for some of these you can see I kind of loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2537" target="_blank">00:42:17.520</a></span> | <span class="t">through the data frame in join and for join test, train and test.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2544" target="_blank">00:42:24.480</a></span> | <span class="t">This whole thing about the durations, I basically put two lines here, one that says data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2550" target="_blank">00:42:30.760</a></span> | <span class="t">equals train columns, one that says data frame equals test columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2554" target="_blank">00:42:34.640</a></span> | <span class="t">And so my idea is you'd run this line first and then you would skip the next one and run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2560" target="_blank">00:42:40.760</a></span> | <span class="t">everything beneath it, and then you'd go back and run this line and then run everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2565" target="_blank">00:42:45.280</a></span> | <span class="t">beneath it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2566" target="_blank">00:42:46.280</a></span> | <span class="t">So some people on the forum were asking how come this code wasn't working this week, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2570" target="_blank">00:42:50.840</a></span> | <span class="t">is a good reminder that the code is not designed to be code that you always run top to bottom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2576" target="_blank">00:42:56.040</a></span> | <span class="t">without thinking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2577" target="_blank">00:42:57.040</a></span> | <span class="t">You're meant to think, what is this code here, should I be running it right now?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2583" target="_blank">00:43:03.760</a></span> | <span class="t">And so the early lessons I tried to make it so you can run it top to bottom, but increasingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2588" target="_blank">00:43:08.160</a></span> | <span class="t">as we go along I kind of make it more and more that you actually have to think about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2591" target="_blank">00:43:11.560</a></span> | <span class="t">what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2593" target="_blank">00:43:13.920</a></span> | <span class="t">So Jeremy, you're talking about shallow learning and deep learning, could you define that a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2601" target="_blank">00:43:21.040</a></span> | <span class="t">bit better?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2602" target="_blank">00:43:22.040</a></span> | <span class="t">By shallow learning, I think I just mean anything that doesn't have a hidden layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2605" target="_blank">00:43:25.760</a></span> | <span class="t">So something that's like a dot product, a matrix multiplier basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2620" target="_blank">00:43:40.720</a></span> | <span class="t">So we end up with a training and a test version, and then everything else is basically the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2626" target="_blank">00:43:46.800</a></span> | <span class="t">same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2629" target="_blank">00:43:49.160</a></span> | <span class="t">One thing to note, and a lot of the details of this we cover in the machine learning course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2633" target="_blank">00:43:53.000</a></span> | <span class="t">by the way, because it's not really deep learning specific, so check that out if you're interested</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2636" target="_blank">00:43:56.160</a></span> | <span class="t">in the details.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2638" target="_blank">00:43:58.800</a></span> | <span class="t">I should mention we use apply cats rather than train cats to make sure that the test</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2643" target="_blank">00:44:03.440</a></span> | <span class="t">set and the training set have the same categorical codes that they join to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2652" target="_blank">00:44:12.720</a></span> | <span class="t">We also need to make sure that we keep track of the mapper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2655" target="_blank">00:44:15.640</a></span> | <span class="t">This is the thing which basically says what's the mean and standard deviation of each continuous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2659" target="_blank">00:44:19.960</a></span> | <span class="t">column and then apply that same mapper to the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2667" target="_blank">00:44:27.020</a></span> | <span class="t">And so when we do all that, that's basically it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2668" target="_blank">00:44:28.720</a></span> | <span class="t">When the rest is easy, we just have to pass in the test data frame in the usual way when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2674" target="_blank">00:44:34.560</a></span> | <span class="t">we create our model data object, and then there's no changes through all here, we train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2682" target="_blank">00:44:42.240</a></span> | <span class="t">it in the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2683" target="_blank">00:44:43.640</a></span> | <span class="t">And then once we finish training it, we can then call predict as per usual passing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2694" target="_blank">00:44:54.880</a></span> | <span class="t">true to say this is the test set rather than the validation set, and pass that off to Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2702" target="_blank">00:45:02.260</a></span> | <span class="t">And so it was really interesting because this was my submission, it got a public score of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2709" target="_blank">00:45:09.860</a></span> | <span class="t">103, which would put us in about 300 and somethings plus, which looks awful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2724" target="_blank">00:45:24.040</a></span> | <span class="t">And our private score of 107 is about 5th.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2740" target="_blank">00:45:40.400</a></span> | <span class="t">So if you're competing in a Kaggle competition and you haven't thoughtfully created a validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2747" target="_blank">00:45:47.520</a></span> | <span class="t">set of your own and you're relying on public leaderboard feedback, this could totally happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2752" target="_blank">00:45:52.480</a></span> | <span class="t">to you, but the other way round, you'll be like, "Oh, I'm in the top 10, I'm doing great!"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2756" target="_blank">00:45:56.920</a></span> | <span class="t">And then, uh-oh.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2758" target="_blank">00:45:58.200</a></span> | <span class="t">For example, at the moment, the icebergs competition, recognizing icebergs, a very large percentage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2764" target="_blank">00:46:04.800</a></span> | <span class="t">of the public leaderboard set is synthetically generated data augmentation data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2770" target="_blank">00:46:10.600</a></span> | <span class="t">Like totally meaningless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2773" target="_blank">00:46:13.040</a></span> | <span class="t">And so your validation set is going to be much more helpful than the public leaderboard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2777" target="_blank">00:46:17.200</a></span> | <span class="t">feedback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2778" target="_blank">00:46:18.760</a></span> | <span class="t">So be very careful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2782" target="_blank">00:46:22.120</a></span> | <span class="t">So our final score here is kind of within statistical noise of the actual 3rd place getters, so I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2788" target="_blank">00:46:28.280</a></span> | <span class="t">pretty confident that we've captured their approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2792" target="_blank">00:46:32.560</a></span> | <span class="t">And so that's pretty interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2800" target="_blank">00:46:40.040</a></span> | <span class="t">Something to mention, there's a nice kernel about the Rossman, quite a few nice kernels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2804" target="_blank">00:46:44.600</a></span> | <span class="t">actually, but you can go back and see, particularly if you're doing the groceries competition,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2808" target="_blank">00:46:48.280</a></span> | <span class="t">go and have a look at the Rossman kernels, because actually quite a few of them are higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2811" target="_blank">00:46:51.400</a></span> | <span class="t">quality than the ones for the Ecuadorian Groceries competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2815" target="_blank">00:46:55.640</a></span> | <span class="t">One of them, for example, showed how for particular stores, like Store85, the sales for non-sundays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2824" target="_blank">00:47:04.320</a></span> | <span class="t">and the sale for sundays looked very different, whereas there are some other stores where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2829" target="_blank">00:47:09.800</a></span> | <span class="t">the sales on Sunday don't look any different, and you can kind of get a sense of why you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2834" target="_blank">00:47:14.160</a></span> | <span class="t">need these kinds of interactions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2835" target="_blank">00:47:15.800</a></span> | <span class="t">The one I particularly wanted to point out is the one I think I briefly mentioned, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2839" target="_blank">00:47:19.360</a></span> | <span class="t">the 3rd place winners whose approach we used they didn't notice is this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2845" target="_blank">00:47:25.280</a></span> | <span class="t">And here's a really cool visualization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2848" target="_blank">00:47:28.840</a></span> | <span class="t">Here you can see that the store is closed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2854" target="_blank">00:47:34.560</a></span> | <span class="t">And just after, oh my god, we ran out of eggs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2859" target="_blank">00:47:39.320</a></span> | <span class="t">And just before, oh my god, go and get the milk before the store closes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2865" target="_blank">00:47:45.040</a></span> | <span class="t">And here again, closed, bang.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2868" target="_blank">00:47:48.300</a></span> | <span class="t">So this 3rd place winner actually deleted all of the closed store rows before they started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2875" target="_blank">00:47:55.440</a></span> | <span class="t">doing any analysis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2877" target="_blank">00:47:57.160</a></span> | <span class="t">So remember how we talked about don't touch your data unless you first of all analyze</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2883" target="_blank">00:48:03.400</a></span> | <span class="t">to see whether that thing you're doing is actually okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2888" target="_blank">00:48:08.080</a></span> | <span class="t">No assumptions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2889" target="_blank">00:48:09.840</a></span> | <span class="t">So in this case, I am sure, I haven't tried it, but I'm sure they would have won otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2895" target="_blank">00:48:15.840</a></span> | <span class="t">Although there weren't actually any store closures to my knowledge in the test set period,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2901" target="_blank">00:48:21.760</a></span> | <span class="t">the problem is that their model was trying to fit to these really extreme things, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2907" target="_blank">00:48:27.200</a></span> | <span class="t">because it wasn't able to do it very well, it was going to end up getting a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2911" target="_blank">00:48:31.040</a></span> | <span class="t">confused.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2912" target="_blank">00:48:32.040</a></span> | <span class="t">It's not going to break the model, but it's definitely going to harm it because it's kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2915" target="_blank">00:48:35.680</a></span> | <span class="t">of trying to do computations to fit something which it literally doesn't have the data for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2920" target="_blank">00:48:40.080</a></span> | <span class="t">Yannette, can you pass that back there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2924" target="_blank">00:48:44.600</a></span> | <span class="t">So that Rossman model, again, it's nice to kind of look inside to see what's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2933" target="_blank">00:48:53.440</a></span> | <span class="t">going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2935" target="_blank">00:48:55.240</a></span> | <span class="t">And so that Rossman model, I want to make sure you kind of know how to find your way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2944" target="_blank">00:49:04.080</a></span> | <span class="t">around the code so you can answer these questions for yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2946" target="_blank">00:49:06.280</a></span> | <span class="t">So it's inside columnar model data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2952" target="_blank">00:49:12.240</a></span> | <span class="t">We started out by saying hey, if you want to look at the code for something, you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2956" target="_blank">00:49:16.520</a></span> | <span class="t">go question mark, question mark like this, and I haven't got this read in, but you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2964" target="_blank">00:49:24.040</a></span> | <span class="t">use question mark, question mark to get the source code for something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2969" target="_blank">00:49:29.840</a></span> | <span class="t">But obviously that's not really a great way, because often you look at that source code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2974" target="_blank">00:49:34.680</a></span> | <span class="t">and it turns out you need to look at something else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2977" target="_blank">00:49:37.280</a></span> | <span class="t">And so for those of you that haven't done much coding, you might not be aware that almost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2982" target="_blank">00:49:42.040</a></span> | <span class="t">certainly the editor you're using probably has the ability to both open up stuff directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2988" target="_blank">00:49:48.360</a></span> | <span class="t">off SSH and to navigate through it so you can jump straight from place to place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2993" target="_blank">00:49:53.680</a></span> | <span class="t">So I want to show you what I mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=2995" target="_blank">00:49:55.520</a></span> | <span class="t">So if I want to find columnar model data, and I happen to be using vim here, I can basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3001" target="_blank">00:50:01.000</a></span> | <span class="t">say tag columnar model data and it will jump straight to the definition of that class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3009" target="_blank">00:50:09.040</a></span> | <span class="t">And so then I notice here that it's actually building up a data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3013" target="_blank">00:50:13.320</a></span> | <span class="t">That's interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3014" target="_blank">00:50:14.320</a></span> | <span class="t">If I hit Ctrl + right square bracket, it will jump to the definition of the thing that was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3019" target="_blank">00:50:19.280</a></span> | <span class="t">under my cursor, and after I finished reading it for a while, I can hit Ctrl + T to jump</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3024" target="_blank">00:50:24.760</a></span> | <span class="t">back up to where I came from, and you kind of get the idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3029" target="_blank">00:50:29.280</a></span> | <span class="t">If I want to find every usage of this in this file of columnar model data, I can hit * to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3037" target="_blank">00:50:37.680</a></span> | <span class="t">jump to the next place it's used, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3042" target="_blank">00:50:42.200</a></span> | <span class="t">So in this case, get_learner was the thing which actually got the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3050" target="_blank">00:50:50.760</a></span> | <span class="t">We want to find out what kind of model it is, and apparently it uses a columnar model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3065" target="_blank">00:51:05.480</a></span> | <span class="t">data, get_learner, which uses -- and so here you can see mixed_input_model is the PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3073" target="_blank">00:51:13.080</a></span> | <span class="t">model, and then it wraps it in the structured_learner, which is the fast_ai_learner type, which wraps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3082" target="_blank">00:51:22.480</a></span> | <span class="t">the data and the model together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3084" target="_blank">00:51:24.660</a></span> | <span class="t">So if we want to see the definition of this actual PyTorch model, I can go to Ctrl + right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3090" target="_blank">00:51:30.000</a></span> | <span class="t">square bracket to see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3093" target="_blank">00:51:33.680</a></span> | <span class="t">And so here is the model, and nearly all of this we can now understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3102" target="_blank">00:51:42.440</a></span> | <span class="t">So we got past a list of embedding sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3122" target="_blank">00:52:02.720</a></span> | <span class="t">In the mixed model that we saw, does it always expect categorical and continuous together?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3132" target="_blank">00:52:12.880</a></span> | <span class="t">Yes, it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3135" target="_blank">00:52:15.920</a></span> | <span class="t">And the model data behind the scenes, if there are none of the other type, it creates a column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3144" target="_blank">00:52:24.760</a></span> | <span class="t">of 1s or 0s or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3148" target="_blank">00:52:28.320</a></span> | <span class="t">So if it is null, it can still work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3154" target="_blank">00:52:34.600</a></span> | <span class="t">It's kind of ugly and hacky, and we'll hopefully improve it, but you can pass in an empty list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3160" target="_blank">00:52:40.500</a></span> | <span class="t">of categorical or continuous variables to the model data, and it will basically pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3167" target="_blank">00:52:47.120</a></span> | <span class="t">an unused column of 0s to avoid things breaking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3174" target="_blank">00:52:54.560</a></span> | <span class="t">I'm leaving fixing some of these slightly hacky edge cases because PyTorch 0.4 as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3180" target="_blank">00:53:00.920</a></span> | <span class="t">as getting rid of variables, they're going to also add rank 0 tensors, which is to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3187" target="_blank">00:53:07.480</a></span> | <span class="t">if you grab a single thing out of a rank 1 tensor rather than getting back a number which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3193" target="_blank">00:53:13.840</a></span> | <span class="t">is qualitatively different, you're actually going to get back a tensor that just happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3198" target="_blank">00:53:18.960</a></span> | <span class="t">to have no rank.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3199" target="_blank">00:53:19.960</a></span> | <span class="t">Now it turns out that a lot of this code is going to be much easier to write then, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3204" target="_blank">00:53:24.400</a></span> | <span class="t">for now it's a little bit more hacky than it needs to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3208" target="_blank">00:53:28.960</a></span> | <span class="t">Jeremy, you talked about this a little bit before, but maybe it's a good time at some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3215" target="_blank">00:53:35.360</a></span> | <span class="t">point to talk about how can we write something that is slightly different from what is in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3221" target="_blank">00:53:41.560</a></span> | <span class="t">the library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3222" target="_blank">00:53:42.560</a></span> | <span class="t">Yeah, I think we'll cover that a little bit next week, but I'm mainly going to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3228" target="_blank">00:53:48.920</a></span> | <span class="t">in part 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3229" target="_blank">00:53:49.920</a></span> | <span class="t">Part 2 is going to cover quite a lot of stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3234" target="_blank">00:53:54.860</a></span> | <span class="t">One of the main things we'll cover in part 2 is what are called generative models, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3238" target="_blank">00:53:58.480</a></span> | <span class="t">things where the output is a whole sentence or a whole image, but I'll also dig into how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3244" target="_blank">00:54:04.160</a></span> | <span class="t">to really either customize the fastai library or use it on more custom models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3254" target="_blank">00:54:14.800</a></span> | <span class="t">So if we have time, we'll touch on it a little bit next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3260" target="_blank">00:54:20.680</a></span> | <span class="t">So the learner, we were passing in a list of embedding sizes, and as you can see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3267" target="_blank">00:54:27.280</a></span> | <span class="t">embedding sizes list was literally just the number of rows and the number of columns in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3271" target="_blank">00:54:31.360</a></span> | <span class="t">each embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3272" target="_blank">00:54:32.360</a></span> | <span class="t">And the number of rows was just coming from literally how many stores are there in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3278" target="_blank">00:54:38.960</a></span> | <span class="t">store category, for example, and the number of columns was just equal to that divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3284" target="_blank">00:54:44.760</a></span> | <span class="t">by 2 and a maximum of 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3287" target="_blank">00:54:47.780</a></span> | <span class="t">So that list of tuples was coming in, and so you can see here how we use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3292" target="_blank">00:54:52.240</a></span> | <span class="t">We go through each of those tuples, grab the number of categories and the size of the embedding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3299" target="_blank">00:54:59.680</a></span> | <span class="t">and construct an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3302" target="_blank">00:55:02.480</a></span> | <span class="t">And so that's a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3305" target="_blank">00:55:05.240</a></span> | <span class="t">One minor thing, PyTorch-specific thing we haven't talked about before is for it to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3311" target="_blank">00:55:11.080</a></span> | <span class="t">able to register, remember how we kind of said it registers your parameters, it registers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3316" target="_blank">00:55:16.280</a></span> | <span class="t">your layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3318" target="_blank">00:55:18.280</a></span> | <span class="t">So when we listed the model, it actually printed out the name of each embedding and each bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3323" target="_blank">00:55:23.560</a></span> | <span class="t">It can't do that if they're hidden inside a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3327" target="_blank">00:55:27.000</a></span> | <span class="t">They have to be an actual nn.module subclass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3333" target="_blank">00:55:33.440</a></span> | <span class="t">So there's a special thing called an nn.module list which takes a list, and it basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3338" target="_blank">00:55:38.600</a></span> | <span class="t">says I want you to register everything in here as being part of this model, so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3344" target="_blank">00:55:44.440</a></span> | <span class="t">just a minor tweak.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3347" target="_blank">00:55:47.960</a></span> | <span class="t">So our mixed-input model has a list of embeddings, and then I do the same thing for a list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3355" target="_blank">00:55:55.360</a></span> | <span class="t">linear layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3357" target="_blank">00:55:57.440</a></span> | <span class="t">So when I said here 1000, 500, this is saying how many activations I wanted for each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3367" target="_blank">00:56:07.040</a></span> | <span class="t">my linear layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3369" target="_blank">00:56:09.240</a></span> | <span class="t">And so here I just go through that list and create a linear layer that goes from this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3375" target="_blank">00:56:15.240</a></span> | <span class="t">size to the next size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3378" target="_blank">00:56:18.920</a></span> | <span class="t">So you can see how easy it is to construct not just your own model, but a model which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3385" target="_blank">00:56:25.560</a></span> | <span class="t">you can pass parameters to have it constructed on the fly dynamically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3389" target="_blank">00:56:29.960</a></span> | <span class="t">BatchNorm we'll talk about next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3393" target="_blank">00:56:33.200</a></span> | <span class="t">This is initialization, we've mentioned timing initialization before, we mentioned it last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3397" target="_blank">00:56:37.560</a></span> | <span class="t">week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3401" target="_blank">00:56:41.320</a></span> | <span class="t">And then dropout, same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3404" target="_blank">00:56:44.440</a></span> | <span class="t">We have here a list of how much dropout to apply to each layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3408" target="_blank">00:56:48.360</a></span> | <span class="t">So again here, let's just go through each thing in that list and create a dropout layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3413" target="_blank">00:56:53.040</a></span> | <span class="t">for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3414" target="_blank">00:56:54.300</a></span> | <span class="t">So this constructor, we understand everything in it except for BatchNorm, which we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3420" target="_blank">00:57:00.060</a></span> | <span class="t">have to worry about for now, so that's the constructor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3423" target="_blank">00:57:03.900</a></span> | <span class="t">And so then the forward, also all stuff we're aware of, goes through each of those embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3431" target="_blank">00:57:11.120</a></span> | <span class="t">layers that we just saw, and remember we just treated it like it's a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3435" target="_blank">00:57:15.480</a></span> | <span class="t">So call it with the ith categorical variable, and then concatenate them all together, put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3442" target="_blank">00:57:22.040</a></span> | <span class="t">that through dropout, and then go through each one of our linear layers and call it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3451" target="_blank">00:57:31.080</a></span> | <span class="t">apply ReLU to it, apply dropout to it, and then finally apply the final linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3457" target="_blank">00:57:37.720</a></span> | <span class="t">And the final linear layer has this as its size, which is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3467" target="_blank">00:57:47.600</a></span> | <span class="t">Size 1 is a single unit sales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3471" target="_blank">00:57:51.240</a></span> | <span class="t">So we're kind of getting to the point where, and then of course at the end, I mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3476" target="_blank">00:57:56.400</a></span> | <span class="t">we'd come back to this, if you passed in a y_range parameter, then we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3481" target="_blank">00:58:01.920</a></span> | <span class="t">the thing we just learned about last week, which is to use a sigmoid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3486" target="_blank">00:58:06.200</a></span> | <span class="t">This is a cool little trick not just to make your collaborative filtering better, but in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3491" target="_blank">00:58:11.040</a></span> | <span class="t">this case my basic idea was sales are going to be greater than zero, and probably less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3499" target="_blank">00:58:19.680</a></span> | <span class="t">than the largest sale they've ever had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3503" target="_blank">00:58:23.200</a></span> | <span class="t">So I just pass in that as y_range, and so we do a sigmoid and multiply the sigmoid by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3510" target="_blank">00:58:30.440</a></span> | <span class="t">the range that I passed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3513" target="_blank">00:58:33.080</a></span> | <span class="t">And so hopefully we can find that here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3518" target="_blank">00:58:38.800</a></span> | <span class="t">So I actually said maybe the range is between 0 and the highest times 1.2, because maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3527" target="_blank">00:58:47.280</a></span> | <span class="t">the next two weeks we have one bigger, but this is again trying to make it a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3531" target="_blank">00:58:51.120</a></span> | <span class="t">easier for it to give us the kind of results that it thinks is right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3536" target="_blank">00:58:56.160</a></span> | <span class="t">So increasingly, I'd love you all to kind of try to not treat these learners and models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3545" target="_blank">00:59:05.880</a></span> | <span class="t">as black boxes, but to feel like you now have the information you need to look inside them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3551" target="_blank">00:59:11.320</a></span> | <span class="t">And remember you could then copy and paste this plus, paste it into a cell in Jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3556" target="_blank">00:59:16.960</a></span> | <span class="t">Notebook and start fiddling with it to create your own versions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3570" target="_blank">00:59:30.600</a></span> | <span class="t">I think what I might do is we might take a bit of an early break because we've got a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3575" target="_blank">00:59:35.440</a></span> | <span class="t">lot to cover and I want to do it all in one big go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3578" target="_blank">00:59:38.720</a></span> | <span class="t">So let's take a break until 7.45 and then we're going to come back and talk about recurrent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3588" target="_blank">00:59:48.040</a></span> | <span class="t">neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3597" target="_blank">00:59:57.580</a></span> | <span class="t">So we're going to talk about RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3599" target="_blank">00:59:59.360</a></span> | <span class="t">Before we do, we're going to dig a little bit deeper into SGD, because I just want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3606" target="_blank">01:00:06.120</a></span> | <span class="t">make sure everybody's totally comfortable with SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3611" target="_blank">01:00:11.200</a></span> | <span class="t">And so what we're going to look at is we're going to look at a Lesson 6 SGD Notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3618" target="_blank">01:00:18.600</a></span> | <span class="t">And we're going to look at a really simple example of using SGD to learn y=ax+b.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3629" target="_blank">01:00:29.040</a></span> | <span class="t">And so what we're going to do here is create the simplest possible model, y=ax+b.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3638" target="_blank">01:00:38.280</a></span> | <span class="t">And then we're going to generate some random data that looks like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3644" target="_blank">01:00:44.320</a></span> | <span class="t">So here's our x, and here's our y, we're going to predict y from x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3650" target="_blank">01:00:50.240</a></span> | <span class="t">And we passed in 3 and 8 as our a and b, so we're going to try and recover that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3658" target="_blank">01:00:58.720</a></span> | <span class="t">And so the idea is that if we can solve something like this, which has two parameters, we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3664" target="_blank">01:01:04.640</a></span> | <span class="t">use the same technique to solve something with 100 million parameters without any changes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3675" target="_blank">01:01:15.040</a></span> | <span class="t">at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3678" target="_blank">01:01:18.440</a></span> | <span class="t">So in order to find an a and b that fits this, we need a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3685" target="_blank">01:01:25.240</a></span> | <span class="t">And this is a regression problem because we have a continuous output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3689" target="_blank">01:01:29.240</a></span> | <span class="t">So for continuous output regression, we tend to use mean-squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3693" target="_blank">01:01:33.220</a></span> | <span class="t">And obviously all of this stuff, there's implementations in NumPy, implementations in PyTorch, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3697" target="_blank">01:01:37.680</a></span> | <span class="t">just doing stuff by hand so you can see all the steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3701" target="_blank">01:01:41.100</a></span> | <span class="t">So there's MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3703" target="_blank">01:01:43.120</a></span> | <span class="t">y-hat is what we often call our predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3705" target="_blank">01:01:45.620</a></span> | <span class="t">y-hat minus y-squared means there's our mean-squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3709" target="_blank">01:01:49.720</a></span> | <span class="t">So for example, if we had 10 and 5 were our a and b, then there's our mean-squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3718" target="_blank">01:01:58.360</a></span> | <span class="t">So if we've got an a and a b and we've got an x and a y, then our mean-squared error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3721" target="_blank">01:02:01.540</a></span> | <span class="t">loss is just the mean-squared error of our linear predictions and our y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3727" target="_blank">01:02:07.160</a></span> | <span class="t">So there's our loss for 10, 5, x, y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3731" target="_blank">01:02:11.780</a></span> | <span class="t">So that's a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3734" target="_blank">01:02:14.320</a></span> | <span class="t">And so when we talk about combining linear layers and loss functions and optionally nonlinear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3743" target="_blank">01:02:23.160</a></span> | <span class="t">layers, this is all we're doing, we're putting a function inside a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3750" target="_blank">01:02:30.280</a></span> | <span class="t">I know people draw these clever-looking dots and lines all over the screen when they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3756" target="_blank">01:02:36.200</a></span> | <span class="t">saying this is what a neural network is, but it's just a function of a function of a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3760" target="_blank">01:02:40.640</a></span> | <span class="t">So here we've got a prediction function being a linear layer, followed by a loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3764" target="_blank">01:02:44.960</a></span> | <span class="t">being MSE, and now we can say, oh, let's just define this as MSE loss and we'll use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3769" target="_blank">01:02:49.560</a></span> | <span class="t">in the future.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3771" target="_blank">01:02:51.720</a></span> | <span class="t">So there's our loss function, which incorporates our prediction function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3776" target="_blank">01:02:56.760</a></span> | <span class="t">So let's generate 10,000 items of fake data, and let's turn them into variables so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3782" target="_blank">01:03:02.600</a></span> | <span class="t">use them with PyTorch, because Jeremy doesn't like taking derivatives, so we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3785" target="_blank">01:03:05.880</a></span> | <span class="t">use PyTorch for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3788" target="_blank">01:03:08.480</a></span> | <span class="t">And let's create a random weight for A and for B, so a single random number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3794" target="_blank">01:03:14.160</a></span> | <span class="t">And we want the gradients of these to be calculated as we start computing with them, because these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3799" target="_blank">01:03:19.160</a></span> | <span class="t">are the actual things we need to update in our SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3803" target="_blank">01:03:23.820</a></span> | <span class="t">So here's our A and B, 0.029, 0.111.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3810" target="_blank">01:03:30.840</a></span> | <span class="t">So let's pick a learning rate, and let's do 10,000 epochs of SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3820" target="_blank">01:03:40.200</a></span> | <span class="t">In fact, this isn't really SGD, it's not Stochastic Gradient Descent, this is actually full gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3824" target="_blank">01:03:44.180</a></span> | <span class="t">descent, each loop is going to look at all of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3831" target="_blank">01:03:51.600</a></span> | <span class="t">Stochastic Gradient Descent would be looking at a subset each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3836" target="_blank">01:03:56.540</a></span> | <span class="t">So to do gradient descent, we basically calculate the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3840" target="_blank">01:04:00.400</a></span> | <span class="t">So remember, we've started out with a random A and B, and so this is going to compute some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3845" target="_blank">01:04:05.920</a></span> | <span class="t">amount of loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3847" target="_blank">01:04:07.480</a></span> | <span class="t">And it's nice from time to time, so one way of saying from time to time is if the epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3852" target="_blank">01:04:12.760</a></span> | <span class="t">number mod 1000 is 0, so every 1000 epochs, just print out the loss, see how we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3861" target="_blank">01:04:21.560</a></span> | <span class="t">So now that we've computed the loss, we can compute our gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3865" target="_blank">01:04:25.920</a></span> | <span class="t">And so remember, this thing here is both a number, a single number that is our loss, something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3872" target="_blank">01:04:32.840</a></span> | <span class="t">we can print, but it's also a variable because we passed variables into it, and therefore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3877" target="_blank">01:04:37.960</a></span> | <span class="t">it also has a method .backward, which means calculate the gradients of everything that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3883" target="_blank">01:04:43.880</a></span> | <span class="t">we asked it to, everything that we said requires grad equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3888" target="_blank">01:04:48.640</a></span> | <span class="t">So at this point, we now have a .grad property inside A and inside B, and here they are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3898" target="_blank">01:04:58.120</a></span> | <span class="t">here is that .grad property.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3901" target="_blank">01:05:01.760</a></span> | <span class="t">So now that we've calculated the gradients for A and B, we can update them by saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3906" target="_blank">01:05:06.560</a></span> | <span class="t">A is equal to whatever it used to be minus the learning rate times the gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3914" target="_blank">01:05:14.240</a></span> | <span class="t">Update data, because A is a variable, and a variable contains a tensor in its .data property,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3922" target="_blank">01:05:22.720</a></span> | <span class="t">and again this is going to disappear in PyTorch 0.4, but for now it's actually the tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3928" target="_blank">01:05:28.480</a></span> | <span class="t">that we need to update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3930" target="_blank">01:05:30.360</a></span> | <span class="t">So update the tensor inside here with whatever it used to be minus the learning rate times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3935" target="_blank">01:05:35.600</a></span> | <span class="t">the gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3938" target="_blank">01:05:38.680</a></span> | <span class="t">And that's basically it, that's basically all gradient descent is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3944" target="_blank">01:05:44.880</a></span> | <span class="t">So it's as simple as we claimed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3947" target="_blank">01:05:47.320</a></span> | <span class="t">There's one extra step in PyTorch, which is that you might have multiple different loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3953" target="_blank">01:05:53.400</a></span> | <span class="t">functions or lots of output layers all contributing to the gradient, and you have to add them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3960" target="_blank">01:06:00.320</a></span> | <span class="t">all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3961" target="_blank">01:06:01.760</a></span> | <span class="t">And so if you've got multiple loss functions, you could be calling loss.backward on each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3966" target="_blank">01:06:06.560</a></span> | <span class="t">of them, and what it does is it adds it to the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3970" target="_blank">01:06:10.640</a></span> | <span class="t">And so you have to tell it when to set the gradients back to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3975" target="_blank">01:06:15.080</a></span> | <span class="t">So that's where you just go set A to 0, and gradients and set B gradients to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3983" target="_blank">01:06:23.000</a></span> | <span class="t">And so this is wrapped up inside the Optium.sgd class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3991" target="_blank">01:06:31.560</a></span> | <span class="t">So when we say optium.sgd and we just say .stat, it's just doing these for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=3997" target="_blank">01:06:37.800</a></span> | <span class="t">So when we say .zero gradients, it's just doing this for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4002" target="_blank">01:06:42.140</a></span> | <span class="t">And this underscore here, pretty much every function that applies to a tensor in PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4010" target="_blank">01:06:50.080</a></span> | <span class="t">if you stick an underscore on the end, it means do it in place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4013" target="_blank">01:06:53.000</a></span> | <span class="t">So this is actually going to not return a bunch of zeros, but it's going to change this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4017" target="_blank">01:06:57.240</a></span> | <span class="t">in place to be a bunch of zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4021" target="_blank">01:07:01.440</a></span> | <span class="t">So that's basically it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4023" target="_blank">01:07:03.720</a></span> | <span class="t">We can look at the same thing without PyTorch, which means we actually do have to do some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4030" target="_blank">01:07:10.680</a></span> | <span class="t">calculus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4031" target="_blank">01:07:11.840</a></span> | <span class="t">So if we generate some fake data, again, we're just going to create 50 data points this time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4037" target="_blank">01:07:17.460</a></span> | <span class="t">just to make this fast and easy to look at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4041" target="_blank">01:07:21.040</a></span> | <span class="t">And so let's create a function called update, we're just going to use NumPy, no PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4046" target="_blank">01:07:26.840</a></span> | <span class="t">So our predictions are equal to linear, and in this case we're actually going to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4052" target="_blank">01:07:32.200</a></span> | <span class="t">the derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4053" target="_blank">01:07:33.200</a></span> | <span class="t">So the derivative of the square of the loss is just 2 times, and then the derivative with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4058" target="_blank">01:07:38.280</a></span> | <span class="t">respect to a is just that, you can confirm that yourself if you want to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4062" target="_blank">01:07:42.420</a></span> | <span class="t">And so here we're going to update a minus equals learning rate times the derivative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4067" target="_blank">01:07:47.960</a></span> | <span class="t">of loss with respect to a, and for b it's learning rate times derivative with respect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4074" target="_blank">01:07:54.540</a></span> | <span class="t">to b.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4076" target="_blank">01:07:56.120</a></span> | <span class="t">And so what we can do -- let's just run all this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4081" target="_blank">01:08:01.640</a></span> | <span class="t">So just for fun, rather than looping through manually, we can use the matplotlibfuncanimation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4088" target="_blank">01:08:08.320</a></span> | <span class="t">command to run the animate function a bunch of times, and the animate function is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4095" target="_blank">01:08:15.920</a></span> | <span class="t">to run 30 epochs, and at the end of each epoch it's going to print out on the plot where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4102" target="_blank">01:08:22.920</a></span> | <span class="t">the line currently is, and that creates this little movie.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4107" target="_blank">01:08:27.840</a></span> | <span class="t">So you can actually see the line moving into place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4112" target="_blank">01:08:32.520</a></span> | <span class="t">So if you want to play around with understanding how PyTorch gradients actually work, step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4120" target="_blank">01:08:40.720</a></span> | <span class="t">by step here's the world's simplest example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4126" target="_blank">01:08:46.560</a></span> | <span class="t">And it's kind of weird to say that's it, like when you're optimizing 100 million parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4134" target="_blank">01:08:54.200</a></span> | <span class="t">in a neural net, it's doing the same thing, but it actually is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4138" target="_blank">01:08:58.200</a></span> | <span class="t">You can actually look at the PyTorch code and see this is it, there's no trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4145" target="_blank">01:09:05.200</a></span> | <span class="t">Well we learned a couple of minor tricks last time, which was like momentum and atom, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4152" target="_blank">01:09:12.760</a></span> | <span class="t">if you can do it in Excel you can do it in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4156" target="_blank">01:09:16.680</a></span> | <span class="t">So let's now talk about RNNs, so we're now in lesson 6 RNN notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4167" target="_blank">01:09:27.320</a></span> | <span class="t">And we're going to study Nietzsche, as you should.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4175" target="_blank">01:09:35.480</a></span> | <span class="t">So Nietzsche says supposing that truth is a woman, apparently all philosophers have failed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4186" target="_blank">01:09:46.260</a></span> | <span class="t">to understand women.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4187" target="_blank">01:09:47.400</a></span> | <span class="t">So apparently at the point that Nietzsche was alive, there were no female philosophers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4191" target="_blank">01:09:51.160</a></span> | <span class="t">or at least those that were around didn't understand women either.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4194" target="_blank">01:09:54.540</a></span> | <span class="t">So anyway, this is the philosopher apparently we've chosen to study.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4200" target="_blank">01:10:00.600</a></span> | <span class="t">Which is actually much less worse than people think he is, but it's a different era I guess.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4207" target="_blank">01:10:07.240</a></span> | <span class="t">So we're going to learn to write philosophy like Nietzsche.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4214" target="_blank">01:10:14.320</a></span> | <span class="t">And so we're going to do it one character at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4217" target="_blank">01:10:17.440</a></span> | <span class="t">So this is like the language model that we did in lesson 4 where we did it a word at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4221" target="_blank">01:10:21.240</a></span> | <span class="t">a time, but this time we're going to do it a character at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4225" target="_blank">01:10:25.880</a></span> | <span class="t">And so the main thing I'm going to try and convince you is that an RNN is no different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4231" target="_blank">01:10:31.100</a></span> | <span class="t">to anything you've already learned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4233" target="_blank">01:10:33.960</a></span> | <span class="t">And so to show you that, we're going to build it from plain PyTorch layers, all of which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4240" target="_blank">01:10:40.680</a></span> | <span class="t">are extremely familiar already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4243" target="_blank">01:10:43.240</a></span> | <span class="t">And eventually we're going to use something really complex, which is a for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4247" target="_blank">01:10:47.280</a></span> | <span class="t">So that's when we're going to make it really sophisticated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4249" target="_blank">01:10:49.920</a></span> | <span class="t">So the basic idea of RNNs is that you want to keep track of state-over-long-term dependencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4260" target="_blank">01:11:00.720</a></span> | <span class="t">So for example, if you're trying to model something like this template language, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4268" target="_blank">01:11:08.200</a></span> | <span class="t">at the end of your percent comment do percent, you need a percent comment end percent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4273" target="_blank">01:11:13.800</a></span> | <span class="t">And so somehow your model needs to keep track of the fact that it's inside a comment over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4279" target="_blank">01:11:19.160</a></span> | <span class="t">all of these different characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4281" target="_blank">01:11:21.520</a></span> | <span class="t">So this is this idea of state, it needs kind of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4285" target="_blank">01:11:25.280</a></span> | <span class="t">And this is quite a difficult thing to do with just a ConvNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4290" target="_blank">01:11:30.440</a></span> | <span class="t">It turns out to be possible, but it's a little bit tricky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4296" target="_blank">01:11:36.520</a></span> | <span class="t">Whereas with an RNN, it turns out to be pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4300" target="_blank">01:11:40.860</a></span> | <span class="t">So these are the basic ideas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4301" target="_blank">01:11:41.860</a></span> | <span class="t">You want a stateful representation where you're keeping track of where are we now, have memory,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4307" target="_blank">01:11:47.040</a></span> | <span class="t">have long-term dependencies, and potentially even have variable length sequences -- these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4313" target="_blank">01:11:53.160</a></span> | <span class="t">are all difficult things to do with ConvNets -- they're very straightforward with RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4319" target="_blank">01:11:59.040</a></span> | <span class="t">So for example, SwiftKey a year or so ago did a blog post about how they had a new language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4325" target="_blank">01:12:05.720</a></span> | <span class="t">model where they basically said, of course this is what their neural net looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4334" target="_blank">01:12:14.200</a></span> | <span class="t">Somehow they always looked like this on the internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4337" target="_blank">01:12:17.400</a></span> | <span class="t">You've got a bunch of words and it's basically going to take your particular words in their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4341" target="_blank">01:12:21.440</a></span> | <span class="t">particular orders and try and figure out what the next word's going to be, which is to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4345" target="_blank">01:12:25.320</a></span> | <span class="t">they built a language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4347" target="_blank">01:12:27.120</a></span> | <span class="t">They actually have a pretty good language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4348" target="_blank">01:12:28.520</a></span> | <span class="t">If you've used SwiftKey, they seem to do better predictions than anybody else still.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4354" target="_blank">01:12:34.440</a></span> | <span class="t">Another cool example was Andre Kepathy a couple of years ago showed that he could use character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4359" target="_blank">01:12:39.240</a></span> | <span class="t">level RNN to actually create an entire LaTeX document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4364" target="_blank">01:12:44.720</a></span> | <span class="t">So he didn't actually tell it in any way what LaTeX looks like, he just passed in some LaTeX</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4371" target="_blank">01:12:51.440</a></span> | <span class="t">text like this and said generate more LaTeX text, and it literally started writing something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4376" target="_blank">01:12:56.400</a></span> | <span class="t">which means about as much to me as most math papers do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4383" target="_blank">01:13:03.960</a></span> | <span class="t">So we're going to start with something that's not an RNN, and I've got to introduce Jeremy's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4391" target="_blank">01:13:11.760</a></span> | <span class="t">patented neural network notation involving boxes, circles and triangles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4400" target="_blank">01:13:20.740</a></span> | <span class="t">So let me explain what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4404" target="_blank">01:13:24.000</a></span> | <span class="t">A rectangle is an input, an arrow is a layer, a circle -- in fact every shape is a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4419" target="_blank">01:13:39.000</a></span> | <span class="t">of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4421" target="_blank">01:13:41.320</a></span> | <span class="t">The rectangle is the input activations, the circle is the hidden activations, and a triangle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4429" target="_blank">01:13:49.160</a></span> | <span class="t">is the output activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4431" target="_blank">01:13:51.960</a></span> | <span class="t">An arrow is a layer operation, or possibly more than one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4438" target="_blank">01:13:58.200</a></span> | <span class="t">So here my rectangle is an input of number of rows equal to batch size and number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4444" target="_blank">01:14:04.600</a></span> | <span class="t">columns equal to the number of inputs, number of variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4448" target="_blank">01:14:08.900</a></span> | <span class="t">And so my first arrow, my first operation, is going to represent a matrix product followed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4454" target="_blank">01:14:14.480</a></span> | <span class="t">by a ReLU, and that's going to generate a set of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4460" target="_blank">01:14:20.680</a></span> | <span class="t">For activations, an activation is a number, an activation is a number, a number that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4468" target="_blank">01:14:28.000</a></span> | <span class="t">being calculated by a ReLU or a matrix product or whatever, it's a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4474" target="_blank">01:14:34.740</a></span> | <span class="t">So this circle here represents a matrix of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4479" target="_blank">01:14:39.480</a></span> | <span class="t">All of the numbers that come out when we take the inputs, we do a matrix product followed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4483" target="_blank">01:14:43.720</a></span> | <span class="t">by a ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4484" target="_blank">01:14:44.720</a></span> | <span class="t">So we started with batch size by number of inputs, and so after we do this matrix operation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4489" target="_blank">01:14:49.920</a></span> | <span class="t">we now have batch size by whatever the number of columns in our matrix product was, by number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4497" target="_blank">01:14:57.560</a></span> | <span class="t">of hidden units.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4500" target="_blank">01:15:00.380</a></span> | <span class="t">And so if we now take these activations, which is a matrix, and we put it through another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4505" target="_blank">01:15:05.480</a></span> | <span class="t">operation, in this case another matrix product, and a softmax, we get a triangle that's our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4510" target="_blank">01:15:10.560</a></span> | <span class="t">output activations, another matrix of activations, and again, number of rows is batch size, number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4516" target="_blank">01:15:16.160</a></span> | <span class="t">of columns is equal to the number of classes, however many columns our matrix and this matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4521" target="_blank">01:15:21.600</a></span> | <span class="t">product had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4522" target="_blank">01:15:22.600</a></span> | <span class="t">So that's a neural net, that's our basic one hidden layer neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4534" target="_blank">01:15:34.160</a></span> | <span class="t">If you haven't written one of these from scratch, try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4539" target="_blank">01:15:39.160</a></span> | <span class="t">And in fact, in lessons 9, 10 and 11 of the machine learning course, we do this, we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4545" target="_blank">01:15:45.040</a></span> | <span class="t">one of these from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4546" target="_blank">01:15:46.720</a></span> | <span class="t">So if you're not quite sure how to do it, you can check out the machine learning course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4551" target="_blank">01:15:51.120</a></span> | <span class="t">In general the machine learning course is much more like building stuff up from the foundations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4555" target="_blank">01:15:55.880</a></span> | <span class="t">whereas this course is much more like best practices kind of top down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4562" target="_blank">01:16:02.800</a></span> | <span class="t">So if we were doing a ConvNet with a single dense hidden layer, our input would be equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4569" target="_blank">01:16:09.240</a></span> | <span class="t">to pi torch, number of channels by height by width, and notice that here batch size appeared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4578" target="_blank">01:16:18.680</a></span> | <span class="t">every time, so I'm not going to write it anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4582" target="_blank">01:16:22.600</a></span> | <span class="t">So I've removed the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4586" target="_blank">01:16:26.160</a></span> | <span class="t">Also the activation function, it's always basically value or something similar for all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4590" target="_blank">01:16:30.840</a></span> | <span class="t">the hidden layers and softmax at the end for classification, so I'm not going to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4594" target="_blank">01:16:34.760</a></span> | <span class="t">that either.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4596" target="_blank">01:16:36.760</a></span> | <span class="t">In each picture I'm going to simplify it a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4600" target="_blank">01:16:40.640</a></span> | <span class="t">So I'm not going to mention batch size is still there, we're not going to mention value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4603" target="_blank">01:16:43.840</a></span> | <span class="t">or softmax, but it's still there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4605" target="_blank">01:16:45.680</a></span> | <span class="t">So here's our input, and so in this case rather than a matrix product, we'll do a convolution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4611" target="_blank">01:16:51.040</a></span> | <span class="t">a stride 2 convolution, so we'll skip over every second one, or it could be a convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4617" target="_blank">01:16:57.680</a></span> | <span class="t">followed by a max pull.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4619" target="_blank">01:16:59.880</a></span> | <span class="t">In either case, we end up with something which is replace number of channels with number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4624" target="_blank">01:17:04.320</a></span> | <span class="t">filters, and we have now height divided by 2 and width divided by 2, and then we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4632" target="_blank">01:17:12.120</a></span> | <span class="t">flatten that out somehow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4633" target="_blank">01:17:13.880</a></span> | <span class="t">We'll talk next week about the main way we do that nowadays, which is basically to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4637" target="_blank">01:17:17.800</a></span> | <span class="t">something called an adaptive max pulling, where we basically get an average across the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4643" target="_blank">01:17:23.480</a></span> | <span class="t">height and the width, and turn that into a vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4647" target="_blank">01:17:27.800</a></span> | <span class="t">Anyway, somehow we flatten it out into a vector, we can do a matrix product, or a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4653" target="_blank">01:17:33.240</a></span> | <span class="t">matrix products.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4654" target="_blank">01:17:34.240</a></span> | <span class="t">We actually tend to do in fastai, so that'll be our fully connected layer with some number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4660" target="_blank">01:17:40.640</a></span> | <span class="t">of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4661" target="_blank">01:17:41.640</a></span> | <span class="t">The final matrix product gives us some number of classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4665" target="_blank">01:17:45.920</a></span> | <span class="t">So this is our basic component, remembering, rectangle is input, circle is hidden, triangle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4672" target="_blank">01:17:52.840</a></span> | <span class="t">is output, all of the shapes represent a tensor of activations, all of the arrows represent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4680" target="_blank">01:18:00.520</a></span> | <span class="t">a layer operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4685" target="_blank">01:18:05.080</a></span> | <span class="t">So now let's jump to the first one that we're going to actually try to create for NLP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4692" target="_blank">01:18:12.880</a></span> | <span class="t">And we're going to basically do exactly the same thing as here, and we're going to try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4697" target="_blank">01:18:17.760</a></span> | <span class="t">and predict the third character in a three-character sequence based on the previous two characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4705" target="_blank">01:18:25.080</a></span> | <span class="t">So our input, and again remember, we've removed the batch size dimension, we're not saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4714" target="_blank">01:18:34.240</a></span> | <span class="t">it but it's still here, and also here I've removed the names of the layer operations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4720" target="_blank">01:18:40.520</a></span> | <span class="t">entirely, just keeping simplifying things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4723" target="_blank">01:18:43.640</a></span> | <span class="t">So for example, our first input would be the first character of each string in our mini-batch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4732" target="_blank">01:18:52.760</a></span> | <span class="t">and assuming this is one-hot encoded, then the width is just however many items there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4739" target="_blank">01:18:59.160</a></span> | <span class="t">are in the vocabulary, how many unique characters could we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4743" target="_blank">01:19:03.400</a></span> | <span class="t">We probably won't really one-hot encode it, we'll feed it in as an integer and pretend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4747" target="_blank">01:19:07.920</a></span> | <span class="t">it's one-hot encoded by using an embedding layer, which is mathematically identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4752" target="_blank">01:19:12.840</a></span> | <span class="t">And then that's going to give us some activations which we can stick through a fully connected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4758" target="_blank">01:19:18.080</a></span> | <span class="t">layer, so we put that through a fully connected layer to get some activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4767" target="_blank">01:19:27.760</a></span> | <span class="t">We can then put that through another fully connected layer, and now we're going to bring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4772" target="_blank">01:19:32.160</a></span> | <span class="t">in the input of character 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4774" target="_blank">01:19:34.760</a></span> | <span class="t">So the character 2 input will be exactly the same dimensionality as the character 1 input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4780" target="_blank">01:19:40.920</a></span> | <span class="t">and we now need to somehow combine these two arrows together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4784" target="_blank">01:19:44.580</a></span> | <span class="t">So we could just add them up, for instance, because remember this arrow here represents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4791" target="_blank">01:19:51.320</a></span> | <span class="t">a matrix product, so this matrix product is going to spit out the same dimensionality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4796" target="_blank">01:19:56.120</a></span> | <span class="t">as this matrix product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4797" target="_blank">01:19:57.820</a></span> | <span class="t">So we could just add them up to create these activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4802" target="_blank">01:20:02.440</a></span> | <span class="t">And so now we can put that through another matrix product, and of course remember all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4805" target="_blank">01:20:05.520</a></span> | <span class="t">these matrix products have a value as well, and this final one will have a softmax instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4811" target="_blank">01:20:11.920</a></span> | <span class="t">to create our predicted set of characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4815" target="_blank">01:20:15.480</a></span> | <span class="t">So it's a standard 2-hidden layer, I guess it's actually 3 matrix products neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4826" target="_blank">01:20:26.160</a></span> | <span class="t">This first one is coming through an embedding layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4829" target="_blank">01:20:29.160</a></span> | <span class="t">The only difference is that we've also got a second input coming in here that we're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4834" target="_blank">01:20:34.840</a></span> | <span class="t">adding in, but it's kind of conceptually identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4838" target="_blank">01:20:38.960</a></span> | <span class="t">So let's implement that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4846" target="_blank">01:20:46.320</a></span> | <span class="t">So I'm not going to use torch text, I'm going to try not to use almost any fast AI so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4851" target="_blank">01:20:51.640</a></span> | <span class="t">can see it all again from raw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4854" target="_blank">01:20:54.680</a></span> | <span class="t">So here's the first 400 characters of the collected works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4859" target="_blank">01:20:59.160</a></span> | <span class="t">Let's grab a set of all of the letters that we see there and sort them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4866" target="_blank">01:21:06.000</a></span> | <span class="t">And so a set creates all the unique letters, so we've got 85 unique letters in our vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4874" target="_blank">01:21:14.180</a></span> | <span class="t">It's nice to put an empty null or some kind of padding character in there for padding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4879" target="_blank">01:21:19.000</a></span> | <span class="t">so we're going to put a padding character at the start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4882" target="_blank">01:21:22.000</a></span> | <span class="t">And so here is what our vocab looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4888" target="_blank">01:21:28.120</a></span> | <span class="t">So cars is our vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4891" target="_blank">01:21:31.880</a></span> | <span class="t">So as per usual, we want some way to map every character to a unique ID and every unique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4898" target="_blank">01:21:38.880</a></span> | <span class="t">ID to a character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4902" target="_blank">01:21:42.440</a></span> | <span class="t">And so now we can just go through our collected works of niche and grab the index of each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4909" target="_blank">01:21:49.340</a></span> | <span class="t">one of those characters, so now we've just turned it into this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4915" target="_blank">01:21:55.000</a></span> | <span class="t">So rather than "pe", we now have 40, 42, 29.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4927" target="_blank">01:22:07.240</a></span> | <span class="t">So that's basically the first step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4928" target="_blank">01:22:08.780</a></span> | <span class="t">And just to confirm, we can now take each of those indexes and turn them back into characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4934" target="_blank">01:22:14.880</a></span> | <span class="t">and join them together, and yeah, there it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4939" target="_blank">01:22:19.840</a></span> | <span class="t">So from now on we're just going to work with this IDX list, the list of character numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4946" target="_blank">01:22:26.160</a></span> | <span class="t">in the connected works of Nietzsche.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4948" target="_blank">01:22:28.080</a></span> | <span class="t">Yes?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4949" target="_blank">01:22:29.080</a></span> | <span class="t">So Jeremy, why are we doing a model of characters and not a model of words?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4956" target="_blank">01:22:36.920</a></span> | <span class="t">I just thought it seemed simpler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4958" target="_blank">01:22:38.800</a></span> | <span class="t">With a vocab of 80-ish items, we can kind of see it better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4965" target="_blank">01:22:45.620</a></span> | <span class="t">Character level models turn out to be potentially quite useful in a number of situations, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4971" target="_blank">01:22:51.440</a></span> | <span class="t">we'll cover that in Part 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4973" target="_blank">01:22:53.640</a></span> | <span class="t">The short answer is, you generally want to combine both a word level model and a character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4978" target="_blank">01:22:58.800</a></span> | <span class="t">level model, like if you're doing translation, it's a great way to deal with unusual words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4984" target="_blank">01:23:04.440</a></span> | <span class="t">rather than treating it as unknown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4986" target="_blank">01:23:06.060</a></span> | <span class="t">Anytime you see a word you haven't seen before, you could use a character level model for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4990" target="_blank">01:23:10.200</a></span> | <span class="t">that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4991" target="_blank">01:23:11.200</a></span> | <span class="t">And there's actually something in between the two called a byte pair encoding, BPE, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=4995" target="_blank">01:23:15.360</a></span> | <span class="t">basically looks at little n-grams of characters, but we'll cover all that in Part 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5003" target="_blank">01:23:23.000</a></span> | <span class="t">If you want to look at it right now, then Part 2 of the existing course already has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5007" target="_blank">01:23:27.780</a></span> | <span class="t">this stuff taught.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5010" target="_blank">01:23:30.280</a></span> | <span class="t">And Part 2 of the version 1 of this course, all the NLP stuff is in PyTorch, by the way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5017" target="_blank">01:23:37.200</a></span> | <span class="t">so you'll understand it straight away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5021" target="_blank">01:23:41.000</a></span> | <span class="t">It was actually the thing that inspired us to move to PyTorch, because trying to do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5024" target="_blank">01:23:44.060</a></span> | <span class="t">in Keras turned out to be a nightmare.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5028" target="_blank">01:23:48.220</a></span> | <span class="t">So let's create the inputs to this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5032" target="_blank">01:23:52.480</a></span> | <span class="t">We're actually going to do something slightly different to what I said.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5034" target="_blank">01:23:54.560</a></span> | <span class="t">We're actually going to try and predict the fifth character using the first 4, so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5041" target="_blank">01:24:01.680</a></span> | <span class="t">index 4 character using the index 0, 1, 2, and 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5045" target="_blank">01:24:05.720</a></span> | <span class="t">So we're going to do exactly the same thing, but with just a couple more layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5050" target="_blank">01:24:10.060</a></span> | <span class="t">So that means that we need a list of the 0th, 1st, 2nd, and 3rd characters, so I'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5059" target="_blank">01:24:19.480</a></span> | <span class="t">getting every character from the start, from the 1, from 2, from 3, skipping over, 3 at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5066" target="_blank">01:24:26.720</a></span> | <span class="t">a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5069" target="_blank">01:24:29.200</a></span> | <span class="t">So we're going to predict the 4th character from the first 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5087" target="_blank">01:24:47.420</a></span> | <span class="t">So our inputs will be these three lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5092" target="_blank">01:24:52.540</a></span> | <span class="t">So we can just use np.stack to pop them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5098" target="_blank">01:24:58.140</a></span> | <span class="t">So here's the 0, 1, and 2 characters that are going to feed into our model, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5104" target="_blank">01:25:04.720</a></span> | <span class="t">here is the next character in the list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5109" target="_blank">01:25:09.120</a></span> | <span class="t">So for example, x1, x2, x3, and y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5122" target="_blank">01:25:22.620</a></span> | <span class="t">So you can see for example, the very first item would be 40, 42, and 29, so that's characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5135" target="_blank">01:25:35.060</a></span> | <span class="t">0, 1, and 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5137" target="_blank">01:25:37.700</a></span> | <span class="t">And then we'd be predicting 30, that's the 4th character, which is the start of the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5145" target="_blank">01:25:45.340</a></span> | <span class="t">row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5146" target="_blank">01:25:46.340</a></span> | <span class="t">So 30, 25, 27, we need to predict 29, which is the start of the next row, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5154" target="_blank">01:25:54.420</a></span> | <span class="t">So we're always using 3 characters to predict the 4th.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5159" target="_blank">01:25:59.980</a></span> | <span class="t">So there are 200,000 of these that we're going to try and model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5167" target="_blank">01:26:07.300</a></span> | <span class="t">So we're going to build this model, which means we need to decide how many activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5175" target="_blank">01:26:15.780</a></span> | <span class="t">So I'm going to use 256, and we need to decide how big our embeddings are going to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5181" target="_blank">01:26:21.660</a></span> | <span class="t">And so I decided to use 42, so about half the number of characters I have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5187" target="_blank">01:26:27.180</a></span> | <span class="t">And you can play around with these to see if you can come up with better numbers, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5189" target="_blank">01:26:29.620</a></span> | <span class="t">just kind of experimental.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5192" target="_blank">01:26:32.300</a></span> | <span class="t">And now we're going to build our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5194" target="_blank">01:26:34.740</a></span> | <span class="t">Now I'm going to change my model slightly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5197" target="_blank">01:26:37.260</a></span> | <span class="t">And so here is the full version, so predicting character 4 using characters 1, 2, and 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5203" target="_blank">01:26:43.940</a></span> | <span class="t">As you can see, it's the same picture as the previous page, but I put some very important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5207" target="_blank">01:26:47.860</a></span> | <span class="t">colored arrows here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5210" target="_blank">01:26:50.180</a></span> | <span class="t">All the arrows of the same color are going to use the same matrix, the same weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5217" target="_blank">01:26:57.740</a></span> | <span class="t">So all of our input embeddings are going to use the same matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5223" target="_blank">01:27:03.220</a></span> | <span class="t">All of our layers that go from one layer to the next are going to use the same orange</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5229" target="_blank">01:27:09.520</a></span> | <span class="t">arrow weight matrix, and then our output will have its own matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5235" target="_blank">01:27:15.020</a></span> | <span class="t">So we're going to have 1, 2, 3 weight matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5240" target="_blank">01:27:20.260</a></span> | <span class="t">And the idea here is the reason I'm not going to have a separate one for everything here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5244" target="_blank">01:27:24.880</a></span> | <span class="t">is that why would semantically a character have a different meaning depending if it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5250" target="_blank">01:27:30.860</a></span> | <span class="t">the first or the second or the third item in a sequence?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5253" target="_blank">01:27:33.940</a></span> | <span class="t">It's not like we're even starting every sequence at the start of a sentence, we just arbitrarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5258" target="_blank">01:27:38.060</a></span> | <span class="t">chopped it into groups of 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5259" target="_blank">01:27:39.900</a></span> | <span class="t">So you would expect these to all have the same kind of conceptual mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5264" target="_blank">01:27:44.620</a></span> | <span class="t">And when we're moving from character_0 to character_1, to kind of say build up some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5269" target="_blank">01:27:49.780</a></span> | <span class="t">state here, why would that be any different kind of operation to moving from character_1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5273" target="_blank">01:27:53.980</a></span> | <span class="t">to character_2?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5274" target="_blank">01:27:54.980</a></span> | <span class="t">So that's the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5277" target="_blank">01:27:57.940</a></span> | <span class="t">So let's create a 3-character model, and so we're going to create one linear layer for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5285" target="_blank">01:28:05.140</a></span> | <span class="t">our green arrow, one linear layer for our orange arrow, and one linear layer for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5290" target="_blank">01:28:10.180</a></span> | <span class="t">blue arrow, and then also one embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5295" target="_blank">01:28:15.860</a></span> | <span class="t">So the embedding is going to bring in something of size, whatever it was, 84, and spit out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5302" target="_blank">01:28:22.180</a></span> | <span class="t">something with a number of factors in the embedding, we'll then put that through a linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5306" target="_blank">01:28:26.980</a></span> | <span class="t">layer, and then we've got our hidden layers, we've got our output layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5311" target="_blank">01:28:31.820</a></span> | <span class="t">So when we call forward, we're going to be passing in 1, 2, 3 characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5319" target="_blank">01:28:39.300</a></span> | <span class="t">So for each one, we'll stick it through an embedding, we'll stick it through a linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5323" target="_blank">01:28:43.260</a></span> | <span class="t">layer, and we'll stick it through a value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5325" target="_blank">01:28:45.660</a></span> | <span class="t">So we'll do it for character_1, character_2, and character_3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5333" target="_blank">01:28:53.060</a></span> | <span class="t">Then I'm going to create this circle of activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5345" target="_blank">01:29:05.620</a></span> | <span class="t">here, and that matrix I'm going to call h, so it's going to be equal to my input activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5356" target="_blank">01:29:16.620</a></span> | <span class="t">after going through the value and the linear layer and the embedding, and then I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5361" target="_blank">01:29:21.380</a></span> | <span class="t">to apply this L hidden, so the orange arrow, and that's going to get me to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5370" target="_blank">01:29:30.400</a></span> | <span class="t">So that's what this layer here does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5373" target="_blank">01:29:33.100</a></span> | <span class="t">And then to get to the next one, I need to apply the same thing, and apply the orange</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5377" target="_blank">01:29:37.300</a></span> | <span class="t">arrow to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5379" target="_blank">01:29:39.820</a></span> | <span class="t">But I also have to add in this second input, so take my second input and add in my previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5389" target="_blank">01:29:49.620</a></span> | <span class="t">layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5392" target="_blank">01:29:52.500</a></span> | <span class="t">I don't really see how these dimensions are the same from h and in, too.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5407" target="_blank">01:30:07.900</a></span> | <span class="t">Let's figure out the dimensions together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5411" target="_blank">01:30:11.260</a></span> | <span class="t">Self.e is going to be of length 42, and then it's going to go through ln, I'm just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5418" target="_blank">01:30:18.720</a></span> | <span class="t">to make it of size nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5424" target="_blank">01:30:24.820</a></span> | <span class="t">And so then we're going to pass that, which is now size nhidden, through this, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5433" target="_blank">01:30:33.220</a></span> | <span class="t">also going to return something of size nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5436" target="_blank">01:30:36.500</a></span> | <span class="t">So it's really important to notice that this is square, this is a square weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5442" target="_blank">01:30:42.600</a></span> | <span class="t">So we now know that this is of size nhidden, n2 is going to be exactly the same size as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5447" target="_blank">01:30:47.660</a></span> | <span class="t">n1 was, which is nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5450" target="_blank">01:30:50.000</a></span> | <span class="t">So we can now sum together two sets of activations, both of size nhidden, passing it into here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5458" target="_blank">01:30:58.180</a></span> | <span class="t">and again it returns something of size nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5460" target="_blank">01:31:00.260</a></span> | <span class="t">So basically the trick was to make this a square matrix, and to make sure that its square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5464" target="_blank">01:31:04.500</a></span> | <span class="t">matrix was the same size as the output of this hidden layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5467" target="_blank">01:31:07.940</a></span> | <span class="t">Thanks for the great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5469" target="_blank">01:31:09.260</a></span> | <span class="t">Can you pass that back to you now?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5473" target="_blank">01:31:13.820</a></span> | <span class="t">I don't like it when I have three bits of code that look identical, and then three bits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5490" target="_blank">01:31:30.460</a></span> | <span class="t">of code that look nearly identical but aren't quite because it's harder to refactor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5495" target="_blank">01:31:35.040</a></span> | <span class="t">So I'm going to make h into a bunch of zeros, so that I can then put h here, and these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5506" target="_blank">01:31:46.140</a></span> | <span class="t">now identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5508" target="_blank">01:31:48.520</a></span> | <span class="t">So the hugely complex trick that we're going to do very shortly is to replace these three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5514" target="_blank">01:31:54.600</a></span> | <span class="t">things with a for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5517" target="_blank">01:31:57.660</a></span> | <span class="t">And it's going to loop through 1, 2 and 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5522" target="_blank">01:32:02.260</a></span> | <span class="t">That's going to be the for loop, or actually 0, 1 and 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5525" target="_blank">01:32:05.180</a></span> | <span class="t">At that point we'll be able to call it a recurrent neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5528" target="_blank">01:32:08.580</a></span> | <span class="t">So just to skip ahead a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5531" target="_blank">01:32:11.700</a></span> | <span class="t">So we create that model, so we can now just use the same columnar model data class that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5546" target="_blank">01:32:26.660</a></span> | <span class="t">we've used before, and if we use fromArrays, then it's basically going to spit back the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5552" target="_blank">01:32:32.300</a></span> | <span class="t">exact arrays we gave it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5554" target="_blank">01:32:34.420</a></span> | <span class="t">So if we stack together those three arrays, then it's going to feed us those three things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5560" target="_blank">01:32:40.060</a></span> | <span class="t">back to our for loop method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5561" target="_blank">01:32:41.660</a></span> | <span class="t">So if you want to play around with training models using as raw an approach as possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5571" target="_blank">01:32:51.100</a></span> | <span class="t">but without writing lots of boilerplate, this is kind of how to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5574" target="_blank">01:32:54.440</a></span> | <span class="t">Use columnar model data fromArrays and then if you pass in whatever you pass in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5581" target="_blank">01:33:01.480</a></span> | <span class="t">you're going to get back here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5586" target="_blank">01:33:06.800</a></span> | <span class="t">So I've passed in three things, which means I'm going to get sent three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5590" target="_blank">01:33:10.780</a></span> | <span class="t">So that's how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5594" target="_blank">01:33:14.540</a></span> | <span class="t">Batch size 512, because this data is tiny so I can use a bigger batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5600" target="_blank">01:33:20.440</a></span> | <span class="t">So I'm not using really much fast.ai stuff at all, I'm using fast.ai stuff just to save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5606" target="_blank">01:33:26.300</a></span> | <span class="t">me fiddling around with data loaders and data sets and stuff, but I'm actually going to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5610" target="_blank">01:33:30.180</a></span> | <span class="t">a standard PyTorch model, I'm not going to create a learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5613" target="_blank">01:33:33.860</a></span> | <span class="t">So this is a standard PyTorch model, and because I'm using PyTorch, that means I have to remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5618" target="_blank">01:33:38.420</a></span> | <span class="t">to write .cuda, just to get on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5623" target="_blank">01:33:43.660</a></span> | <span class="t">So here is how we can look inside at what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5630" target="_blank">01:33:50.700</a></span> | <span class="t">So we can say iter md.train data loader to grab the iterator to iterate through the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5636" target="_blank">01:33:56.960</a></span> | <span class="t">set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5638" target="_blank">01:33:58.160</a></span> | <span class="t">We can then call next on that to grab a mini-batch, and that's going to return all of our x's and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5644" target="_blank">01:34:04.700</a></span> | <span class="t">our y tensor, and so we can then take a look at x's, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5654" target="_blank">01:34:14.260</a></span> | <span class="t">And so you would expect, have a think about what you would expect for this length, 3, not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5661" target="_blank">01:34:21.460</a></span> | <span class="t">surprisingly because these are the three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5664" target="_blank">01:34:24.940</a></span> | <span class="t">And so then xs0, not surprisingly, is of length 512, and it's not actually one hot encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5677" target="_blank">01:34:37.860</a></span> | <span class="t">because we're using embedding to pretend it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5681" target="_blank">01:34:41.180</a></span> | <span class="t">And so then we can use a model as if it's a function by passing to it the variableized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5687" target="_blank">01:34:47.940</a></span> | <span class="t">version of our tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5690" target="_blank">01:34:50.760</a></span> | <span class="t">And so have a think about what you would expect to be returned here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5695" target="_blank">01:34:55.940</a></span> | <span class="t">So not surprisingly, we had a mini-batch of 512, so we still have 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5700" target="_blank">01:35:00.240</a></span> | <span class="t">And then 85 is the probability of each of the possible vocab items, and of course we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5705" target="_blank">01:35:05.380</a></span> | <span class="t">got the log of them, because that's kind of what we do in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5711" target="_blank">01:35:11.560</a></span> | <span class="t">So that's how you can look inside, so you can see here how to do everything really very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5715" target="_blank">01:35:15.780</a></span> | <span class="t">much by hand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5719" target="_blank">01:35:19.020</a></span> | <span class="t">So we can create an optimizer, again using standard PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5723" target="_blank">01:35:23.160</a></span> | <span class="t">So with PyTorch, when you use a PyTorch optimizer, you have to pass in a list of the things to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5728" target="_blank">01:35:28.300</a></span> | <span class="t">optimize, and so if you call m.parameters, that will return that list for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5734" target="_blank">01:35:34.300</a></span> | <span class="t">And then we can fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5737" target="_blank">01:35:37.280</a></span> | <span class="t">And there it goes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5741" target="_blank">01:35:41.020</a></span> | <span class="t">And so we don't have learning rate finders and SGDR and all that stuff because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5746" target="_blank">01:35:46.460</a></span> | <span class="t">not using a learner, so we'll have to manually do learning rate annealing, so set the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5750" target="_blank">01:35:50.300</a></span> | <span class="t">rate a little bit lower and fit again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5758" target="_blank">01:35:58.380</a></span> | <span class="t">And so now we can write a little function to test this thing out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5764" target="_blank">01:36:04.380</a></span> | <span class="t">So here's something called getNext() where we can pass in 3 characters, like y, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5777" target="_blank">01:36:17.600</a></span> | <span class="t">I can then go through and turn that into a tensor of an array of the character index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5785" target="_blank">01:36:25.620</a></span> | <span class="t">for each character in that list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5787" target="_blank">01:36:27.260</a></span> | <span class="t">So basically turn those into the integers, variables, pass that to our model, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5794" target="_blank">01:36:34.740</a></span> | <span class="t">we can do an argmax on that to grab which character number is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5800" target="_blank">01:36:40.260</a></span> | <span class="t">And in order to do stuff in NumPy land, I use 2np to turn that variable into a NumPy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5805" target="_blank">01:36:45.500</a></span> | <span class="t">array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5806" target="_blank">01:36:46.500</a></span> | <span class="t">And then I can return that character, and so for example a capital T is what it thinks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5811" target="_blank">01:36:51.040</a></span> | <span class="t">would be reasonable after seeing y, full stop space, that seems like a very reasonable way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5816" target="_blank">01:36:56.060</a></span> | <span class="t">to start a sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5818" target="_blank">01:36:58.420</a></span> | <span class="t">If it was ppl, e, that sounds reasonable, space th, e, that sounds reasonable, and space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5825" target="_blank">01:37:05.060</a></span> | <span class="t">that sounds reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5826" target="_blank">01:37:06.060</a></span> | <span class="t">So it seems to have created something sensible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5831" target="_blank">01:37:11.020</a></span> | <span class="t">So the important thing to note here is our character model is a totally standard fully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5841" target="_blank">01:37:21.140</a></span> | <span class="t">connected model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5842" target="_blank">01:37:22.780</a></span> | <span class="t">The only slightly interesting thing we did was to do this addition of each of the inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5852" target="_blank">01:37:32.540</a></span> | <span class="t">one at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5854" target="_blank">01:37:34.420</a></span> | <span class="t">But there's nothing new conceptually here, we're training it in the usual way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5866" target="_blank">01:37:46.100</a></span> | <span class="t">Let's now create an RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5870" target="_blank">01:37:50.460</a></span> | <span class="t">So an RNN is when we do exactly the same thing that we did here, but I could draw this more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5884" target="_blank">01:38:04.900</a></span> | <span class="t">simply by saying, you know what, if we've got a green arrow going to a circle, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5889" target="_blank">01:38:09.940</a></span> | <span class="t">not draw a green arrow going to a circle again and again and again, but let's just draw it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5894" target="_blank">01:38:14.900</a></span> | <span class="t">like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5895" target="_blank">01:38:15.900</a></span> | <span class="t">So this is exactly the same picture as this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5912" target="_blank">01:38:32.300</a></span> | <span class="t">And so you just have to say how many times to go around this circle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5915" target="_blank">01:38:35.420</a></span> | <span class="t">So in this case, if we want to predict character number n from characters 1 through n-1, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5920" target="_blank">01:38:40.660</a></span> | <span class="t">we can take the character 1 input, get some activations, feed that to some new activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5925" target="_blank">01:38:45.540</a></span> | <span class="t">that go through, remember orange is the hidden to hidden weight matrix, and each time we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5931" target="_blank">01:38:51.460</a></span> | <span class="t">also bring in the next character of input through its embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5937" target="_blank">01:38:57.060</a></span> | <span class="t">So that picture and that picture are two ways of writing the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5943" target="_blank">01:39:03.820</a></span> | <span class="t">But this one is more flexible because rather than me having to say let's do it for 8, I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5947" target="_blank">01:39:07.860</a></span> | <span class="t">don't have to draw 8 circles, I can just say, oh just repeat this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5956" target="_blank">01:39:16.220</a></span> | <span class="t">So I could simplify this a little bit further by saying, you know what, rather than having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5961" target="_blank">01:39:21.820</a></span> | <span class="t">this thing as a special case, let's actually start out with a bunch of zeros and then let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5967" target="_blank">01:39:27.940</a></span> | <span class="t">have all of our characters inside here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5977" target="_blank">01:39:37.980</a></span> | <span class="t">So I was wondering, if you can explain a little bit better, why are you reusing those...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5985" target="_blank">01:39:45.220</a></span> | <span class="t">Why use the same colored arrows?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5987" target="_blank">01:39:47.780</a></span> | <span class="t">You kind of seem to be reusing the same weight matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5993" target="_blank">01:39:53.500</a></span> | <span class="t">Maybe this is kind of similar to what we did in convolutional units, like somehow...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=5998" target="_blank">01:39:58.300</a></span> | <span class="t">No, I don't think so, at least not that I can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6002" target="_blank">01:40:02.060</a></span> | <span class="t">So the idea is just kind of semantically speaking, like this arrow here is saying take a character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6017" target="_blank">01:40:17.340</a></span> | <span class="t">of import and represent it as some set of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6024" target="_blank">01:40:24.340</a></span> | <span class="t">And this arrow is saying the same thing, take some character and represent it as a set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6027" target="_blank">01:40:27.220</a></span> | <span class="t">features, and so is this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6029" target="_blank">01:40:29.380</a></span> | <span class="t">So why would the 3 be represented with different weight matrices?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6034" target="_blank">01:40:34.100</a></span> | <span class="t">Because it's all doing the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6036" target="_blank">01:40:36.420</a></span> | <span class="t">And this orange arrow is saying transition from character 0's state to character 1's state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6047" target="_blank">01:40:47.420</a></span> | <span class="t">to character 2's state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6048" target="_blank">01:40:48.420</a></span> | <span class="t">Again, it's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6049" target="_blank">01:40:49.740</a></span> | <span class="t">Why would the transition from character 0 to 1 be different from character 1 to 2?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6055" target="_blank">01:40:55.140</a></span> | <span class="t">So the idea is to say, hey, if it's doing the same conceptual thing, let's use the exact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6064" target="_blank">01:41:04.540</a></span> | <span class="t">same weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6067" target="_blank">01:41:07.260</a></span> | <span class="t">My comment on convolutional neural networks is that a filter also can apply to multiple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6072" target="_blank">01:41:12.380</a></span> | <span class="t">places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6073" target="_blank">01:41:13.380</a></span> | <span class="t">Yeah, that's an interesting point of view.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6075" target="_blank">01:41:15.380</a></span> | <span class="t">So you're saying a convolution is almost like a kind of a special dot product with shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6080" target="_blank">01:41:20.860</a></span> | <span class="t">weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6081" target="_blank">01:41:21.860</a></span> | <span class="t">Yeah, that's a very good point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6084" target="_blank">01:41:24.420</a></span> | <span class="t">And in fact, one of our students actually wrote a good blog post about that last year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6088" target="_blank">01:41:28.940</a></span> | <span class="t">We should dig that up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6089" target="_blank">01:41:29.940</a></span> | <span class="t">Okay, I totally see where you're coming from and I totally agree with you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6095" target="_blank">01:41:35.860</a></span> | <span class="t">So let's implement this version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6100" target="_blank">01:41:40.940</a></span> | <span class="t">So this time we're going to do 8 characters, 8 c's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6107" target="_blank">01:41:47.900</a></span> | <span class="t">And so let's create a list of every 8th character from 0 through 7, and then our outputs will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6115" target="_blank">01:41:55.020</a></span> | <span class="t">be the next character, and so we can stack that together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6119" target="_blank">01:41:59.260</a></span> | <span class="t">And so now we've got 600,000 by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6125" target="_blank">01:42:05.020</a></span> | <span class="t">So here's an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6128" target="_blank">01:42:08.740</a></span> | <span class="t">So for example, after this series of 8 characters, so this is characters 0 through 8, this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6137" target="_blank">01:42:17.860</a></span> | <span class="t">characters 1 through 9, this is 2 through 10, these are all overlapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6144" target="_blank">01:42:24.060</a></span> | <span class="t">So after characters 1, 0 through 8, this is going to be the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6149" target="_blank">01:42:29.460</a></span> | <span class="t">And then after these characters, this will be the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6152" target="_blank">01:42:32.820</a></span> | <span class="t">So you can see that this one here has 43 as its y value, because after those, the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6160" target="_blank">01:42:40.660</a></span> | <span class="t">one will be 43.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6164" target="_blank">01:42:44.740</a></span> | <span class="t">So this is the first 8 characters, this is 2 through 9, 3 through 10, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6171" target="_blank">01:42:51.060</a></span> | <span class="t">So these are overlapping groups of 8 characters, and then this is the next one along.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6179" target="_blank">01:42:59.420</a></span> | <span class="t">So let's create that model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6186" target="_blank">01:43:06.320</a></span> | <span class="t">So again, we use fromArrays to create a model data class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6190" target="_blank">01:43:10.540</a></span> | <span class="t">And so you'll see here we have exactly the same code as we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6194" target="_blank">01:43:14.980</a></span> | <span class="t">Here's our embedding, linear, hidden, output, these are literally identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6201" target="_blank">01:43:21.780</a></span> | <span class="t">And then we've replaced our value of the linear input of the embedding with something that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6208" target="_blank">01:43:28.380</a></span> | <span class="t">inside a loop, and then we've replaced the self.lhidden thing, also inside the loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6224" target="_blank">01:43:44.180</a></span> | <span class="t">I just realized I didn't mention last time the use of the hyperbolic tan.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6229" target="_blank">01:43:49.780</a></span> | <span class="t">Hyperbolic tan looks like this, so it's just a sigmoid that's offset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6240" target="_blank">01:44:00.220</a></span> | <span class="t">And it's very common to use a hyperbolic tan inside this state-to-state transition because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6246" target="_blank">01:44:06.700</a></span> | <span class="t">it kind of stops it from flying off too high or too low.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6250" target="_blank">01:44:10.860</a></span> | <span class="t">It's nicely controlled.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6254" target="_blank">01:44:14.020</a></span> | <span class="t">Back in the old days, we used to use hyperbolic tan or the equivalent sigmoid a lot as most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6262" target="_blank">01:44:22.220</a></span> | <span class="t">of our activation functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6263" target="_blank">01:44:23.540</a></span> | <span class="t">Nowadays we tend to use ReLU, but in these hidden-state transition matrices, we still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6272" target="_blank">01:44:32.100</a></span> | <span class="t">tend to use hyperbolic tan quite a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6275" target="_blank">01:44:35.580</a></span> | <span class="t">So you'll see I've done that also here, hyperbolic tan.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6281" target="_blank">01:44:41.900</a></span> | <span class="t">So this is exactly the same as before, but I've just replaced it with a for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6285" target="_blank">01:44:45.580</a></span> | <span class="t">And then here's my output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6287" target="_blank">01:44:47.260</a></span> | <span class="t">Yes, unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6289" target="_blank">01:44:49.740</a></span> | <span class="t">So does it have to do anything with convergence of these networks?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6294" target="_blank">01:44:54.420</a></span> | <span class="t">Yeah, kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6296" target="_blank">01:44:56.900</a></span> | <span class="t">We'll talk about that a little bit over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6301" target="_blank">01:45:01.020</a></span> | <span class="t">Let's come back to that though.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6302" target="_blank">01:45:02.900</a></span> | <span class="t">For now, we're not really going to do anything special at all, recognizing this is just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6307" target="_blank">01:45:07.940</a></span> | <span class="t">standard fully connected network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6311" target="_blank">01:45:11.380</a></span> | <span class="t">Mainly it's quite a deep one, because this is actually this, but we've got 8 of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6319" target="_blank">01:45:19.560</a></span> | <span class="t">things now, we've now got a deep 8-layer network, which is why units starting to suggest we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6325" target="_blank">01:45:25.900</a></span> | <span class="t">should be concerned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6326" target="_blank">01:45:26.900</a></span> | <span class="t">As we get deeper and deeper networks, they can be harder and harder to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6330" target="_blank">01:45:30.740</a></span> | <span class="t">But let's try training this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6338" target="_blank">01:45:38.620</a></span> | <span class="t">So away it goes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6341" target="_blank">01:45:41.140</a></span> | <span class="t">As before, we've got a batch size of 512, we're using atom, and away it goes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6349" target="_blank">01:45:49.220</a></span> | <span class="t">So we won't sit there watching it, so we can then set the loading rate down back to 1 in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6354" target="_blank">01:45:54.300</a></span> | <span class="t">x3, we can fit it again, and it seems to be training fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6364" target="_blank">01:46:04.500</a></span> | <span class="t">But we're going to try something else, which is we're going to use the trick that Yannette</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6368" target="_blank">01:46:08.660</a></span> | <span class="t">rather hinted at before, which is maybe we shouldn't be adding these things together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6373" target="_blank">01:46:13.780</a></span> | <span class="t">And so the reason you might want to be feeling a little uncomfortable about adding these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6377" target="_blank">01:46:17.940</a></span> | <span class="t">things together is that the input state and the hidden state are kind of qualitatively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6386" target="_blank">01:46:26.140</a></span> | <span class="t">different kinds of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6388" target="_blank">01:46:28.340</a></span> | <span class="t">The input state is the encoding of this character, whereas h represents the encoding of the series</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6396" target="_blank">01:46:36.040</a></span> | <span class="t">of characters so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6397" target="_blank">01:46:37.780</a></span> | <span class="t">And so adding them together is potentially going to lose information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6403" target="_blank">01:46:43.060</a></span> | <span class="t">So I think what Yannette was going to prefer that we might do is maybe to concatenate these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6407" target="_blank">01:46:47.220</a></span> | <span class="t">instead of adding them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6408" target="_blank">01:46:48.220</a></span> | <span class="t">Does that sound good to you, Yannette?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6411" target="_blank">01:46:51.060</a></span> | <span class="t">So let's now make a copy of the previous cell all the same, but rather than using +, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6418" target="_blank">01:46:58.420</a></span> | <span class="t">use cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6421" target="_blank">01:47:01.380</a></span> | <span class="t">Now if we concat, then we need to make sure now that our input layer is not from nFAC</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6429" target="_blank">01:47:09.740</a></span> | <span class="t">to hidden, which is what we had before, but because we're concatenating, it needs to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6433" target="_blank">01:47:13.820</a></span> | <span class="t">nFAC + nhidden to nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6439" target="_blank">01:47:19.140</a></span> | <span class="t">And so now that's going to make all the dimensions work nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6443" target="_blank">01:47:23.760</a></span> | <span class="t">So this now is of size nFAC + nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6449" target="_blank">01:47:29.380</a></span> | <span class="t">This now makes it back to size nhidden again, and then this is putting it through the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6455" target="_blank">01:47:35.240</a></span> | <span class="t">square matrix as before so it's still of size nhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6459" target="_blank">01:47:39.640</a></span> | <span class="t">So this is like a good design heuristic if you're designing an architecture is if you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6466" target="_blank">01:47:46.500</a></span> | <span class="t">got different types of information that you want to combine, you generally want to concatenate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6471" target="_blank">01:47:51.980</a></span> | <span class="t">it, adding things together, even if they're the same shape, is losing information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6480" target="_blank">01:48:00.660</a></span> | <span class="t">And so once you've concatenated things together, you can always convert it back down to a fixed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6486" target="_blank">01:48:06.380</a></span> | <span class="t">size by just chucking it through a matrix product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6490" target="_blank">01:48:10.980</a></span> | <span class="t">So that's what we've done here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6491" target="_blank">01:48:11.980</a></span> | <span class="t">It's the same thing, but now we're concatenating instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6497" target="_blank">01:48:17.280</a></span> | <span class="t">And so we can fit that, and so last time we got 1.72, this time we got 1.68.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6504" target="_blank">01:48:24.640</a></span> | <span class="t">So it's not setting the world on fire, but it's an improvement, and the improvement's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6508" target="_blank">01:48:28.520</a></span> | <span class="t">good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6510" target="_blank">01:48:30.260</a></span> | <span class="t">So we can now test that with getNext.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6513" target="_blank">01:48:33.220</a></span> | <span class="t">And so now we can pass in 8 things, so it's normally for those, it looks good, or part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6518" target="_blank">01:48:38.900</a></span> | <span class="t">of 2, that sounds good as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6521" target="_blank">01:48:41.620</a></span> | <span class="t">So that's enough manual hackery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6532" target="_blank">01:48:52.660</a></span> | <span class="t">Let's see if PyTorch can do some of this for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6535" target="_blank">01:48:55.700</a></span> | <span class="t">And so basically what PyTorch will do for us is it will write this loop automatically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6543" target="_blank">01:49:03.620</a></span> | <span class="t">and it will create these linear input layers automatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6548" target="_blank">01:49:08.420</a></span> | <span class="t">And so to ask it to do that, we can use the nn.rnnplus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6554" target="_blank">01:49:14.740</a></span> | <span class="t">So here's the exact same thing in less code by taking advantage of PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6560" target="_blank">01:49:20.660</a></span> | <span class="t">And again, I'm not using a conceptual analogy to say PyTorch is doing something like it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6565" target="_blank">01:49:25.860</a></span> | <span class="t">I'm saying PyTorch is doing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6568" target="_blank">01:49:28.260</a></span> | <span class="t">This is just the code you just saw wrapped up a little bit, refactored a little bit for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6573" target="_blank">01:49:33.500</a></span> | <span class="t">your convenience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6574" target="_blank">01:49:34.900</a></span> | <span class="t">So when we say we now want to create an rnn, called rnn, then what this does is it does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6583" target="_blank">01:49:43.080</a></span> | <span class="t">that for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6584" target="_blank">01:49:44.660</a></span> | <span class="t">Now notice that our for loop needed a starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6590" target="_blank">01:49:50.700</a></span> | <span class="t">You remember why, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6591" target="_blank">01:49:51.820</a></span> | <span class="t">Because otherwise our for loop didn't quite work, we couldn't quite refactor it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6595" target="_blank">01:49:55.420</a></span> | <span class="t">And because this is exactly the same, this needs a starting point too.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6599" target="_blank">01:49:59.660</a></span> | <span class="t">So let's give it a starting point and so you have to pass in your initial hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6605" target="_blank">01:50:05.940</a></span> | <span class="t">For reasons that will become apparent later on, it turns out to be quite useful to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6614" target="_blank">01:50:14.820</a></span> | <span class="t">able to get back that hidden state at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6619" target="_blank">01:50:19.540</a></span> | <span class="t">And just like we could here, we could actually keep track of the hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6624" target="_blank">01:50:24.460</a></span> | <span class="t">We get back two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6625" target="_blank">01:50:25.460</a></span> | <span class="t">We get back both the output and the hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6629" target="_blank">01:50:29.320</a></span> | <span class="t">So we pass in the input and the hidden state and we get back the output and the hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6633" target="_blank">01:50:33.640</a></span> | <span class="t">state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6634" target="_blank">01:50:34.640</a></span> | <span class="t">Yes?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6635" target="_blank">01:50:35.640</a></span> | <span class="t">So it's the orange circle ellipse of activations, and so it is of size 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6661" target="_blank">01:51:01.520</a></span> | <span class="t">So there's one other thing to know, which is in our case we were replacing h with a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6672" target="_blank">01:51:12.740</a></span> | <span class="t">hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6675" target="_blank">01:51:15.140</a></span> | <span class="t">The one minor difference in PyTorch is they append the new hidden state to a list, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6682" target="_blank">01:51:22.060</a></span> | <span class="t">to a tensor, which gets bigger and bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6684" target="_blank">01:51:24.340</a></span> | <span class="t">So they actually give you back all of the hidden states, so in other words, rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6687" target="_blank">01:51:27.940</a></span> | <span class="t">just giving you back the final ellipse, they give you back all of the ellipses stacked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6692" target="_blank">01:51:32.660</a></span> | <span class="t">on top of each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6694" target="_blank">01:51:34.060</a></span> | <span class="t">And so because we just want the final one, I just got indexed into it with -1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6698" target="_blank">01:51:38.740</a></span> | <span class="t">Other than that, this is the same code as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6703" target="_blank">01:51:43.700</a></span> | <span class="t">Work that through our output layer to get the correct vocab size, and then we can train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6720" target="_blank">01:52:00.060</a></span> | <span class="t">that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6721" target="_blank">01:52:01.060</a></span> | <span class="t">So you can see here I can do it manually, I can create some hidden state, I can pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6722" target="_blank">01:52:02.060</a></span> | <span class="t">it to that RNN, I can see the stuff I get back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6726" target="_blank">01:52:06.100</a></span> | <span class="t">You'll see that the dimensionality of h, it's actually a rank 3 tensor, where else in my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6735" target="_blank">01:52:15.060</a></span> | <span class="t">version it was a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6743" target="_blank">01:52:23.660</a></span> | <span class="t">And the difference is here we've got just a unit axis at the front.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6748" target="_blank">01:52:28.380</a></span> | <span class="t">We'll learn more about why that is later, but basically it turns out you can have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6752" target="_blank">01:52:32.620</a></span> | <span class="t">second RNN that goes backwards, one that goes forwards, one that goes backwards, and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6757" target="_blank">01:52:37.700</a></span> | <span class="t">idea is it's going to be better at finding relationships that kind of go backwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6763" target="_blank">01:52:43.580</a></span> | <span class="t">That's called a bidirectional RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6765" target="_blank">01:52:45.740</a></span> | <span class="t">Also it turns out you can have an RNN feed to an RNN, that's called a multi-layer RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6770" target="_blank">01:52:50.060</a></span> | <span class="t">So basically if you have those things, you need an additional axis on your tensor to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6775" target="_blank">01:52:55.700</a></span> | <span class="t">keep track of those additional layers of hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6778" target="_blank">01:52:58.620</a></span> | <span class="t">But for now, we'll always have a 1 here, and we'll always also get back a 1 at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6789" target="_blank">01:53:09.180</a></span> | <span class="t">So if we go ahead and fit this now, let's actually train it for a bit longer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6796" target="_blank">01:53:16.540</a></span> | <span class="t">So last time we only did a couple of epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6799" target="_blank">01:53:19.500</a></span> | <span class="t">This time we'll do 4 epochs at one in egg 3, and then we'll do another 2 epochs at one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6808" target="_blank">01:53:28.020</a></span> | <span class="t">in egg 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6810" target="_blank">01:53:30.120</a></span> | <span class="t">And so we've now got our loss down to 1.5, so getting better and better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6818" target="_blank">01:53:38.460</a></span> | <span class="t">So here's our getNext again, and let's just do the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6824" target="_blank">01:53:44.580</a></span> | <span class="t">So what we can now do is we can loop through 40 times, calling getNext each time, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6831" target="_blank">01:53:51.900</a></span> | <span class="t">each time we'll replace that input by removing the first character and adding the thing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6836" target="_blank">01:53:56.780</a></span> | <span class="t">we just predicted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6838" target="_blank">01:53:58.300</a></span> | <span class="t">And so that way we can feed in a new set of 8 characters again and again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6843" target="_blank">01:54:03.660</a></span> | <span class="t">And so that way we'll call that getNext in, so here are 40 characters that we've generated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6849" target="_blank">01:54:09.780</a></span> | <span class="t">So we started out with 4thos, we got 4 those of the same, to the same, to the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6856" target="_blank">01:54:16.980</a></span> | <span class="t">You can probably guess what happens if you keep predicting the same to the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6861" target="_blank">01:54:21.160</a></span> | <span class="t">So it's doing okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6865" target="_blank">01:54:25.100</a></span> | <span class="t">We now have something which we've basically built from scratch, and then we've said here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6875" target="_blank">01:54:35.180</a></span> | <span class="t">how PyTorch refactored it for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6878" target="_blank">01:54:38.540</a></span> | <span class="t">So if you want to have an interesting little homework assignment this week, try to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6884" target="_blank">01:54:44.220</a></span> | <span class="t">your own version of an RNN class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6888" target="_blank">01:54:48.820</a></span> | <span class="t">Try to literally create your Jeremy's RNN, and then type in here Jeremy's RNN, or in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6898" target="_blank">01:54:58.180</a></span> | <span class="t">case maybe your name's not Jeremy, which is OK too, and then get it to run, writing your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6904" target="_blank">01:55:04.260</a></span> | <span class="t">implementation of that class from scratch without looking at the PyTorch source code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6909" target="_blank">01:55:09.940</a></span> | <span class="t">Basically it's just a case of going up and seeing what we did back here, make sure you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6915" target="_blank">01:55:15.300</a></span> | <span class="t">get the same answers, and confirm that you do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6918" target="_blank">01:55:18.620</a></span> | <span class="t">So that's kind of a good little test, very simple little assignment, but I think you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6923" target="_blank">01:55:23.940</a></span> | <span class="t">feel really good when you've seen "Oh, I've just re-implemented nn.RNN."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6931" target="_blank">01:55:31.700</a></span> | <span class="t">So I'm going to do one other thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6936" target="_blank">01:55:36.420</a></span> | <span class="t">When I switched from this one, when I've moved the car1 input inside the dotted line, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6941" target="_blank">01:55:41.020</a></span> | <span class="t">dotted rectangle represents the thing I'm repeating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6944" target="_blank">01:55:44.580</a></span> | <span class="t">I also, watch the triangle, the output, I move that inside as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6950" target="_blank">01:55:50.700</a></span> | <span class="t">Now that's a big difference because now what I've actually done is I'm actually saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6957" target="_blank">01:55:57.940</a></span> | <span class="t">spit out an output after every one of these circles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6963" target="_blank">01:56:03.380</a></span> | <span class="t">So spit out an output here, and here, and here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6968" target="_blank">01:56:08.620</a></span> | <span class="t">So in other words, if I have a 3-character input, I'm going to spit out a 3-character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6972" target="_blank">01:56:12.900</a></span> | <span class="t">output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6973" target="_blank">01:56:13.900</a></span> | <span class="t">I'm saying after character 1, this will be next, after character 2, this will be next,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6977" target="_blank">01:56:17.260</a></span> | <span class="t">after character 3, this will be next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6981" target="_blank">01:56:21.580</a></span> | <span class="t">So again, nothing different, and again, if you wanted to go a bit further with the assignment,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6988" target="_blank">01:56:28.820</a></span> | <span class="t">you could write this by hand as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6991" target="_blank">01:56:31.420</a></span> | <span class="t">But basically what we're saying is in the for loop, we'd be saying results = some empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=6999" target="_blank">01:56:39.680</a></span> | <span class="t">list, and then we'd be going through, and rather than returning that, we'd instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7005" target="_blank">01:56:45.620</a></span> | <span class="t">be saying results.append that, and then return torch.stat, something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7021" target="_blank">01:57:01.460</a></span> | <span class="t">That may even be right, I'm not quite sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7023" target="_blank">01:57:03.960</a></span> | <span class="t">So now we now have every step we've created an output, which is basically this picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7033" target="_blank">01:57:13.960</a></span> | <span class="t">And so the reason, well there's lots of reasons that's interesting, but I think the main reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7040" target="_blank">01:57:20.020</a></span> | <span class="t">right now that's interesting is that you probably noticed this approach to dealing with that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7051" target="_blank">01:57:31.280</a></span> | <span class="t">data seems terribly inefficient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7053" target="_blank">01:57:33.700</a></span> | <span class="t">Like we're grabbing the first 8, but then this next set, all but one of them overlaps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7061" target="_blank">01:57:41.780</a></span> | <span class="t">the previous one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7064" target="_blank">01:57:44.580</a></span> | <span class="t">So we're kind of recalculating the exact same embeddings, 7 out of 8 of them are going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7070" target="_blank">01:57:50.460</a></span> | <span class="t">be exact same embeddings, exact same transitions, it kind of seems weird to do all this calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7079" target="_blank">01:57:59.460</a></span> | <span class="t">to just predict one thing and then go back and recalculate 7 out of 8 of them and add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7083" target="_blank">01:58:03.620</a></span> | <span class="t">one more to the end to calculate the next thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7087" target="_blank">01:58:07.260</a></span> | <span class="t">So the basic idea then is to say, well let's not do it that way, instead let's take non-overlapping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7097" target="_blank">01:58:17.580</a></span> | <span class="t">sets of characters, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7102" target="_blank">01:58:22.580</a></span> | <span class="t">Here is our first 8 characters, here is the next 8 characters, here are the next 8 characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7108" target="_blank">01:58:28.660</a></span> | <span class="t">So like if you read this top left to bottom right, that would be the whole mixture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7116" target="_blank">01:58:36.320</a></span> | <span class="t">And so then, if these are the first 8 characters, then offset this by 1, starting here, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7125" target="_blank">01:58:45.100</a></span> | <span class="t">a list of outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7128" target="_blank">01:58:48.460</a></span> | <span class="t">So after we see characters 0 through 7, we should predict characters 1 through 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7135" target="_blank">01:58:55.520</a></span> | <span class="t">So after 40 should come 42 as it did, after 42 should come 29 as it did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7144" target="_blank">01:59:04.580</a></span> | <span class="t">And so now that can be our inputs and labels for that model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7150" target="_blank">01:59:10.940</a></span> | <span class="t">And so it shouldn't be any more or less accurate, it should just be the same, but it should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7160" target="_blank">01:59:20.660</a></span> | <span class="t">allow us to do it more efficiently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7166" target="_blank">01:59:26.860</a></span> | <span class="t">So let's try that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7175" target="_blank">01:59:35.540</a></span> | <span class="t">So I mentioned last time that we had a -1 index here, because we just wanted to grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7184" target="_blank">01:59:44.060</a></span> | <span class="t">the last triangle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7188" target="_blank">01:59:48.180</a></span> | <span class="t">So in this case, we're going to grab all the triangles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7191" target="_blank">01:59:51.300</a></span> | <span class="t">So this is actually the way an n dot r and n creates things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7195" target="_blank">01:59:55.880</a></span> | <span class="t">We only kept the last one, but this time we're going to keep all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7205" target="_blank">02:00:05.700</a></span> | <span class="t">So we've made one change, which is to remove that -1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7209" target="_blank">02:00:09.900</a></span> | <span class="t">Other than that, this is the exact same code as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7216" target="_blank">02:00:16.260</a></span> | <span class="t">There's nothing much to show you here, except of course this time if we look at the labels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7229" target="_blank">02:00:29.080</a></span> | <span class="t">it's now 512x8 because we're trying to predict 8 things every time through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7238" target="_blank">02:00:38.220</a></span> | <span class="t">So there is one complexity here, which is that we want to use the negative-l likelihood</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7247" target="_blank">02:00:47.420</a></span> | <span class="t">loss function as before, but the negative-l likelihood loss function just like RMSE expects</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7255" target="_blank">02:00:55.680</a></span> | <span class="t">to receive 2 rank 1 tensors, well actually with the minibatch axis, 2 rank 2 tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7263" target="_blank">02:01:03.420</a></span> | <span class="t">So 2 minibatches of vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7268" target="_blank">02:01:08.000</a></span> | <span class="t">The problem is that we've got 8 time steps, 8 characters, in an r and n we call it a time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7277" target="_blank">02:01:17.140</a></span> | <span class="t">step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7278" target="_blank">02:01:18.700</a></span> | <span class="t">We have 8 time steps, and then for each one we have 84 probabilities, the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7285" target="_blank">02:01:25.020</a></span> | <span class="t">for every single one of those 8 time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7290" target="_blank">02:01:30.780</a></span> | <span class="t">And then we have that for each of our 512 items in the minibatch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7296" target="_blank">02:01:36.460</a></span> | <span class="t">So we have a rank 3 tensor, not a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7302" target="_blank">02:01:42.060</a></span> | <span class="t">So that means that the negative-l likelihood loss function is going to spit out an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7307" target="_blank">02:01:47.940</a></span> | <span class="t">Frankly I think this is kind of dumb, I think it would be better if PyTorch had written</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7313" target="_blank">02:01:53.820</a></span> | <span class="t">their loss functions in such a way that they didn't care at all about rank and they just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7319" target="_blank">02:01:59.060</a></span> | <span class="t">applied it to whatever rank you gave it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7322" target="_blank">02:02:02.620</a></span> | <span class="t">But for now at least, it does care about rec.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7326" target="_blank">02:02:06.560</a></span> | <span class="t">But the nice thing is I get to show you how to write a custom loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7330" target="_blank">02:02:10.460</a></span> | <span class="t">So we're going to create a special negative-l likelihood loss function for sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7336" target="_blank">02:02:16.620</a></span> | <span class="t">And so it's going to take an input in the target, and it's going to call f.negative-l likelihood</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7341" target="_blank">02:02:21.460</a></span> | <span class="t">loss, so the PyTorch one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7346" target="_blank">02:02:26.140</a></span> | <span class="t">So what we're going to do is we're going to flatten our input, and we're going to flatten</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7354" target="_blank">02:02:34.540</a></span> | <span class="t">our targets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7357" target="_blank">02:02:37.940</a></span> | <span class="t">And it turns out these are going to be the first two axes that have to be transposed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7366" target="_blank">02:02:46.540</a></span> | <span class="t">So the way PyTorch handles RNN data by default is the first axis is the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7376" target="_blank">02:02:56.100</a></span> | <span class="t">In this case, 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7378" target="_blank">02:02:58.120</a></span> | <span class="t">So the sequence length of an RNN is how many time steps?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7382" target="_blank">02:03:02.620</a></span> | <span class="t">So we have 8 characters, so sequence length of 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7385" target="_blank">02:03:05.540</a></span> | <span class="t">The second axis is the batch size, and then as you would expect, the third axis is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7391" target="_blank">02:03:11.360</a></span> | <span class="t">actual hidden state itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7393" target="_blank">02:03:13.940</a></span> | <span class="t">So this is going to be 8 by 512 by nhidden, which I think was 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7406" target="_blank">02:03:26.540</a></span> | <span class="t">So we can grab the size and unpack it into each of these, sequence length batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7411" target="_blank">02:03:31.980</a></span> | <span class="t">numhidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7416" target="_blank">02:03:36.820</a></span> | <span class="t">Our target is 512 by 8, where else this one here was 8 by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7432" target="_blank">02:03:52.900</a></span> | <span class="t">So to make them match, we're going to have to transpose the first two axes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7442" target="_blank">02:04:02.500</a></span> | <span class="t">PyTorch, when you do something like transpose, doesn't generally actually shuffle the memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7448" target="_blank">02:04:08.100</a></span> | <span class="t">order, but instead it just kind of keeps some internal metadata to say you should treat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7454" target="_blank">02:04:14.340</a></span> | <span class="t">this as if it's transposed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7458" target="_blank">02:04:18.820</a></span> | <span class="t">Some things in PyTorch will give you an error if you try and use it when it has this internal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7464" target="_blank">02:04:24.900</a></span> | <span class="t">state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7465" target="_blank">02:04:25.900</a></span> | <span class="t">It will basically say, "Error, this tensor is not contiguous."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7472" target="_blank">02:04:32.100</a></span> | <span class="t">If you ever see that error, add the word "contiguous" after it and it goes away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7476" target="_blank">02:04:36.700</a></span> | <span class="t">So I don't know, they can't do that for you apparently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7479" target="_blank">02:04:39.300</a></span> | <span class="t">So in this particular case, I got that error, so I wrote the word "contiguous" after it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7484" target="_blank">02:04:44.020</a></span> | <span class="t">And so then finally we need to flatten it out into a single vector, and so we can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7489" target="_blank">02:04:49.100</a></span> | <span class="t">go dot view, which is the same as numPy dot reshape, and -1 means as long as it needs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7494" target="_blank">02:04:54.840</a></span> | <span class="t">to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7497" target="_blank">02:04:57.820</a></span> | <span class="t">And then the input, again we also reshape that, but remember the predictions also have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7508" target="_blank">02:05:08.980</a></span> | <span class="t">this axis of length 84, all of the predicted probabilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7514" target="_blank">02:05:14.860</a></span> | <span class="t">So here's a custom loss function, that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7519" target="_blank">02:05:19.140</a></span> | <span class="t">So if you ever want to play around with your own loss functions, you can just do that like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7523" target="_blank">02:05:23.780</a></span> | <span class="t">so, and then pass that to fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7529" target="_blank">02:05:29.460</a></span> | <span class="t">So it's important to remember that fit is this lowest level fastai abstraction, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7539" target="_blank">02:05:39.180</a></span> | <span class="t">is the thing that implements the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7542" target="_blank">02:05:42.220</a></span> | <span class="t">And so the stuff you pass it in is all standard PyTorch stuff except for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7551" target="_blank">02:05:51.820</a></span> | <span class="t">This is our model data object, this is the thing that wraps up the test set, the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7557" target="_blank">02:05:57.420</a></span> | <span class="t">set and the validation set together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7565" target="_blank">02:06:05.780</a></span> | <span class="t">So when we pull the triangle into the repeated structure, so the first n-1 iterations of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7574" target="_blank">02:06:14.900</a></span> | <span class="t">the sequence length, we don't see the whole sequence length, so does that mean that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7579" target="_blank">02:06:19.940</a></span> | <span class="t">batch size should be much bigger so that you get a triangular kind of --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7583" target="_blank">02:06:23.780</a></span> | <span class="t">Now be careful, you don't mean batch size, you mean sequence length, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7587" target="_blank">02:06:27.820</a></span> | <span class="t">Because the batch size is like something else entirely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7591" target="_blank">02:06:31.820</a></span> | <span class="t">So yes, if you have a short sequence length like 8, the first character has nothing to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7600" target="_blank">02:06:40.420</a></span> | <span class="t">go on, it starts with an empty hidden state of zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7608" target="_blank">02:06:48.260</a></span> | <span class="t">So what we're going to start with next week is we're going to learn how to avoid that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7613" target="_blank">02:06:53.220</a></span> | <span class="t">problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7614" target="_blank">02:06:54.740</a></span> | <span class="t">And so it's a really insightful question or concern.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7619" target="_blank">02:06:59.700</a></span> | <span class="t">But if you think about it, the basic idea is why should we reset this to 0 every time?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7629" target="_blank">02:07:09.100</a></span> | <span class="t">If we can kind of line up these mini-batches somehow so that the next mini-batch joins</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7636" target="_blank">02:07:16.540</a></span> | <span class="t">up correctly, it represents the next letter in nature's works, then we'd want to move</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7642" target="_blank">02:07:22.340</a></span> | <span class="t">this up into the constructor and then pass that here and then store it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7656" target="_blank">02:07:36.460</a></span> | <span class="t">And now we're not resetting the hidden state each time, we're actually keeping the hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7663" target="_blank">02:07:43.340</a></span> | <span class="t">state from call to call, and so the only time that it would be failing to benefit from learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7671" target="_blank">02:07:51.680</a></span> | <span class="t">state would be literally at the very start of the document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7675" target="_blank">02:07:55.500</a></span> | <span class="t">So that's where we're going to try ahead next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7687" target="_blank">02:08:07.380</a></span> | <span class="t">I feel like this lesson, every time I've got a punch line coming, somebody asks me a question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7691" target="_blank">02:08:11.700</a></span> | <span class="t">where I have to do the punch line ahead of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7697" target="_blank">02:08:17.220</a></span> | <span class="t">So we can fit that and we can fit that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7700" target="_blank">02:08:20.940</a></span> | <span class="t">And I want to show you something interesting, and this is coming to another punch line that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7706" target="_blank">02:08:26.740</a></span> | <span class="t">Yannette tried to spoil, which is when we're -- remember, this is just doing a loop, applying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7716" target="_blank">02:08:36.380</a></span> | <span class="t">the same matrix multiply again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7720" target="_blank">02:08:40.420</a></span> | <span class="t">If that matrix multiply tends to increase the activations each time, then effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7727" target="_blank">02:08:47.740</a></span> | <span class="t">we're doing that to the power of 8, so it's going to shoot off really high, or if it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7733" target="_blank">02:08:53.260</a></span> | <span class="t">decreasing it a little bit each time, it's going to shoot off really low.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7737" target="_blank">02:08:57.260</a></span> | <span class="t">So this is what we call a gradient explosion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7740" target="_blank">02:09:00.860</a></span> | <span class="t">And so we really want to make sure that the initial L hidden that we create is of a size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7758" target="_blank">02:09:18.700</a></span> | <span class="t">that's not going to cause our activations on average to increase or decrease.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7764" target="_blank">02:09:24.500</a></span> | <span class="t">And there's actually a very nice matrix that does exactly that, called the identity matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7773" target="_blank">02:09:33.180</a></span> | <span class="t">So the identity matrix for those that don't quite remember their linear algebra is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7780" target="_blank">02:09:40.980</a></span> | <span class="t">This would be a size 3 identity matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7784" target="_blank">02:09:44.740</a></span> | <span class="t">And so the trick about an identity matrix is anything times an identity matrix is itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7792" target="_blank">02:09:52.740</a></span> | <span class="t">And therefore you could multiply by this again and again and again and again and still end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7797" target="_blank">02:09:57.620</a></span> | <span class="t">up with itself, so there's no gradient explosion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7802" target="_blank">02:10:02.860</a></span> | <span class="t">So what we could do is instead of using whatever the default random unit is for this matrix,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7810" target="_blank">02:10:10.540</a></span> | <span class="t">we could instead, after we create our RNN, we can go into that RNN, and if we now go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7821" target="_blank">02:10:21.860</a></span> | <span class="t">like so, we can get the docs for m.RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7827" target="_blank">02:10:27.740</a></span> | <span class="t">And as well as the arguments for constructing it, it also tells you the inputs and outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7833" target="_blank">02:10:33.140</a></span> | <span class="t">for calling the layer, and it also tells you the attributes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7837" target="_blank">02:10:37.180</a></span> | <span class="t">And so it tells you there's something called weightHH, and these are the learnable hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7842" target="_blank">02:10:42.060</a></span> | <span class="t">to hidden weights, that's that square matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7845" target="_blank">02:10:45.300</a></span> | <span class="t">So after we've constructed our m, we can just go in and say m.RNN.weightHHL.data, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7855" target="_blank">02:10:55.820</a></span> | <span class="t">the tensor, dot copy_inplace, torch.i, that is 'i' for identity, in case you were wondering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7868" target="_blank">02:11:08.860</a></span> | <span class="t">So this is an identity matrix of size n hidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7872" target="_blank">02:11:12.580</a></span> | <span class="t">So this both puts into this weight matrix and returns the identity matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7880" target="_blank">02:11:20.320</a></span> | <span class="t">And so this was like, actually a Jeffrey Hinton paper was like, hey, you know, after 2015,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7892" target="_blank">02:11:32.020</a></span> | <span class="t">so after recurrent neural nets have been around for decades, he was like, hey gang, maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7899" target="_blank">02:11:39.300</a></span> | <span class="t">we should just use the identity matrix to initialize this, and it actually turns out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7905" target="_blank">02:11:45.180</a></span> | <span class="t">to work really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7908" target="_blank">02:11:48.140</a></span> | <span class="t">And so that was a 2015 paper, believe it or not, from the father of neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7912" target="_blank">02:11:52.880</a></span> | <span class="t">And so here is our implementation of his paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7915" target="_blank">02:11:55.780</a></span> | <span class="t">And this is an important thing to note, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7918" target="_blank">02:11:58.060</a></span> | <span class="t">When very famous people like Jeffrey Hinton write a paper, sometimes the entire implementation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7923" target="_blank">02:12:03.260</a></span> | <span class="t">of that paper looks like one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7927" target="_blank">02:12:07.140</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7928" target="_blank">02:12:08.900</a></span> | <span class="t">Before we got 0.61257, we'll fit it with exactly the same parameters, and now we've got 0.51,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7936" target="_blank">02:12:16.540</a></span> | <span class="t">and in fact we can keep training 0.50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7938" target="_blank">02:12:18.780</a></span> | <span class="t">So this tweak really, really, really helped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7943" target="_blank">02:12:23.300</a></span> | <span class="t">And one of the nice things about this tweak was before I could only use a learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7947" target="_blank">02:12:27.220</a></span> | <span class="t">of 1 in egg 3 before it started going crazy, but after I used the identity matrix, I found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7953" target="_blank">02:12:33.460</a></span> | <span class="t">I could use 1 in egg 2 because it's better behaved.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7957" target="_blank">02:12:37.420</a></span> | <span class="t">Weight initialization, I found I could use a higher learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7962" target="_blank">02:12:42.340</a></span> | <span class="t">And honestly, these things, increasingly we're trying to incorporate into the defaults in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7970" target="_blank">02:12:50.260</a></span> | <span class="t">fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7971" target="_blank">02:12:51.260</a></span> | <span class="t">You won't necessarily need to actually know them, but at this point we're still at a point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7979" target="_blank">02:12:59.140</a></span> | <span class="t">where most things in most libraries most of the time don't have great defaults, it's good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7983" target="_blank">02:13:03.420</a></span> | <span class="t">to know all these little tricks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7985" target="_blank">02:13:05.100</a></span> | <span class="t">It's also nice to know if you want to improve something what kind of tricks people have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7989" target="_blank">02:13:09.100</a></span> | <span class="t">used elsewhere because you can often borrow them yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=7993" target="_blank">02:13:13.360</a></span> | <span class="t">Alright, that's the end of the lesson today, so next week we will look at this idea of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=8000" target="_blank">02:13:20.140</a></span> | <span class="t">a stateful RNN that's going to keep its hidden state around, and then we're going to go back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=8004" target="_blank">02:13:24.740</a></span> | <span class="t">to looking at language models again, and then finally we're going to go all the way back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=8008" target="_blank">02:13:28.880</a></span> | <span class="t">to computer vision and learn about things like resnets, and batch norm, and all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=8014" target="_blank">02:13:34.640</a></span> | <span class="t">tricks that were figured out in cats vs dogs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=8017" target="_blank">02:13:37.780</a></span> | <span class="t">See you then!</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sHcLkfRrgoQ&t=8018" target="_blank">02:13:38.740</a></span> | <span class="t">[APPLAUSE]</span></div></div></body></html>