<html><head><title>Lesson 19: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 19: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=ItyO8s48zdc"><img src="https://i.ytimg.com/vi/ItyO8s48zdc/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=0">0:0</a> Introduction and quick update from last lesson<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=128">2:8</a> Dropout<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=727">12:7</a> DDPM from scratch - Paper and math<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2417">40:17</a> DDPM - The code<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2476">41:16</a> U-Net Neural Network<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2621">43:41</a> Training process<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3367">56:7</a> Inheriting from miniai TrainCB<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3622">60:22</a> Using the trained model: denoising with “sample” method<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4149">69:9</a> Inference: generating some images<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4496">74:56</a> Notebook 17: Jeremy’s exploration of Tanishq’s notebook<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5049">84:9</a> Make it faster: Initialization<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5261">87:41</a> Make it faster: Mixed Precision<br><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5380">89:40</a> Change of plans: Mixed Precision goes to Lesson 20<br><br><div style="text-align: left;"><a href="./ItyO8s48zdc.html">Whisper Transcript</a> | <a href="./transcript_ItyO8s48zdc.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Okay, hi everybody, and this is Lesson 19 with extremely special guests Tanish and Jono.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=8" target="_blank">00:00:08.200</a></span> | <span class="t">Hi guys, how are you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=10" target="_blank">00:00:10.260</a></span> | <span class="t">Hello.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=11" target="_blank">00:00:11.260</a></span> | <span class="t">Hey Jeremy, good to be here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=13" target="_blank">00:00:13.640</a></span> | <span class="t">And it's New Year's Eve 2022, finishing off 2022 with a bang, or at least a really cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=22" target="_blank">00:00:22.800</a></span> | <span class="t">lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=25" target="_blank">00:00:25.920</a></span> | <span class="t">And most of this lesson's going to be Tanish and Jono, but I'm going to start with a quick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=33" target="_blank">00:00:33.120</a></span> | <span class="t">update from the last lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=39" target="_blank">00:00:39.840</a></span> | <span class="t">What I wanted to show you is that Christopher Thomas on the forum, what I want to show you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=49" target="_blank">00:00:49.360</a></span> | <span class="t">is that Christopher Thomas on the forum came up with a better winning result for our challenge,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=58" target="_blank">00:00:58.960</a></span> | <span class="t">the Fashion MNIST Challenge, which we are tracking here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=64" target="_blank">00:01:04.520</a></span> | <span class="t">And be sure to check out this forum thread for the latest results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=71" target="_blank">00:01:11.240</a></span> | <span class="t">And he found that he was able to get better results with Dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=77" target="_blank">00:01:17.920</a></span> | <span class="t">Then Peter on the forum noticed I had a bug in my code, and the bug in my code for ResNets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=87" target="_blank">00:01:27.360</a></span> | <span class="t">actually I won't show you, I'll just tell you, is that in the res block I was not passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=92" target="_blank">00:01:32.400</a></span> | <span class="t">along the batch norm parameter, and as a result, all the results I had were without batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=98" target="_blank">00:01:38.120</a></span> | <span class="t">So then when I fixed batch norm and added Dropout at Christopher's suggestion, I got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=105" target="_blank">00:01:45.040</a></span> | <span class="t">better results still, and then Christopher came up with a better Dropout and got better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=110" target="_blank">00:01:50.280</a></span> | <span class="t">results still for 50 epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=112" target="_blank">00:01:52.400</a></span> | <span class="t">So let me show you the 93.2 for 5 epochs improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=119" target="_blank">00:01:59.640</a></span> | <span class="t">I won't show the change to batch norm because that's actually, that'll just be in the repo</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=124" target="_blank">00:02:04.880</a></span> | <span class="t">now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=125" target="_blank">00:02:05.880</a></span> | <span class="t">So the batch norm is already fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=128" target="_blank">00:02:08.880</a></span> | <span class="t">So I'm going to tell you about what Dropout is and then show that to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=133" target="_blank">00:02:13.740</a></span> | <span class="t">So Dropout is a simple but powerful idea where what we do with some particular probability,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=142" target="_blank">00:02:22.480</a></span> | <span class="t">so here that's a probability of 0.1, we randomly delete some activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=150" target="_blank">00:02:30.100</a></span> | <span class="t">And when I say delete, what I actually mean is we change them to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=156" target="_blank">00:02:36.080</a></span> | <span class="t">So one easy way to do this is to create a binomial distribution object where the probabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=165" target="_blank">00:02:45.280</a></span> | <span class="t">are 1 minus p, and then sample from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=170" target="_blank">00:02:50.440</a></span> | <span class="t">And that will give you a 0.1 probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=176" target="_blank">00:02:56.640</a></span> | <span class="t">So in this case, oh, this is perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=178" target="_blank">00:02:58.680</a></span> | <span class="t">I have exactly 1, 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=180" target="_blank">00:03:00.180</a></span> | <span class="t">Of course, randomly, that's not always going to be the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=183" target="_blank">00:03:03.240</a></span> | <span class="t">But since I asked for 10 samples and 0.1 of the time, it should be 0, I so happened to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=188" target="_blank">00:03:08.400</a></span> | <span class="t">get, yeah, exactly one of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=191" target="_blank">00:03:11.020</a></span> | <span class="t">And so if we took a tensor like this and multiplied it by our activations, that will set about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=201" target="_blank">00:03:21.360</a></span> | <span class="t">a tenth of them to 0 because multiplying by 0 gives you 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=205" target="_blank">00:03:25.640</a></span> | <span class="t">So here's a Dropout plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=208" target="_blank">00:03:28.400</a></span> | <span class="t">So you pass it and you say what probability of Dropout there is, store it away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=213" target="_blank">00:03:33.440</a></span> | <span class="t">Now we're only going to do this during training time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=217" target="_blank">00:03:37.900</a></span> | <span class="t">So at evaluation time, we're not going to randomly delete activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=223" target="_blank">00:03:43.440</a></span> | <span class="t">But during training time, we will create our binomial distribution object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=229" target="_blank">00:03:49.220</a></span> | <span class="t">We will pass in the 1 minus p probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=232" target="_blank">00:03:52.200</a></span> | <span class="t">And then you say, how many binomial trials do you want to run, so how many coin tosses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=238" target="_blank">00:03:58.760</a></span> | <span class="t">or dice rolls or whatever each time, and so it's just one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=242" target="_blank">00:04:02.520</a></span> | <span class="t">And this is a cool little trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=244" target="_blank">00:04:04.000</a></span> | <span class="t">If you put that one onto your accelerator, GPU or MPS or whatever, it's actually going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=250" target="_blank">00:04:10.520</a></span> | <span class="t">to create a binomial distribution that runs on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=253" target="_blank">00:04:13.720</a></span> | <span class="t">That's a really cool trick that not many people know about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=258" target="_blank">00:04:18.800</a></span> | <span class="t">And so then if I sample and I make a sample exactly the same size as my input, then that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=265" target="_blank">00:04:25.680</a></span> | <span class="t">going to give me a bunch of ones and zeros and a tensor the same size as my activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=272" target="_blank">00:04:32.240</a></span> | <span class="t">And then another cool trick is this is going to result in activations that are on average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=278" target="_blank">00:04:38.400</a></span> | <span class="t">about one tenth smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=281" target="_blank">00:04:41.400</a></span> | <span class="t">So if I multiply by 1 over 1 minus 0.9, so I multiply in this case by that, then that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=293" target="_blank">00:04:53.040</a></span> | <span class="t">going to scale up to undo that difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=302" target="_blank">00:05:02.280</a></span> | <span class="t">And Jeremy, in the line above where you have props equals 1 minus p, should that be 1 minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=308" target="_blank">00:05:08.660</a></span> | <span class="t">self.p?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=309" target="_blank">00:05:09.660</a></span> | <span class="t">Oh, it absolutely should.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=312" target="_blank">00:05:12.560</a></span> | <span class="t">Thank you very much, Jenna.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=315" target="_blank">00:05:15.940</a></span> | <span class="t">Not that it matters too much because, yeah, you can always just use nn.dropout at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=321" target="_blank">00:05:21.080</a></span> | <span class="t">point and use point one, which is why I didn't even see that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=324" target="_blank">00:05:24.440</a></span> | <span class="t">So as you can see, I'm not even bothering to export this because I'm just showing how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=327" target="_blank">00:05:27.720</a></span> | <span class="t">to repeat what's already available in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=335" target="_blank">00:05:35.600</a></span> | <span class="t">So yeah, thanks, Jenna.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=336" target="_blank">00:05:36.840</a></span> | <span class="t">That's a good fix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=340" target="_blank">00:05:40.640</a></span> | <span class="t">So if we're in evaluation mode, it's just going to return the original.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=345" target="_blank">00:05:45.880</a></span> | <span class="t">If p equals 0, then these are all going to be just ones anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=353" target="_blank">00:05:53.440</a></span> | <span class="t">So we'll be multiplying by 1 divided by 1, so there's nothing to change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=357" target="_blank">00:05:57.980</a></span> | <span class="t">So with p of 0, it does nothing in effect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=361" target="_blank">00:06:01.080</a></span> | <span class="t">Yeah, and otherwise it's going to kind of zero out some of our activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=365" target="_blank">00:06:05.240</a></span> | <span class="t">So a pretty common place to add dropout is before your last linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=371" target="_blank">00:06:11.200</a></span> | <span class="t">So that's what I've done here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=375" target="_blank">00:06:15.720</a></span> | <span class="t">So yeah, if I run the exact same epochs, I get 93.2, which is a very slight improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=384" target="_blank">00:06:24.200</a></span> | <span class="t">And so the reason for that is that it's not going to be able to memorize the data or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=394" target="_blank">00:06:34.880</a></span> | <span class="t">actions, because there's a little bit of randomness.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=399" target="_blank">00:06:39.400</a></span> | <span class="t">So it's going to force it to try to identify just the actual underlying differences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=405" target="_blank">00:06:45.500</a></span> | <span class="t">There's a lot of different ways of thinking about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=407" target="_blank">00:06:47.480</a></span> | <span class="t">You can almost think of it as a bagging thing, a bit like a random forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=410" target="_blank">00:06:50.880</a></span> | <span class="t">Each time it's giving a slightly different kind of random subset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=416" target="_blank">00:06:56.000</a></span> | <span class="t">Yeah, but that's what it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=423" target="_blank">00:07:03.120</a></span> | <span class="t">I also added a drop2d layer right at the start, which is not particularly common.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=427" target="_blank">00:07:07.960</a></span> | <span class="t">I was just kind of like showing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=430" target="_blank">00:07:10.320</a></span> | <span class="t">This is also how Christopher Thomas' idea tried it as well, although he didn't use dropout2d.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=434" target="_blank">00:07:14.920</a></span> | <span class="t">What's the difference between dropout2d and dropout?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=437" target="_blank">00:07:17.960</a></span> | <span class="t">So this is actually something I'd like you to do to implement yourself is an exercise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=441" target="_blank">00:07:21.640</a></span> | <span class="t">is to implement dropout2d.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=444" target="_blank">00:07:24.480</a></span> | <span class="t">The difference is that with dropout2d, rather than using x.size as our tensor of ones and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=455" target="_blank">00:07:35.400</a></span> | <span class="t">zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=456" target="_blank">00:07:36.400</a></span> | <span class="t">So in other words, potentially dropping out every single batch, every single channel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=460" target="_blank">00:07:40.400</a></span> | <span class="t">every single x, y independently, instead, we want to drop out an entire kind of grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=469" target="_blank">00:07:49.560</a></span> | <span class="t">area, all of the channels together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=473" target="_blank">00:07:53.080</a></span> | <span class="t">So if any of them are zero, then they're all zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=477" target="_blank">00:07:57.640</a></span> | <span class="t">So you can look up the docs for dropout2d for more details about exactly what that looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=483" target="_blank">00:08:03.280</a></span> | <span class="t">like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=484" target="_blank">00:08:04.280</a></span> | <span class="t">But yeah, so the exercise is to try and implement that from scratch and come up with a way to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=491" target="_blank">00:08:11.440</a></span> | <span class="t">test it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=492" target="_blank">00:08:12.640</a></span> | <span class="t">So like actually check that it's working correctly, because it's a very easy thing to think that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=497" target="_blank">00:08:17.560</a></span> | <span class="t">it's working and then realize it's not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=503" target="_blank">00:08:23.480</a></span> | <span class="t">So then yeah, Christopher Thomas actually found that if you remove this entirely and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=511" target="_blank">00:08:31.120</a></span> | <span class="t">only keep this, then you end up with a better results for 50 epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=515" target="_blank">00:08:35.920</a></span> | <span class="t">And so he's the first to break 95%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=519" target="_blank">00:08:39.000</a></span> | <span class="t">So I feel like we should insert some kind of animation or trumpet sounds or something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=527" target="_blank">00:08:47.160</a></span> | <span class="t">at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=528" target="_blank">00:08:48.160</a></span> | <span class="t">I'm not sure if I'm clever enough to do that in the video editor, but I'll see how I go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=534" target="_blank">00:08:54.880</a></span> | <span class="t">Hooray.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=535" target="_blank">00:08:55.880</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=536" target="_blank">00:08:56.880</a></span> | <span class="t">So that's about it for me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=540" target="_blank">00:09:00.400</a></span> | <span class="t">Did you guys have any other things to add about dropout, how to understand it or what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=544" target="_blank">00:09:04.320</a></span> | <span class="t">it does or interesting things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=546" target="_blank">00:09:06.080</a></span> | <span class="t">Oh, I did have one more thing before, but you go ahead if you've got anything to mention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=552" target="_blank">00:09:12.120</a></span> | <span class="t">And I was going to ask just because I think the standard is to set it like remove the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=557" target="_blank">00:09:17.280</a></span> | <span class="t">dropout before you do inference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=558" target="_blank">00:09:18.520</a></span> | <span class="t">But I was wondering if there's anyone you know of, or if it works to use it for some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=563" target="_blank">00:09:23.560</a></span> | <span class="t">sort of test time augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=565" target="_blank">00:09:25.000</a></span> | <span class="t">Oh, dude.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=566" target="_blank">00:09:26.560</a></span> | <span class="t">Thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=567" target="_blank">00:09:27.560</a></span> | <span class="t">Because I wrote a callback for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=568" target="_blank">00:09:28.800</a></span> | <span class="t">Did you see this or were you just like, okay, test time dropout callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=575" target="_blank">00:09:35.480</a></span> | <span class="t">Nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=576" target="_blank">00:09:36.440</a></span> | <span class="t">So yeah, before Epoch, if you remember in learner, we put it into training mode, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=588" target="_blank">00:09:48.200</a></span> | <span class="t">actually what it does is it puts every individual layer into training mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=593" target="_blank">00:09:53.160</a></span> | <span class="t">So that's why for the module itself, we can check whether that module is in training mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=598" target="_blank">00:09:58.800</a></span> | <span class="t">So what we can actually do is after that's happened, we can then go back in this callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=604" target="_blank">00:10:04.000</a></span> | <span class="t">and apply a lambda that says if this is a dropout, then put it in training mode all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=622" target="_blank">00:10:22.320</a></span> | <span class="t">the time, including a devaluation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=626" target="_blank">00:10:26.280</a></span> | <span class="t">And so then you can run it multiple times just like did for TTA with this callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=633" target="_blank">00:10:33.720</a></span> | <span class="t">Now that's very unlikely to give you a better result because it's not kind of showing at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=645" target="_blank">00:10:45.720</a></span> | <span class="t">different versions or anything like that, like TTA does that are kind of meant to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=651" target="_blank">00:10:51.040</a></span> | <span class="t">the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=653" target="_blank">00:10:53.120</a></span> | <span class="t">But what it does do is it gives you some a sense of how confident it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=664" target="_blank">00:11:04.400</a></span> | <span class="t">If it kind of has no idea, then that little bit of dropouts quite often going to lead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=671" target="_blank">00:11:11.000</a></span> | <span class="t">to different predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=672" target="_blank">00:11:12.920</a></span> | <span class="t">So this is a way of kind of doing some kind of confidence measure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=676" target="_blank">00:11:16.920</a></span> | <span class="t">You'd have to calibrate it by kind of looking at things that it should be confident about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=682" target="_blank">00:11:22.120</a></span> | <span class="t">and not confident about and seeing how that test time dropout changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=687" target="_blank">00:11:27.020</a></span> | <span class="t">But the basic idea, it's been used in medical models before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=695" target="_blank">00:11:35.040</a></span> | <span class="t">I wouldn't say it's totally popular, which is why I didn't even bother to show it being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=701" target="_blank">00:11:41.840</a></span> | <span class="t">used, but I just want to add it here because I think it's an interesting idea and maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=707" target="_blank">00:11:47.160</a></span> | <span class="t">could be more used than it is, or at least more studied than it has been.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=714" target="_blank">00:11:54.900</a></span> | <span class="t">A lot of stuff that gets used in the medical world is less well-known in the rest of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=720" target="_blank">00:12:00.880</a></span> | <span class="t">world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=721" target="_blank">00:12:01.880</a></span> | <span class="t">So maybe that's part of the problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=724" target="_blank">00:12:04.840</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=725" target="_blank">00:12:05.840</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=727" target="_blank">00:12:07.840</a></span> | <span class="t">So I will stop my sharing and we're going to switch to Tanish, who's going to do something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=733" target="_blank">00:12:13.880</a></span> | <span class="t">much more exciting, which is to show that we are now at a point where we can do DDPM from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=741" target="_blank">00:12:21.680</a></span> | <span class="t">scratch or at least everything except the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=746" target="_blank">00:12:26.120</a></span> | <span class="t">And so to remind you, DDPM doesn't have the latent VAE thing and we're not going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=752" target="_blank">00:12:32.720</a></span> | <span class="t">conditional, so we're not going to get to tell it what to draw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=760" target="_blank">00:12:40.000</a></span> | <span class="t">And the UNET model itself is the one bit we're not going to do today.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=766" target="_blank">00:12:46.040</a></span> | <span class="t">We're going to do that next lesson, but other than the UNET, it's going to be unconditional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=773" target="_blank">00:12:53.160</a></span> | <span class="t">DDPM from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=776" target="_blank">00:12:56.400</a></span> | <span class="t">So Tanish, take it away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=779" target="_blank">00:12:59.200</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=780" target="_blank">00:13:00.200</a></span> | <span class="t">Hi.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=781" target="_blank">00:13:01.200</a></span> | <span class="t">Welcome back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=782" target="_blank">00:13:02.200</a></span> | <span class="t">Sorry for the slight continuity problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=785" target="_blank">00:13:05.620</a></span> | <span class="t">You may notice people look a little bit different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=787" target="_blank">00:13:07.800</a></span> | <span class="t">That's because we had some Zoom issues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=789" target="_blank">00:13:09.880</a></span> | <span class="t">So we have a couple of days have passed and we're back again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=794" target="_blank">00:13:14.600</a></span> | <span class="t">And then Chavado recorded his bit before we do Tanishk's bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=798" target="_blank">00:13:18.520</a></span> | <span class="t">And then we're going to post them in backwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=800" target="_blank">00:13:20.360</a></span> | <span class="t">So hopefully there's not too many confusing continuity problems as a result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=804" target="_blank">00:13:24.640</a></span> | <span class="t">And it all goes smoothly, but it's time to turn it over to Tanishk to talk about DDPM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=810" target="_blank">00:13:30.800</a></span> | <span class="t">So we've reached the point where we have this mini AI framework and I guess it's time to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=822" target="_blank">00:13:42.760</a></span> | <span class="t">now start using it to build more, I guess, sophisticated models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=828" target="_blank">00:13:48.440</a></span> | <span class="t">And as we'll see here, we can start putting together a diffusion model from scratch using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=834" target="_blank">00:13:54.600</a></span> | <span class="t">the mini AI library, and we'll see how it makes our life a lot easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=839" target="_blank">00:13:59.040</a></span> | <span class="t">And also, it'd be very nice to see how, you know, the equations in the papers correspond</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=844" target="_blank">00:14:04.360</a></span> | <span class="t">to the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=845" target="_blank">00:14:05.420</a></span> | <span class="t">So I have here, of course, the notebook that we'll be watching from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=853" target="_blank">00:14:13.800</a></span> | <span class="t">The paper, which, you know, we have the diffusion model paper, the Doising Diffusion Probabilistic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=860" target="_blank">00:14:20.720</a></span> | <span class="t">Models, which is the paper that was published in 2020, it was one of the original diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=867" target="_blank">00:14:27.200</a></span> | <span class="t">model papers that kind of set off the entire trend of diffusion models and is a good starting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=873" target="_blank">00:14:33.720</a></span> | <span class="t">point as we delve into this topic further.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=878" target="_blank">00:14:38.200</a></span> | <span class="t">And also, I have some diagrams and drawings that I will also show later on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=885" target="_blank">00:14:45.880</a></span> | <span class="t">But yeah, basically, let's just get started with the code here, and of course, the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=893" target="_blank">00:14:53.240</a></span> | <span class="t">So just to provide some context with this paper, you know, this paper that was published</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=898" target="_blank">00:14:58.600</a></span> | <span class="t">from this group in UC Berkeley, I think a few of them have gone on now to work at Google.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=904" target="_blank">00:15:04.860</a></span> | <span class="t">And this is a big lab at UC Berkeley.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=910" target="_blank">00:15:10.500</a></span> | <span class="t">And so diffusion models were actually originally introduced in 2015.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=915" target="_blank">00:15:15.520</a></span> | <span class="t">But this paper in 2020 greatly simplified the diffusion models and made it a lot easier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=920" target="_blank">00:15:20.040</a></span> | <span class="t">to work with and, you know, got these amazing results, as you can see here, when they trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=925" target="_blank">00:15:25.000</a></span> | <span class="t">on faces and in this case, CIFAR-10, and, you know, this really was very kind of a big leap</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=934" target="_blank">00:15:34.160</a></span> | <span class="t">in terms of the progress of diffusion models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=937" target="_blank">00:15:37.960</a></span> | <span class="t">And so just to kind of briefly provide, I guess, kind of an overview.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=942" target="_blank">00:15:42.560</a></span> | <span class="t">If I could just quickly just mention something, which is, you know, when we started this course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=952" target="_blank">00:15:52.040</a></span> | <span class="t">we talked a bit about how perhaps the diffusion part of diffusion models is not actually all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=960" target="_blank">00:16:00.480</a></span> | <span class="t">that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=961" target="_blank">00:16:01.480</a></span> | <span class="t">Everybody's been talking about diffusion models, particularly because that's the open source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=965" target="_blank">00:16:05.700</a></span> | <span class="t">thing we have that works really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=967" target="_blank">00:16:07.920</a></span> | <span class="t">But this week, actually a model that appears to be quite a lot better than stable diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=975" target="_blank">00:16:15.040</a></span> | <span class="t">was released that doesn't use diffusion at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=980" target="_blank">00:16:20.320</a></span> | <span class="t">Having said that, the basic ideas, like most of the stuff that Tanishk talks about today,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=988" target="_blank">00:16:28.440</a></span> | <span class="t">will still appear in some kind of form, you know, but a lot of the details will be different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=995" target="_blank">00:16:35.160</a></span> | <span class="t">But strictly speaking, actually, I don't even know if I've got a word anymore for the kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1001" target="_blank">00:16:41.900</a></span> | <span class="t">of like modern generative model things we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1006" target="_blank">00:16:46.760</a></span> | <span class="t">So in some ways when we're talking about diffusion models, you should maybe replace it in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1011" target="_blank">00:16:51.960</a></span> | <span class="t">head with some other word, which is more general and includes this paper that Tanishk is looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1016" target="_blank">00:16:56.760</a></span> | <span class="t">at here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1017" target="_blank">00:16:57.760</a></span> | <span class="t">iterative refinement, perhaps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1018" target="_blank">00:16:58.760</a></span> | <span class="t">That's what I...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1019" target="_blank">00:16:59.760</a></span> | <span class="t">Yeah, that's not bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1020" target="_blank">00:17:00.760</a></span> | <span class="t">Iterative refinement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1021" target="_blank">00:17:01.760</a></span> | <span class="t">I'm sure by the time people watch this video, probably, you know, somebody will have decided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1026" target="_blank">00:17:06.760</a></span> | <span class="t">on something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1027" target="_blank">00:17:07.760</a></span> | <span class="t">We will keep our course website up to date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1030" target="_blank">00:17:10.920</a></span> | <span class="t">Steve?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1031" target="_blank">00:17:11.920</a></span> | <span class="t">Yeah, yeah, this is the paper that first Jeremy was talking about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1036" target="_blank">00:17:16.000</a></span> | <span class="t">And yeah, every week there seems to be another state of the art model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1041" target="_blank">00:17:21.260</a></span> | <span class="t">But yeah, like Jeremy said, a lot of the principles are the same, but you know, the details can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1045" target="_blank">00:17:25.920</a></span> | <span class="t">be different for each paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1048" target="_blank">00:17:28.200</a></span> | <span class="t">But yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1050" target="_blank">00:17:30.040</a></span> | <span class="t">And just to, I just want to again, also, like Jeremy was saying, kind of zoom back a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1054" target="_blank">00:17:34.360</a></span> | <span class="t">bit and kind of talk about a little bit about what, you know, I just kind of provide a review</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1060" target="_blank">00:17:40.680</a></span> | <span class="t">of what we're trying to do here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1062" target="_blank">00:17:42.680</a></span> | <span class="t">So let me just, yeah, so with this task, we were trying to, in this case, I would try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1074" target="_blank">00:17:54.880</a></span> | <span class="t">do image generation, of course, it could be other forms of generation like text generation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1079" target="_blank">00:17:59.240</a></span> | <span class="t">or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1081" target="_blank">00:18:01.080</a></span> | <span class="t">And the general idea is that, of course, we have some, you know, data points, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1087" target="_blank">00:18:07.360</a></span> | <span class="t">in this case, we have some images of dogs, and we want to produce more like these data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1091" target="_blank">00:18:11.160</a></span> | <span class="t">points that were given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1092" target="_blank">00:18:12.400</a></span> | <span class="t">So in this case, maybe the dog image generation or something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1097" target="_blank">00:18:17.120</a></span> | <span class="t">And so the overall idea that a lot of these approaches take for image, you know, for some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1104" target="_blank">00:18:24.000</a></span> | <span class="t">sort of generative modeling task is they have, they tried to, not over there, here, they tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1110" target="_blank">00:18:30.960</a></span> | <span class="t">to, yeah, so let me use it in a bit, P of X, which is our, which is basically the sort</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1125" target="_blank">00:18:45.160</a></span> | <span class="t">of likelihood of data point X, of X. So let's say X is some image, then P of X tells us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1141" target="_blank">00:19:01.560</a></span> | <span class="t">like, what is the probability that you would see that image in real life.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1147" target="_blank">00:19:07.320</a></span> | <span class="t">And like, if we can take like a simpler example, which may be easier to think about of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1152" target="_blank">00:19:12.760</a></span> | <span class="t">a one dimensional data point, like height, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1157" target="_blank">00:19:17.080</a></span> | <span class="t">And if we were to look at height, of course, we know like we have a data distribution that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1160" target="_blank">00:19:20.740</a></span> | <span class="t">kind of a bell curve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1162" target="_blank">00:19:22.240</a></span> | <span class="t">And, you know, you have maybe some, you know, mean height, which is like something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1167" target="_blank">00:19:27.160</a></span> | <span class="t">5'9", 5'10", yeah, I guess 5'9", 10 inches or something like that, or 5'9", whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1174" target="_blank">00:19:34.920</a></span> | <span class="t">And of course, we have some is like, you have some on more unlikely points, but that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1178" target="_blank">00:19:38.920</a></span> | <span class="t">still possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1179" target="_blank">00:19:39.920</a></span> | <span class="t">Like, for example, we have a set of feet, or where you have something that maybe not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1184" target="_blank">00:19:44.320</a></span> | <span class="t">as likely, it was just like, you know, like three feet or something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1186" target="_blank">00:19:46.960</a></span> | <span class="t">So here's my X axis is height, and the Y axis is the probability of some random person you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1193" target="_blank">00:19:53.840</a></span> | <span class="t">meet being that tall.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1196" target="_blank">00:19:56.560</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1197" target="_blank">00:19:57.760</a></span> | <span class="t">So you know, yeah, this is basically the probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1202" target="_blank">00:20:02.160</a></span> | <span class="t">And so of course, you have this sort of peak, which is where, you know, you have higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1205" target="_blank">00:20:05.760</a></span> | <span class="t">probability. And so those are the sorts of, you know, values that you would see more often.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1211" target="_blank">00:20:11.200</a></span> | <span class="t">So this is this is our what we do call our P of X. And like, the important part about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1219" target="_blank">00:20:19.360</a></span> | <span class="t">P of X is that you can use this now to sample new values, if you know what P of X is, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1225" target="_blank">00:20:25.320</a></span> | <span class="t">even if you have some sort of information about P of X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1227" target="_blank">00:20:27.480</a></span> | <span class="t">So for example, here, you can think of like, if you were to like, say, maybe have some,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1233" target="_blank">00:20:33.040</a></span> | <span class="t">let's say you have some game, and you have some human characters in the game, and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1236" target="_blank">00:20:36.600</a></span> | <span class="t">just want to randomly generate a height for this human character, you know, you could,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1242" target="_blank">00:20:42.780</a></span> | <span class="t">you wouldn't want to, of course, select a random height between three and seven, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1245" target="_blank">00:20:45.800</a></span> | <span class="t">kind of uniformly distributed, you would instead maybe want to, you would want to have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1252" target="_blank">00:20:52.960</a></span> | <span class="t">height dependent on this sort of function where you would more likely sample values,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1258" target="_blank">00:20:58.760</a></span> | <span class="t">you know, in the middle, and less likely sample the source of extreme points. So it's dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1263" target="_blank">00:21:03.760</a></span> | <span class="t">on this function to P of X. So having some information about P of X will allow you to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1269" target="_blank">00:21:09.760</a></span> | <span class="t">sample more data points. And so that's kind of the overall goal of generative modeling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1275" target="_blank">00:21:15.260</a></span> | <span class="t">is to get some information about P of X, that then allows us to sample new points and, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1282" target="_blank">00:21:22.040</a></span> | <span class="t">know, create new generations. So that's kind of a high level kind of description of what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1288" target="_blank">00:21:28.520</a></span> | <span class="t">we're trying to do when we're doing generative modeling. And of course, there are many different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1294" target="_blank">00:21:34.120</a></span> | <span class="t">approaches. We, you know, we have our famous scans, which, you know, used to be the common</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1299" target="_blank">00:21:39.800</a></span> | <span class="t">method back in the day before diffusion models, you know, we have VAEs, which I think we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1305" target="_blank">00:21:45.760</a></span> | <span class="t">probably talk a little bit more about that later as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1308" target="_blank">00:21:48.120</a></span> | <span class="t">We'll be talking about both of those techniques later here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1311" target="_blank">00:21:51.520</a></span> | <span class="t">Yeah. And so there are many different other techniques. There are also some niche techniques</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1315" target="_blank">00:21:55.320</a></span> | <span class="t">that are out there as well. But of course, now the popular one is, are these diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1320" target="_blank">00:22:00.320</a></span> | <span class="t">models? Or, you know, as we talked about, maybe a better term might be inhibitor of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1324" target="_blank">00:22:04.200</a></span> | <span class="t">refinement or whenever, you know, whatever the term ends to be. But yeah, so there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1332" target="_blank">00:22:12.160</a></span> | <span class="t">many different techniques. And yeah, so let's just, so this is kind of the general diagram</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1340" target="_blank">00:22:20.160</a></span> | <span class="t">that shows what diffusion models are. And if we can look at the paper here, which let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1346" target="_blank">00:22:26.440</a></span> | <span class="t">pull up the paper. Yeah, you see here, this is the sort of, they call it a direct directed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1351" target="_blank">00:22:31.960</a></span> | <span class="t">graphical model. It's a very complicated term. It's just kind of showing what's going on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1356" target="_blank">00:22:36.080</a></span> | <span class="t">in this, you know, in this process. And, you know, there's a lot of complicated math here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1362" target="_blank">00:22:42.680</a></span> | <span class="t">but we'll highlight some of the key variables and equations here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1368" target="_blank">00:22:48.520</a></span> | <span class="t">So basically the idea is that, okay, so let's see here. So this is like, so this is an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1374" target="_blank">00:22:54.720</a></span> | <span class="t">that we want to generate, right? And so X0 is basically, you know, these are actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1383" target="_blank">00:23:03.440</a></span> | <span class="t">the samples that we want. So we want to, X0 is what we want to generate. And, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1391" target="_blank">00:23:11.280</a></span> | <span class="t">these would be, yeah, these are images. And we start out with pure noise. So that's the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1399" target="_blank">00:23:19.440</a></span> | <span class="t">that's what, X uppercase T, pure noise. And the whole idea is that we have two processes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1410" target="_blank">00:23:30.680</a></span> | <span class="t">We have this process where we're going from pure noise to our image. And we have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1418" target="_blank">00:23:38.240</a></span> | <span class="t">process where we're going from image to pure noise. So the process where we're going from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1421" target="_blank">00:23:41.880</a></span> | <span class="t">our image to pure noise, this is called the forward process. Well, word, sorry, my typing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1430" target="_blank">00:23:50.820</a></span> | <span class="t">instead of my handwriting is not so good in it. So hopefully it's clear enough. Let me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1436" target="_blank">00:23:56.640</a></span> | <span class="t">know if it's not. So we have the forward process, which is mostly just used for our training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1442" target="_blank">00:24:02.460</a></span> | <span class="t">Then we also have our reverse process. So this is the reverse process, right up here. Reverse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1453" target="_blank">00:24:13.320</a></span> | <span class="t">process. So this is a bit of a summary, I guess, of what you and Waseem talked about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1460" target="_blank">00:24:20.840</a></span> | <span class="t">in lesson 9b. And just, it's just mostly to highlight now what, what are the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1469" target="_blank">00:24:29.520</a></span> | <span class="t">variables as we look at the, the code and see, you know, the different variables in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1475" target="_blank">00:24:35.120</a></span> | <span class="t">the code. Okay. So we'll be focusing today on the code, but the code we'll be referring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1480" target="_blank">00:24:40.360</a></span> | <span class="t">to things by name and those names won't make sense very much unless we see the, what they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1487" target="_blank">00:24:47.680</a></span> | <span class="t">used for in the math. Okay. And I will dive too much into the math. I just want to focus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1493" target="_blank">00:24:53.520</a></span> | <span class="t">on the sorts of variables and equations that we see in the code. So basically the general</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1501" target="_blank">00:25:01.200</a></span> | <span class="t">idea is that, you know, we do these in multiple different steps. You know, we have here from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1506" target="_blank">00:25:06.680</a></span> | <span class="t">time step zero all the way to time steps, time steps, uppercase T. And so there's some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1513" target="_blank">00:25:13.120</a></span> | <span class="t">fixed number of steps, but then we have this intermediate process where we're going, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1517" target="_blank">00:25:17.200</a></span> | <span class="t">know, from some particular, yeah, some particular time step. Yeah. We have this time step lower</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1526" target="_blank">00:25:26.200</a></span> | <span class="t">T steep, which is some noisy image. And, and, and yes, we're transitioning between these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1535" target="_blank">00:25:35.120</a></span> | <span class="t">two different noisy images. So we have this, what is sometimes called the transition. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1539" target="_blank">00:25:39.880</a></span> | <span class="t">have this one here. This is like sometimes called the transition kernel or yeah, whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1544" target="_blank">00:25:44.440</a></span> | <span class="t">it is, it basically is just telling us, you know, how do we go from, you know, one in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1550" target="_blank">00:25:50.120</a></span> | <span class="t">this case, we're going from a less noisy image to a more noisy image. And then going backwards</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1553" target="_blank">00:25:53.840</a></span> | <span class="t">is going from a more noisy image to a less noisy image. So let's look at the equations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1559" target="_blank">00:25:59.040</a></span> | <span class="t">So the forward direction is trivially easily to make it something more noisy. You just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1562" target="_blank">00:26:02.640</a></span> | <span class="t">add a bit more noise to it. And the reverse direction is incredibly difficult, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1567" target="_blank">00:26:07.480</a></span> | <span class="t">to particularly to go from the far left to the far right is strictly speaking impossible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1571" target="_blank">00:26:11.840</a></span> | <span class="t">because none of that person's face exists anymore. But somewhere in between, you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1578" target="_blank">00:26:18.880</a></span> | <span class="t">certainly go from something that's partially noisy to less noisy by a learned model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1586" target="_blank">00:26:26.160</a></span> | <span class="t">Exactly. And that's like what I'm going to write down right now in terms of, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1591" target="_blank">00:26:31.000</a></span> | <span class="t">in terms of, I guess, the symbols in the map. So yeah, basically, I'm just trying to pull</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1595" target="_blank">00:26:35.880</a></span> | <span class="t">out the, just to write down the equations here. So we have, let me zoom in a bit. Yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1605" target="_blank">00:26:45.040</a></span> | <span class="t">so we have our two, oops, let's see here. Two of x t, x t minus one. Or actually, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1618" target="_blank">00:26:58.880</a></span> | <span class="t">know what, maybe it's just better if I just snip. Yeah, it's a snippet from here. So the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1628" target="_blank">00:27:08.980</a></span> | <span class="t">one that is going from our, the one that is going from our forward process is this, this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1639" target="_blank">00:27:19.400</a></span> | <span class="t">this equation here. So I'll just make that a little smaller for you guys. So right there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1646" target="_blank">00:27:26.040</a></span> | <span class="t">So that is going, and basically, to explain, we have this, we have this sort of script,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1656" target="_blank">00:27:36.880</a></span> | <span class="t">a little bit of a, maybe a little bit confusing notation here. But basically, this is referring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1661" target="_blank">00:27:41.120</a></span> | <span class="t">to a normal distribution or Gaussian distribution. And instead of saying, okay, this is a Gaussian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1668" target="_blank">00:27:48.080</a></span> | <span class="t">distribution that's describing this particular variable. So it's just saying, okay, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1674" target="_blank">00:27:54.400</a></span> | <span class="t">n is our normal or Gaussian distribution, and it's representing this variable x of t,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1681" target="_blank">00:28:01.360</a></span> | <span class="t">or x, sorry, x t. And then we have here is, is the mean. And this is the variance. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1695" target="_blank">00:28:15.280</a></span> | <span class="t">just to again, clarify, I think we've talked about this before as well. But like, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1700" target="_blank">00:28:20.280</a></span> | <span class="t">this is a, you know, this is, of course, a bad drawing of a Gaussian. But, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1704" target="_blank">00:28:24.040</a></span> | <span class="t">our mean is just, our mean is just, you know, this, you know, the middle point here is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1710" target="_blank">00:28:30.680</a></span> | <span class="t">mean, and the variance just kind of describes the sort of spread of, of the Gaussian distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1717" target="_blank">00:28:37.760</a></span> | <span class="t">So if you think about this a little further, you have this beta, which is one of the important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1723" target="_blank">00:28:43.800</a></span> | <span class="t">variables that kind of describe the diffusion process, beta dot t. So you'll see the beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1731" target="_blank">00:28:51.040</a></span> | <span class="t">t in the code. And basically, beta t increases as t increases. So basically, your beta t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1742" target="_blank">00:29:02.000</a></span> | <span class="t">will be greater than your beta t minus one. So if you think about that a little bit more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1747" target="_blank">00:29:07.960</a></span> | <span class="t">carefully, you can see that, okay, so at, you know, t minus one, at this time point here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1756" target="_blank">00:29:16.560</a></span> | <span class="t">and then you're going to the next time point, you're going to increase your beta t, so increasing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1760" target="_blank">00:29:20.880</a></span> | <span class="t">the variance, but then you have this one minus beta t and take the square root of that on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1767" target="_blank">00:29:27.160</a></span> | <span class="t">and multiply it by x t minus one. So as your t is increasing, this term actually decreases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1775" target="_blank">00:29:35.300</a></span> | <span class="t">So your mean is actually decreasing, and you're getting less of the original image, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1779" target="_blank">00:29:39.880</a></span> | <span class="t">the original image is going to be part of x t minus one. So as you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1784" target="_blank">00:29:44.540</a></span> | <span class="t">And just to let you know, just like, you know, we, we can't see your pointer. So if you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1792" target="_blank">00:29:52.160</a></span> | <span class="t">to point at things, you would need to highlight them or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1796" target="_blank">00:29:56.080</a></span> | <span class="t">Yeah, so yeah, I'll just, let's see. Yeah. Or yeah, basically, I mean, I don't particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1805" target="_blank">00:30:05.080</a></span> | <span class="t">play anything in specific, I was just saying that, yeah, basically, if we have our, our,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1811" target="_blank">00:30:11.360</a></span> | <span class="t">our x of t here, as, as the time step increases, you know, you're getting less contribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1817" target="_blank">00:30:17.800</a></span> | <span class="t">from your x of x t minus one. And so that means your mean is going towards zero. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1824" target="_blank">00:30:24.240</a></span> | <span class="t">so you've got to have a mean of zero, and, you know, the variance keeps increasing, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1828" target="_blank">00:30:28.240</a></span> | <span class="t">basically, you just have a Gaussian distribution and you lose any contribution from the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1832" target="_blank">00:30:32.520</a></span> | <span class="t">image as your time step increases. So that's why when we start out from x of zero and go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1838" target="_blank">00:30:38.160</a></span> | <span class="t">all the way to our x of t here, this becomes pure noise, it's because we're doing this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1843" target="_blank">00:30:43.600</a></span> | <span class="t">iterative process where we keep adding noise, we lose that contribution from the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1847" target="_blank">00:30:47.240</a></span> | <span class="t">image, and, and, you know, that that leads to, that leads to the image having pure noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1854" target="_blank">00:30:54.960</a></span> | <span class="t">at the end of the process. So just something I find useful here is to consider one extreme,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1863" target="_blank">00:31:03.800</a></span> | <span class="t">which is that is to consider x one. So at x one, the mean is going to be one minus beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1873" target="_blank">00:31:13.560</a></span> | <span class="t">t times x naught. And the reason that's interesting is x naught is the original image. So we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1879" target="_blank">00:31:19.160</a></span> | <span class="t">taking the original image. And at this point, one minus beta t will be pretty close to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1888" target="_blank">00:31:28.240</a></span> | <span class="t">So at x one, we're going to have something that's the mean is very close to the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1894" target="_blank">00:31:34.280</a></span> | <span class="t">And the variance will be very small. And so that's why we will have a image that just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1899" target="_blank">00:31:39.600</a></span> | <span class="t">has a tiny bit of noise. Right, right. And then another thing that sometimes is easier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1906" target="_blank">00:31:46.120</a></span> | <span class="t">to write out is sometimes you can write out, in this case, you can write out q of x t directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1916" target="_blank">00:31:56.160</a></span> | <span class="t">Because these are all independent in terms of like, q of x t is only dependent of x t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1921" target="_blank">00:32:01.880</a></span> | <span class="t">minus one, and then x t minus one is only dependent on x t minus two. And you can you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1926" target="_blank">00:32:06.560</a></span> | <span class="t">can use this independent, each of these steps are independent. So based on the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1931" target="_blank">00:32:11.920</a></span> | <span class="t">laws of probability, you can get your q above x t in close form. So yeah, that's what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1939" target="_blank">00:32:19.000</a></span> | <span class="t">shown here. q of x t did it the original image. So this is also another way of kind of seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1944" target="_blank">00:32:24.360</a></span> | <span class="t">this more clearly where you can see you can see that. Anyways, some going back here. Yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1954" target="_blank">00:32:34.760</a></span> | <span class="t">so this is another way to see here more directly. So this is, of course, our clean image. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1965" target="_blank">00:32:45.280</a></span> | <span class="t">this is our clear, our noisy image. And so you can also see again, now, alpha bar t is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1979" target="_blank">00:32:59.160</a></span> | <span class="t">dependent on beta t, basically, it's like one minus like the cumulative. This is I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1987" target="_blank">00:33:07.600</a></span> | <span class="t">we'll see the card for it, I guess. So maybe, yes, yes. So it might be clear to see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1992" target="_blank">00:33:12.600</a></span> | <span class="t">this is alpha bar t or something like this. But basically, basically, the idea is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=1997" target="_blank">00:33:17.360</a></span> | <span class="t">alpha bar t, alpha bar t is going to be, again, less, this is what is going to be less than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2007" target="_blank">00:33:27.520</a></span> | <span class="t">alpha bar t minus one. So basically, alpha, this keeps decreasing, right? This decreases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2014" target="_blank">00:33:34.400</a></span> | <span class="t">as as time step increases. And on the other hand, this is going to be increasing as time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2019" target="_blank">00:33:39.380</a></span> | <span class="t">step increases. So again, you can see the contribution from the original image decreases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2025" target="_blank">00:33:45.080</a></span> | <span class="t">as time step increases, while the noise, you know, as shown by the variance is increasing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2030" target="_blank">00:33:50.280</a></span> | <span class="t">while, you know, the time step is increased. Anyway, so that hopefully clap eyes that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2035" target="_blank">00:33:55.800</a></span> | <span class="t">forward process and then the reverse process is basically a neural network, as we as Jeremy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2042" target="_blank">00:34:02.600</a></span> | <span class="t">had mentioned. And yeah, this is a screenshot this, that's he's this. That's yes, this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2056" target="_blank">00:34:16.760</a></span> | <span class="t">our this is our reverse process. And basically, the idea is, well, this is a neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2063" target="_blank">00:34:23.340</a></span> | <span class="t">And this is also a neural network, a neural network. And we learned during the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2071" target="_blank">00:34:31.660</a></span> | <span class="t">of the model. But the the nice thing about this particular diffusion model paper that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2077" target="_blank">00:34:37.560</a></span> | <span class="t">made it so simple was actually, we completely ignored this and actually said to our instance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2085" target="_blank">00:34:45.360</a></span> | <span class="t">just based on, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2087" target="_blank">00:34:47.400</a></span> | <span class="t">We can't say what you're pointing at. So I think it's important to mention what this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2090" target="_blank">00:34:50.560</a></span> | <span class="t">is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2091" target="_blank">00:34:51.560</a></span> | <span class="t">This term here. So this one, we just kind of ignore and it's just a constant dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2104" target="_blank">00:35:04.680</a></span> | <span class="t">on beta t. So you only have one neural network that you need to train, which is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2111" target="_blank">00:35:11.800</a></span> | <span class="t">referring to this mean. And when the nice thing about this decision model process is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2119" target="_blank">00:35:19.040</a></span> | <span class="t">that it also meet power prices mean into this easier form, where you do a lot of complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2126" target="_blank">00:35:26.800</a></span> | <span class="t">math, which will not get into here. But basically, you get this kind of simplified training objective</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2134" target="_blank">00:35:34.600</a></span> | <span class="t">where see here. Yeah, you see the simplified training objective, you instead have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2143" target="_blank">00:35:43.080</a></span> | <span class="t">epsilon beta function. And let me just screenshot that again, screenshot. This is our loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2153" target="_blank">00:35:53.920</a></span> | <span class="t">that we train and we have this epsilon beta function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2160" target="_blank">00:36:00.200</a></span> | <span class="t">You could see it's a very simple loss function, right? This is just a, you can just write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2165" target="_blank">00:36:05.280</a></span> | <span class="t">this down. This is just an MSC loss. And we have this epsilon beta function here. That</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2171" target="_blank">00:36:11.800</a></span> | <span class="t">is our... I mean, to folks like me here are less mathy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2174" target="_blank">00:36:14.440</a></span> | <span class="t">It might not be obvious that it's a simple thing because it looks quite complicated to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2177" target="_blank">00:36:17.800</a></span> | <span class="t">me, but once we see it in code, it'll be simple. Yes, yes. Basically, you're just doing like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2185" target="_blank">00:36:25.040</a></span> | <span class="t">an... Yeah, you'll see an encode how simple it is. But this is like just an MSC loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2190" target="_blank">00:36:30.440</a></span> | <span class="t">So we've seen MSC loss before, but you'll see how... Yeah, this is basically MSC. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2195" target="_blank">00:36:35.560</a></span> | <span class="t">the nice... So just to kind of take a step back again, what is this epsilon theta? Because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2201" target="_blank">00:36:41.160</a></span> | <span class="t">this is like a new thing that seems a little bit confusing. Basically, epsilon... You can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2208" target="_blank">00:36:48.280</a></span> | <span class="t">see here, basically... Yeah, absolutely. This here is saying... This is actually equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2218" target="_blank">00:36:58.800</a></span> | <span class="t">to this equation here. These two are equivalent. This is just another way of saying that because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2225" target="_blank">00:37:05.200</a></span> | <span class="t">basically it's saying that's X of t. So this is giving X of t just in a different way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2233" target="_blank">00:37:13.680</a></span> | <span class="t">But epsilon is actually this normal distribution with a mean of zero and a variance of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2244" target="_blank">00:37:24.520</a></span> | <span class="t">And then you have all these scaling terms that changes the mean to be the same as this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2250" target="_blank">00:37:30.040</a></span> | <span class="t">equation that we have over here. So this is our X of t. And so what epsilon is, it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2258" target="_blank">00:37:38.480</a></span> | <span class="t">the noise that we're adding to our image to make it into a noisy image. And what this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2263" target="_blank">00:37:43.840</a></span> | <span class="t">neural network is doing is trying to predict that noise. So what this is actually doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2269" target="_blank">00:37:49.600</a></span> | <span class="t">is this is actually a noise predictor. And it is predicting the noise in the image. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2279" target="_blank">00:37:59.400</a></span> | <span class="t">why is that important? Basically, the general idea is if we were to think about our distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2291" target="_blank">00:38:11.460</a></span> | <span class="t">of data, let's just think about it in a 2D space. Just here, each data point here represents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2301" target="_blank">00:38:21.840</a></span> | <span class="t">an image. And they're in this blob area, which represents a distribution. So this is in distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2316" target="_blank">00:38:36.080</a></span> | <span class="t">And this is out of the distribution. Out of distribution. And basically, the idea is that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2327" target="_blank">00:38:47.640</a></span> | <span class="t">OK, if we take an image and we want to generate some random image, if we were to take a random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2336" target="_blank">00:38:56.040</a></span> | <span class="t">data point, it would most likely be noisy images. So if we take some random data point,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2343" target="_blank">00:39:03.240</a></span> | <span class="t">the way to generate a random data point, it's going to be just noise. But we want to keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2348" target="_blank">00:39:08.880</a></span> | <span class="t">adjusting this data point to make it look more like an image from your distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2354" target="_blank">00:39:14.040</a></span> | <span class="t">That's the whole idea of this iterative process that we're doing in our diffusion model. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2358" target="_blank">00:39:18.800</a></span> | <span class="t">the way to get that information is actually to take images from your data set and actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2366" target="_blank">00:39:26.660</a></span> | <span class="t">add noise to it. So that's what we try to do in this process. So we have an image here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2372" target="_blank">00:39:32.280</a></span> | <span class="t">and we add noise to it. And then what we do is we try to plan a neural network to predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2377" target="_blank">00:39:37.440</a></span> | <span class="t">the noise. And by predicting the noise and subtracting it out, we're going back to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2382" target="_blank">00:39:42.240</a></span> | <span class="t">distribution. So adding the noise takes you away from the distribution, and then predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2387" target="_blank">00:39:47.020</a></span> | <span class="t">the noise brings you back to distribution. So then if we know at any given point in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2394" target="_blank">00:39:54.440</a></span> | <span class="t">space how much noise to remove, that tells you how to keep going towards the data distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2404" target="_blank">00:40:04.160</a></span> | <span class="t">and get a point that lies within the distribution. So that's why we have noise prediction, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2410" target="_blank">00:40:10.560</a></span> | <span class="t">that's the importance of doing this noise prediction is to be able to then do this iterative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2415" target="_blank">00:40:15.260</a></span> | <span class="t">process where we can start out at a random point, which would be, for example, pure noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2420" target="_blank">00:40:20.080</a></span> | <span class="t">and keep predicting and removing that noise and walking towards the data distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2426" target="_blank">00:40:26.000</a></span> | <span class="t">Okay. Okay. So yeah, let's get started with the code. And so here, we of course have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2435" target="_blank">00:40:35.480</a></span> | <span class="t">imports, and we're going to load our dataset. We're going to work with our fashion amnesty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2443" target="_blank">00:40:43.400</a></span> | <span class="t">set, which is what we've been working with for a while already. And yeah, this is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2451" target="_blank">00:40:51.160</a></span> | <span class="t">basically similar code that we've seen from before in terms of loading the dataset. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2457" target="_blank">00:40:57.920</a></span> | <span class="t">then we have our model. So we remove the noise from the image. So what our model is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2462" target="_blank">00:41:02.660</a></span> | <span class="t">to take in is it's going to take in the previous image, the noisy image, and predict the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2470" target="_blank">00:41:10.520</a></span> | <span class="t">So the shapes of the input and the output are the same. They're going to be in the shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2474" target="_blank">00:41:14.800</a></span> | <span class="t">of an image. So what we use is we use a unit neural network, which takes in kind of an input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2482" target="_blank">00:41:22.840</a></span> | <span class="t">image. And we do see your pointer now, by the way, so feel free to point at things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2487" target="_blank">00:41:27.680</a></span> | <span class="t">Yeah. So yeah, it takes an input image. And in this case, a unit is for purpose, but they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2498" target="_blank">00:41:38.640</a></span> | <span class="t">can also be used for any sort of image-to-image path, where we're going from an input image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2503" target="_blank">00:41:43.920</a></span> | <span class="t">and then outputting some other image of some sort.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2508" target="_blank">00:41:48.000</a></span> | <span class="t">And we'll talk about a new architecture, which we haven't learned about yet, and we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2511" target="_blank">00:41:51.760</a></span> | <span class="t">be learning about in the next lesson. But broadly speaking, those gray arrows going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2518" target="_blank">00:41:58.880</a></span> | <span class="t">from left to right are very much like ResNet skip connections, but they're being used in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2527" target="_blank">00:42:07.840</a></span> | <span class="t">a different way. Everything else is stuff that we've seen before. So basically, we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2536" target="_blank">00:42:16.360</a></span> | <span class="t">pretend that those don't exist for now. It's a neural network that the output is the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2545" target="_blank">00:42:25.280</a></span> | <span class="t">size or a similar size to the input, and therefore you can use it to learn how to go from one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2552" target="_blank">00:42:32.320</a></span> | <span class="t">image to a different image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2554" target="_blank">00:42:34.880</a></span> | <span class="t">Yeah. So that's where the unit is. And yeah, like Jefferson said, we'll talk about it more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2565" target="_blank">00:42:45.280</a></span> | <span class="t">The sort of units that are used for diffusion models also tend to have some additional tricks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2570" target="_blank">00:42:50.520</a></span> | <span class="t">which again, we'll talk about them later on as well. But yeah, for the time being, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2577" target="_blank">00:42:57.080</a></span> | <span class="t">will just import a unit from the Diffusers library, which is the Hagen-Feiss library for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2585" target="_blank">00:43:05.740</a></span> | <span class="t">diffusion models. So they have a unit implementation, and we'll just be using that for now. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2593" target="_blank">00:43:13.120</a></span> | <span class="t">so, yeah, of course, strictly speaking, we're cheating at this point because we're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2597" target="_blank">00:43:17.560</a></span> | <span class="t">something we haven't written from scratch, but we're only cheating temporarily because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2601" target="_blank">00:43:21.480</a></span> | <span class="t">we will be writing it from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2604" target="_blank">00:43:24.360</a></span> | <span class="t">Yeah. And yeah, so and then of course, we're working with one channel images or fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2610" target="_blank">00:43:30.720</a></span> | <span class="t">MNIST images or one channel images. So we just have to specify that. And then of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2615" target="_blank">00:43:35.880</a></span> | <span class="t">the channels of the different blocks within the unit are also specified. And then let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2622" target="_blank">00:43:42.240</a></span> | <span class="t">go into the training process. So basically, the general idea of course, is we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2632" target="_blank">00:43:52.200</a></span> | <span class="t">train with this MSE loss. What we do is we select a random time step, and then we add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2640" target="_blank">00:44:00.880</a></span> | <span class="t">noise to our image based on that time step. So of course, if we have a very high time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2646" target="_blank">00:44:06.480</a></span> | <span class="t">step, we're adding a lot of noise. If we have a lower time step, then we're adding very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2654" target="_blank">00:44:14.840</a></span> | <span class="t">little noise. So we're going to randomly choose a time step. And then yeah, we add the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2662" target="_blank">00:44:22.120</a></span> | <span class="t">accordingly to the image. And then we pass the noisy image to a model as well as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2668" target="_blank">00:44:28.400</a></span> | <span class="t">time step. And we are trying to predict the amount of noise that was in the image. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2674" target="_blank">00:44:34.960</a></span> | <span class="t">we predicted with the MSE loss. So we can see all the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2677" target="_blank">00:44:37.440</a></span> | <span class="t">I have some pictures of some of these variables I could share if that would be useful. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2686" target="_blank">00:44:46.440</a></span> | <span class="t">I have a version. So I think Tanishka is sharing notebook number 15. Is that right? And I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2692" target="_blank">00:44:52.320</a></span> | <span class="t">got here notebook number 17. And so I talked to Tanishka's notebook and just as I was starting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2698" target="_blank">00:44:58.000</a></span> | <span class="t">to understand it, I'd like to draw pictures for myself to understand what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2702" target="_blank">00:45:02.720</a></span> | <span class="t">So I talked to things which are in Tanishka's class and just put them into a cell. So I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2710" target="_blank">00:45:10.960</a></span> | <span class="t">just copied and pasted them, although I replaced the Greek letters with English written out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2717" target="_blank">00:45:17.680</a></span> | <span class="t">versions. And then I just plotted them to see what they look like. So in Tanishka's class,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2724" target="_blank">00:45:24.680</a></span> | <span class="t">he has this thing called beta, which is just lin space. So that's just literally a line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2733" target="_blank">00:45:33.120</a></span> | <span class="t">So beta, there's going to be 1,000 of them. And they're just going to be equally spaced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2737" target="_blank">00:45:37.960</a></span> | <span class="t">from 0.001 to 0.02. And then there's something called sigma, which is the square root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2750" target="_blank">00:45:50.360</a></span> | <span class="t">that. So that's what sigma is going to look like. And then he's also got alpha bar, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2760" target="_blank">00:46:00.640</a></span> | <span class="t">is a cumulative product of 1 minus this. And there's what alpha bar looks like. So you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2770" target="_blank">00:46:10.160</a></span> | <span class="t">can see here, as Tanishka was describing earlier, that when T is higher, this is T on the x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2779" target="_blank">00:46:19.600</a></span> | <span class="t">axis, beta is higher. And when T is higher, alpha bar is lower. So yeah, so if you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2790" target="_blank">00:46:30.840</a></span> | <span class="t">to remind yourself, so each of these things, beta, sigma, alpha bar, they're each got 1,000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2800" target="_blank">00:46:40.400</a></span> | <span class="t">things in them. And this is the shape of those 1,000 things. So this is the amount of variance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2811" target="_blank">00:46:51.120</a></span> | <span class="t">I guess, added at each step. This is the square root of that. So it's the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2817" target="_blank">00:46:57.760</a></span> | <span class="t">added at each step. And then if we do 1 minus that, it's just the exact opposite. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2827" target="_blank">00:47:07.880</a></span> | <span class="t">this is what happens if you multiply them all together up to that point. And the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2830" target="_blank">00:47:10.840</a></span> | <span class="t">you do that is because if you add noise to something, you add noise to something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2835" target="_blank">00:47:15.120</a></span> | <span class="t">you add noise to something that you add noise to something, then you have to multiply together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2838" target="_blank">00:47:18.120</a></span> | <span class="t">all that amount of noise to say how much noise you would get. So yeah, those are my pictures,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2843" target="_blank">00:47:23.880</a></span> | <span class="t">if that's helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2846" target="_blank">00:47:26.080</a></span> | <span class="t">Yep, good to see the diagram or see how the actual values and how it changes over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2855" target="_blank">00:47:35.600</a></span> | <span class="t">So yeah, let's see here, sorry. Yeah, so like Jeremy was showing, we have our lint space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2864" target="_blank">00:47:44.280</a></span> | <span class="t">for our beta. In this case, we're using kind of more of the Greek letters. So you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2869" target="_blank">00:47:49.720</a></span> | <span class="t">the Greek letters that we see in the paper as well as now we have it here in the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2874" target="_blank">00:47:54.720</a></span> | <span class="t">as well. And we have our lint space from our minimum value to our maximum value. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2881" target="_blank">00:48:01.080</a></span> | <span class="t">have some number of steps. So this is the number of time steps. So here, we use a thousand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2886" target="_blank">00:48:06.880</a></span> | <span class="t">time steps, but that can depend on the type of model that you're training. And that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2891" target="_blank">00:48:11.720</a></span> | <span class="t">one of the parameters of your model or high parameters of your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2896" target="_blank">00:48:16.280</a></span> | <span class="t">And this is the callback you've got here. So this callback is going to be used to set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2904" target="_blank">00:48:24.720</a></span> | <span class="t">up the data, I guess, so that you're going to be using this to add the noise so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2910" target="_blank">00:48:30.760</a></span> | <span class="t">the models then got the data that we're trying to get it to learn to then denoise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2917" target="_blank">00:48:37.600</a></span> | <span class="t">Yeah, so the callback, of course, makes life a lot easier in terms of, yeah, setting up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2925" target="_blank">00:48:45.560</a></span> | <span class="t">everything and still being able to use, I guess, the mini AI learner with maybe some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2931" target="_blank">00:48:51.560</a></span> | <span class="t">of these more complicated and maybe a little bit more unique training loops. So yeah, in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2938" target="_blank">00:48:58.240</a></span> | <span class="t">this case, we're just able to use the callback in order to set up the data, the data, I guess,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2948" target="_blank">00:49:08.600</a></span> | <span class="t">the batch that we are passing into our learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2951" target="_blank">00:49:11.520</a></span> | <span class="t">I just wanted to mention, when you first did this, you wrote out the Greek letters in English,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2959" target="_blank">00:49:19.600</a></span> | <span class="t">alpha and beta and so forth. And at least for my brain, I was finding it difficult to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2965" target="_blank">00:49:25.760</a></span> | <span class="t">read because they were literally going off the edge of the page and I couldn't see it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2969" target="_blank">00:49:29.840</a></span> | <span class="t">all at once. And so we did a search in a place to replace it with the actual Greek letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2976" target="_blank">00:49:36.520</a></span> | <span class="t">I still don't know how I feel about it. I'm finding it easier to read because I can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2983" target="_blank">00:49:43.600</a></span> | <span class="t">it all at once and it was a scroll and I don't get it as overwhelmed. But when I need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2989" target="_blank">00:49:49.960</a></span> | <span class="t">edit the code, I kind of just tend to copy and paste the Greek letters, which is why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=2996" target="_blank">00:49:56.300</a></span> | <span class="t">we use the actual word beta in the init parameter list so that somebody using this never has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3003" target="_blank">00:50:03.520</a></span> | <span class="t">to type a Greek letter. But I don't know, Johnno or Tanishka, if you had any thoughts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3009" target="_blank">00:50:09.080</a></span> | <span class="t">over the last week or two since we made that change about whether you guys like having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3013" target="_blank">00:50:13.360</a></span> | <span class="t">the Greek letters in there or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3018" target="_blank">00:50:18.160</a></span> | <span class="t">I like it for this demo in particular. I don't know that I do this in my code, but because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3022" target="_blank">00:50:22.400</a></span> | <span class="t">we're looking back and forth between the paper and the implementation year, I think it works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3027" target="_blank">00:50:27.200</a></span> | <span class="t">in this case just fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3029" target="_blank">00:50:29.520</a></span> | <span class="t">Yeah, I agree. I think it's good for like, yeah, when you're trying to study something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3035" target="_blank">00:50:35.800</a></span> | <span class="t">or trying to implement something, having the Greek letters is very useful to be able to,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3041" target="_blank">00:50:41.560</a></span> | <span class="t">I guess, match the math more closely and it's just easy just to do it. Take the equation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3047" target="_blank">00:50:47.640</a></span> | <span class="t">and put it into code or, you know, white-swear style looking at the code and try to match</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3052" target="_blank">00:50:52.000</a></span> | <span class="t">to the equation. So I think for like, yeah, educational purpose, I tend to like, I guess,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3058" target="_blank">00:50:58.480</a></span> | <span class="t">the Greek letters. So yeah, so, you know, we have our initialization, but we're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3068" target="_blank">00:51:08.640</a></span> | <span class="t">defining all these variables. We'll get to the predict in just a moment. But first, I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3075" target="_blank">00:51:15.200</a></span> | <span class="t">just want to go over the before batch, where we're ever setting up our batch to pass into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3083" target="_blank">00:51:23.200</a></span> | <span class="t">the model. So remember that the model is taking in our noisy image and the time step. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3092" target="_blank">00:51:32.840</a></span> | <span class="t">of course the target is the actual amount of noise that we are adding to the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3099" target="_blank">00:51:39.640</a></span> | <span class="t">So basically, we generate that noise. So that's what... epsilon is that target. So epsilon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3105" target="_blank">00:51:45.920</a></span> | <span class="t">is the amount of noise, not the amount of, is the actual noise. Yes, epsilon is the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3111" target="_blank">00:51:51.560</a></span> | <span class="t">noise that we're adding. And that's the target as well, because our model is a noise-predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3116" target="_blank">00:51:56.880</a></span> | <span class="t">model. It's predicting the noise in the image. And so our target should be the noise that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3123" target="_blank">00:52:03.320</a></span> | <span class="t">we're adding to the image during training. So we have our epsilon on and we're generating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3128" target="_blank">00:52:08.700</a></span> | <span class="t">it with this random function. It's the random normal distribution with a mean of zero, variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3135" target="_blank">00:52:15.320</a></span> | <span class="t">of one. So that's what that's doing and adding the appropriate shape and device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3141" target="_blank">00:52:21.200</a></span> | <span class="t">Then the batch that we get originally will contain the clean images. These are the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3150" target="_blank">00:52:30.200</a></span> | <span class="t">images from our dataset. So that's x0. And then what we want to do is we want to add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3156" target="_blank">00:52:36.400</a></span> | <span class="t">noise. So we have our alpha bar and we have a random time step that we select. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3163" target="_blank">00:52:43.280</a></span> | <span class="t">we just simply follow that equation, which again, I'll just show in just a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3167" target="_blank">00:52:47.880</a></span> | <span class="t">That equation, you can make a tiny bit easier to read, I think. If you were to double-click</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3171" target="_blank">00:52:51.480</a></span> | <span class="t">on that first alpha bar underscore t, cut it and then paste it, sorry, in the xt equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3177" target="_blank">00:52:57.840</a></span> | <span class="t">torch dot square root, take the thing inside the square root, double-click it and paste</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3183" target="_blank">00:53:03.200</a></span> | <span class="t">it over the top of the word torch. That would be a little bit easier to read, I think. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3193" target="_blank">00:53:13.560</a></span> | <span class="t">then you'll do the same for the next one. There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3204" target="_blank">00:53:24.560</a></span> | <span class="t">Yeah, so basically, yeah, so yeah, I guess let's just pull up the equation. So let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3217" target="_blank">00:53:37.400</a></span> | <span class="t">see. There's a section in the paper that has the nice algorithm. Let's see if I can find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3224" target="_blank">00:53:44.520</a></span> | <span class="t">it. No, here. I think earlier. Yes, string. Right, so we're just following the same sort</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3234" target="_blank">00:53:54.360</a></span> | <span class="t">of training steps here, right? We select a clean image that we take from our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3241" target="_blank">00:54:01.560</a></span> | <span class="t">This fancy kind of equation here is just saying take an image from your data set, take a random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3248" target="_blank">00:54:08.380</a></span> | <span class="t">time step between this range. Then this is our epsilon that we're getting, just to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3255" target="_blank">00:54:15.120</a></span> | <span class="t">get some epsilon value. And then we have our equation for x of t, right? This is the equation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3262" target="_blank">00:54:22.360</a></span> | <span class="t">here. You can see that square root of alpha bar t x0 plus square root of 1 minus alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3267" target="_blank">00:54:27.840</a></span> | <span class="t">bar t times epsilon. So that's the same equation that we have right here, right? And then what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3274" target="_blank">00:54:34.520</a></span> | <span class="t">we need to do is we need to pass this into our model. So we have x t and t. So we set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3280" target="_blank">00:54:40.200</a></span> | <span class="t">up our batch accordingly. So this is the two things that we pass into our model. And of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3285" target="_blank">00:54:45.200</a></span> | <span class="t">course, we also have our target, which is our epsilon. And so that's what this is showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3289" target="_blank">00:54:49.160</a></span> | <span class="t">here. We pass in our x of t as well as our t here, right? And we pass that into a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3296" target="_blank">00:54:56.280</a></span> | <span class="t">The model is represented here as epsilon theta. And theta is often used to represent like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3301" target="_blank">00:55:01.120</a></span> | <span class="t">this is a neural network with some parameters and the parameters are represented by theta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3305" target="_blank">00:55:05.520</a></span> | <span class="t">So epsilon theta is just representing our noise predicting model. So this is our neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3309" target="_blank">00:55:09.400</a></span> | <span class="t">network. So we have passed in our x of t and our t into a neural network. And we are comparing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3315" target="_blank">00:55:15.040</a></span> | <span class="t">it to our target here, which is the actual epsilon. And so that's what we're doing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3320" target="_blank">00:55:20.820</a></span> | <span class="t">We have our batch where we have our x of t and t and epsilon. And then here we have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3328" target="_blank">00:55:28.100</a></span> | <span class="t">prediction function. And because we actually have, I guess, in this case, we have two things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3333" target="_blank">00:55:33.640</a></span> | <span class="t">that are in a tuple that we need to pass into our model. So we just kind of get those elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3340" target="_blank">00:55:40.620</a></span> | <span class="t">from our tuple with this. Yeah, we get the elements from the tuple, pass it into the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3345" target="_blank">00:55:45.720</a></span> | <span class="t">model, and then hugging face has its own API in terms of getting the output. So you need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3351" target="_blank">00:55:51.360</a></span> | <span class="t">to call dot sample in order to get the predictions from your model. So we just do that. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3357" target="_blank">00:55:57.360</a></span> | <span class="t">we do, yeah, we have learned dot preds. And that's what's going to be used later than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3362" target="_blank">00:56:02.920</a></span> | <span class="t">when we're trying to do our loss function calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3365" target="_blank">00:56:05.880</a></span> | <span class="t">So, I mean, it's just worth looking at that a little bit more since we haven't quite seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3371" target="_blank">00:56:11.440</a></span> | <span class="t">something like this before. And it's something which I'm not aware of any other framework</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3375" target="_blank">00:56:15.760</a></span> | <span class="t">that would let you do this. Literally replace how prediction works. And many AIs kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3381" target="_blank">00:56:21.800</a></span> | <span class="t">really fun for this. So because you're inherited from TrainedCB, TrainedCB has predict, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3388" target="_blank">00:56:28.320</a></span> | <span class="t">ought to find, and you have to find a new version. So it's not going to use the TrainedCB version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3393" target="_blank">00:56:33.240</a></span> | <span class="t">anymore. It's going to use your version. And what you're doing is instead of passing learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3400" target="_blank">00:56:40.320</a></span> | <span class="t">dot batch zero to the model, you've got a star in front of it. So the key thing is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3406" target="_blank">00:56:46.720</a></span> | <span class="t">star is going to, and we know actually learned dot batch zero has two things in it because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3412" target="_blank">00:56:52.680</a></span> | <span class="t">that learned dot batch that you showed at the end of the before batch method has two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3416" target="_blank">00:56:56.920</a></span> | <span class="t">things in learned dot zero. So that star will unpack them and send each one of those as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3422" target="_blank">00:57:02.680</a></span> | <span class="t">a separate argument. So our model needs to take two things, which the diffusers unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3428" target="_blank">00:57:08.820</a></span> | <span class="t">does take two things. So that's the main interesting point. And then something I find a bit awkward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3435" target="_blank">00:57:15.280</a></span> | <span class="t">honestly about a lot of HackingFace stuff including diffusers is that generally their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3442" target="_blank">00:57:22.280</a></span> | <span class="t">models don't just return the result, but they put it inside some name. And so that's what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3447" target="_blank">00:57:27.960</a></span> | <span class="t">happens here. They put it inside something called sample. So that's why Tanishk added</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3453" target="_blank">00:57:33.360</a></span> | <span class="t">dot sample at the end of the predict because of this somewhat awkward thing, which HackingFace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3460" target="_blank">00:57:40.320</a></span> | <span class="t">like to do for some reason. But yeah, now that you know, I mean, this is something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3464" target="_blank">00:57:44.920</a></span> | <span class="t">people often get stuck on. I see on Kaggle and stuff like that. It's like, how on earth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3470" target="_blank">00:57:50.080</a></span> | <span class="t">do I use these models? Because they take things in weird forms and they give back things with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3474" target="_blank">00:57:54.360</a></span> | <span class="t">weird forms. Well, this is hell, you know, if you inherit from TranCB, you can change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3481" target="_blank">00:58:01.000</a></span> | <span class="t">predict to do whatever you want, which I think is quite sweet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3487" target="_blank">00:58:07.120</a></span> | <span class="t">Yep. So yeah, that's the training loop. And then of course you have your regular training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3494" target="_blank">00:58:14.840</a></span> | <span class="t">loop that's implemented in many AI where you are going to have, yeah, you have your loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3501" target="_blank">00:58:21.400</a></span> | <span class="t">function calculation. I mean, at the predictions, learn.preds, and of course the target is our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3511" target="_blank">00:58:31.400</a></span> | <span class="t">learn.batch1, which is our epsilon. So, you know, we have those and we pass it into the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3517" target="_blank">00:58:37.880</a></span> | <span class="t">loss function. It calculates the loss function and does the back propagation. So I'll just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3522" target="_blank">00:58:42.480</a></span> | <span class="t">go over that. We'll get back to the sampling in just a moment. But just to show the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3529" target="_blank">00:58:49.520</a></span> | <span class="t">loop. So most of this is copied from our, I think it's 14 augment notebook. The way you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3538" target="_blank">00:58:58.880</a></span> | <span class="t">got the Tmax and the shed. The only thing I think you've added here is the DDPM callback,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3546" target="_blank">00:59:06.480</a></span> | <span class="t">right? Yes. The DDPM callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3549" target="_blank">00:59:09.200</a></span> | <span class="t">And the transient loss function. Yes. So basically we have to initialize our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3554" target="_blank">00:59:14.560</a></span> | <span class="t">DDPM callback with the appropriate arguments. So like the number of time steps and the minimum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3561" target="_blank">00:59:21.840</a></span> | <span class="t">beta and maximum beta. And then of course we're using an MSC loss as we talked about. It just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3572" target="_blank">00:59:32.480</a></span> | <span class="t">becomes a regular training loop. And everything else is from before. Yeah. We have your scheduler,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3579" target="_blank">00:59:39.840</a></span> | <span class="t">your progress bar, all of that we've seen before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3582" target="_blank">00:59:42.240</a></span> | <span class="t">I think that's really cool that we're using basically the same code to train a diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3586" target="_blank">00:59:46.880</a></span> | <span class="t">model as we've used to train a classifier just with, yeah, an extra callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3591" target="_blank">00:59:51.840</a></span> | <span class="t">Yeah. Yeah. Yeah. So I think callbacks are very powerful for being, you know, for allowing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3597" target="_blank">00:59:57.720</a></span> | <span class="t">us to do such things. It's like pretty, you can take all this code and now we have a diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3605" target="_blank">01:00:05.080</a></span> | <span class="t">training loop and we can just call it lower.fit. And yeah, you can see got a nice training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3611" target="_blank">01:00:11.720</a></span> | <span class="t">loop, nice loss curve. We can save our model. Saving functionality to be able to save our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3619" target="_blank">01:00:19.880</a></span> | <span class="t">model and we could load it in. But now that we have our trained model, then the question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3625" target="_blank">01:00:25.800</a></span> | <span class="t">is what can we do to use it to sample, you know, the dataset?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3632" target="_blank">01:00:32.080</a></span> | <span class="t">So the basic idea, of course, was that, you know, we have like basically we're here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3644" target="_blank">01:00:44.160</a></span> | <span class="t">We have, let's see here. Okay. So we have a basic idea is that we start out with a random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3650" target="_blank">01:00:50.200</a></span> | <span class="t">data point. And of course that's not going to be within the distribution at first, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3655" target="_blank">01:00:55.160</a></span> | <span class="t">now we've learned how to move from, you know, at one point towards the data distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3663" target="_blank">01:01:03.520</a></span> | <span class="t">That's what our noise prediction predicting function does. It basically tells you in what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3669" target="_blank">01:01:09.220</a></span> | <span class="t">direction and how much to... So the basic idea is that, yeah, I guess I'll start from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3677" target="_blank">01:01:17.740</a></span> | <span class="t">a new drawing here. Again, we have distribution is and we have a random point. And we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3688" target="_blank">01:01:28.480</a></span> | <span class="t">our noise predicting model that we have trained to tell us which direction to move. So it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3693" target="_blank">01:01:33.400</a></span> | <span class="t">tells us some direction. Or I guess, let's... It tells us some direction to move. At first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3706" target="_blank">01:01:46.460</a></span> | <span class="t">that direction is not going to be like you cannot follow that direction all the way to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3710" target="_blank">01:01:50.160</a></span> | <span class="t">get the correct data point. Because basically what we were doing is we're trying to reverse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3715" target="_blank">01:01:55.560</a></span> | <span class="t">the path that we were following when we were adding noise. So like, because we had originally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3719" target="_blank">01:01:59.640</a></span> | <span class="t">a data point and we kept adding noise to the data point and maybe, you know, it followed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3723" target="_blank">01:02:03.440</a></span> | <span class="t">some path like this. And we want to reverse that path to get to... So our noise predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3732" target="_blank">01:02:12.760</a></span> | <span class="t">function will give us an original direction which would be some kind of... It's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3738" target="_blank">01:02:18.720</a></span> | <span class="t">to be kind of tangential to the actual path at that location. So what we would do is we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3745" target="_blank">01:02:25.040</a></span> | <span class="t">would maybe follow that data point all the way towards... We're just going to keep following</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3750" target="_blank">01:02:30.920</a></span> | <span class="t">that data point. We're going to try to predict the fully denoised image by following this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3759" target="_blank">01:02:39.040</a></span> | <span class="t">noise prediction. But our fully denoised image is also not going to be a real image. So what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3765" target="_blank">01:02:45.540</a></span> | <span class="t">we... So let me... I'll show you an example of that over here in the paper on where they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3771" target="_blank">01:02:51.080</a></span> | <span class="t">show this a little bit more carefully. Let's see here. So X zero... Yeah. So basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3780" target="_blank">01:03:00.600</a></span> | <span class="t">you can see the different... You can see the different data points here. It's not going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3788" target="_blank">01:03:08.520</a></span> | <span class="t">to look anything like a real image. So you can see all these points. You know, it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3792" target="_blank">01:03:12.080</a></span> | <span class="t">look anything. That we would do is we actually had a little bit of noise back to it and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3803" target="_blank">01:03:23.320</a></span> | <span class="t">start... We have a new point where then we could maybe estimate a better... Get a better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3807" target="_blank">01:03:27.480</a></span> | <span class="t">estimate of which direction to move. Follow that all the way again. We follow a new point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3813" target="_blank">01:03:33.920</a></span> | <span class="t">I get add back a little bit of noise. You get a new estimate. You make a new estimate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3818" target="_blank">01:03:38.760</a></span> | <span class="t">of this noise prediction and removing the noise. Follow that all again completely and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3824" target="_blank">01:03:44.840</a></span> | <span class="t">add a little bit of noise again to the image and burst onto a dimension. So that's kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3832" target="_blank">01:03:52.640</a></span> | <span class="t">of what we're showing here as well. That's a lot like SGD. With SGD, we don't take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3837" target="_blank">01:03:57.080</a></span> | <span class="t">gradient and jump all the way. We use a learning rate to go some of the way because each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3841" target="_blank">01:04:01.280</a></span> | <span class="t">those estimates of where we want to go are not that great, but we just do it slowly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3848" target="_blank">01:04:08.680</a></span> | <span class="t">Exactly. And at the end of the day, that's what we're doing with this noise prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3852" target="_blank">01:04:12.800</a></span> | <span class="t">We are predicting the gradient of this p of x, but of course, we need to keep making estimates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3861" target="_blank">01:04:21.320</a></span> | <span class="t">of that gradient as we're progressing. So we have to keep evaluating our noise prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3867" target="_blank">01:04:27.040</a></span> | <span class="t">function to get updated and better estimates of our gradient in order to finally converge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3873" target="_blank">01:04:33.920</a></span> | <span class="t">onto our image. And then you can see that here where we have maybe this fully predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3880" target="_blank">01:04:40.520</a></span> | <span class="t">denoised image, which at the beginning doesn't look anything like a real image, but then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3885" target="_blank">01:04:45.740</a></span> | <span class="t">as we continue throughout the sound like process, we finally converge on something that looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3890" target="_blank">01:04:50.880</a></span> | <span class="t">like an actual image. Again, these are CIFAR-10 images and still a little bit maybe unclear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3895" target="_blank">01:04:55.880</a></span> | <span class="t">about how realistic these images, these very small images look, but that's kind of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3900" target="_blank">01:05:00.880</a></span> | <span class="t">general principle I would say. And so that's what I can show in the code. This idea of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3912" target="_blank">01:05:12.400</a></span> | <span class="t">we're going to start out basically with a random image, right? And this random image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3917" target="_blank">01:05:17.480</a></span> | <span class="t">is going to be like a pure noise image and it's not going to be part of the data distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3923" target="_blank">01:05:23.440</a></span> | <span class="t">It's not anything like a real image, it's just a rounded image. And so this is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3927" target="_blank">01:05:27.040</a></span> | <span class="t">to be our x, I guess, x uppercase T, right? That's what we start out with. And we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3932" target="_blank">01:05:32.960</a></span> | <span class="t">to go from x uppercase T all the way to x0. So what we do is we go through each of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3939" target="_blank">01:05:39.520</a></span> | <span class="t">time steps and we have to put it in this sort of batch format because that's what our neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3948" target="_blank">01:05:48.600</a></span> | <span class="t">network expects. So we just have to format it appropriately. And we'll get to Z in just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3955" target="_blank">01:05:55.760</a></span> | <span class="t">a moment. I'll explain that in just a moment. But of course, we just again have similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3960" target="_blank">01:06:00.000</a></span> | <span class="t">alpha bar, beta bar, which is getting those variables that we --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3966" target="_blank">01:06:06.840</a></span> | <span class="t">And we faked beta bar because we couldn't figure out how to type it, so we used b bar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3970" target="_blank">01:06:10.320</a></span> | <span class="t">instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3971" target="_blank">01:06:11.320</a></span> | <span class="t">Yeah, we were unable to get beta bar to work, I guess. But anyway, at each step, what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3980" target="_blank">01:06:20.260</a></span> | <span class="t">trying to do is to try to predict what direction we need to go. And that direction is given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3984" target="_blank">01:06:24.320</a></span> | <span class="t">by our noise predicting model, right? So what we do is we pass in x of t and our current</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3990" target="_blank">01:06:30.480</a></span> | <span class="t">time step into our model and we get this noise prediction and that's the direction that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=3995" target="_blank">01:06:35.280</a></span> | <span class="t">need to move it. So basically, we take x of t, we first attempt to completely remove the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4001" target="_blank">01:06:41.600</a></span> | <span class="t">noise, right? That's what this is doing. That's what x0 cap is. That's completely removing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4005" target="_blank">01:06:45.880</a></span> | <span class="t">the noise. And of course, as we said, that estimate at the beginning won't be very accurate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4013" target="_blank">01:06:53.160</a></span> | <span class="t">And so now what we do is we have some coefficients here where we have a coefficient of how much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4018" target="_blank">01:06:58.420</a></span> | <span class="t">that we keep of this estimate of our denoise image and how much of the originally noisy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4026" target="_blank">01:07:06.800</a></span> | <span class="t">image we keep. And on top of that, we're going to add in some additional noise. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4033" target="_blank">01:07:13.160</a></span> | <span class="t">what we do here. We have x0 cap and we multiply by its coefficient and we have x of t, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4044" target="_blank">01:07:24.320</a></span> | <span class="t">multiply by some coefficient and we also add some additional noise. That's what the z is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4049" target="_blank">01:07:29.480</a></span> | <span class="t">It's basically a weighted average of the two plus the natural noise. And then the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4057" target="_blank">01:07:37.940</a></span> | <span class="t">idea is that as we get closer and closer to a time step equals to zero, our estimate of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4068" target="_blank">01:07:48.120</a></span> | <span class="t">x0 will be more and more accurate. So our x0 coefficient will get closer as we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4078" target="_blank">01:07:58.520</a></span> | <span class="t">through the process and our x t coefficient will get closer and closer to zero. So basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4085" target="_blank">01:08:05.200</a></span> | <span class="t">we're going to be weighting more and more of the x0 hat estimate and less and less of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4090" target="_blank">01:08:10.600</a></span> | <span class="t">the x t as we're getting closer and closer to our final time step. And so at the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4095" target="_blank">01:08:15.620</a></span> | <span class="t">of the day, we will have our estimated generated image. So that's kind of an overview of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4103" target="_blank">01:08:23.540</a></span> | <span class="t">sampling process. So yeah, basically the way I implemented it here was I had the sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4114" target="_blank">01:08:34.720</a></span> | <span class="t">function that's part of our callback and it will take in the model and the kind of shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4123" target="_blank">01:08:43.800</a></span> | <span class="t">that you want for your images that you're producing. So if you want to specify how many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4128" target="_blank">01:08:48.600</a></span> | <span class="t">images you produce, that's going to be part of your back size or whatever. And you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4132" target="_blank">01:08:52.400</a></span> | <span class="t">just see that in a moment. But yeah, it's just part of the callback. So then we basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4137" target="_blank">01:08:57.600</a></span> | <span class="t">have our DDPM callback and then we could just call the sample method of our DDPM callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4147" target="_blank">01:09:07.720</a></span> | <span class="t">and we pass in our model. And then here you can see we're going to produce, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4151" target="_blank">01:09:11.960</a></span> | <span class="t">16 images and it just has to be a one channel image of shape 32 by 32. And we get our samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4160" target="_blank">01:09:20.720</a></span> | <span class="t">And one thing I forgot to note was that I am collecting each of the time step effects</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4167" target="_blank">01:09:27.560</a></span> | <span class="t">of t. So the predictions here, you can see that there are a thousand of them. We want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4174" target="_blank">01:09:34.680</a></span> | <span class="t">the last one because that is our final generation. So we want the last one and that's what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4180" target="_blank">01:09:40.120</a></span> | <span class="t">have. They're no sad actually. Yeah. And this is a long way since DDPM. So this is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4186" target="_blank">01:09:46.860</a></span> | <span class="t">slower and less great than it could be. But considering that except for unit, we've done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4192" target="_blank">01:09:52.400</a></span> | <span class="t">this from scratch, you know, literally from matrix multiplication. I think those are pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4198" target="_blank">01:09:58.160</a></span> | <span class="t">decent. Yeah. And we're only trained for about five epochs. It took like, you know, maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4205" target="_blank">01:10:05.360</a></span> | <span class="t">like four minutes to train this model, something like that. It's pretty quick. And this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4209" target="_blank">01:10:09.880</a></span> | <span class="t">what we could get with very little training. And it's yeah, pretty decent. You can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4215" target="_blank">01:10:15.200</a></span> | <span class="t">it or some clear shirts and shoes and pants and whatever else. So yeah. And you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4221" target="_blank">01:10:21.480</a></span> | <span class="t">fabric and it's got texture and things have buckles and yeah. You know, something to compare,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4229" target="_blank">01:10:29.480</a></span> | <span class="t">like we did generative modeling in the first time we did part two back in the days when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4237" target="_blank">01:10:37.320</a></span> | <span class="t">something called Vassus Guy and Gan was just new, which is actually created by the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4241" target="_blank">01:10:41.760</a></span> | <span class="t">guy that created PyTorch or one of the two guys, Sumith. And we trained for hours and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4247" target="_blank">01:10:47.160</a></span> | <span class="t">hours and hours and got things that I'm not sure were any better than this. So things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4254" target="_blank">01:10:54.320</a></span> | <span class="t">that come a long way. Yeah. Yeah. And of course, then yeah, so we can see then like how this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4266" target="_blank">01:11:06.800</a></span> | <span class="t">sampling progresses over time, over the multiple time steps. So that's what I'm showing here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4272" target="_blank">01:11:12.440</a></span> | <span class="t">because I collected during the sampling process, we are collecting at each time step what that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4277" target="_blank">01:11:17.080</a></span> | <span class="t">estimate looks like. And you can kind of see here. And so this is an estimate out of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4283" target="_blank">01:11:23.360</a></span> | <span class="t">the noisy image over the time steps. Oops. And I guess I had to pause for a minute. Yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4288" target="_blank">01:11:28.480</a></span> | <span class="t">you can kind of see. But you'll notice that actually, so we actually what we did is like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4293" target="_blank">01:11:33.200</a></span> | <span class="t">okay, so we selected an image, which is like the ninth image. So that's this image here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4298" target="_blank">01:11:38.560</a></span> | <span class="t">So we're looking at this image, particularly here. And we're going over, yeah, we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4303" target="_blank">01:11:43.640</a></span> | <span class="t">a function here that's showing the i time step during the sampling process of that image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4311" target="_blank">01:11:51.280</a></span> | <span class="t">And we're just getting the images. And what we are doing is we're only showing basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4317" target="_blank">01:11:57.560</a></span> | <span class="t">from time step 800 to 1000. And here, we're just, we're just having it like where it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4324" target="_blank">01:12:04.040</a></span> | <span class="t">like, okay, we're looking at like, maybe every five steps and we're going from 800 to nine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4329" target="_blank">01:12:09.160</a></span> | <span class="t">And this kind of make it a little bit visually easier to see the transition. But what you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4334" target="_blank">01:12:14.400</a></span> | <span class="t">notice is I didn't start all the way from zero, I started from 800. And the reason we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4339" target="_blank">01:12:19.320</a></span> | <span class="t">do that is because actually, between zero and 800, there's very little change in terms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4345" target="_blank">01:12:25.560</a></span> | <span class="t">of like, it's just mostly a noisy image. And it turns out, yeah, I didn't see as I make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4352" target="_blank">01:12:32.040</a></span> | <span class="t">a note of this year, it's actually a limitation of the noise schedule that is used in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4357" target="_blank">01:12:37.000</a></span> | <span class="t">original DDP on paper. And especially when applied to some of these smaller images when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4362" target="_blank">01:12:42.200</a></span> | <span class="t">we're working with images of like size 32 by 32 or whatever. And so there are some other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4368" target="_blank">01:12:48.880</a></span> | <span class="t">papers like the improved DDP on paper that propose other sorts of noise schedules. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4374" target="_blank">01:12:54.320</a></span> | <span class="t">what I mean by noise schedule is basically how beta is defined, basically. So, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4380" target="_blank">01:13:00.520</a></span> | <span class="t">we had this definition of torch.lenspace for our beta, but people have different ways of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4385" target="_blank">01:13:05.840</a></span> | <span class="t">defining beta that lead to different properties. So, you know, things like that, people have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4391" target="_blank">01:13:11.800</a></span> | <span class="t">come up with different improvements, and those sorts of improvements work well when we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4395" target="_blank">01:13:15.120</a></span> | <span class="t">working with these smaller images. And basically, the point is like, if we are working from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4399" target="_blank">01:13:19.840</a></span> | <span class="t">0 to 800, and it's just mostly just noise that entire time, you know, we're not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4404" target="_blank">01:13:24.680</a></span> | <span class="t">making full use of all those time steps. So, it would be nice if we could actually make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4408" target="_blank">01:13:28.680</a></span> | <span class="t">full use of those time steps and actually have it do something during that time period.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4412" target="_blank">01:13:32.960</a></span> | <span class="t">So, all these, there are some papers that examine this a little bit more carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4417" target="_blank">01:13:37.160</a></span> | <span class="t">And it would be kind of interesting for maybe some of you folks to also look at these papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4421" target="_blank">01:13:41.600</a></span> | <span class="t">and see if you can try to implement, you know, those sorts of models with this notebook as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4427" target="_blank">01:13:47.400</a></span> | <span class="t">a starting point. And it should be a fairly simple change in terms of like noise schedule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4431" target="_blank">01:13:51.120</a></span> | <span class="t">or something like that. So, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4432" target="_blank">01:13:52.680</a></span> | <span class="t">So I actually think, you know, this is the start of our next journey, you know, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4437" target="_blank">01:13:57.200</a></span> | <span class="t">is our previous journey was, you know, going from being totally rubbish at FashionMnist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4444" target="_blank">01:14:04.280</a></span> | <span class="t">classification to being really good at it. I would say now we're like a little bit rubbish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4450" target="_blank">01:14:10.640</a></span> | <span class="t">at doing FashionMnist generation. And yeah, I think, you know, we should all now work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4460" target="_blank">01:14:20.080</a></span> | <span class="t">from here over the next few lessons and so forth and people, you know, trying things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4466" target="_blank">01:14:26.020</a></span> | <span class="t">at home and all of us trying to make better and better generative models, you know, initially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4474" target="_blank">01:14:34.520</a></span> | <span class="t">a FashionMnist and hopefully we'll get to the point where we're so good at that, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4477" target="_blank">01:14:37.800</a></span> | <span class="t">we're like, oh, this is too easy. And then we'll pick something harder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4482" target="_blank">01:14:42.960</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4484" target="_blank">01:14:44.840</a></span> | <span class="t">And eventually that'll take us to stable diffusion and beyond, I imagine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4493" target="_blank">01:14:53.680</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4495" target="_blank">01:14:55.800</a></span> | <span class="t">That's cool. I got some stuff to show you guys. If you're interested, I tried to, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4507" target="_blank">01:15:07.600</a></span> | <span class="t">know, better understand what was going on in Tanishk's notebook and tried doing it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4513" target="_blank">01:15:13.080</a></span> | <span class="t">a thousand different ways and also see if I could just start to make it a bit faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4518" target="_blank">01:15:18.680</a></span> | <span class="t">So that's what's in notebook 17, which I will share. So we've already seen the start of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4531" target="_blank">01:15:31.120</a></span> | <span class="t">notebook 17. Well, one thing I did just do is just drew a picture for myself, partly just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4536" target="_blank">01:15:36.800</a></span> | <span class="t">to remind myself what the real ones look like, and they definitely have more detail than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4543" target="_blank">01:15:43.480</a></span> | <span class="t">the samples that Tanishk was showing. But they're not, you know, they're just 28 by 28. I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4551" target="_blank">01:15:51.040</a></span> | <span class="t">they're not super amazing images and they're just black and white. So even if we're fantastic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4555" target="_blank">01:15:55.360</a></span> | <span class="t">at this, they're never going to look great because we're using a small, simple dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4561" target="_blank">01:16:01.200</a></span> | <span class="t">As you always should, when you're doing any kind of R and D or experiments, you should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4566" target="_blank">01:16:06.480</a></span> | <span class="t">always use a small and simple dataset up until you're so good at it that it's not challenging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4571" target="_blank">01:16:11.800</a></span> | <span class="t">anymore. And even then, when you're exploring new ideas, you should explore them on small,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4577" target="_blank">01:16:17.920</a></span> | <span class="t">simple datasets first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4579" target="_blank">01:16:19.480</a></span> | <span class="t">Yeah. So after I drew the various things, what I like to do is one thing I found challenging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4587" target="_blank">01:16:27.200</a></span> | <span class="t">about working with your class to Tanishk is I find when stuff is inside a class, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4592" target="_blank">01:16:32.160</a></span> | <span class="t">harder for me to explore. So I copied and pasted it before batch contents and called it Noisify.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4603" target="_blank">01:16:43.800</a></span> | <span class="t">And so one of the things that's fun to do that is it forces you to figure out what are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4608" target="_blank">01:16:48.040</a></span> | <span class="t">the actual parameters to it. And so now that I, rather than putting that fast, now that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4612" target="_blank">01:16:52.360</a></span> | <span class="t">I've got all of my various things to do with, so these are the three parameters to the DDPM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4621" target="_blank">01:17:01.560</a></span> | <span class="t">callbacks in it. So then these things we can calculate from that. So with those, then actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4627" target="_blank">01:17:07.440</a></span> | <span class="t">all we need is, yeah, what's the image that we're going to Noisify and then what's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4636" target="_blank">01:17:16.760</a></span> | <span class="t">alpha bar, which I mean, we can get from here, but it sort of would be more general if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4640" target="_blank">01:17:20.560</a></span> | <span class="t">can pass in your alpha bar. So yeah, this is just copying and pasting from the class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4647" target="_blank">01:17:27.240</a></span> | <span class="t">But the nice thing is then I could experiment with it. So I can call Noisify on my first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4652" target="_blank">01:17:32.320</a></span> | <span class="t">25 images and with a random T, each one's got a different random T. And so I can print</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4661" target="_blank">01:17:41.160</a></span> | <span class="t">out the T and then I could actually use those as titles. And so this lets me, I thought</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4665" target="_blank">01:17:45.960</a></span> | <span class="t">this was quite nice. I might actually rerun this because actually none of these look like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4671" target="_blank">01:17:51.440</a></span> | <span class="t">anything because as it turns out in this particular case, all of the Ts are over 200. And as Tanishk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4678" target="_blank">01:17:58.280</a></span> | <span class="t">mentioned, once you're over 200, it's almost impossible to see anything. So let me just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4683" target="_blank">01:18:03.240</a></span> | <span class="t">rerun this and see if we get a better, there we go. There's a better one. So with a T of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4692" target="_blank">01:18:12.200</a></span> | <span class="t">0, right? So remember T equals 0 is the pure image. So T equals 7, it's just a slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4699" target="_blank">01:18:19.560</a></span> | <span class="t">speckled image. And by 67, it's a pretty bad image. And by 94, it's very hard to see what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4706" target="_blank">01:18:26.480</a></span> | <span class="t">it is at all. And by 293, maybe I can see a pair of pants. I'm not sure I can see anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4716" target="_blank">01:18:36.680</a></span> | <span class="t">So yeah, by the way, there's a handy little, so I think we've looked at map before in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4725" target="_blank">01:18:45.520</a></span> | <span class="t">course. There's an extended version of map in fast core. And one of the nice things is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4729" target="_blank">01:18:49.640</a></span> | <span class="t">you can pass it a string and it basically just calls this format string if you pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4735" target="_blank">01:18:55.200</a></span> | <span class="t">it a string rather than a function. And so this is going to stringify everything using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4739" target="_blank">01:18:59.560</a></span> | <span class="t">its representations. This is how I got the titles out of it, just by the way. So yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4746" target="_blank">01:19:06.720</a></span> | <span class="t">I found this useful to be able to draw a picture of everything. And then I wanted to, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4754" target="_blank">01:19:14.280</a></span> | <span class="t">look at what else can I do. So then I took, you won't be surprised to see, I took the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4759" target="_blank">01:19:19.640</a></span> | <span class="t">sample method and turned that into a function. And I actually decided to pass everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4764" target="_blank">01:19:24.560</a></span> | <span class="t">that it needs even, I mean, you could actually calculate pretty much all of these. But I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4769" target="_blank">01:19:29.840</a></span> | <span class="t">thought since I've calculated them before, it was passed them in. So this is all copied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4772" target="_blank">01:19:32.800</a></span> | <span class="t">and pasted from Janiszk's version. And so that means the callback now is tiny, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4779" target="_blank">01:19:39.420</a></span> | <span class="t">Because before batch is just noisify and the sample method just calls the sample function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4787" target="_blank">01:19:47.640</a></span> | <span class="t">Now what I did do is I decided just to, yeah, I wanted to try like as many different ways</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4792" target="_blank">01:19:52.240</a></span> | <span class="t">of doing this as possible, partly as an exercise to help everybody like see all the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4799" target="_blank">01:19:59.800</a></span> | <span class="t">ways we can work with our framework, you know. So I decided not to inherit from train_cb,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4805" target="_blank">01:20:05.160</a></span> | <span class="t">but instead I inherited from callback. So that means I can't use Janiszk's nifty trick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4814" target="_blank">01:20:14.080</a></span> | <span class="t">of replacing predict. So instead I now need some way to pass in the two parts of the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4821" target="_blank">01:20:21.800</a></span> | <span class="t">element of the tuple, add separate things to the model and return the sample. So how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4828" target="_blank">01:20:28.280</a></span> | <span class="t">else could we do that? Well, what we could do is we could actually inherit from unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4833" target="_blank">01:20:33.040</a></span> | <span class="t">2D model, which is what Janiszk used directly, unit 2D model, and we could replace the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4840" target="_blank">01:20:40.400</a></span> | <span class="t">And so we could replace specifically the forward function. That's the thing that gets called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4845" target="_blank">01:20:45.080</a></span> | <span class="t">And we could just call the original forward function, but rather than passing an x or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4850" target="_blank">01:20:50.320</a></span> | <span class="t">passing star x, and rather than returning that, we'll return that dot sample. Okay. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4856" target="_blank">01:20:56.840</a></span> | <span class="t">if we do that, then we don't need the train_cb anymore and we don't need the predict. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4863" target="_blank">01:21:03.120</a></span> | <span class="t">so if you're not working with something as beautifully flexible as mini AI, you can always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4869" target="_blank">01:21:09.440</a></span> | <span class="t">do this, you know, to make, to replace your model so that it has the interface that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4876" target="_blank">01:21:16.600</a></span> | <span class="t">need it to have. So now, again, we did the same as Janiszk had of create the callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4883" target="_blank">01:21:23.160</a></span> | <span class="t">And now when we create the model, we'll use our unit class, which we just created. I wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4888" target="_blank">01:21:28.800</a></span> | <span class="t">to see if I can make things faster. I tried dividing all of Janiszk's channels by two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4895" target="_blank">01:21:35.460</a></span> | <span class="t">and I found it worked just as well. One thing I noticed is that it uses group_norm in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4901" target="_blank">01:21:41.720</a></span> | <span class="t">unit, which we have briefly learned about before. And in group_norm, it splits the channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4907" target="_blank">01:21:47.400</a></span> | <span class="t">up into a certain number of groups. And I needed to make sure that those groups had more than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4916" target="_blank">01:21:56.320</a></span> | <span class="t">one thing in. So you can actually pass in how many groups do you want to use in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4920" target="_blank">01:22:00.800</a></span> | <span class="t">normalization. So that's what this is for. If you're going to be a little bit careful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4926" target="_blank">01:22:06.280</a></span> | <span class="t">of these things, I didn't think of it at first. And I ended up, I think the NAM groups might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4930" target="_blank">01:22:10.720</a></span> | <span class="t">have been 32, and I got an error saying you can't split 16 things into 32 groups. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4938" target="_blank">01:22:18.200</a></span> | <span class="t">it also made me realize, actually, even in Janiszk's, maybe you probably had 32 in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4942" target="_blank">01:22:22.400</a></span> | <span class="t">first with 32 groups, and so maybe the group_norm wouldn't have been working as well. So they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4947" target="_blank">01:22:27.120</a></span> | <span class="t">little subtle things to look out for. So now that we're not using anything inherited from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4954" target="_blank">01:22:34.840</a></span> | <span class="t">train_cb, that means we either need to use train_cb itself or just use our train_liner,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4960" target="_blank">01:22:40.200</a></span> | <span class="t">and that everything else is the same as what Janiszk had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4964" target="_blank">01:22:44.280</a></span> | <span class="t">So then I wanted to look at the results of Noisify here, and we've seen this trick before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4971" target="_blank">01:22:51.640</a></span> | <span class="t">which is we call fit, but don't call the training part of the fit, and use the single batch_cb</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4978" target="_blank">01:22:58.320</a></span> | <span class="t">callback that we created way back when we first created learner. And now learn.batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4983" target="_blank">01:23:03.560</a></span> | <span class="t">will contain the tuple of tuples, which we can then use that trick to show. So, I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4992" target="_blank">01:23:12.520</a></span> | <span class="t">obviously we'd expect it to look the same as before, but it's nice. I always like to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=4996" target="_blank">01:23:16.480</a></span> | <span class="t">draw pictures of everything all along the way, because it's very, very often. I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5001" target="_blank">01:23:21.000</a></span> | <span class="t">the first six to seven times I do anything, I do it wrong. So given that I know that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5006" target="_blank">01:23:26.600</a></span> | <span class="t">I might as well draw a picture to try and see how it's wrong until it's fixed. It also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5010" target="_blank">01:23:30.280</a></span> | <span class="t">tells me when it's not wrong. Isn't there a show_batch function now that does something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5017" target="_blank">01:23:37.320</a></span> | <span class="t">similar? Yes, you wrote that show_image_batch, didn't you? I can't quite remember. Yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5026" target="_blank">01:23:46.240</a></span> | <span class="t">we should remind ourselves how that worked. That's a good point. Thanks for reminding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5035" target="_blank">01:23:55.480</a></span> | <span class="t">it. Okay, so then I'll just go ahead and do the same thing that Nish did. But then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5042" target="_blank">01:24:02.160</a></span> | <span class="t">next thing I looked at was I looked at the, how am I going to make this train faster?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5047" target="_blank">01:24:07.160</a></span> | <span class="t">I want a higher learning rate. And I realized, oddly enough, the diffuser's code does not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5056" target="_blank">01:24:16.960</a></span> | <span class="t">initialize anything at all. They use the defaults, which just goes to show, like even the experts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5064" target="_blank">01:24:24.440</a></span> | <span class="t">at Hugging Face that don't necessarily think like, oh, maybe the PyTorch defaults aren't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5073" target="_blank">01:24:33.680</a></span> | <span class="t">perfect for my model. Of course they're not because they depend on what activation function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5077" target="_blank">01:24:37.960</a></span> | <span class="t">do you have and what resbox do you have and so forth. So I wasn't exactly sure how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5085" target="_blank">01:24:45.840</a></span> | <span class="t">initialize it. Partly by chatting to Kat Crowley, who's the author of K. Diffusion, and partly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5095" target="_blank">01:24:55.040</a></span> | <span class="t">by looking at papers and partly by thinking about my own experience, I ended up doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5100" target="_blank">01:25:00.240</a></span> | <span class="t">a few things. One is I did do the thing that we talked about a while ago, which is to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5106" target="_blank">01:25:06.640</a></span> | <span class="t">every second convolutional layer and zero it out. You could do the same thing with using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5112" target="_blank">01:25:12.080</a></span> | <span class="t">batch norm, which is what we tried. And since we've got quite a deep network, that seemed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5116" target="_blank">01:25:16.200</a></span> | <span class="t">like it might, it helps basically by having the non-ID path in the resnets do nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5125" target="_blank">01:25:25.560</a></span> | <span class="t">at first. So they can't cause problems. We haven't talked about orthogonalized weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5133" target="_blank">01:25:33.280</a></span> | <span class="t">before and we probably won't because you would need to take our computational linear algebra</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5140" target="_blank">01:25:40.580</a></span> | <span class="t">course to learn about that, which is a great course. Rachel Thomas did a fantastic job</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5145" target="_blank">01:25:45.040</a></span> | <span class="t">of it. I highly recommend it, but I don't want to make it a prerequisite. But Kat mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5149" target="_blank">01:25:49.320</a></span> | <span class="t">she thought that using orthogonal weights for the downsamplers was a good idea. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5157" target="_blank">01:25:57.000</a></span> | <span class="t">then for the app blocks, they also set the second comms to zero. And something Kat mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5163" target="_blank">01:26:03.840</a></span> | <span class="t">she found useful, which is also from, I think it's from the Darrow while Google paper is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5170" target="_blank">01:26:10.660</a></span> | <span class="t">to also zero out the weights of basically the very last layer. And so it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5175" target="_blank">01:26:15.960</a></span> | <span class="t">start by predicting zero as the noise, which is something that can't hurt. So that's how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5184" target="_blank">01:26:24.160</a></span> | <span class="t">I initialized the weights. So call in at DDPM on my model. Something that I found made a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5191" target="_blank">01:26:31.400</a></span> | <span class="t">huge difference is I replaced the normal atom optimizer with one that has an epsilon of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5196" target="_blank">01:26:36.200</a></span> | <span class="t">one in Nick five. The default I think is one in egg eight. And so to remind you, this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5204" target="_blank">01:26:44.000</a></span> | <span class="t">when we divide by the kind of exponentially weighted moving average of the squared gradients,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5211" target="_blank">01:26:51.400</a></span> | <span class="t">when we divide by that, if that's a very, very small number, then it makes the effective</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5218" target="_blank">01:26:58.880</a></span> | <span class="t">learning rate huge. And so we add this to it to make it not too huge. And it's nearly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5224" target="_blank">01:27:04.680</a></span> | <span class="t">always a good idea to make this bigger than the default. I don't know why the default</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5228" target="_blank">01:27:08.400</a></span> | <span class="t">is so small. And I found until I did this, anytime I tried to use a reasonably large</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5233" target="_blank">01:27:13.320</a></span> | <span class="t">learning rate somewhere around the middle of the one cycle training, it would explode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5240" target="_blank">01:27:20.120</a></span> | <span class="t">So that makes a big difference. So this way, yeah, I could train, I could get 0.016 after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5251" target="_blank">01:27:31.000</a></span> | <span class="t">five epochs and then sampling. So it looks all pretty similar. We've got some pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5258" target="_blank">01:27:38.480</a></span> | <span class="t">nice textures, I think. So then I was thinking, how do I get faster? So one way we can make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5264" target="_blank">01:27:44.640</a></span> | <span class="t">it faster is we can take advantage of something called mixed precision. So currently we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5273" target="_blank">01:27:53.720</a></span> | <span class="t">using 32 bit floating point values. That's the defaults and also known as single precision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5282" target="_blank">01:28:02.040</a></span> | <span class="t">And GPUs are pretty fast at doing 32 bit floating point values, but they're much, much, much,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5289" target="_blank">01:28:09.240</a></span> | <span class="t">much faster at doing 16 bit floating point values. So 16 bit floating point values aren't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5297" target="_blank">01:28:17.120</a></span> | <span class="t">able to represent a very wide range of numbers or much precision at the difference between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5303" target="_blank">01:28:23.000</a></span> | <span class="t">numbers. And so they're quite difficult to use, but if you can, you'll get a huge benefit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5308" target="_blank">01:28:28.820</a></span> | <span class="t">because modern GPUs, modern Nvidia GPUs specifically have special units that do matrix multiplies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5317" target="_blank">01:28:37.920</a></span> | <span class="t">of 16 bit values extremely quickly. You can't just cast everything to 16 bit because then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5326" target="_blank">01:28:46.280</a></span> | <span class="t">you, there's not enough precision to calculate gradients and stuff properly. So we have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5331" target="_blank">01:28:51.280</a></span> | <span class="t">use something called mixed precision. Depending on how enthusiastic I'm feeling, I guess we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5341" target="_blank">01:29:01.000</a></span> | <span class="t">ought to do this from scratch as well. We'll see. We do have an implementation from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5349" target="_blank">01:29:09.160</a></span> | <span class="t">because we actually implemented this before Nvidia implemented it in an earlier version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5354" target="_blank">01:29:14.360</a></span> | <span class="t">of fast AI. Anyway, we'll see. So basically the idea is that we use 32 bit for things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5363" target="_blank">01:29:23.400</a></span> | <span class="t">where we need 32 bit and we use 16 bit for things we use 16 bit. So that's what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5367" target="_blank">01:29:27.800</a></span> | <span class="t">going to do is we're going to use this mixed precision. But for now, we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5371" target="_blank">01:29:31.720</a></span> | <span class="t">Nvidia's, you know, semi-automatic or fairly automatic code to do that for us. Actually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5380" target="_blank">01:29:40.600</a></span> | <span class="t">we had a slight change of plan at this point when we realized this lesson was going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5385" target="_blank">01:29:45.160</a></span> | <span class="t">be over three hours in length and we should actually split it into two. So we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5389" target="_blank">01:29:49.840</a></span> | <span class="t">to wrap up this lesson here and we're going to come back and implement this mixed precision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5396" target="_blank">01:29:56.960</a></span> | <span class="t">thing in lesson 20. So we'll see you then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ItyO8s48zdc&t=5400" target="_blank">01:30:00.720</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>