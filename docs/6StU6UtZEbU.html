<html><head><title>Lesson 10: Deep Learning Foundations to Stable Diffusion, 2022</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 10: Deep Learning Foundations to Stable Diffusion, 2022</h2><a href="https://www.youtube.com/watch?v=6StU6UtZEbU"><img src="https://i.ytimg.com/vi/6StU6UtZEbU/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=35">0:35</a> Showing student’s work over the past week.<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=364">6:4</a> Recap Lesson 9<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=775">12:55</a> Explaining “Progressive Distillation for Fast Sampling of Diffusion Models” & “On Distillation of Guided Diffusion Models”<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1613">26:53</a> Explaining “Imagic: Text-Based Real Image Editing with Diffusion Models”<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2033">33:53</a> Stable diffusion pipeline code walkthrough<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2479">41:19</a> Scaling random noise to ensure variance<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3021">50:21</a> Recommended homework for the week<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3222">53:42</a> What are the foundations of stable diffusion? Notebook deep dive<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3990">66:30</a> Numpy arrays and PyTorch Tensors from scratch<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5308">88:28</a> History of tensor programming<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5820">97:0</a> Random numbers from scratch<br><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6161">102:41</a> Important tip on random numbers via process forking<br><br><div style="text-align: left;"><a href="./6StU6UtZEbU.html">Whisper Transcript</a> | <a href="./transcript_6StU6UtZEbU.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi, everybody, and welcome back. This is lesson 10 of practical deep learning for coders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=9" target="_blank">00:00:09.920</a></span> | <span class="t">It's the second lesson in part two, which is where we're going from deep learning foundations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=14" target="_blank">00:00:14.880</a></span> | <span class="t">to stable diffusion. So before we dive back into our notebook, I think first of all, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=20" target="_blank">00:00:20.700</a></span> | <span class="t">take a look at some of the interesting work that students in the course have done over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=24" target="_blank">00:00:24.640</a></span> | <span class="t">the last week. I'm just going to show a small sample of what's on the forum. So check out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=29" target="_blank">00:00:29.760</a></span> | <span class="t">the share your work here thread on the forum for many, many, many more examples. So Puro</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=38" target="_blank">00:00:38.400</a></span> | <span class="t">did some something interesting, which is to create a bunch of images of doing a linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=46" target="_blank">00:00:46.500</a></span> | <span class="t">interpolation. I mean, details actually spherical linear interpolation, but it doesn't matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=51" target="_blank">00:00:51.160</a></span> | <span class="t">Doing a linear interpolation between two different latent, you know, noisy, you know, latent noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=56" target="_blank">00:00:56.280</a></span> | <span class="t">starting points for an auto picture and then showed all the intermediate results that came</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=63" target="_blank">00:01:03.720</a></span> | <span class="t">out pretty nice and they did something similar starting with an old car prompt and going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=68" target="_blank">00:01:08.640</a></span> | <span class="t">to a modern Ferrari prompt. I can't remember exactly what the prompts were, but you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=72" target="_blank">00:01:12.720</a></span> | <span class="t">see how as it kind of goes through that latent space, it actually is changing the image that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=80" target="_blank">00:01:20.380</a></span> | <span class="t">coming out. I think that's really cool. And then I love the way Namrata took that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=86" target="_blank">00:01:26.000</a></span> | <span class="t">took it to another level in a way, which is starting with a dinosaur and turning into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=90" target="_blank">00:01:30.240</a></span> | <span class="t">a bird. And this is a very cool intermediate picture of one of the steps along the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=97" target="_blank">00:01:37.480</a></span> | <span class="t">The dino bird. I love it. Dino chick. Fantastic. So much creativity on the forums. I loved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=108" target="_blank">00:01:48.480</a></span> | <span class="t">this. John Richmond took his daughter's dog and turned it gradually into a unicorn. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=117" target="_blank">00:01:57.640</a></span> | <span class="t">I thought this one along the way actually came out very, very nicely. I think this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=122" target="_blank">00:02:02.240</a></span> | <span class="t">adorable. And I suspect that John has won the dad of the year or dad of the week, maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=128" target="_blank">00:02:08.080</a></span> | <span class="t">award this week for this fantastic project. And Maureen did something very interesting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=138" target="_blank">00:02:18.920</a></span> | <span class="t">which is she took John O's parrot image from his lesson and tried bringing it across to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=148" target="_blank">00:02:28.840</a></span> | <span class="t">various different painter's styles. And so her question was, anyone want to guess the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=153" target="_blank">00:02:33.040</a></span> | <span class="t">artists in the prompts? So I'm just going to let you pause it before I move on. If you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=160" target="_blank">00:02:40.000</a></span> | <span class="t">want to try to guess. And there they are. Most of them pretty obvious, I guess. I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=171" target="_blank">00:02:51.320</a></span> | <span class="t">it's so funny that Frida Kahlo appears in all of her paintings. So the parents actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=176" target="_blank">00:02:56.840</a></span> | <span class="t">turned into Frida Kahlo. All right. Not all of her paintings, but all of her famous ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=181" target="_blank">00:03:01.960</a></span> | <span class="t">So the very idea of Frida Kahlo painting without her in it is so unheard of that the parrots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=185" target="_blank">00:03:05.960</a></span> | <span class="t">turned into Frida Kahlo. And I like this Jackson Pollock. It's still got the parrot going on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=191" target="_blank">00:03:11.340</a></span> | <span class="t">there. So that's a really lovely one, Maureen. Thank you. And this is a good reminder to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=199" target="_blank">00:03:19.760</a></span> | <span class="t">make sure that you check out the other two lesson videos. So she was working with John</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=207" target="_blank">00:03:27.280</a></span> | <span class="t">Ono's stable diffusion lesson. So be sure to check that out if you haven't yet. It is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=215" target="_blank">00:03:35.200</a></span> | <span class="t">available on the course web page and on the forums and has lots of cool stuff that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=221" target="_blank">00:03:41.000</a></span> | <span class="t">can work with, including this parrot. And then the other one to remind you about is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=229" target="_blank">00:03:49.120</a></span> | <span class="t">the video that Waseem and Tanish did on the math of diffusion. And I do want to read out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=236" target="_blank">00:03:56.880</a></span> | <span class="t">what Alex said about this because I'm sure a number of you feel the same way. My first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=242" target="_blank">00:04:02.080</a></span> | <span class="t">reaction on seeing something with the title math of diffusion was to assume that, oh,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=245" target="_blank">00:04:05.960</a></span> | <span class="t">that's just something for all the smart people who have PhDs in maths on the course. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=249" target="_blank">00:04:09.640</a></span> | <span class="t">it'll probably be completely incomprehensible. But of course, it's not that at all. So be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=256" target="_blank">00:04:16.400</a></span> | <span class="t">sure to check this out. Even if you don't think of yourself as a math person, I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=260" target="_blank">00:04:20.840</a></span> | <span class="t">it's some nice background that you may find useful. It's certainly not necessary. But you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=268" target="_blank">00:04:28.480</a></span> | <span class="t">might. Yeah, I think it's kind of useful to start to dig in some of the math at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=279" target="_blank">00:04:39.280</a></span> | <span class="t">One particularly interesting project that's been happening during the week is from Jason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=283" target="_blank">00:04:43.040</a></span> | <span class="t">Antich, who is a bit of a legend around here. Many of you will remember him as being the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=289" target="_blank">00:04:49.480</a></span> | <span class="t">guy that created De-Oldify and actually worked closely with us on our research, which together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=297" target="_blank">00:04:57.440</a></span> | <span class="t">turned into Nogan and Decrapify and other things, created lots of papers. And Jason has kindly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=307" target="_blank">00:05:07.680</a></span> | <span class="t">joined our little research team working on the stuff for these lessons and for developing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=313" target="_blank">00:05:13.680</a></span> | <span class="t">a kind of fast AI approach to stable diffusion. And he took the idea that I prompted last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=321" target="_blank">00:05:21.080</a></span> | <span class="t">week, which is maybe we should be using classic optimizers rather than differential equation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=328" target="_blank">00:05:28.000</a></span> | <span class="t">solvers. And he actually made it work incredibly well already within a week. These faces were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=333" target="_blank">00:05:33.600</a></span> | <span class="t">generated on a single GPU in a few hours from scratch by using classic deep learning optimizers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=345" target="_blank">00:05:45.120</a></span> | <span class="t">which is like an unheard of speed to get this quality of image. And we think that this research</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=352" target="_blank">00:05:52.160</a></span> | <span class="t">direction is looking extremely promising. So really great news there. And thank you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=358" target="_blank">00:05:58.640</a></span> | <span class="t">Jason, for this fantastic progress. Yeah, so maybe we'll do a quick reminder of what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=369" target="_blank">00:06:09.640</a></span> | <span class="t">looked at last week. So last week, I used a bit of a mega one note hand-drawn thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=377" target="_blank">00:06:17.000</a></span> | <span class="t">I thought this week I might just turn it into some slides that we can use. So the basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=384" target="_blank">00:06:24.760</a></span> | <span class="t">idea, if you remember, is that we started with, if we're doing handwritten digits, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=390" target="_blank">00:06:30.400</a></span> | <span class="t">we'd start with a number seven. This would be one of the ones with a stroke through it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=395" target="_blank">00:06:35.040</a></span> | <span class="t">that some countries use. And then we add to it some noise. And the seven plus the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=403" target="_blank">00:06:43.120</a></span> | <span class="t">together would equal this noisy seven. And so what we then do is we present this noisy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=411" target="_blank">00:06:51.440</a></span> | <span class="t">seven as an input to a unit. And we have it try to predict which pixels are noise, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=422" target="_blank">00:07:02.320</a></span> | <span class="t">or predict the noise. And so the unit tries to predict the noise from the number. It then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=429" target="_blank">00:07:09.800</a></span> | <span class="t">compares its prediction to the actual noise. And it's going to then get a loss, which it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=438" target="_blank">00:07:18.680</a></span> | <span class="t">can use to update the weights in the unit. And that's basically how stable diffusion,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=446" target="_blank">00:07:26.240</a></span> | <span class="t">the main bit, if you like, the unit is created. To make it easier for the unit, we can also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=454" target="_blank">00:07:34.220</a></span> | <span class="t">pass in an embedding of the actual digit, the actual number seven. So for example, a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=459" target="_blank">00:07:39.600</a></span> | <span class="t">one hot encoded vector, which goes through an embedding layer. And the nice thing about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=465" target="_blank">00:07:45.720</a></span> | <span class="t">that to remind you is that if we do this, then we also have the benefit that then later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=470" target="_blank">00:07:50.080</a></span> | <span class="t">on we can actually generate specific digits by saying I want a number seven or I want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=474" target="_blank">00:07:54.960</a></span> | <span class="t">a number five and it knows what they look like. I've skipped over here the VAE Latents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=481" target="_blank">00:08:01.080</a></span> | <span class="t">piece, which we talked about last week. And to remind you, that's just a computational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=486" target="_blank">00:08:06.640</a></span> | <span class="t">shortcut. It makes it it makes it faster. And so we don't need to include that in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=494" target="_blank">00:08:14.600</a></span> | <span class="t">picture because it's just a just a computational shortcut that we can pre-process things into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=499" target="_blank">00:08:19.920</a></span> | <span class="t">that latent space with the VAE first, if we wish. So that's what the unit does. Now then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=508" target="_blank">00:08:28.120</a></span> | <span class="t">to remind you, you know, we want to handle things that are more interesting than just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=511" target="_blank">00:08:31.680</a></span> | <span class="t">the number seven. We want to actually handle things where we can say, for example, a graceful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=520" target="_blank">00:08:40.720</a></span> | <span class="t">swan or a scene from Hitchcock. And the way we do that is we turn these sentences into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=528" target="_blank">00:08:48.120</a></span> | <span class="t">embeddings as well. And we turn them into embeddings by trying to create embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=533" target="_blank">00:08:53.120</a></span> | <span class="t">of these sentences, which are as similar as possible to embeddings of the photos or images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=538" target="_blank">00:08:58.280</a></span> | <span class="t">that they are connected with. And remind you, the way we did that or the way that was done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=542" target="_blank">00:09:02.760</a></span> | <span class="t">originally as part of this thing called clip was to basically download from the internet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=550" target="_blank">00:09:10.120</a></span> | <span class="t">lots of examples of lots of images, find their alt tags. And then for each one, we then have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=557" target="_blank">00:09:17.800</a></span> | <span class="t">their image and its alt tag. So here's the graceful swan and its alt tag. And then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=564" target="_blank">00:09:24.240</a></span> | <span class="t">build two models, an image encoder that turns each image into some feature vector. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=573" target="_blank">00:09:33.320</a></span> | <span class="t">we have a text encoder that turns each piece of text into a bunch of features. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=578" target="_blank">00:09:38.680</a></span> | <span class="t">we create a loss function that says that the features for a graceful swan, the text, should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=584" target="_blank">00:09:44.960</a></span> | <span class="t">be as close as possible to the features for the picture of a graceful swan. And specifically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=591" target="_blank">00:09:51.000</a></span> | <span class="t">we take the dot product and then we add up all the green ones because these are the ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=595" target="_blank">00:09:55.320</a></span> | <span class="t">that we want to match and we subtract all the red ones because those are the ones we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=598" target="_blank">00:09:58.880</a></span> | <span class="t">don't want to match. Those are where the text doesn't match the image. And so that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=604" target="_blank">00:10:04.160</a></span> | <span class="t">contrastive lost, which gives us the CL in clip. So that's a review of some stuff we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=611" target="_blank">00:10:11.600</a></span> | <span class="t">did last week. And so with this, then we can, we now have a text encoder, which we can now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=617" target="_blank">00:10:17.760</a></span> | <span class="t">say a graceful swan, and it will spit out some embeddings. And those are the embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=623" target="_blank">00:10:23.160</a></span> | <span class="t">that we can feed into our unit during training. And so then we haven't been doing any of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=634" target="_blank">00:10:34.320</a></span> | <span class="t">training ourselves, except for some fine tuning, because it takes a very long time on a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=638" target="_blank">00:10:38.120</a></span> | <span class="t">of computers. But instead, we take pre-trained models and do inference. And the way we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=644" target="_blank">00:10:44.120</a></span> | <span class="t">inference is we put in an example of the thing that we want, that we have an embedding for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=649" target="_blank">00:10:49.480</a></span> | <span class="t">So let's say we're doing handwritten digits, and we put in some random noise into the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=656" target="_blank">00:10:56.280</a></span> | <span class="t">And then it spits out a prediction of which bits of noise you could remove to leave behind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=662" target="_blank">00:11:02.000</a></span> | <span class="t">a picture of the number three. Initially, it's going to do quite a bad job of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=667" target="_blank">00:11:07.040</a></span> | <span class="t">So we subtract just a little bit of that noise from the image to make it a little bit less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=671" target="_blank">00:11:11.760</a></span> | <span class="t">noisy, and we do it again, and we do it a bunch of times. So here's what that looks like, creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=683" target="_blank">00:11:23.200</a></span> | <span class="t">a-- I think somebody here did a smiling picture of Jeremy Howard or something, if I remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=687" target="_blank">00:11:27.320</a></span> | <span class="t">correctly. And if we print out the noise at kind of step zero, and it's step six, and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=696" target="_blank">00:11:36.240</a></span> | <span class="t">step 12, you can see the first signs of a face starting to appear. Definitely a face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=701" target="_blank">00:11:41.640</a></span> | <span class="t">appearing here, 18, 24. By step 30, it's looking much more like a face. By 42, it's getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=710" target="_blank">00:11:50.800</a></span> | <span class="t">there. It's just got a few little blemishes to fix up. And here we are. I think I've slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=715" target="_blank">00:11:55.940</a></span> | <span class="t">messed up my indexes here because it should finish at 60, not 54, but such is life. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=723" target="_blank">00:12:03.140</a></span> | <span class="t">rather rosy red lips, too, I would have to say. So remember, in the early days, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=732" target="_blank">00:12:12.200</a></span> | <span class="t">took 1,000 steps, and now there are some shortcuts to make it take 60 steps. And this is what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=740" target="_blank">00:12:20.720</a></span> | <span class="t">the process looks like. And the reason this doesn't look like normal noise is because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=744" target="_blank">00:12:24.200</a></span> | <span class="t">now we are actually doing the VAE Latents thing. And so noisy Latents don't look like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=752" target="_blank">00:12:32.600</a></span> | <span class="t">a Gaussian noise. They look like, well, they look like this. This is what happens when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=756" target="_blank">00:12:36.520</a></span> | <span class="t">you decode those noisy Latents. Now, you might remember last week I complained that things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=764" target="_blank">00:12:44.200</a></span> | <span class="t">are moving too quickly. And there was a couple of papers that had come out the day before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=769" target="_blank">00:12:49.480</a></span> | <span class="t">and made everything entirely out of date. So John and I and the team have actually had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=778" target="_blank">00:12:58.120</a></span> | <span class="t">time to read those papers. And I thought now would be a good time to start going through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=788" target="_blank">00:13:08.240</a></span> | <span class="t">some papers for the first time. So what we're actually going to do is show how these papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=796" target="_blank">00:13:16.680</a></span> | <span class="t">have taken the required number of steps to go through this process down from 60 steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=803" target="_blank">00:13:23.160</a></span> | <span class="t">to 4 steps, which is pretty amazing. So let's talk about that. And the paper is specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=813" target="_blank">00:13:33.440</a></span> | <span class="t">is this one progressive distillation for fast sampling of diffusion models. So it's only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=825" target="_blank">00:13:45.680</a></span> | <span class="t">been a week, so I haven't had much of a chance to try to explain this before. So apologies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=829" target="_blank">00:13:49.040</a></span> | <span class="t">in advance if this is awkward, but hopefully it's going to make some sense. What we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=835" target="_blank">00:13:55.160</a></span> | <span class="t">going to start with is so we're going to start with this process, which is gradually denoising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=847" target="_blank">00:14:07.680</a></span> | <span class="t">images and actually I wonder if we can copy it. Okay, so how are we going to get this down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=857" target="_blank">00:14:17.760</a></span> | <span class="t">from 60 steps to 4 steps? The basic idea is that we're going to do a process. We're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=872" target="_blank">00:14:32.520</a></span> | <span class="t">to do a process called distillation, which I have no idea how to spell, but hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=878" target="_blank">00:14:38.560</a></span> | <span class="t">that's close enough that you get the idea. Distillation is a process which is pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=883" target="_blank">00:14:43.640</a></span> | <span class="t">common in deep learning. And the basic idea of distillation is that you take something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=888" target="_blank">00:14:48.760</a></span> | <span class="t">called a teacher network, which is some neural network that already knows how to do something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=895" target="_blank">00:14:55.720</a></span> | <span class="t">but it might be slow and big. And the teacher network is then used by a student network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=903" target="_blank">00:15:03.400</a></span> | <span class="t">which tries to learn how to do the same thing, but faster or with less memory. And in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=910" target="_blank">00:15:10.640</a></span> | <span class="t">case, we want ours to be faster. We want to do less steps. And the way we can do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=917" target="_blank">00:15:17.000</a></span> | <span class="t">conceptually, it's actually, in my opinion, reasonably straightforward. We have. Like when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=929" target="_blank">00:15:29.840</a></span> | <span class="t">I look at this and I think like, wow, you know, neural nets are really amazing. So given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=934" target="_blank">00:15:34.920</a></span> | <span class="t">your own, it's really amazing. Why is it taking like 18 steps to go from there to there? Like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=947" target="_blank">00:15:47.640</a></span> | <span class="t">that seems like something that you should be able to do in one step. The fact that it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=953" target="_blank">00:15:53.440</a></span> | <span class="t">taking 18 steps and originally, of course, that was hundreds and hundreds of steps is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=960" target="_blank">00:16:00.480</a></span> | <span class="t">because it's kind of that's just a kind of a side effect of the math of how this thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=968" target="_blank">00:16:08.000</a></span> | <span class="t">was originally developed, you know, this idea of this diffusion process. But the idea in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=975" target="_blank">00:16:15.600</a></span> | <span class="t">this paper is something that actually we've, I think I might have even mentioned in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=980" target="_blank">00:16:20.840</a></span> | <span class="t">last lesson, it's something we were thinking of doing ourselves before this paper beat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=984" target="_blank">00:16:24.240</a></span> | <span class="t">us to it, which is to say, well, what if we train a new model where the model takes as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=992" target="_blank">00:16:32.760</a></span> | <span class="t">input this image, right, and puts it through some other unit, unit B. Okay. And then that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1012" target="_blank">00:16:52.360</a></span> | <span class="t">spits out some result. And what we do is we take that result and we compare it to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1023" target="_blank">00:17:03.200</a></span> | <span class="t">image, the thing we actually want. Because the nice thing is now, which we've never really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1028" target="_blank">00:17:08.980</a></span> | <span class="t">had before is we have for each intermediate output, like the desired goal where we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1033" target="_blank">00:17:13.720</a></span> | <span class="t">trying to get to. And so we could compare those two just using, you know, whatever means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1040" target="_blank">00:17:20.080</a></span> | <span class="t">squared error. Keep on forgetting to change my pen means squared error. And so then if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1049" target="_blank">00:17:29.280</a></span> | <span class="t">we keep doing this for lots and lots of images and lots of lots of pairs and exactly this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1053" target="_blank">00:17:33.240</a></span> | <span class="t">way, this unit is going to hopefully learn to take these incomplete images and turn them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1061" target="_blank">00:17:41.580</a></span> | <span class="t">into complete images. And that is exactly what this paper does. It just says, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1070" target="_blank">00:17:50.960</a></span> | <span class="t">now that we've got all these examples of showing what step 36 should turn into at step 54,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1078" target="_blank">00:17:58.720</a></span> | <span class="t">let's just feed those examples into a model. And that works. And you'd kind of expect it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1085" target="_blank">00:18:05.540</a></span> | <span class="t">to work because you can see that like a human would be able to look at this. And if they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1089" target="_blank">00:18:09.520</a></span> | <span class="t">were a competent artist, they could turn that into a, you know, a well finished product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1095" target="_blank">00:18:15.220</a></span> | <span class="t">So you would expect that a computer could as well. There are some little tweaks around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1101" target="_blank">00:18:21.240</a></span> | <span class="t">how it makes this work, which I will briefly describe because we need to be able to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1106" target="_blank">00:18:26.140</a></span> | <span class="t">from kind of step one through to step 10 through to step 20 and so forth. And so the way that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1119" target="_blank">00:18:39.540</a></span> | <span class="t">it does this, it's actually quite clever. What they do is they initially, so they take their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1125" target="_blank">00:18:45.020</a></span> | <span class="t">teacher model. So remember the teacher model is one that has already been trained. Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1130" target="_blank">00:18:50.100</a></span> | <span class="t">So the teacher model already is a complete stable diffusion model. That's finished. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1134" target="_blank">00:18:54.580</a></span> | <span class="t">take that as a given and we put in our image. Well, actually it's noise. We put in our noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1143" target="_blank">00:19:03.420</a></span> | <span class="t">right? And we put it through two time steps. Okay. And then we train our unit B or whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1153" target="_blank">00:19:13.780</a></span> | <span class="t">you want to call it to try to go directly from the noise to time step number two. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1160" target="_blank">00:19:20.940</a></span> | <span class="t">it's pretty easy for it to do. And so then what they do is they take this. Okay. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1166" target="_blank">00:19:26.660</a></span> | <span class="t">so this thing here, remember is called the student model. They then say, okay, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1173" target="_blank">00:19:33.100</a></span> | <span class="t">now take that student model and treat that as the new teacher. So they now take their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1180" target="_blank">00:19:40.940</a></span> | <span class="t">noise and they run it through the student model twice, once and twice, and they get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1189" target="_blank">00:19:49.900</a></span> | <span class="t">out something at the end. And so then they try to create a new student, which is a copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1197" target="_blank">00:19:57.700</a></span> | <span class="t">of the previous student, and it learns to go directly from the noise to two goes of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1202" target="_blank">00:20:02.940</a></span> | <span class="t">the student model. And you won't be surprised to hear they now take that new student model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1208" target="_blank">00:20:08.060</a></span> | <span class="t">and use that to go two goes. And then they learn, they use that. Then they copy that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1215" target="_blank">00:20:15.940</a></span> | <span class="t">to become the next student model. And so they're doing it again and again and again. And each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1221" target="_blank">00:20:21.100</a></span> | <span class="t">time they're basically doubling the amount of work. So it goes one to two, effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1225" target="_blank">00:20:25.380</a></span> | <span class="t">it's then going two to four and then four to eight. And that's basically what they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1231" target="_blank">00:20:31.260</a></span> | <span class="t">what they're doing. And they're doing it for multiple different time steps. So the single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1235" target="_blank">00:20:35.700</a></span> | <span class="t">student model is learning to both do these initial steps, trying to jump multiple steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1247" target="_blank">00:20:47.220</a></span> | <span class="t">at a time. And it's also learning to do these later steps, multiple steps at a time. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1256" target="_blank">00:20:56.620</a></span> | <span class="t">that's it, believe it or not. So this is this neat paper that came out last week. And that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1264" target="_blank">00:21:04.140</a></span> | <span class="t">how it works. Now I mentioned that there was actually two papers. The second one is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1273" target="_blank">00:21:13.720</a></span> | <span class="t">On Distillation of Guided Diffusion Models. And the trick now is this second paper, these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1285" target="_blank">00:21:25.440</a></span> | <span class="t">came out at basically the same time, if I remember correctly, even though they build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1288" target="_blank">00:21:28.940</a></span> | <span class="t">on each other from the same teams, is that they say, okay, this is all very well, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1297" target="_blank">00:21:37.100</a></span> | <span class="t">we don't just want to create random pictures. We want to be able to do guidance, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1306" target="_blank">00:21:46.100</a></span> | <span class="t">And you might remember, I hope you remember from last week that we used something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1309" target="_blank">00:21:49.540</a></span> | <span class="t">Classifier Free Guided Diffusion Models, which, because I'm lazy, we will just use an acronym,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1318" target="_blank">00:21:58.340</a></span> | <span class="t">Classifier Free Guided Diffusion Models. And this one, you may recall, we take, let's say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1327" target="_blank">00:22:07.540</a></span> | <span class="t">we want a cute puppy. We put in the prompt cute puppy into our clip text encoder, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1336" target="_blank">00:22:16.620</a></span> | <span class="t">that spits out an embedding. And we put that, let's ignore the VAE Latents business. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1349" target="_blank">00:22:29.020</a></span> | <span class="t">put that into our unit, but we also put the empty prompt into our clip text encoder. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1363" target="_blank">00:22:43.100</a></span> | <span class="t">concatenate these things too together so that then out the other side, we get back two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1369" target="_blank">00:22:49.820</a></span> | <span class="t">We get back the image of the cute puppy, and we get back the image of some arbitrary thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1378" target="_blank">00:22:58.420</a></span> | <span class="t">Could be anything. And then we effectively do something very much like taking the weighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1383" target="_blank">00:23:03.020</a></span> | <span class="t">average of these two things together, combine them. And then we use that for the next stage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1391" target="_blank">00:23:11.340</a></span> | <span class="t">of our diffusion process. Now, what this paper does is it says, this is all pretty awkward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1398" target="_blank">00:23:18.260</a></span> | <span class="t">We end up having to train two images instead of one. And for different types of levels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1403" target="_blank">00:23:23.740</a></span> | <span class="t">of guided diffusion, we have to do it multiple different times. It's all pretty annoying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1408" target="_blank">00:23:28.620</a></span> | <span class="t">How do we skip it? And based on the description of how we did it before, you may be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1414" target="_blank">00:23:34.260</a></span> | <span class="t">guess. What we do is we do exactly the same student-teacher distillation we did before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1424" target="_blank">00:23:44.020</a></span> | <span class="t">but this time we pass in, in addition, the guidance. And so again, we've got the entire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1436" target="_blank">00:23:56.300</a></span> | <span class="t">stable diffusion model, the teacher model available for us. And we are doing actual CFGD,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1447" target="_blank">00:24:07.980</a></span> | <span class="t">Classifier Free Guided Diffusion, to create our guided diffusion cute puppy pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1453" target="_blank">00:24:13.780</a></span> | <span class="t">And we're doing it for a range of different guidance scales. So you might be doing two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1457" target="_blank">00:24:17.940</a></span> | <span class="t">in 7.5 and 12 and whatever, right? And those now are becoming inputs to our student model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1469" target="_blank">00:24:29.140</a></span> | <span class="t">So the student model now has additional inputs. It's getting the noise as always. It's getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1476" target="_blank">00:24:36.980</a></span> | <span class="t">the caption or the prompt, I guess I should say, as always, but it's now also getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1483" target="_blank">00:24:43.500</a></span> | <span class="t">the guidance scale. And so it's learning to find out how all of these things are handled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1493" target="_blank">00:24:53.820</a></span> | <span class="t">by the teacher model. Like what does it do after a few steps each time? So it's exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1500" target="_blank">00:25:00.420</a></span> | <span class="t">the same thing as before, but now it's learning to use the Classifier Free Guided Diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1506" target="_blank">00:25:06.860</a></span> | <span class="t">as well. Okay. So that's got quite a lot going on there. And if it's a bit confusing, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1517" target="_blank">00:25:17.060</a></span> | <span class="t">okay. It is a bit confusing. And what I would recommend is you check out the extra information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1527" target="_blank">00:25:27.700</a></span> | <span class="t">from Jono who has a whole video on this. And one of the cool things actually about this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1531" target="_blank">00:25:31.620</a></span> | <span class="t">video is it's actually a paper walkthrough. And so part of this course is hopefully we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1536" target="_blank">00:25:36.620</a></span> | <span class="t">going to start reading papers together. Reading papers is extremely intimidating and overwhelming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1543" target="_blank">00:25:43.820</a></span> | <span class="t">for all of us, all of the time, at least for me, it never gets any better. There's a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1548" target="_blank">00:25:48.540</a></span> | <span class="t">of math. And by watching somebody like Jono, who's an expert at this stuff, read through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1554" target="_blank">00:25:54.940</a></span> | <span class="t">a paper, you'll kind of get a sense of how he is skipping over lots of the math, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1561" target="_blank">00:26:01.340</a></span> | <span class="t">To focus on, in this case, the really important thing, which is the actual algorithm. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1566" target="_blank">00:26:06.180</a></span> | <span class="t">when you actually look at the algorithm, you start to realize it's basically all stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1571" target="_blank">00:26:11.420</a></span> | <span class="t">nearly all stuff, maybe all stuff that you did in primary school or secondary school.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1575" target="_blank">00:26:15.940</a></span> | <span class="t">So we've got division, okay, sampling from a normal distribution, so high school, subtraction,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1583" target="_blank">00:26:23.420</a></span> | <span class="t">division, division, multiplication, right? Oh, okay, we've got a log there. But basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1590" target="_blank">00:26:30.020</a></span> | <span class="t">you know, there's not too much going on. And then when you look at the code, you'll find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1596" target="_blank">00:26:36.060</a></span> | <span class="t">that once you turn this into code, of course, it becomes even more understandable if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1600" target="_blank">00:26:40.260</a></span> | <span class="t">somebody who's more familiar with code, like me. So yeah, definitely check out Jono's video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1609" target="_blank">00:26:49.980</a></span> | <span class="t">on this. So another paper came out about three hours ago. And I just had to show you it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1622" target="_blank">00:27:02.900</a></span> | <span class="t">you because I think it's amazing. And so this is definitely the first video about this paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1632" target="_blank">00:27:12.100</a></span> | <span class="t">because yeah, only came out a few hours ago. But check this out. This is a paper called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1636" target="_blank">00:27:16.180</a></span> | <span class="t">iMagic. And with this algorithm, you can pass in an input image. This is just a, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1643" target="_blank">00:27:23.100</a></span> | <span class="t">a photo you've taken or downloaded off the internet. And then you pass in some text saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1648" target="_blank">00:27:28.340</a></span> | <span class="t">a bird spreading wings. And what it's going to try to do is it's going to try to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1652" target="_blank">00:27:32.060</a></span> | <span class="t">this exact bird in this exact pose and leave everything as similar as possible, but adjust</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1656" target="_blank">00:27:36.880</a></span> | <span class="t">it just enough so that the prompt is now matched. So here we take this, this little guy here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1665" target="_blank">00:27:45.100</a></span> | <span class="t">and we say, oh, this is actually what we want this to be a person giving the thumbs up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1669" target="_blank">00:27:49.460</a></span> | <span class="t">And this is what it produces. And you can see everything else is very, very similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1672" target="_blank">00:27:52.460</a></span> | <span class="t">to the previous picture. So this dog is not sitting. But if we put in the prompt, a sitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1679" target="_blank">00:27:59.980</a></span> | <span class="t">dog, it turns it into a sitting dog, leaving everything else as similar as possible. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1688" target="_blank">00:28:08.180</a></span> | <span class="t">here's an example of a waterfall. And then you say it's a children's drawing of a waterfall</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1691" target="_blank">00:28:11.740</a></span> | <span class="t">and now it's become a children's drawing. So lots of people in the YouTube chat going,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1696" target="_blank">00:28:16.340</a></span> | <span class="t">oh my God, this is amazing, which it absolutely is. And that's why we're going to show you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1699" target="_blank">00:28:19.580</a></span> | <span class="t">how it works. And one of the really amazing things is you're going to realize that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1703" target="_blank">00:28:23.540</a></span> | <span class="t">understand how it works already. Just to show you some more examples, here's the dog image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1709" target="_blank">00:28:29.940</a></span> | <span class="t">Here's the sitting dog, the jumping dog, dog playing with the toy, jumping dog holding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1716" target="_blank">00:28:36.880</a></span> | <span class="t">a frisbee. Okay. And here's this guy again, giving the thumbs up, crossed arms in a greeting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1725" target="_blank">00:28:45.020</a></span> | <span class="t">pose to namaste hands, holding a cup. So that's pretty amazing. So I had to show you how this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1736" target="_blank">00:28:56.380</a></span> | <span class="t">works. And I'm not going to go into too much detail, but I think we can get the idea actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1746" target="_blank">00:29:06.640</a></span> | <span class="t">pretty well. So what we do is again, we start with a fully pre-trained, ready to go generative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1760" target="_blank">00:29:20.860</a></span> | <span class="t">model like a stable diffusion model. And this is what this is talking about here, pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1767" target="_blank">00:29:27.380</a></span> | <span class="t">diffusion model. In the paper, they actually use a model called Imogen, but none of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1771" target="_blank">00:29:31.500</a></span> | <span class="t">details as far as I can see in any way depend on what the model is. It should work just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1775" target="_blank">00:29:35.900</a></span> | <span class="t">fine for stable diffusion. And we take a photo of a bird spreading wings. Okay. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1781" target="_blank">00:29:41.420</a></span> | <span class="t">our, that's our target. And we create an embedding from that using, for example, our clip encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1792" target="_blank">00:29:52.220</a></span> | <span class="t">as usual. And we then pass it through our pre-trained diffusion model. And we then see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1805" target="_blank">00:30:05.220</a></span> | <span class="t">what it creates. And it doesn't create something that's actually like our bird. So then what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1818" target="_blank">00:30:18.020</a></span> | <span class="t">they do is they fine-tune this embedding. So this is kind of like textual inversion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1823" target="_blank">00:30:23.820</a></span> | <span class="t">They fine-tune the embedding to try to make the diffusion model output something that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1830" target="_blank">00:30:30.420</a></span> | <span class="t">as similar as possible to the, to the input image. And so you can see here, they're saying,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1837" target="_blank">00:30:37.260</a></span> | <span class="t">oh, we're moving our embedding a little bit. They don't do this for very long. They just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1841" target="_blank">00:30:41.820</a></span> | <span class="t">want to move it a little bit in the right direction. And then now they lock that in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1846" target="_blank">00:30:46.900</a></span> | <span class="t">place and they say, okay, now let's fine-tune the entire diffusion model end to end, including</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1853" target="_blank">00:30:53.140</a></span> | <span class="t">the VAE or actually with Imogen, they have a super resolution model, but same idea. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1858" target="_blank">00:30:58.900</a></span> | <span class="t">we fine-tune the entire model end to end. And now the embedding, this optimized embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1864" target="_blank">00:31:04.020</a></span> | <span class="t">we created, we, we, we store in place. We don't change that at all. That's now frozen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1871" target="_blank">00:31:11.580</a></span> | <span class="t">And we try to make it so that the diffusion model now spits out our bird as close as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1882" target="_blank">00:31:22.140</a></span> | <span class="t">So you fine-tune that for a few epochs. And so you've now got something that takes this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1886" target="_blank">00:31:26.300</a></span> | <span class="t">embedding that we fine-tuned, goes through a fine-tuned model and spits out our bird.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1890" target="_blank">00:31:30.460</a></span> | <span class="t">And then finally, the original target embedding we actually wanted is a photo of a bird spreading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1897" target="_blank">00:31:37.060</a></span> | <span class="t">its wings. We ended up with this slightly different embedding and we take the weighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1902" target="_blank">00:31:42.620</a></span> | <span class="t">average of the two. That's called the interpolate step, the weighted average of the two. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1907" target="_blank">00:31:47.820</a></span> | <span class="t">pass that through this fine-tune diffusion model and we're done. And so that's pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1916" target="_blank">00:31:56.700</a></span> | <span class="t">amazing. This, this would not take, I don't think a particularly long time or require any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1923" target="_blank">00:32:03.020</a></span> | <span class="t">particular special hardware. It's the kind of thing I expect people will be doing, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1929" target="_blank">00:32:09.740</a></span> | <span class="t">in the coming days and weeks. But it's very interesting because, yeah, I mean, the ability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1934" target="_blank">00:32:14.860</a></span> | <span class="t">to take any photo of a person or whatever and change it, like literally change what the person's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1946" target="_blank">00:32:26.380</a></span> | <span class="t">doing is, you know, societally very important and really means that anybody I guess now can generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1960" target="_blank">00:32:40.380</a></span> | <span class="t">believable photos that never actually existed. I see John O in the chat saying it took</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1967" target="_blank">00:32:47.020</a></span> | <span class="t">about eight minutes to do it for Imogen on TPUs. Although Imogen is quite a slow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1974" target="_blank">00:32:54.620</a></span> | <span class="t">big model, although the TPUs they used were very, the latest TPUs. So might be, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1983" target="_blank">00:33:03.260</a></span> | <span class="t">maybe it's an hour or something for stable diffusion on GPUs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1987" target="_blank">00:33:07.740</a></span> | <span class="t">All right. So that is a lot of fun.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=1996" target="_blank">00:33:16.220</a></span> | <span class="t">All right. So with that, let's go back to our notebook where we left it last time. We had kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2010" target="_blank">00:33:30.700</a></span> | <span class="t">of looked at some applications that we can play with in this diffusion NBS repo, in the stable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2016" target="_blank">00:33:36.140</a></span> | <span class="t">diffusion notebook. And what we've got now, and to remind you, when I say we, it's mainly actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2025" target="_blank">00:33:45.020</a></span> | <span class="t">Pedro, Patrick and Suraj, just a little bit of help from me. So hugging face folks. What we/they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2032" target="_blank">00:33:52.700</a></span> | <span class="t">have done is they now dig into the pipeline to pull it all apart step by step. So you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2039" target="_blank">00:33:59.740</a></span> | <span class="t">exactly what happens. The first thing I was just going to mention is this is how you can create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2045" target="_blank">00:34:05.740</a></span> | <span class="t">those gradual denoising pictures. And this is thanks to something called the callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2053" target="_blank">00:34:13.980</a></span> | <span class="t">So you can say here, when you go through the pipeline, every 12 steps, call this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2061" target="_blank">00:34:21.980</a></span> | <span class="t">And as you can see, it's going to call it with I and T and the latents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2069" target="_blank">00:34:29.180</a></span> | <span class="t">And so then we can just make an image and stick it on the end of an array. And that's all that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2077" target="_blank">00:34:37.260</a></span> | <span class="t">happening here. So this is how you can start to interact with a pipeline without rewriting it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2085" target="_blank">00:34:45.420</a></span> | <span class="t">yourself from scratch. But now what we're going to do is we're actually going to write it, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2089" target="_blank">00:34:49.580</a></span> | <span class="t">going to build it from scratch. So you don't actually have to use a callback because you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2094" target="_blank">00:34:54.620</a></span> | <span class="t">be able to change it yourself. So let's take a look. So looking inside the pipeline, what exactly is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2103" target="_blank">00:35:03.500</a></span> | <span class="t">going on? So what's going to be going on in the pipeline is seeing all of the steps that we saw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2113" target="_blank">00:35:13.900</a></span> | <span class="t">in last week's OneNote notes that I drew. And it's going to be all the code. And we're not going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2120" target="_blank">00:35:20.860</a></span> | <span class="t">show the code of how each step is implemented. So for example, the clip text model we talked about,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2127" target="_blank">00:35:27.340</a></span> | <span class="t">the thing that takes as input a prompt and creates an embedding, we just take that as a given. So we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2134" target="_blank">00:35:34.860</a></span> | <span class="t">download it, open AI is trained one called clip, the IT large patch 14. So we just say from tree</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2141" target="_blank">00:35:41.980</a></span> | <span class="t">change. So hugging face will transformers will download and create that model for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2149" target="_blank">00:35:49.100</a></span> | <span class="t">Ditto for the tokenizer. And so ditto for the auto encoder, and ditto for the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2156" target="_blank">00:35:56.460</a></span> | <span class="t">So there they all are, we can just grab them. So we just take that all as a given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2161" target="_blank">00:36:01.500</a></span> | <span class="t">These are the three models that we've talked about, the text encoder, the clip encoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2167" target="_blank">00:36:07.020</a></span> | <span class="t">the VAE, and the unit. So there they are. So given that we now have those,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2176" target="_blank">00:36:16.540</a></span> | <span class="t">the next thing we need is that thing that converts time steps into the amount of noise. Remember that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2182" target="_blank">00:36:22.540</a></span> | <span class="t">graph we drew. And so we can basically, again, use something that hugging face,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2191" target="_blank">00:36:31.340</a></span> | <span class="t">well, actually, in this case, Catherine Carlson has already provided, which is a scheduler,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2197" target="_blank">00:36:37.580</a></span> | <span class="t">it's basically something that shows us that connection. So we've got that. So we use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2204" target="_blank">00:36:44.700</a></span> | <span class="t">scheduler. And we say how much noise when we're using. And so we have to make sure that that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2211" target="_blank">00:36:51.580</a></span> | <span class="t">matches. And so we just use these numbers that were given. Okay, so now to create our photograph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2219" target="_blank">00:36:59.260</a></span> | <span class="t">of astronaut riding a horse again, in 70 steps with a 7.5 guide and scale, batch size of one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2228" target="_blank">00:37:08.380</a></span> | <span class="t">step number one is to take our prompt and tokenize it. Okay, so we looked at that in part one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2236" target="_blank">00:37:16.060</a></span> | <span class="t">course. So check that out if you can't remember what tokenizing does, but it's just splitting it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2240" target="_blank">00:37:20.620</a></span> | <span class="t">in basically splitting it into words, or subword units if they're long and unusual words. So here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2246" target="_blank">00:37:26.860</a></span> | <span class="t">are so this will be the start the start of sentence token, and this will be a photograph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2252" target="_blank">00:37:32.620</a></span> | <span class="t">of an astronaut, etc. And then you can see the same token is repeated again again at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2258" target="_blank">00:37:38.380</a></span> | <span class="t">That's just the padding to say we're all done. And the reason for that is that GPUs and TPUs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2265" target="_blank">00:37:45.340</a></span> | <span class="t">really like to do lots of things at once. So we kind of have everything be the same length by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2271" target="_blank">00:37:51.820</a></span> | <span class="t">padding them. That may sound like a lot of wasted work, which it kind of is. But a GPU would rather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2278" target="_blank">00:37:58.620</a></span> | <span class="t">do lots of things at the same time on exactly the same sized input. So this is why we have all this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2283" target="_blank">00:38:03.660</a></span> | <span class="t">padding. So you can see here if we decode that number, it's the end of text marker, just just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2291" target="_blank">00:38:11.340</a></span> | <span class="t">padding really in this case. As well as getting the input IDs, so these are just lookups into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2298" target="_blank">00:38:18.620</a></span> | <span class="t">vocabulary. There's also a mask, which is just telling it which ones are actual words as opposed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2305" target="_blank">00:38:25.500</a></span> | <span class="t">to padding, which is not very interesting. So we can now take those input IDs, we can put them on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2315" target="_blank">00:38:35.180</a></span> | <span class="t">the GPU, and we can run them through the clip encoder. And so for a batch size of one, so you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2323" target="_blank">00:38:43.180</a></span> | <span class="t">got one image that gives us back a 77 by 768, because we've got 77 here. And each one of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2334" target="_blank">00:38:54.620</a></span> | <span class="t">creates a 768 long vector. So we've got a 77 by 768 tensor. So these are the embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2341" target="_blank">00:39:01.820</a></span> | <span class="t">for a photograph of an astronaut riding a horse that come from clip. So remember,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2348" target="_blank">00:39:08.540</a></span> | <span class="t">everything's pre-trained. So that's all done for us. We're just doing inference. And so remember,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2355" target="_blank">00:39:15.340</a></span> | <span class="t">for the classifier free guidance, we also need the embeddings for the empty string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2363" target="_blank">00:39:23.500</a></span> | <span class="t">So we do exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2376" target="_blank">00:39:36.540</a></span> | <span class="t">So now we just concatenate those two together, because this is just a trick to get the GPU to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2382" target="_blank">00:39:42.380</a></span> | <span class="t">do both at the same time, because we like the GPU to do as many things at once as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2386" target="_blank">00:39:46.220</a></span> | <span class="t">And so now we create our noise. And because we're doing it with a VAE, we can call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2396" target="_blank">00:39:56.380</a></span> | <span class="t">Latents, but it's just noise, really. I wonder if you'd still call it that without the VAE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2403" target="_blank">00:40:03.340</a></span> | <span class="t">Maybe you would have to think about that. So that's just random numbers normally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2409" target="_blank">00:40:09.180</a></span> | <span class="t">generated, normally distributed random numbers of size one, that's our batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2414" target="_blank">00:40:14.140</a></span> | <span class="t">And the reason that we've got this divided by eight here is because that's what the VAE does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2420" target="_blank">00:40:20.220</a></span> | <span class="t">It allows us to create things that are eight times smaller by height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2424" target="_blank">00:40:24.700</a></span> | <span class="t">And then it's going to expand it up again for us later. That's why this is so much faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2430" target="_blank">00:40:30.700</a></span> | <span class="t">You'll see a lot of this after we put it on the GPU, you'll see a lot of this dot half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2434" target="_blank">00:40:34.620</a></span> | <span class="t">This is converting things into what's called half precision or FB 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2439" target="_blank">00:40:39.580</a></span> | <span class="t">Details don't matter too much. It's just making it half as big in memory by using less precision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2445" target="_blank">00:40:45.740</a></span> | <span class="t">Modern GPUs are much, much, much, much faster if we do that. So you'll see that a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2451" target="_blank">00:40:51.500</a></span> | <span class="t">If you use something like fast AI, you don't have to worry about it, but all this stuff is done for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2456" target="_blank">00:40:56.780</a></span> | <span class="t">you. And we'll see that later as we rebuild this with much, much less code later in the course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2462" target="_blank">00:41:02.060</a></span> | <span class="t">So we'll be building our own kind of framework from scratch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2467" target="_blank">00:41:07.740</a></span> | <span class="t">which you'll then be able to maintain and work with yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2472" target="_blank">00:41:12.780</a></span> | <span class="t">Okay, so we have to say we want to do 70 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2476" target="_blank">00:41:16.060</a></span> | <span class="t">Something that's very important, we won't worry too much about the details right now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2483" target="_blank">00:41:23.740</a></span> | <span class="t">but what you see here is that we take our random noise and we scale it. And that's because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2489" target="_blank">00:41:29.740</a></span> | <span class="t">depending on what stage you're up to, you need to make sure that you have the right amount of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2496" target="_blank">00:41:36.860</a></span> | <span class="t">variance, basically. Otherwise you're going to get activations and gradients that go out of control.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2502" target="_blank">00:41:42.940</a></span> | <span class="t">This is something we're going to be talking about a huge amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2505" target="_blank">00:41:45.580</a></span> | <span class="t">during this course, and we'll show you lots of tricks to handle that kind of thing automatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2510" target="_blank">00:41:50.860</a></span> | <span class="t">Unfortunately at the moment in the stable diffusion world, this is all done in rather,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2516" target="_blank">00:41:56.940</a></span> | <span class="t">in my opinion, kind of ways that are too tied to the details of the model. I think we will be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2524" target="_blank">00:42:04.620</a></span> | <span class="t">to improve it as the course goes on, but for now we'll stick with how everybody else is doing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2530" target="_blank">00:42:10.220</a></span> | <span class="t">This is how they do it. So we're going to be jumping through. So normally it would take a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2535" target="_blank">00:42:15.740</a></span> | <span class="t">thousand time steps, but because we're using a fancy scheduler, we get to skip from 999 to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2541" target="_blank">00:42:21.660</a></span> | <span class="t">984, 984 to 970, and so forth. So we're going down about 14 time steps. And remember, this is a very,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2548" target="_blank">00:42:28.460</a></span> | <span class="t">very, very unfortunate word. They're not time steps at all. In fact, they're not even integers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2553" target="_blank">00:42:33.420</a></span> | <span class="t">It's just a measure of how much noise are we adding at each time, and you find out how much noise by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2561" target="_blank">00:42:41.500</a></span> | <span class="t">looking it up on this graph. Okay. That's all time step means. It's not a step of time, and it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2567" target="_blank">00:42:47.740</a></span> | <span class="t">real shame that that word is used because it's incredibly confusing. This is much more helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2573" target="_blank">00:42:53.660</a></span> | <span class="t">This is the actual amount of noise at each one of those iterations. And so here you can see the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2582" target="_blank">00:43:02.140</a></span> | <span class="t">amount of noise for each of those time steps, and we're going to be going backwards. As you can see,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2591" target="_blank">00:43:11.100</a></span> | <span class="t">we start at 999, so we'll start with lots of noise, and then we'll be using less and less and less and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2595" target="_blank">00:43:15.900</a></span> | <span class="t">less noise. So we go through the 70 time steps in a for loop, concatenating our two noise bits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2610" target="_blank">00:43:30.380</a></span> | <span class="t">together, because we've got the classifier free and the prompt versions, do our scaling,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2619" target="_blank">00:43:39.500</a></span> | <span class="t">calculate our predictions from the unit, and notice here we're passing in the time step,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2624" target="_blank">00:43:44.460</a></span> | <span class="t">as well as our prompt. That's going to return two things, the unconditional prediction,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2631" target="_blank">00:43:51.980</a></span> | <span class="t">so that's the one for the empty string. Remember, we passed in one of the two things we passed in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2637" target="_blank">00:43:57.180</a></span> | <span class="t">was the empty string. So we concatenated them together, and so after they come out of the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2644" target="_blank">00:44:04.220</a></span> | <span class="t">we can pull them apart again. So dot chunk just means pull them apart into two separate variables,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2649" target="_blank">00:44:09.580</a></span> | <span class="t">and then we can do the guide and scale that we talked about last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2654" target="_blank">00:44:14.140</a></span> | <span class="t">And so now we can do that update where we take a little bit of the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2663" target="_blank">00:44:23.660</a></span> | <span class="t">and remove it to give us our new latents. So that's the loop. And so at the end of all that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2673" target="_blank">00:44:33.740</a></span> | <span class="t">we decode it in the VAE. The paper that created this VAE tells us that we have to divide it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2681" target="_blank">00:44:41.180</a></span> | <span class="t">this number to scale it correctly. And once we've done that, that gives us a number which is between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2688" target="_blank">00:44:48.620</a></span> | <span class="t">negative one and one. Python imaging library expects something between zero and one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2696" target="_blank">00:44:56.860</a></span> | <span class="t">so that's what we do here to make it between zero and one and enforce that to be true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2702" target="_blank">00:45:02.460</a></span> | <span class="t">Put that back on the CPU, make sure it's that the order of the dimensions is the same as what Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2708" target="_blank">00:45:08.780</a></span> | <span class="t">imaging library expects, and then finally convert it up to between zero and 255 as an int,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2716" target="_blank">00:45:16.220</a></span> | <span class="t">which is actually what PIO really wants. And there's our picture. So there's all the steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2726" target="_blank">00:45:26.620</a></span> | <span class="t">So what I then did, this is kind of like, so the way I normally build code, I use notebooks for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2734" target="_blank">00:45:34.860</a></span> | <span class="t">everything, is I kind of do things step by step by step, and then I tend to kind of copy them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2740" target="_blank">00:45:40.460</a></span> | <span class="t">and I use shift M. I don't know if you've seen that, but what shift M does, it takes two cells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2746" target="_blank">00:45:46.460</a></span> | <span class="t">and combines them like that. And so I basically combined some of the cells together, and I removed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2753" target="_blank">00:45:53.820</a></span> | <span class="t">a bunch of the the pros, so you can see the entire thing on one screen. And what I was trying to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2764" target="_blank">00:46:04.620</a></span> | <span class="t">here is I'd like to get to the point where I've got something which I can very quickly do experiments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2769" target="_blank">00:46:09.420</a></span> | <span class="t">with. So maybe I want to try some different approach to guidance tree classification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2773" target="_blank">00:46:13.820</a></span> | <span class="t">maybe I want to add some callbacks, so on and so forth. So I kind of like to have everything,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2782" target="_blank">00:46:22.540</a></span> | <span class="t">you know, I like to have all of my important code be able to fit into my screen at once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2788" target="_blank">00:46:28.300</a></span> | <span class="t">And so you can see now I do, I've got the whole thing on my screen, so I can keep it all in my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2792" target="_blank">00:46:32.380</a></span> | <span class="t">head. One thing I was playing around with was I was trying to understand the actual guidance tree</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2801" target="_blank">00:46:41.340</a></span> | <span class="t">equation in terms of like how does it work. Computer scientists tend to write things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2810" target="_blank">00:46:50.220</a></span> | <span class="t">and software engineers with kind of long words as variable names. Mathematicians tend to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2815" target="_blank">00:46:55.820</a></span> | <span class="t">short just letters normally. For me, when I want to play around with stuff like that, I turn stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2821" target="_blank">00:47:01.580</a></span> | <span class="t">back into letters. And that's because I actually kind of pulled out one note and I started jutting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2826" target="_blank">00:47:06.540</a></span> | <span class="t">down this equation and playing around with it to understand how it behaves. So this is just like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2833" target="_blank">00:47:13.900</a></span> | <span class="t">it's not better or worse, it's just depending on what you're doing. So actually here I said, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2838" target="_blank">00:47:18.860</a></span> | <span class="t">g is guidance scale. And then rather than having the unconditional and text embeddings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2844" target="_blank">00:47:24.940</a></span> | <span class="t">I just call them u and t. And now I've got this all down into an equation which I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2849" target="_blank">00:47:29.420</a></span> | <span class="t">write down in a notebook and play with and understand exactly how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2852" target="_blank">00:47:32.860</a></span> | <span class="t">So that's something I find really helpful for working with this kind of code is to, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2860" target="_blank">00:47:40.700</a></span> | <span class="t">turn it into a form that I can manipulate algebraically more easily. I also try to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2866" target="_blank">00:47:46.140</a></span> | <span class="t">it look as much like the paper that I'm implementing as possible. Anyways, that's that code. So then I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2872" target="_blank">00:47:52.860</a></span> | <span class="t">copied all this again and I basically, oh, I actually did it for two prompts this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2879" target="_blank">00:47:59.420</a></span> | <span class="t">I thought this was fun. While you're painting an astronaut riding a horse in the style of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2883" target="_blank">00:48:03.340</a></span> | <span class="t">Grant Wood, just to remind you, Grant Wood looks like this. Not obviously astronaut material,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2895" target="_blank">00:48:15.500</a></span> | <span class="t">which I thought would make it actually kind of particularly interesting. Although he does have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2899" target="_blank">00:48:19.500</a></span> | <span class="t">horses. I can't see one here. Some of his pictures have horses. So because I did two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2907" target="_blank">00:48:27.820</a></span> | <span class="t">prompts, I got back two pictures I could do. So here's the Grant Wood one. I don't know what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2913" target="_blank">00:48:33.340</a></span> | <span class="t">going on in his back here, but I think it's quite nice. So yeah, I then copied that whole thing again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2919" target="_blank">00:48:39.980</a></span> | <span class="t">and merged them all together and then just put it into a function. So I took the little bit which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2928" target="_blank">00:48:48.540</a></span> | <span class="t">creates an image and put that into a function. I took the bit which does the tokenizing and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2935" target="_blank">00:48:55.020</a></span> | <span class="t">text encoding and put that into a function. And so now all of the code necessary to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2941" target="_blank">00:49:01.340</a></span> | <span class="t">the whole thing from top to bottom fits in these two cells, which makes it for me much easier to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2950" target="_blank">00:49:10.300</a></span> | <span class="t">see exactly what's going on. So you can see I've got the text embeddings. I've got the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2956" target="_blank">00:49:16.860</a></span> | <span class="t">unconditional embeddings. I've got the embeddings which can catenate the two together,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2960" target="_blank">00:49:20.220</a></span> | <span class="t">optional random seed, my latents, and then the loop itself. And you'll also see something I do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2972" target="_blank">00:49:32.700</a></span> | <span class="t">which is a bit different to a lot of software engineering is I often create things which are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2976" target="_blank">00:49:36.780</a></span> | <span class="t">kind of like longer lines because I try to have each line be kind of like mathematically one thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2984" target="_blank">00:49:44.620</a></span> | <span class="t">that I want to be able to think about as a whole. So yeah, these are some differences between kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2990" target="_blank">00:49:50.300</a></span> | <span class="t">the way I find numerical programming works well compared to the way I would write a more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=2996" target="_blank">00:49:56.060</a></span> | <span class="t">traditional software engineering approach. And again, this is partly a personal preference,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3001" target="_blank">00:50:01.100</a></span> | <span class="t">but it's something I find works well for me. So we're now at a point where we've got, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3006" target="_blank">00:50:06.300</a></span> | <span class="t">two fun, three functions that easily fit on the screen and do everything. So I can now just say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3011" target="_blank">00:50:11.500</a></span> | <span class="t">make samples and display each image. And so this is something for you to experiment with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3021" target="_blank">00:50:21.660</a></span> | <span class="t">And what I specifically suggest as homework is to try picking one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3032" target="_blank">00:50:32.860</a></span> | <span class="t">extra tricks we learned about like image to image or negative prompts. Negative prompts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3039" target="_blank">00:50:39.340</a></span> | <span class="t">would be a nice easy one like see if you can implement negative prompt in your version of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3048" target="_blank">00:50:48.780</a></span> | <span class="t">Or yeah, try doing image to image. That wouldn't be too hard either. Another one you can add is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3060" target="_blank">00:51:00.220</a></span> | <span class="t">try adding callbacks. And the nice thing is then, you know, you've got code which you fully understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3067" target="_blank">00:51:07.900</a></span> | <span class="t">because you know what all the lines do. And you then don't need to wait for the diffusers folks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3076" target="_blank">00:51:16.460</a></span> | <span class="t">to update it. The library to do is, for example, the callbacks are only added like a week ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3082" target="_blank">00:51:22.140</a></span> | <span class="t">So until then you couldn't do callbacks. Well, now you don't have to wait for the diffusers team</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3086" target="_blank">00:51:26.140</a></span> | <span class="t">to add something. The code's all here for you to play with. So that's my recommendation as a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3092" target="_blank">00:51:32.380</a></span> | <span class="t">of homework for this week. Okay, so that brings us to the end of our rapid overview of stable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3107" target="_blank">00:51:47.420</a></span> | <span class="t">diffusion and some very recent papers that very significantly developed stable diffusion. I hope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3113" target="_blank">00:51:53.180</a></span> | <span class="t">that's given you a good sense of the kind of very high level slightly hand wavy version of all this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3120" target="_blank">00:52:00.940</a></span> | <span class="t">and you can actually get started playing with some fun code. What we're going to be doing next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3126" target="_blank">00:52:06.540</a></span> | <span class="t">is going right back to the start, learning how to multiply two matrices together effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3134" target="_blank">00:52:14.860</a></span> | <span class="t">and then gradually building from there until we've got to the point that we've rebuilt all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3139" target="_blank">00:52:19.180</a></span> | <span class="t">this from scratch and we understand why things work the way they do, understand how to debug</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3144" target="_blank">00:52:24.300</a></span> | <span class="t">problems, improve performance and implement new research papers as well. So that's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3152" target="_blank">00:52:32.380</a></span> | <span class="t">very exciting. And so we're going to have a break and I will see you back here in 10 minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3165" target="_blank">00:52:45.660</a></span> | <span class="t">Okay, welcome back everybody. I'm really excited about the next part of this. It's going to require</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3173" target="_blank">00:52:53.100</a></span> | <span class="t">some serious tenacity and a certain amount of patience. But I think you're going to learn a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3182" target="_blank">00:53:02.620</a></span> | <span class="t">A lot of folks I've spoken to have said that previous iterations of this part of the course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3190" target="_blank">00:53:10.060</a></span> | <span class="t">is like the best course they've ever done. And this one's going to be dramatically better than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3194" target="_blank">00:53:14.620</a></span> | <span class="t">any previous version we've done of this. So hopefully you'll find that the hard work and patience</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3202" target="_blank">00:53:22.620</a></span> | <span class="t">pays off. We're working now through the course 22 p2 repo. So 2022 course part two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3213" target="_blank">00:53:33.500</a></span> | <span class="t">And notebooks are ordered. So we'll start with notebook number one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3220" target="_blank">00:53:40.940</a></span> | <span class="t">And okay, so the goal is to get to stable diffusion from the foundations, which means we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3229" target="_blank">00:53:49.020</a></span> | <span class="t">have to define what are the foundations. So I've decided to define them as follows. We're allowed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3236" target="_blank">00:53:56.060</a></span> | <span class="t">to use Python. We're allowed to use the Python standard library. So that's all the stuff that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3241" target="_blank">00:54:01.500</a></span> | <span class="t">comes with Python by default. We're allowed to use matplotlib because I couldn't be bothered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3247" target="_blank">00:54:07.100</a></span> | <span class="t">creating my own plotting library. And we're allowed to use Jupyter notebooks and NBDev,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3253" target="_blank">00:54:13.420</a></span> | <span class="t">which is something that creates modules from notebooks. So basically what we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3259" target="_blank">00:54:19.340</a></span> | <span class="t">try to do is to rebuild everything starting from this foundation. Now, to be clear,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3267" target="_blank">00:54:27.980</a></span> | <span class="t">what we are allowed to use are the libraries once we have reimplemented them correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3276" target="_blank">00:54:36.060</a></span> | <span class="t">And so if we reimplement something from NumPy or PyTorch or whatever, we're then allowed to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3283" target="_blank">00:54:43.020</a></span> | <span class="t">the NumPy or PyTorch or whatever version. Sometimes we'll be creating things that haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3290" target="_blank">00:54:50.700</a></span> | <span class="t">been created before. And that's then going to be becoming our own library. And we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3296" target="_blank">00:54:56.860</a></span> | <span class="t">calling that library mini AI. So we're going to be building our own little framework as we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3303" target="_blank">00:55:03.740</a></span> | <span class="t">So, for example, here are some imports. And these imports all come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3308" target="_blank">00:55:08.540</a></span> | <span class="t">from the Python standard library, except for these two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3312" target="_blank">00:55:12.300</a></span> | <span class="t">Now, to be clear, one challenge we have is that the models we use in stable diffusion were trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3324" target="_blank">00:55:24.300</a></span> | <span class="t">on millions of dollars worth of equipment for months, which we don't have the time or money.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3331" target="_blank">00:55:31.740</a></span> | <span class="t">So another trick we're going to do is we're going to create smaller identical but smaller versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3338" target="_blank">00:55:38.860</a></span> | <span class="t">of them. And so once we've got them working, we'll then be allowed to use the big pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3344" target="_blank">00:55:44.540</a></span> | <span class="t">versions. So that's the basic idea. So we're going to have to end up with our own VAE,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3350" target="_blank">00:55:50.380</a></span> | <span class="t">our own unit, our own clip encoder, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3359" target="_blank">00:55:59.020</a></span> | <span class="t">To some degree, I am assuming that you've completed part one of the course. To some degree,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3365" target="_blank">00:56:05.500</a></span> | <span class="t">I will cover everything at least briefly. But if I cover something about deep learning too fast for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3373" target="_blank">00:56:13.100</a></span> | <span class="t">you to know what's going on and you get lost, go back and watch part one, or go and Google for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3381" target="_blank">00:56:21.740</a></span> | <span class="t">that term. For stuff that we haven't covered in part one, I will go over it very thoroughly and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3387" target="_blank">00:56:27.340</a></span> | <span class="t">carefully. All right. So I'm going to assume that you know the basic idea, which is that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3397" target="_blank">00:56:37.420</a></span> | <span class="t">to need to be doing some matrix multiplication. So we're going to try to take a deep dive into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3403" target="_blank">00:56:43.820</a></span> | <span class="t">matrix multiplication today. And we're going to need some input data. And I quite like working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3409" target="_blank">00:56:49.900</a></span> | <span class="t">with MNIST data. MNIST is handwritten digits. It's a classic data set. They're 28 by 28 pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3424" target="_blank">00:57:04.380</a></span> | <span class="t">grayscale images. And so we can download them from this URL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3435" target="_blank">00:57:15.980</a></span> | <span class="t">So we use the path libs path object a lot. It's part of Python. And it basically takes a string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3443" target="_blank">00:57:23.100</a></span> | <span class="t">and turns it into something that you can treat as a path. For example, you can use slash to mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3448" target="_blank">00:57:28.460</a></span> | <span class="t">this file inside this subdirectory. So this is how we create a path object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3454" target="_blank">00:57:34.140</a></span> | <span class="t">Path objects have, for example, a make directory method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3463" target="_blank">00:57:43.340</a></span> | <span class="t">So I like to get everything set up. But I want to be able to rerun this cell lots of times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3468" target="_blank">00:57:48.940</a></span> | <span class="t">and not give me errors if I run it more than once. If I run it a second time, it still works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3475" target="_blank">00:57:55.100</a></span> | <span class="t">And in that case, that's because I put this exist OK equals true. How did I know that I can say--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3480" target="_blank">00:58:00.460</a></span> | <span class="t">because otherwise, it would try to make the directory. It would already exist in a given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3483" target="_blank">00:58:03.820</a></span> | <span class="t">error. How do I know what parameters I can pass to make dir? I just press shift tab. And so when I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3490" target="_blank">00:58:10.540</a></span> | <span class="t">hit shift tab, it tells me what options there are. If I press it a few times, it'll actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3498" target="_blank">00:58:18.460</a></span> | <span class="t">pop it down to the bottom of the screen to remind me. I can press escape to get rid of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3505" target="_blank">00:58:25.020</a></span> | <span class="t">Or you can just-- or else you can just hit tab inside. And it'll list all the things you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3517" target="_blank">00:58:37.900</a></span> | <span class="t">type here, as you can see. All right. So we need to grab this URL. And so Python comes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3532" target="_blank">00:58:52.620</a></span> | <span class="t">with something for doing that, which is the URL lib library that's part of Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3539" target="_blank">00:58:59.340</a></span> | <span class="t">that has something called URL retrieve. And something which I'm always a bit surprised</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3545" target="_blank">00:59:05.020</a></span> | <span class="t">is not widely used as people reading the Python documentation. So you should do that a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3551" target="_blank">00:59:11.580</a></span> | <span class="t">So if I click on that, here is the documentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3559" target="_blank">00:59:19.340</a></span> | <span class="t">for URL retrieve. And so I can find exactly what it can take. And I can learn about exactly what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3573" target="_blank">00:59:33.980</a></span> | <span class="t">it does. And so I read the documentation from the Python docs for every single method I use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3588" target="_blank">00:59:48.460</a></span> | <span class="t">And I look at every single option that it takes. And then I practice with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3593" target="_blank">00:59:53.420</a></span> | <span class="t">And to practice with it, I practice inside Jupyter. So if I want this import on its own,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3607" target="_blank">01:00:07.660</a></span> | <span class="t">I can hit Control-Shift- and it's going to spit it into two cells. And then I'll hit Alt-Enter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3616" target="_blank">01:00:16.300</a></span> | <span class="t">or Option-Enter so I can create something underneath. And I can type URL retrieve, Shift-Tab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3622" target="_blank">01:00:22.700</a></span> | <span class="t">And so there it all is. If I'm like way down somewhere in the notebook and I have no idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3632" target="_blank">01:00:32.540</a></span> | <span class="t">where URL retrieve comes from, I can just hit Shift-Enter. And it actually tells me exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3638" target="_blank">01:00:38.140</a></span> | <span class="t">where it comes from. And if I want to know more about it, I can just hit Question Mark,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3643" target="_blank">01:00:43.340</a></span> | <span class="t">Shift-Enter, and it's going to give me the documentation. And most cool of all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3649" target="_blank">01:00:49.900</a></span> | <span class="t">second question mark, and it gives me the full source code. And you can see it's not a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3658" target="_blank">01:00:58.460</a></span> | <span class="t">You know, reading the source code of Python standard library stuff is often quite revealing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3663" target="_blank">01:01:03.260</a></span> | <span class="t">And you can see exactly how they do it. And that's a great way to learn more about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3672" target="_blank">01:01:12.940</a></span> | <span class="t">more about this. So in this case, I'm just going to use a very simple functionality,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3684" target="_blank">01:01:24.300</a></span> | <span class="t">which is I'm going to say the URL to retrieve and the file name to save it as.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3688" target="_blank">01:01:28.540</a></span> | <span class="t">And again, I made it so I can run this multiple times. So it's only going to do the URL retrieve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3696" target="_blank">01:01:36.460</a></span> | <span class="t">if the path doesn't exist. If I've already downloaded it, I don't want to download it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3701" target="_blank">01:01:41.580</a></span> | <span class="t">So I run that cell. And notice that I can put exclamation mark, followed by a line of bash.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3709" target="_blank">01:01:49.980</a></span> | <span class="t">And it actually runs this using bash.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3714" target="_blank">01:01:54.220</a></span> | <span class="t">If you're using Windows, this won't work. And I would very, very strongly suggest if you're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3726" target="_blank">01:02:06.780</a></span> | <span class="t">Windows, use WSL. And if you use WSL, all of these notebooks will work perfectly. So yeah, do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3734" target="_blank">01:02:14.860</a></span> | <span class="t">Or write it on paper space or Lambda Labs or something like that, Colab, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3739" target="_blank">01:02:19.980</a></span> | <span class="t">Okay, so this is a gzip file. So thankfully, Python comes with a gzip module. Python comes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3751" target="_blank">01:02:31.580</a></span> | <span class="t">with quite a lot, actually. And so we can open a gzip file using gzip.open. And we can pass in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3757" target="_blank">01:02:37.980</a></span> | <span class="t">the path. And we'll say we're going to read it as binary as opposed to text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3763" target="_blank">01:02:43.580</a></span> | <span class="t">Okay, so this is called a context manager. It's a with clause. And what it's going to do is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3771" target="_blank">01:02:51.340</a></span> | <span class="t">going to open up this gzip file. The gzip object will be called f. And then it runs everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3779" target="_blank">01:02:59.100</a></span> | <span class="t">inside the block. And when it's done, it will close the file. So with blocks can do all kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3786" target="_blank">01:03:06.540</a></span> | <span class="t">of different things. But in general, with blocks that involve files are going to close the file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3791" target="_blank">01:03:11.660</a></span> | <span class="t">automatically for you. So we can now do that. And so you can see it's opened up the gzip file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3798" target="_blank">01:03:18.860</a></span> | <span class="t">And the gzip file contains what's called pickle objects. Pickled objects is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3806" target="_blank">01:03:26.060</a></span> | <span class="t">Python objects that have been saved to disk. It's the main way that people in pure Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3812" target="_blank">01:03:32.220</a></span> | <span class="t">save stuff. And it's part of the standard library. So this is how we load in from that file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3819" target="_blank">01:03:39.260</a></span> | <span class="t">Now, the file contains a tuple of tuples. So when you put a tuple on the left hand side of an equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3826" target="_blank">01:03:46.460</a></span> | <span class="t">sign, it's quite neat. It allows us to put the first tuple into two variables called x_train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3831" target="_blank">01:03:51.660</a></span> | <span class="t">and y_train and the second into x_valid and y_valid. This trick here where you put stuff like this on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3839" target="_blank">01:03:59.180</a></span> | <span class="t">the left is called destructuring. And it's a super handy way to make your code kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3847" target="_blank">01:04:07.020</a></span> | <span class="t">clear and concise. And lots of languages support that, including Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3855" target="_blank">01:04:15.340</a></span> | <span class="t">Okay. So we've now got some data. And so we can have a look at it. Now, it's a bit tricky</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3862" target="_blank">01:04:22.380</a></span> | <span class="t">because we're not allowed to use NumPy according to our rules. But unfortunately, this actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3866" target="_blank">01:04:26.540</a></span> | <span class="t">comes as NumPy. So I've turned it into a list. All right. So I've taken the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3874" target="_blank">01:04:34.140</a></span> | <span class="t">image and I've turned it into a list. And so we can look at a few examples of some values in that list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3884" target="_blank">01:04:44.380</a></span> | <span class="t">And here they are. So it looks like they're numbers between zero and one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3887" target="_blank">01:04:47.420</a></span> | <span class="t">And this is what I do when I learn about a new dataset. So when I started writing this notebook,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3896" target="_blank">01:04:56.620</a></span> | <span class="t">what you see here, other than the pros here, is what I actually did when I was working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3904" target="_blank">01:05:04.540</a></span> | <span class="t">with this data. I wanted to know what it was. So I just grab a little bit of it and look at it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3914" target="_blank">01:05:14.140</a></span> | <span class="t">So I kind of got a sense now of what it is. Now, interestingly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3920" target="_blank">01:05:20.060</a></span> | <span class="t">it's 784. This image is 784 long list. Oh, dear. People freaking out in the comments. No NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3939" target="_blank">01:05:39.980</a></span> | <span class="t">Yeah. No NumPy. Do you see NumPy? No NumPy. Why 784? What is that? Well, that's because these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3947" target="_blank">01:05:47.500</a></span> | <span class="t">28 by 28 images. So it's just a flat list here of 784 long. So how do I turn this 784 long thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3957" target="_blank">01:05:57.340</a></span> | <span class="t">into 28 by 28? So I want a list of 28 lists of 28, basically, because we don't have matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3965" target="_blank">01:06:05.820</a></span> | <span class="t">So how do we do that? And so we're going to be learning a lot of cool stuff in Python here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3971" target="_blank">01:06:11.100</a></span> | <span class="t">Sorry, I can't stop laughing at all the stuff in our chat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3975" target="_blank">01:06:15.580</a></span> | <span class="t">Oh, dear. People are quite reasonably freaking out. That's okay. We'll get there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3984" target="_blank">01:06:24.300</a></span> | <span class="t">I promise. I hope. Otherwise, I'll embarrass myself. All right. So how do I convert a 784</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=3993" target="_blank">01:06:33.580</a></span> | <span class="t">long list into 28 lists, 28 long list of 28 long lists? I'm going to use something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4003" target="_blank">01:06:43.740</a></span> | <span class="t">chunks. And first of all, I'll show you what this thing does. And then I'll show you how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4007" target="_blank">01:06:47.340</a></span> | <span class="t">So vowels is currently a list of 10 things. Now, if I take vowels and I pass it to chunks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4016" target="_blank">01:06:56.780</a></span> | <span class="t">with five, it creates two lists of five. Here's list number one of five elements. And here's list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4023" target="_blank">01:07:03.740</a></span> | <span class="t">number two of five elements. Hopefully, you can see what it's doing. It's chunkifying this list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4032" target="_blank">01:07:12.860</a></span> | <span class="t">And this is the length of each chunk. Now, how did it do that? The way I did it is using a very,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4040" target="_blank">01:07:20.620</a></span> | <span class="t">very useful thing in Python that far too many people don't know about, which is called yield.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4046" target="_blank">01:07:26.060</a></span> | <span class="t">And what yield does is you can see here, if we're on loop, it's going to go through from zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4053" target="_blank">01:07:33.020</a></span> | <span class="t">up to the length of my list. And it's going to jump by five at a time. It's going to go,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4060" target="_blank">01:07:40.060</a></span> | <span class="t">in this case, zero comma five. And then it's going to think of this as being like return for now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4067" target="_blank">01:07:47.420</a></span> | <span class="t">it's going to return the list from zero up to five. So it returns the first bit of the list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4075" target="_blank">01:07:55.180</a></span> | <span class="t">But yield doesn't just return. It kind of like returns a bit and then it continues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4082" target="_blank">01:08:02.780</a></span> | <span class="t">And it returns a bit more. And so specifically, what yield does is it creates an iterator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4093" target="_blank">01:08:13.420</a></span> | <span class="t">An iterator is an iterator is basically something you can actually use it that you can call next on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4101" target="_blank">01:08:21.660</a></span> | <span class="t">a bunch of times. So let's try it. So we can say iterator equals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4109" target="_blank">01:08:29.260</a></span> | <span class="t">Okay. Oh, got to run it. So what is iterator? Well, iterator is something that I can basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4118" target="_blank">01:08:38.940</a></span> | <span class="t">I can call next on. And next basically says yield the next thing. So this should yield</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4125" target="_blank">01:08:45.660</a></span> | <span class="t">vals zero colon five. There it is. It did, right? There's vals zero colon five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4136" target="_blank">01:08:56.060</a></span> | <span class="t">Now, if I run that again, it's going to give me a different answer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4140" target="_blank">01:09:00.220</a></span> | <span class="t">because it's now up to the second part of this loop. Now it returns the last five. Okay. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4150" target="_blank">01:09:10.540</a></span> | <span class="t">this is what an iterator does. Now, if you pass an iterator to Python's list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4161" target="_blank">01:09:21.260</a></span> | <span class="t">it runs through the entire iterator until it's finished and creates a list of the results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4167" target="_blank">01:09:27.020</a></span> | <span class="t">And what does finished looks like? This is what finished looks like. If you call next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4171" target="_blank">01:09:31.580</a></span> | <span class="t">and get stop iteration, that means you've run out. And that makes sense, because my loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4178" target="_blank">01:09:38.380</a></span> | <span class="t">there's nothing left in it. So all of that is to say, we now have a way of taking a list and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4186" target="_blank">01:09:46.540</a></span> | <span class="t">chunkifying it. So what if I now take my full image, image number one, chunkify it into chunks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4196" target="_blank">01:09:56.620</a></span> | <span class="t">of 28 long and turn that into a list and plot it. We have successfully created an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4206" target="_blank">01:10:06.780</a></span> | <span class="t">So that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4210" target="_blank">01:10:10.380</a></span> | <span class="t">Now, we are done. But there are other ways to create this iterator. And because iterators</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4229" target="_blank">01:10:29.660</a></span> | <span class="t">and generators, which are closely related, so important, I wanted to show you more about how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4237" target="_blank">01:10:37.100</a></span> | <span class="t">to do them in Python. It's one of these things that if you understand this, you'll often find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4244" target="_blank">01:10:44.700</a></span> | <span class="t">that you can throw away huge pieces of enterprise software and basically replace it with an iterator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4252" target="_blank">01:10:52.700</a></span> | <span class="t">It lets you stream things one bit at a time. It doesn't store it all in memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4258" target="_blank">01:10:58.300</a></span> | <span class="t">It's this really powerful thing that once I show it to people, they suddenly go like, oh, wow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4265" target="_blank">01:11:05.980</a></span> | <span class="t">we've been using all this third party software and we could have just created a Python iterator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4272" target="_blank">01:11:12.300</a></span> | <span class="t">Python comes with a whole standard library module called edit tools just to make it easier to work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4279" target="_blank">01:11:19.900</a></span> | <span class="t">with iterators. I'll show you one example of something from edit tools, which is iseless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4286" target="_blank">01:11:26.540</a></span> | <span class="t">So let's grab our values again, these 10 values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4292" target="_blank">01:11:32.540</a></span> | <span class="t">Okay. So let's take these 10 values and we can take any list and turn it into an iterator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4305" target="_blank">01:11:45.100</a></span> | <span class="t">by passing it to itter, which I should call it. So I don't override this Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4315" target="_blank">01:11:55.340</a></span> | <span class="t">That's not a keyword, but this thing I don't want to override.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4317" target="_blank">01:11:57.500</a></span> | <span class="t">So this is now basically something that I can call. Actually, let's do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4323" target="_blank">01:12:03.180</a></span> | <span class="t">I'll show you that I can call next on it. So if I now go next it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4328" target="_blank">01:12:08.620</a></span> | <span class="t">you can see it's giving me each item one at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4338" target="_blank">01:12:18.300</a></span> | <span class="t">Okay. So that's what converting it into an iterator does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4341" target="_blank">01:12:21.580</a></span> | <span class="t">I slice, converts it into a different kind of iterator. Let's call this maybe I slice iterator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4362" target="_blank">01:12:42.940</a></span> | <span class="t">And so you can see here, what it did was it jumped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4373" target="_blank">01:12:53.340</a></span> | <span class="t">Stop here. So that's what had been better. So I should query,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4383" target="_blank">01:13:03.180</a></span> | <span class="t">create the iterator and then call next a few times. Sorry. This is what I went to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4391" target="_blank">01:13:11.340</a></span> | <span class="t">It's now only returning the first five before it calls stop iteration before it raises stop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4397" target="_blank">01:13:17.100</a></span> | <span class="t">iteration. So what I slice does is it grabs the first N things from an iterable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4404" target="_blank">01:13:24.620</a></span> | <span class="t">something that you can iterate. Why is that interesting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4413" target="_blank">01:13:33.340</a></span> | <span class="t">Because I can pass it to list for example. Right. And now if I pass it to list again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4422" target="_blank">01:13:42.540</a></span> | <span class="t">this iterator has now grabbed the first five things. So it's now up to thing number six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4428" target="_blank">01:13:48.620</a></span> | <span class="t">So if I call it again, it's the next five things. And if I call it again, then there's nothing left.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4439" target="_blank">01:13:59.180</a></span> | <span class="t">And maybe you can see we've actually now got this defined, but we can do it with I slice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4446" target="_blank">01:14:06.940</a></span> | <span class="t">And here's how we can do it. It's actually pretty tricky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4450" target="_blank">01:14:10.460</a></span> | <span class="t">It in Python, you can pass it something like a list to create an iterator,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4459" target="_blank">01:14:19.180</a></span> | <span class="t">or you can pass it. Now this is a really important word. A callable. What's a callable?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4465" target="_blank">01:14:25.260</a></span> | <span class="t">A callable is generally speaking, it's a function. It's something that you can put parentheses after.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4471" target="_blank">01:14:31.660</a></span> | <span class="t">Could even be a class. Anything you can put parentheses after,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4478" target="_blank">01:14:38.780</a></span> | <span class="t">you can just think of it for now as a function. So we're going to pass it a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4482" target="_blank">01:14:42.300</a></span> | <span class="t">And in the second form, it's going to be called until the function returns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4490" target="_blank">01:14:50.620</a></span> | <span class="t">this value here, which in this case is empty list. And we just saw that I slice will return empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4495" target="_blank">01:14:55.500</a></span> | <span class="t">list when it's done. So this here is going to keep calling this function again and again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4507" target="_blank">01:15:07.260</a></span> | <span class="t">And we've seen exactly what happens because we've called it ourselves before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4512" target="_blank">01:15:12.300</a></span> | <span class="t">There it is. Until it gets an empty list. So if we do it with 28, then we're going to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4522" target="_blank">01:15:22.940</a></span> | <span class="t">our image again. So we've now got two different ways of creating exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4534" target="_blank">01:15:34.460</a></span> | <span class="t">And if you've never used iterators before, now's a good time to pause the video and play with them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4543" target="_blank">01:15:43.340</a></span> | <span class="t">right? So for example, you could take this here, right? And if you've not seen lambdas before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4549" target="_blank">01:15:49.500</a></span> | <span class="t">they're exactly the same as functions, but you can define them in line. So let's replace that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4553" target="_blank">01:15:53.900</a></span> | <span class="t">with a function. Okay, so now I've turned it into a function and then you can experiment with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4563" target="_blank">01:16:03.900</a></span> | <span class="t">So let's create our iterator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4567" target="_blank">01:16:07.900</a></span> | <span class="t">and call f on it. Well, not on it, call f. And you can see there's the first 28.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4579" target="_blank">01:16:19.900</a></span> | <span class="t">And each time I do it, I'm getting another 28. Now the first two rows are all empty, but finally,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4587" target="_blank">01:16:27.180</a></span> | <span class="t">look, now I've got some values. Call it again. See how each time I'm getting something else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4592" target="_blank">01:16:32.380</a></span> | <span class="t">Just calling it again and again. And that is the values in our iterator. So that gives you a sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4599" target="_blank">01:16:39.420</a></span> | <span class="t">of like how you can use Jupyter to experiment. So what you should do is as soon as you hit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4608" target="_blank">01:16:48.220</a></span> | <span class="t">something in my code that doesn't look familiar to you, I recommend pausing the video and experimenting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4617" target="_blank">01:16:57.100</a></span> | <span class="t">with that in Jupyter. And for example, itter, most people probably have not used itter at all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4625" target="_blank">01:17:05.660</a></span> | <span class="t">and certainly very few people have used this to argument form. So hit shift tab a few times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4630" target="_blank">01:17:10.540</a></span> | <span class="t">and now you've got at the bottom, there's a description of what it is. Or find out more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4638" target="_blank">01:17:18.380</a></span> | <span class="t">Python itter. Here we are, go to the docs. Well, that's not the right bit of the docs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4651" target="_blank">01:17:31.020</a></span> | <span class="t">See API? Wow, crazy. That's terrible. Let's try searching here. There we go. That's more like it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4672" target="_blank">01:17:52.060</a></span> | <span class="t">So now you've got links. So if it's like, okay, it returns an iterator object, what's that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4676" target="_blank">01:17:56.620</a></span> | <span class="t">Well, click on it. Find out. Now this is really important to know. And here's that stop exception</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4681" target="_blank">01:18:01.020</a></span> | <span class="t">that we saw. So stop iteration exception. We saw next already. We can find out what iterable is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4687" target="_blank">01:18:07.900</a></span> | <span class="t">And here's an example. And as you can see, it's using exactly the same approach that we did,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4695" target="_blank">01:18:15.740</a></span> | <span class="t">but here it's being used to read from a file. This is really cool. Here's how to read from a file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4702" target="_blank">01:18:22.060</a></span> | <span class="t">64 bytes at a time until you get nothing processing it, right? So the docs of Python are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4709" target="_blank">01:18:29.420</a></span> | <span class="t">quite fantastic. As long as you use them, if you don't use them, they're not very useful at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4717" target="_blank">01:18:37.500</a></span> | <span class="t">And I see Seifer in the comments, our local Haskell programmer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4727" target="_blank">01:18:47.900</a></span> | <span class="t">appreciating this Haskellness in Python. That's good. It's not quite Haskell, I'm afraid,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4733" target="_blank">01:18:53.660</a></span> | <span class="t">but it's the closest we're going to come. All right. How are we going for time? Pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4741" target="_blank">01:19:01.980</a></span> | <span class="t">Okay. So now that we've got image, which is a list of lists and each list is 25 long,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4755" target="_blank">01:19:15.500</a></span> | <span class="t">we can index into it. So we can say image 20. Well, let's do it. Image 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4762" target="_blank">01:19:22.380</a></span> | <span class="t">Okay. Is a list of 28 numbers. And then we could index into that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4772" target="_blank">01:19:32.860</a></span> | <span class="t">Okay. So we can index into it. Now, normally, we don't like to do that for matrices. We would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4783" target="_blank">01:19:43.340</a></span> | <span class="t">normally rather write it like this. Okay. So that means we're going to have to create our own class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4791" target="_blank">01:19:51.100</a></span> | <span class="t">to make that work. So to create a class in Python, you write class, and then you write the name of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4799" target="_blank">01:19:59.900</a></span> | <span class="t">And then you write some really weird things. The weird things you write have two underscores,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4808" target="_blank">01:20:08.380</a></span> | <span class="t">a special word, and then two underscores. These things with two underscores on each side are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4813" target="_blank">01:20:13.980</a></span> | <span class="t">called dunder methods, and they're all the special magically named methods which have particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4820" target="_blank">01:20:20.700</a></span> | <span class="t">meanings to Python. And you're just going to learn them, but they're all documented in the Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4827" target="_blank">01:20:27.340</a></span> | <span class="t">object model. Edit object model. Yay, finally. Okay. So it's called data model, not object model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4842" target="_blank">01:20:42.140</a></span> | <span class="t">And so this is basically where all the documentation is about absolutely everything,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4848" target="_blank">01:20:48.620</a></span> | <span class="t">and I can click under edit, and it tells you basically this is the thing that constructs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4853" target="_blank">01:20:53.580</a></span> | <span class="t">objects. So any time you want to create a class that you want to construct, it's going to store</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4862" target="_blank">01:21:02.300</a></span> | <span class="t">some stuff. So in this case, it's going to store our image. You have to define dunder in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4867" target="_blank">01:21:07.900</a></span> | <span class="t">Python's slightly weird in that every method, you have to put self here. For reasons we probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4877" target="_blank">01:21:17.660</a></span> | <span class="t">don't really need to get into right now. And then any parameters. So we're going to be creating an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4882" target="_blank">01:21:22.860</a></span> | <span class="t">image passing in the thing to store, the Xs. They're going to be passing in the Xs. And so here we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4889" target="_blank">01:21:29.580</a></span> | <span class="t">just going to store it inside the self. So once I've got this line of code, I've now got something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4895" target="_blank">01:21:35.340</a></span> | <span class="t">that knows how to store stuff, the Xs inside itself. So now I want to be able to call square bracket</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4903" target="_blank">01:21:43.420</a></span> | <span class="t">20 comma 15. So how do we do that? Well, basically part of the data model is that there's a special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4913" target="_blank">01:21:53.660</a></span> | <span class="t">thing called dunder get item. And when you call square brackets on your object, that's what Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4919" target="_blank">01:21:59.820</a></span> | <span class="t">uses. And it's going to pass across the 20 comma 15 here as indices. So we're now basically just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4931" target="_blank">01:22:11.340</a></span> | <span class="t">going to return this. So the self.Xs with the first index and the second index. So let's create that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4940" target="_blank">01:22:20.620</a></span> | <span class="t">matrix class and run that. And you can now see M 20 comma 15 is the same. Oh, quick note on, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4950" target="_blank">01:22:30.060</a></span> | <span class="t">ways in which my code is different to everybody else's, which it is. It's somewhat unusual to put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4957" target="_blank">01:22:37.100</a></span> | <span class="t">definitions of methods on the same line as as the the signature like this. I do it quite a lot for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4967" target="_blank">01:22:47.580</a></span> | <span class="t">one-liners. As I kind of mentioned before, I find it really helps me to be able to see all the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4973" target="_blank">01:22:53.580</a></span> | <span class="t">I'm working with on the screen at once. A lot of the world's best programmers actually have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4980" target="_blank">01:23:00.060</a></span> | <span class="t">had that approach as well. It seems to work quite well for some people that are extremely productive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4985" target="_blank">01:23:05.180</a></span> | <span class="t">It's not common in Python. Some people are quite against it. So if you're at work, and your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4993" target="_blank">01:23:13.260</a></span> | <span class="t">colleagues don't write Python this way, you probably shouldn't either. But if you can get away with it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=4998" target="_blank">01:23:18.940</a></span> | <span class="t">I think it works quite well. Anyway, okay, so now that we've created something that lets us index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5003" target="_blank">01:23:23.420</a></span> | <span class="t">into things like this, we're allowed to use PyTorch because we're allowed to use this one feature in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5009" target="_blank">01:23:29.660</a></span> | <span class="t">PyTorch. Okay, so we can now do that. And so now to create a tensor, which is basically a lot like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5022" target="_blank">01:23:42.700</a></span> | <span class="t">our matrix, we can now pass a list into tensor to get back a tensor version of that list, or perhaps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5033" target="_blank">01:23:53.180</a></span> | <span class="t">more interestingly, we could pass in a list of lists. Maybe let's give this a name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5044" target="_blank">01:24:04.540</a></span> | <span class="t">Whoopsie dozy. That needs to be a list of lists, just like we had before for our image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5058" target="_blank">01:24:18.380</a></span> | <span class="t">In fact, let's do it for our image. Let's just pass in our image. There we go. And so now we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5067" target="_blank">01:24:27.980</a></span> | <span class="t">should be able to say tens 20 comma 15. And there we go. Okay, so we've successfully reinvented that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5083" target="_blank">01:24:43.020</a></span> | <span class="t">All right. So now we can convert all of our lists into tenses. There's a convenient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5095" target="_blank">01:24:55.980</a></span> | <span class="t">way to do this, which is to use the map function in the Python standard library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5102" target="_blank">01:25:02.220</a></span> | <span class="t">So it takes a function and then some iterables. In this case, one iterable. And it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5114" target="_blank">01:25:14.060</a></span> | <span class="t">apply this function to each of these four things and return those four things. And so then I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5119" target="_blank">01:25:19.900</a></span> | <span class="t">put four things on the left to receive those four things. So this is going to call tensor x_train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5126" target="_blank">01:25:26.140</a></span> | <span class="t">and put it in x_train. Tensor y_train, put it in y_train, and so forth. So this is converting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5130" target="_blank">01:25:30.780</a></span> | <span class="t">all of these lists to tenses and storing them back in the same name. So you can see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5137" target="_blank">01:25:37.580</a></span> | <span class="t">x_train now is a tensor. So that means it has a shape property. It has 50,000 images in it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5146" target="_blank">01:25:46.860</a></span> | <span class="t">which are each 784 long. And you can find out what kind of stuff it contains by calling its .type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5157" target="_blank">01:25:57.180</a></span> | <span class="t">So it contains floats. So this is the tensor class. We'll be using a lot of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5162" target="_blank">01:26:02.620</a></span> | <span class="t">So of course, you should read its documentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5165" target="_blank">01:26:05.420</a></span> | <span class="t">I don't love the PyTorch documentation. Some of it's good. Some of it's not good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5172" target="_blank">01:26:12.860</a></span> | <span class="t">It's a bit all over the place. So here's tensor. But it's well worth scrolling through to get a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5178" target="_blank">01:26:18.060</a></span> | <span class="t">sense of like, this is actually not bad, right? It tells you how you can construct it. This is how I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5181" target="_blank">01:26:21.820</a></span> | <span class="t">constructed one before, passing it lists of lists. You can also pass it NumPy arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5187" target="_blank">01:26:27.660</a></span> | <span class="t">You can change types. So on and so forth. So, you know, it's well worth reading through. And like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5199" target="_blank">01:26:39.980</a></span> | <span class="t">you're not going to look at every single method it takes, but you're kind of, if you browse through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5204" target="_blank">01:26:44.060</a></span> | <span class="t">it, you'll get a general sense, right? That tensors do just about everything you couldn't think of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5211" target="_blank">01:26:51.340</a></span> | <span class="t">for a numeric programming. At some point, you will want to know every single one of these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5217" target="_blank">01:26:57.820</a></span> | <span class="t">or at least be aware roughly what exists. So you know what to search for in the docs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5223" target="_blank">01:27:03.980</a></span> | <span class="t">Otherwise you will end up recreating stuff from scratch, which is much, much slower</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5229" target="_blank">01:27:09.180</a></span> | <span class="t">than simply reading the documentation to find out it's there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5234" target="_blank">01:27:14.300</a></span> | <span class="t">All right. So instead of, instead of calling chunks or I slice, the thing that is roughly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5241" target="_blank">01:27:21.340</a></span> | <span class="t">equivalent in a tensor is the reshape method. So reshape, so to reshape our 50,000 by 784 thing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5250" target="_blank">01:27:30.380</a></span> | <span class="t">we can simply, we want to turn it into 50,000 28 by 28 tensors. So I could write here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5260" target="_blank">01:27:40.620</a></span> | <span class="t">reshape to 50,000 by 28 by 28. But I kind of don't need to, because I could just put minus one here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5271" target="_blank">01:27:51.260</a></span> | <span class="t">and it can figure out that that must be 50, that must be 50,000 because it knows that I have 50,000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5278" target="_blank">01:27:58.620</a></span> | <span class="t">by 784 items. So it can figure out, so minus one means just fill this with all the rest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5284" target="_blank">01:28:04.140</a></span> | <span class="t">Okay. Now, what does the word tensor mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5295" target="_blank">01:28:15.900</a></span> | <span class="t">So there's some very interesting history here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5301" target="_blank">01:28:21.020</a></span> | <span class="t">And I'll try not to get too far into it because I'm a bit over enthusiastic about this stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5307" target="_blank">01:28:27.740</a></span> | <span class="t">I must admit. I'm very, very interested in the history of tensor programming and array programming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5313" target="_blank">01:28:33.980</a></span> | <span class="t">And it basically goes back to a language called APL. APL is basically originally a mathematical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5323" target="_blank">01:28:43.340</a></span> | <span class="t">notation that was developed in the mid to late 50s, 1950s. And at first it was used as a notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5333" target="_blank">01:28:53.260</a></span> | <span class="t">for defining how certain new IBM systems would work. So it was all written out in this notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5342" target="_blank">01:29:02.140</a></span> | <span class="t">It's kind of like a replacement for mathematical notation that was designed to be more consistent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5348" target="_blank">01:29:08.860</a></span> | <span class="t">and kind of more expressive. In the early 60s, so the guy who wrote and made it was called his</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5358" target="_blank">01:29:18.060</a></span> | <span class="t">name Ken Iverson. In the early 60s, some implementations that actually allow this notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5364" target="_blank">01:29:24.620</a></span> | <span class="t">to be executed on a computer appeared. Both the notation and the executable implementations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5371" target="_blank">01:29:31.020</a></span> | <span class="t">slightly confusingly are both called APL. APL's been in constant development ever since that time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5377" target="_blank">01:29:37.740</a></span> | <span class="t">And today is one of the world's most powerful programming languages. And you can try it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5382" target="_blank">01:29:42.700</a></span> | <span class="t">going to try APL. And why am I mentioning it here? Because one of the things Ken Iverson did, well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5391" target="_blank">01:29:51.420</a></span> | <span class="t">he studied an area of physics called tensor analysis. And as he developed APL, he basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5400" target="_blank">01:30:00.860</a></span> | <span class="t">said like, oh, what if we took these ideas from tensor analysis and put them into a programming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5405" target="_blank">01:30:05.180</a></span> | <span class="t">language? So in APL, you can and have been able to for some time can basically you can define a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5416" target="_blank">01:30:16.220</a></span> | <span class="t">variable. And rather than saying equals, which is a terrible way to define things really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5424" target="_blank">01:30:24.140</a></span> | <span class="t">mathematically, because that has a very different meaning most of the time in math. Instead,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5428" target="_blank">01:30:28.860</a></span> | <span class="t">we use arrow to define things. We can say, okay, that's going to be a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5435" target="_blank">01:30:35.260</a></span> | <span class="t">like so. And then we can look at their contents of A and we can do things like, oh, what if we do A</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5444" target="_blank">01:30:44.460</a></span> | <span class="t">times three or A minus two and so forth. And as you can see, what it's doing is it's taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5458" target="_blank">01:30:58.860</a></span> | <span class="t">all the contents of this tensor and it's multiplying them all by three or subtracting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5464" target="_blank">01:31:04.300</a></span> | <span class="t">two from all of them. Or perhaps more fun, we could put into B a different tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5471" target="_blank">01:31:11.580</a></span> | <span class="t">And we can now do things like A divided by B. And you can see it's taking each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5482" target="_blank">01:31:22.860</a></span> | <span class="t">of A and dividing by each of B. Now, this is very interesting because now we don't have to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5494" target="_blank">01:31:34.780</a></span> | <span class="t">loops anymore. We can just express things directly. We can multiply things by scalars,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5501" target="_blank">01:31:41.260</a></span> | <span class="t">even if they're, this is called a rank one tensor. That is to say it's basically in math,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5507" target="_blank">01:31:47.500</a></span> | <span class="t">we'd call it a vector. We can take two vectors and can divide one by the other and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5513" target="_blank">01:31:53.900</a></span> | <span class="t">It's a really powerful idea. Funnily enough, APL didn't call them tensors, even though</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5521" target="_blank">01:32:01.020</a></span> | <span class="t">Ken Iverson said he got this idea from tensor analysis, APL calls them arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5529" target="_blank">01:32:09.340</a></span> | <span class="t">NumPy, which was heavily influenced by APL, also calls them arrays. For some reason, PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5538" target="_blank">01:32:18.140</a></span> | <span class="t">which is very heavily influenced by APL, sorry, by NumPy, doesn't call them arrays,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5543" target="_blank">01:32:23.820</a></span> | <span class="t">it calls them tensors. They're all the same thing. They are rectangular blocks of numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5557" target="_blank">01:32:37.020</a></span> | <span class="t">They can be one-dimensional, like a vector. They can be two-dimensional, like a matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5561" target="_blank">01:32:41.900</a></span> | <span class="t">They can be three-dimensional, which is like a bunch of stacked matrices,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5566" target="_blank">01:32:46.380</a></span> | <span class="t">like a batch of matrices and so forth. If you are interested in APL, which I hope you are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5581" target="_blank">01:33:01.420</a></span> | <span class="t">we have a whole APL and array programming section on our forums, and also we've prepared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5588" target="_blank">01:33:08.220</a></span> | <span class="t">a whole set of notes on every single glyph in APL, which also covers all kinds of interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5603" target="_blank">01:33:23.420</a></span> | <span class="t">mathematical concepts, like complex direction and magnitude, and all kinds of fun stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5616" target="_blank">01:33:36.780</a></span> | <span class="t">That's all totally optional, but a lot of people who do APL say that they feel like they've become</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5622" target="_blank">01:33:42.540</a></span> | <span class="t">a much better programmer in the process, and also you'll find here at the forums a set of 17 study</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5631" target="_blank">01:33:51.180</a></span> | <span class="t">sessions of an hour or two each, covering the entirety of the language, every single glyph.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5637" target="_blank">01:33:57.020</a></span> | <span class="t">That's all where this stuff comes from. This batch of 50,000 images, 50,000 28 by 28 images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5650" target="_blank">01:34:10.540</a></span> | <span class="t">is what we call a rank 3 tensor in PyTorch. In NumPy, we would call it an array with three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5660" target="_blank">01:34:20.220</a></span> | <span class="t">dimensions. Those are the same thing. What is the rank? The rank is just the number of dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5670" target="_blank">01:34:30.220</a></span> | <span class="t">It's 50,000 images of 28 high by 28 wide, so there are three dimensions that is the rank</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5678" target="_blank">01:34:38.220</a></span> | <span class="t">of the tensor. If we then pick out a particular image, then we look at its shape,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5686" target="_blank">01:34:46.380</a></span> | <span class="t">we could call this a matrix. It's a 28 by 28 tensor, or we could call it a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5696" target="_blank">01:34:56.860</a></span> | <span class="t">A vector is a rank 1 tensor. In APL, a scalar is a rank 0 tensor, and that's the way it should be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5706" target="_blank">01:35:06.140</a></span> | <span class="t">A lot of languages and libraries don't, unfortunately, think of it that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5711" target="_blank">01:35:11.420</a></span> | <span class="t">So what is a scalar? It's a bit dependent on the language. Okay, so we can index into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5717" target="_blank">01:35:17.180</a></span> | <span class="t">the zeroth image, 20th row, 15th column to get back this same number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5733" target="_blank">01:35:33.660</a></span> | <span class="t">Okay, so we can take x_train.shape, which is 50,000 by 784,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5744" target="_blank">01:35:44.380</a></span> | <span class="t">and you can destructure it into n, which is the number of images, and c, which is the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5754" target="_blank">01:35:54.620</a></span> | <span class="t">the full number of columns, for example. And we can also, well this is actually part of the standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5763" target="_blank">01:36:03.980</a></span> | <span class="t">library, so we're allowed to use min, so we can find out in y_train what's the smallest number,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5769" target="_blank">01:36:09.180</a></span> | <span class="t">and what's the maximum number, so they go from 0 to 9. So you see here, it's not just the number 0,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5778" target="_blank">01:36:18.780</a></span> | <span class="t">it's a scalar tensor, 0. They act almost the same, most of the time. So here's some example of a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5787" target="_blank">01:36:27.580</a></span> | <span class="t">of the y_train, so you can see these are basically, this is going to be the labels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5793" target="_blank">01:36:33.500</a></span> | <span class="t">right, these are our digits, and this is its shape, so there's just 50,000 of these labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5808" target="_blank">01:36:48.380</a></span> | <span class="t">Okay, and so since we're allowed to use this in the standard library, well it also exists in PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5813" target="_blank">01:36:53.500</a></span> | <span class="t">so that means we're also allowed to use the .min and .max properties.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5817" target="_blank">01:36:57.740</a></span> | <span class="t">All right, so before we wrap up, we're going to do one more thing, and I don't know what the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5826" target="_blank">01:37:06.140</a></span> | <span class="t">we would call kind of anti-cheating, but according to our rules, we're allowed to use random numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5834" target="_blank">01:37:14.460</a></span> | <span class="t">because there is a random number generator in the Python standard library, but we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5840" target="_blank">01:37:20.860</a></span> | <span class="t">random numbers from scratch ourselves, and the reason we're going to do that is even though</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5846" target="_blank">01:37:26.700</a></span> | <span class="t">according to the rules we could be allowed to use the standard library one, it's actually extremely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5851" target="_blank">01:37:31.420</a></span> | <span class="t">instructive to build our own random number generator from scratch, well at least I think so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5858" target="_blank">01:37:38.060</a></span> | <span class="t">Let's see what you think. So there is no way normally in software to create a random number,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5872" target="_blank">01:37:52.540</a></span> | <span class="t">unfortunately. Computers, you know, add, subtract, times, logic gates, stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5884" target="_blank">01:38:04.940</a></span> | <span class="t">So how does one create random numbers? Well you could go to the Australian National University</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5889" target="_blank">01:38:09.580</a></span> | <span class="t">Quantum Random Number Generator, and this looks at the quantum fluctuations of the vacuum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5897" target="_blank">01:38:17.500</a></span> | <span class="t">and provides an API which will actually hook you in and return quantum random fluctuations of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5909" target="_blank">01:38:29.500</a></span> | <span class="t">the vacuum. So that's about, that's the most random thing I'm aware of, so that would be one way to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5915" target="_blank">01:38:35.180</a></span> | <span class="t">random numbers. And there's actually an API for that, so there's a bit of fun. You could do what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5924" target="_blank">01:38:44.700</a></span> | <span class="t">Cloudflare does. Cloudflare has a huge wall full of lava lamps, and it uses the pixels of a camera</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5944" target="_blank">01:39:04.140</a></span> | <span class="t">looking at those lava lamps to generate random numbers. Intel nowadays actually has something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5953" target="_blank">01:39:13.020</a></span> | <span class="t">in its chips, which you can call rdrand, which will return random numbers on certain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5965" target="_blank">01:39:25.420</a></span> | <span class="t">Intel chips from 2012. All of these things are kind of slow, they can kind of get you one random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5974" target="_blank">01:39:34.700</a></span> | <span class="t">number from time to time. We want some way of getting lots and lots of random numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5980" target="_blank">01:39:40.460</a></span> | <span class="t">and so what we do is we use something called a pseudorandom number generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5986" target="_blank">01:39:46.140</a></span> | <span class="t">A pseudorandom number generator is a mathematical function that you can call lots of times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=5994" target="_blank">01:39:54.220</a></span> | <span class="t">and each time you call it, it will give you a number that looks random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6002" target="_blank">01:40:02.540</a></span> | <span class="t">To show you what I mean by that, I'm going to run some code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6007" target="_blank">01:40:07.340</a></span> | <span class="t">I've created a function which we'll look at in a moment called rand, and if I call rand 50 times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6017" target="_blank">01:40:17.900</a></span> | <span class="t">and plot it, there's no obvious relationship between one call and the next. That's one thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6025" target="_blank">01:40:25.420</a></span> | <span class="t">that I would expect to see from my random numbers. I would expect that each time I call rand,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6031" target="_blank">01:40:31.500</a></span> | <span class="t">the numbers would look quite different to each other. The second thing is, rand is meant to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6036" target="_blank">01:40:36.940</a></span> | <span class="t">be returning uniformly distributed random numbers, and therefore if I call it lots and lots and lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6043" target="_blank">01:40:43.180</a></span> | <span class="t">of times and plot its histogram, I would expect to see exactly this, which is each from 0 to 0.1,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6051" target="_blank">01:40:51.980</a></span> | <span class="t">there's a few, from 0.1 to 0.2, there's a few, from 0.2 to 0.3, there's a few. It's a fairly evenly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6058" target="_blank">01:40:58.140</a></span> | <span class="t">spread thing. These are the two key things I would expect to see, an even distribution of random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6063" target="_blank">01:41:03.660</a></span> | <span class="t">numbers and that there's no correlation or no obvious correlation from one to the other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6068" target="_blank">01:41:08.620</a></span> | <span class="t">We're going to try and create a function that has these properties. We're not going to derive it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6075" target="_blank">01:41:15.580</a></span> | <span class="t">from scratch. I'm just going to tell you that we have a function here called the Wickman-Hill</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6079" target="_blank">01:41:19.660</a></span> | <span class="t">algorithm. This is actually what Python used to use back in before Python 2.3, and the key reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6086" target="_blank">01:41:26.140</a></span> | <span class="t">we need to know about this is to understand really well the idea of random state. Random state is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6093" target="_blank">01:41:33.580</a></span> | <span class="t">global variable. It's something which is, or at least it can be, most of the time when we use it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6099" target="_blank">01:41:39.740</a></span> | <span class="t">we use it as a random variable, and it's just basically one or more numbers. So we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6104" target="_blank">01:41:44.780</a></span> | <span class="t">to start with no random state at all, and we're going to create a function called seed that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6110" target="_blank">01:41:50.220</a></span> | <span class="t">going to pass something to, and I just meshed the keyboard to create this number. Okay, so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6115" target="_blank">01:41:55.500</a></span> | <span class="t">my random number. You could get this from the ANU quantum vacuum generator or from cloud fairs lava</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6122" target="_blank">01:42:02.700</a></span> | <span class="t">lamps or from your Intel chips ID rand, or you know in Python land we'd pretty much always use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6128" target="_blank">01:42:08.380</a></span> | <span class="t">the number 42. Any of those are fine. So you pass in some number or you can pass in the current tick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6134" target="_blank">01:42:14.300</a></span> | <span class="t">count in nanoseconds. There's various ways of getting some random starting point, and if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6139" target="_blank">01:42:19.900</a></span> | <span class="t">pass it into seed it's going to do a bunch of modular divisions and create a tuple of three things,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6151" target="_blank">01:42:31.580</a></span> | <span class="t">and it's going to store them in this global state. So rand state now contains three numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6159" target="_blank">01:42:39.740</a></span> | <span class="t">Okay, so why did we do that? The reason we did that is because now this function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6167" target="_blank">01:42:47.660</a></span> | <span class="t">which takes our random state, unpacks it into three things, and does again a bunch of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6174" target="_blank">01:42:54.780</a></span> | <span class="t">modifications and modulus, and then sticks them together with various kind of weights. Modulo one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6182" target="_blank">01:43:02.220</a></span> | <span class="t">so this is how you can pull out the decimal part. This returns random numbers, but the key thing I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6189" target="_blank">01:43:09.980</a></span> | <span class="t">want you to understand is that we pull out the random state at the start. We do some math thingies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6197" target="_blank">01:43:17.020</a></span> | <span class="t">to it, and then we store new random state, and so that means that each time I call this I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6206" target="_blank">01:43:26.460</a></span> | <span class="t">get a different number. Okay, so this is a random number generator, and this is really important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6214" target="_blank">01:43:34.860</a></span> | <span class="t">because lots of people in the deep learning world screw this up, including me sometimes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6221" target="_blank">01:43:41.100</a></span> | <span class="t">which is to remember that random number generators rely on this state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6229" target="_blank">01:43:49.180</a></span> | <span class="t">So let me show you where that will get you if you're not careful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6234" target="_blank">01:43:54.060</a></span> | <span class="t">If we use this special thing called fork, that creates a whole separate copy of this Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6242" target="_blank">01:44:02.060</a></span> | <span class="t">process. In one copy, os.fork returns true. In the other copy, it returns false,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6251" target="_blank">01:44:11.180</a></span> | <span class="t">roughly speaking. So this copy here is this, and if I say this version here, the true version,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6259" target="_blank">01:44:19.500</a></span> | <span class="t">is the original non-copied, it's called the parent, and so in my else here, so this will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6265" target="_blank">01:44:25.180</a></span> | <span class="t">only be called by the parent. This will only be called by the copy, it's called the child.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6269" target="_blank">01:44:29.980</a></span> | <span class="t">And each one I'm calling rand. These are two different random numbers, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6274" target="_blank">01:44:34.540</a></span> | <span class="t">Wrong. They're the same number. Now, why is that? That's because this process here and this process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6286" target="_blank">01:44:46.380</a></span> | <span class="t">here are copies of each other, and therefore they each contain the same numbers in random state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6295" target="_blank">01:44:55.900</a></span> | <span class="t">So this is something that comes up in deep learning all the time, because in deep learning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6303" target="_blank">01:45:03.340</a></span> | <span class="t">we often do parallel processing, for example, to generate lots of augmented images at the same time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6312" target="_blank">01:45:12.620</a></span> | <span class="t">using multiple processes. Fast AI used to have a bug, in fact, where we failed to correctly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6319" target="_blank">01:45:19.900</a></span> | <span class="t">initialize the random number generator separately in each process. And in fact, to this day,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6326" target="_blank">01:45:26.940</a></span> | <span class="t">at least as of October 2022, torch.rand itself, by default, fails to initialize the random number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6337" target="_blank">01:45:37.340</a></span> | <span class="t">generator. That's the same number. Okay, so you've got to be careful. Now, I have a feeling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6347" target="_blank">01:45:47.340</a></span> | <span class="t">NumPy gets it right. Let's check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6352" target="_blank">01:45:52.140</a></span> | <span class="t">Is that how you do it? I don't quite remember. We'll try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6362" target="_blank">01:46:02.220</a></span> | <span class="t">Nope. Okay, NumPy also doesn't. How interesting. What about Python?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6374" target="_blank">01:46:14.220</a></span> | <span class="t">Oh, look at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6392" target="_blank">01:46:32.380</a></span> | <span class="t">So Python does actually remember to reinitialize the random stream in each fork.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6401" target="_blank">01:46:41.820</a></span> | <span class="t">So, you know, this is something that, like, even if you've experimented in Python and you think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6406" target="_blank">01:46:46.060</a></span> | <span class="t">everything's working well in your data loader or whatever, and then you switch to PyTorch or NumPy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6410" target="_blank">01:46:50.700</a></span> | <span class="t">and now suddenly everything's broken. So this is why we've spent some time re-implementing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6416" target="_blank">01:46:56.860</a></span> | <span class="t">the random number generator from scratch, partly because it's fun and interesting and partly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6423" target="_blank">01:47:03.020</a></span> | <span class="t">because it's important that you now understand that when you're calling rand or any random number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6428" target="_blank">01:47:08.380</a></span> | <span class="t">generator, kind of the default versions in NumPy and PyTorch, this global state is going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6434" target="_blank">01:47:14.940</a></span> | <span class="t">copied. So you've got to be a bit careful. Now, I will mention our random number generator. Okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6446" target="_blank">01:47:26.060</a></span> | <span class="t">so this is this is cool. Percent time at percent is a special Jupyter or IPython function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6454" target="_blank">01:47:34.700</a></span> | <span class="t">And percent timer runs a piece of Python code this many times. So to call it 10 times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6461" target="_blank">01:47:41.740</a></span> | <span class="t">well, actually, it'll do seven loops and each one will be seven times and it'll take the mean and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6466" target="_blank">01:47:46.060</a></span> | <span class="t">standard deviation. So here I am going to generate random numbers 7,840 times and put them into 10</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6481" target="_blank">01:48:01.180</a></span> | <span class="t">long chunks. And if I run that, it takes me three milliseconds per loop. If I run it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6490" target="_blank">01:48:10.700</a></span> | <span class="t">using PyTorch, this is the exact same thing in PyTorch. It's going to take me 73 microseconds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6500" target="_blank">01:48:20.860</a></span> | <span class="t">per loop. So as you can see, although we could use our version, we're not going to because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6507" target="_blank">01:48:27.180</a></span> | <span class="t">PyTorch version is much, much faster. This is how we can create a 784 by 10. And why would we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6513" target="_blank">01:48:33.420</a></span> | <span class="t">this? That's because this is our final layer of our neural net or if we're doing a linear classifier,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6519" target="_blank">01:48:39.260</a></span> | <span class="t">our linear weights, we need to be 784 because that's 28 by 28 by 10 because that's the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6528" target="_blank">01:48:48.060</a></span> | <span class="t">of possible outputs, the number of possible digits. All right. That is it. So quite the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6538" target="_blank">01:48:58.940</a></span> | <span class="t">intense lesson. I think we can all agree. Should keep you busy for a week. And thanks very much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=6StU6UtZEbU&t=6546" target="_blank">01:49:06.060</a></span> | <span class="t">for joining. And see you next time. Bye, everybody.</span></div></div></body></html>