<html><head><title>Sentence Similarity With Sentence-Transformers in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Sentence Similarity With Sentence-Transformers in Python</h2><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU"><img src="https://i.ytimg.com/vi/Ey81KfQ3PQU/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=120">2:0</a> initialize a sentence transformer model<br><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=160">2:40</a> create our sentence vectors or sentence embeddings<br><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=254">4:14</a> calculate our cosine similarity<br><br><div style="text-align: left;"><a href="./Ey81KfQ3PQU.html">Whisper Transcript</a> | <a href="./transcript_Ey81KfQ3PQU.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">I welcome to this video on using the sentence transformers library to compare similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=7" target="_blank">00:00:07.600</a></span> | <span class="t">between different sentences. So this is going to be a pretty short video, I'm not going to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=12" target="_blank">00:00:12.000</a></span> | <span class="t">really into depth, I'm just going to show you how to actually use the library. Now if you do want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=18" target="_blank">00:00:18.400</a></span> | <span class="t">go into a little more depth, I have another video that I'll be releasing just before this one and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=26" target="_blank">00:00:26.160</a></span> | <span class="t">that will go into what is actually happening here, how we are calculating similarity or pulling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=33" target="_blank">00:00:33.680</a></span> | <span class="t">how the BERT model that we'll be using is actually creating those embeddings and then how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=41" target="_blank">00:00:41.360</a></span> | <span class="t">we're actually calculating similarity there. So if you're interested in that, go check it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=46" target="_blank">00:00:46.720</a></span> | <span class="t">Otherwise, if you just want to get a quick similarity score between two sentences,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=54" target="_blank">00:00:54.400</a></span> | <span class="t">this is probably the way to go. So we have these six sentences up here and this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=61" target="_blank">00:01:01.600</a></span> | <span class="t">three years later the coffin was still full of jello and this one, the person box was packed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=68" target="_blank">00:01:08.480</a></span> | <span class="t">with jelly many dozens of months later. They're saying the same thing but the second one is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=76" target="_blank">00:01:16.720</a></span> | <span class="t">saying it in a way that most of us wouldn't normally say it. Instead of saying coffin,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=81" target="_blank">00:01:21.440</a></span> | <span class="t">we're saying person box. Instead of jello, we're saying jelly. I think that's kind of normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=86" target="_blank">00:01:26.400</a></span> | <span class="t">actually and instead of years, we're saying dozens of months. So it's not really sharing the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=92" target="_blank">00:01:32.960</a></span> | <span class="t">words but we're going to see that we can actually find that these two sentences are the most similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=100" target="_blank">00:01:40.400</a></span> | <span class="t">out of all of these. So we're taking those and we're going to be importing the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=108" target="_blank">00:01:48.400</a></span> | <span class="t">transformers library. And we want to import the sentence transformer. And then from that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=118" target="_blank">00:01:58.880</a></span> | <span class="t">we want to initialize a sentence transformer model. So we write sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=126" target="_blank">00:02:06.720</a></span> | <span class="t">And then in here, we're going to be using this model that I've already defined a model name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=133" target="_blank">00:02:13.360</a></span> | <span class="t">for which is the BERT base MLI mean tokens model. So initialize that. I need to rerun that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=142" target="_blank">00:02:22.800</a></span> | <span class="t">So we have our model and I'll just show you really quickly. This model is coming from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=149" target="_blank">00:02:29.600</a></span> | <span class="t">HuggingFace transformers library behind sentence transformers. So this is the actual model we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=156" target="_blank">00:02:36.400</a></span> | <span class="t">using. Now, first thing we do here is create our sentence vectors or sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=163" target="_blank">00:02:43.920</a></span> | <span class="t">So we'll call a sentence vects equals model and code. And all we need to do here is pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=174" target="_blank">00:02:54.480</a></span> | <span class="t">our sentences. So we can pass a single sentence or a list of sentences. It's completely fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=183" target="_blank">00:03:03.440</a></span> | <span class="t">And then let's just have a quick look at what we have here. So you see that we have this big array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=189" target="_blank">00:03:09.200</a></span> | <span class="t">And if we look at the shape, we see that we have a six by 768 array. So the six refers to our six</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=201" target="_blank">00:03:21.200</a></span> | <span class="t">sentences here. And the 768 refers to the hidden state size within the BERT model that we're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=211" target="_blank">00:03:31.680</a></span> | <span class="t">So each one of these sentences is now being represented by a dense vector containing 768</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=218" target="_blank">00:03:38.640</a></span> | <span class="t">values. And that means that we are ready to take those and compare similarity between them. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=225" target="_blank">00:03:45.040</a></span> | <span class="t">to do that, we're going to be using the sklearn implementation of cosine similarity,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=232" target="_blank">00:03:52.240</a></span> | <span class="t">which we can import like this. So sklearn pairwise or metrics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=240" target="_blank">00:04:00.480</a></span> | <span class="t">pairwise. And we import cosine similarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=253" target="_blank">00:04:13.280</a></span> | <span class="t">And to calculate our cosine similarity, all we do is take that function. And inside here, we pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=262" target="_blank">00:04:22.480</a></span> | <span class="t">our first sentence. So this three years later, the coffin is still full of jello. I want to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=268" target="_blank">00:04:28.880</a></span> | <span class="t">that sentence vector, which is just an index zero of our sentence vects array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=283" target="_blank">00:04:43.040</a></span> | <span class="t">And because we are extracting that single array value. So if we just have a look at this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=290" target="_blank">00:04:50.080</a></span> | <span class="t">you see that we have a almost like a list of lists here. If we just extract this, we only get a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=298" target="_blank">00:04:58.800</a></span> | <span class="t">So what we want to do is actually keep that inside a list. Otherwise, we'll get dimension error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=304" target="_blank">00:05:04.960</a></span> | <span class="t">And then we do sentence vects one onwards. So this will be the remaining</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=311" target="_blank">00:05:11.200</a></span> | <span class="t">sentences. Okay, so let's take these, or let's just bring them down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=319" target="_blank">00:05:19.360</a></span> | <span class="t">Calculate this. And we can see that our highest similarity by quite a bit is this 0.72. Now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=330" target="_blank">00:05:30.880</a></span> | <span class="t">that means that between this sentence, and this sentence, we have a similarity score of 0.72.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=338" target="_blank">00:05:38.960</a></span> | <span class="t">So clearly, it's working, it's scoring high similarity. And you can play around this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=346" target="_blank">00:05:46.320</a></span> | <span class="t">and, and test multiple different words and sentences and just see how it works. But that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=353" target="_blank">00:05:53.760</a></span> | <span class="t">the easy way putting all this together. So I think it's really cool that we can do that so easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=360" target="_blank">00:06:00.640</a></span> | <span class="t">But I don't think there's really anything else to say about it. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=364" target="_blank">00:06:04.400</a></span> | <span class="t">thank you for watching, and I'll see you in the next one.</span></div></div></body></html>