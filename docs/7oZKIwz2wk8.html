<html><head><title>NEW GPT-4 Function Calling Model!</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>NEW GPT-4 Function Calling Model!</h2><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8"><img src="https://i.ytimg.com/vi/7oZKIwz2wk8/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=0">0:0</a> New GPT-4 and ChatGPT Functions<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=73">1:13</a> Function Calling in OpenAI Docs<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=103">1:43</a> Implementation in Python<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=205">3:25</a> Creating a Function for GPT 4<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=277">4:37</a> Function Calling Instructions<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=371">6:11</a> Calling ChatCompletion with Functions<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=461">7:41</a> Using GPT 4 to Run Functions<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=565">9:25</a> Creating Image Generation Pipeline<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=662">11:2</a> Adding Image Generation to Function<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=823">13:43</a> Creating Product Pages with Images<br><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=916">15:16</a> Final Thoughts on OpenAI Function Calling<br><br><div style="text-align: left;"><a href="./7oZKIwz2wk8.html">Whisper Transcript</a> | <a href="./transcript_7oZKIwz2wk8.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">OpenAI have just released a new functionality for two new models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=5" target="_blank">00:00:05.840</a></span> | <span class="t">Those models are the updated GPT-4 and GPT-3.5 models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=11" target="_blank">00:00:11.920</a></span> | <span class="t">This new feature is called function calling and it essentially allows us to pass to GPT-4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=19" target="_blank">00:00:19.600</a></span> | <span class="t">and GPT-3.5 a description of a Python function and based on that description,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=27" target="_blank">00:00:27.600</a></span> | <span class="t">ask the model a question and if the model sees that this question needs to use one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=34" target="_blank">00:00:34.080</a></span> | <span class="t">function descriptions that you've passed to it, it will go ahead and return you the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=40" target="_blank">00:00:40.080</a></span> | <span class="t">that you need in order to use that function in the way that you have described to GPT-4, GPT-3.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=48" target="_blank">00:00:48.480</a></span> | <span class="t">So it is essentially the tool usage that you would get from LineChain but directly within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=57" target="_blank">00:00:57.280</a></span> | <span class="t">the OpenAI API and it seems just from some initial testing to work pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=64" target="_blank">00:01:04.400</a></span> | <span class="t">So let's have a quick look at what this is and also dive into the code and how we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=71" target="_blank">00:01:11.280</a></span> | <span class="t">actually implement this ourselves. So here we can see that describing what this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=77" target="_blank">00:01:17.200</a></span> | <span class="t">calling is essentially what I just said, right? So we can describe functions to GPT-3.5, GPT-4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=82" target="_blank">00:01:22.880</a></span> | <span class="t">and the model will choose whether it should output a JSON object containing arguments to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=89" target="_blank">00:01:29.360</a></span> | <span class="t">call those functions and then this is an important thing here, so the chat completions API does not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=94" target="_blank">00:01:34.800</a></span> | <span class="t">call the function, it just provides you with those parameters in JSON format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=101" target="_blank">00:01:41.760</a></span> | <span class="t">So let's go ahead and actually see how this works. So I'm going to be using Colab, we don't need all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=111" target="_blank">00:01:51.440</a></span> | <span class="t">of these prerequisite libraries just to understand how this works but I wanted to go with a kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=116" target="_blank">00:01:56.400</a></span> | <span class="t">interesting example. So later on we are going to be using an image generation model from Hugging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=121" target="_blank">00:02:01.760</a></span> | <span class="t">Face diffusers. So for that component of this notebook, again you don't need to get to that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=129" target="_blank">00:02:09.360</a></span> | <span class="t">point in order to understand this, but for that component you do need basically all of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=136" target="_blank">00:02:16.560</a></span> | <span class="t">prerequisites or libraries installed and you should also make sure that you are using a CUDA-enabled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=142" target="_blank">00:02:22.240</a></span> | <span class="t">GPU because otherwise it's going to take a very long time. So you can switch to a GPU runtime</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=151" target="_blank">00:02:31.280</a></span> | <span class="t">within Colab by going to runtime at the top, going to your change runtime type and making sure you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=159" target="_blank">00:02:39.920</a></span> | <span class="t">have GPU in here and you can use the T4 GPU on standard which I believe is available on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=167" target="_blank">00:02:47.040</a></span> | <span class="t">free version of Colab as well. So let's go ahead and run this. So one thing that we will need here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=173" target="_blank">00:02:53.840</a></span> | <span class="t">and we will need to pay for unless you are within the free usage of OpenAI is a OpenAI API key. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=182" target="_blank">00:03:02.240</a></span> | <span class="t">you can get one of those over at platform.openai.com. There'll be a link to that at the top of the video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=188" target="_blank">00:03:08.400</a></span> | <span class="t">right now. Yep, once you have that all you need to do is just enter your API key in here, run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=195" target="_blank">00:03:15.600</a></span> | <span class="t">and you should see this and this will tell us that you are authenticated to use the OpenAI API.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=204" target="_blank">00:03:24.080</a></span> | <span class="t">Okay, it looks good. So what we're going to do is first create a function that we will be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=209" target="_blank">00:03:29.040</a></span> | <span class="t">GPT-4 to call. Also, if you still don't have access to GPT-4, that's fine. We can also,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=215" target="_blank">00:03:35.680</a></span> | <span class="t">I'll show you where you can switch this out for GPT-3.5 as well and you should get pretty similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=222" target="_blank">00:03:42.240</a></span> | <span class="t">results. Okay, so this function that we're going to create is a page builder for a product. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=228" target="_blank">00:03:48.960</a></span> | <span class="t">imagine you want to generate a ton of product pages. You're going to use this function here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=237" target="_blank">00:03:57.600</a></span> | <span class="t">and what you're going to want to do is ask GPT-4 or 3.5 to give you a title and some copy text. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=248" target="_blank">00:04:08.240</a></span> | <span class="t">like the marketing text for that product and we're just going to take that into our HTML code here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=254" target="_blank">00:04:14.560</a></span> | <span class="t">We're going to write that to file and then just for us in the notebook, we're going to view that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=260" target="_blank">00:04:20.160</a></span> | <span class="t">file as well. So we run that, run it again and you should see in a moment we get this. Okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=267" target="_blank">00:04:27.200</a></span> | <span class="t">so I've just manually put in these two parameters here. So the title of the product and the copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=274" target="_blank">00:04:34.080</a></span> | <span class="t">text for that product. Okay, now what we want to do is give GPT-4, GPT-3.5 instructions on how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=285" target="_blank">00:04:45.120</a></span> | <span class="t">use this function. Okay, so to do that we need these three items at high level. So we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=294" target="_blank">00:04:54.160</a></span> | <span class="t">name of this function that GPT will use. It's going to be called page builder. It doesn't necessarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=301" target="_blank">00:05:01.920</a></span> | <span class="t">need to align to the function name here. You can put anything out, anything you want in there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=306" target="_blank">00:05:06.720</a></span> | <span class="t">but basically you'll be using this to identify which function a GPT wants you to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=313" target="_blank">00:05:13.920</a></span> | <span class="t">We need a short description, so creates product web pages. You can make that longer or shorter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=321" target="_blank">00:05:21.680</a></span> | <span class="t">depending on what you need and then parameters. So this is probably the most important part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=326" target="_blank">00:05:26.720</a></span> | <span class="t">So these describe the inputs into your function, right? So those actual inputs are within the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=338" target="_blank">00:05:38.080</a></span> | <span class="t">properties here. Okay, and we have two. We have title and copy text, right? So both of these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=345" target="_blank">00:05:45.520</a></span> | <span class="t">strings and I'm just describing what they actually are. Okay, so the name of the product and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=350" target="_blank">00:05:50.560</a></span> | <span class="t">here marketing copy that describes and sells the product. That's all it is. And then after that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=357" target="_blank">00:05:57.920</a></span> | <span class="t">so within parameters, we say what is required and that is all of the parameters. So title and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=364" target="_blank">00:06:04.320</a></span> | <span class="t">copy text. Okay, so this is basically the description on how GPT can use our function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=370" target="_blank">00:06:10.800</a></span> | <span class="t">So with that, what we're going to do is go to the check completion endpoint. We're going to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=377" target="_blank">00:06:17.920</a></span> | <span class="t">our prompt. So create web page for a new cutting edge mango cutting machine. That's what I want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=383" target="_blank">00:06:23.120</a></span> | <span class="t">GPT to create for us. And then as usual, we use check completion create. So these lines I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=392" target="_blank">00:06:32.640</a></span> | <span class="t">highlighted here, we would always run those. Okay. The only difference now is one we're changing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=399" target="_blank">00:06:39.600</a></span> | <span class="t">model. So using this GPT 4.0.6.13, if again, you don't have access to GPT 4 yet, you should use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=407" target="_blank">00:06:47.200</a></span> | <span class="t">this model here. So GPT 3.5 turbo 0.6.13. And then the other difference. So the difference that allows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=416" target="_blank">00:06:56.560</a></span> | <span class="t">us to use this function calling feature is we add functions and then we pass in a list of functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=423" target="_blank">00:07:03.120</a></span> | <span class="t">that we would like GPT to be able to use. And when I say functions, I mean, these kind of function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=430" target="_blank">00:07:10.560</a></span> | <span class="t">descriptor items. Right. So we, let's run that and this. Okay. And in the response from GPT 4.0.6.13,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=439" target="_blank">00:07:19.200</a></span> | <span class="t">we can see we get all of this. So we have, what do we have here? So basically we can see in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=447" target="_blank">00:07:27.040</a></span> | <span class="t">we have the message, we have function call. Okay. So this is the function call that GPT is creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=455" target="_blank">00:07:35.760</a></span> | <span class="t">for us. And we can also see that we have this new finish reason. So programmatically, how are we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=462" target="_blank">00:07:42.400</a></span> | <span class="t">going to identify that GPT 4 wants us to call our function? Well, we're going to come down to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=469" target="_blank">00:07:49.360</a></span> | <span class="t">We're going to say, okay, if the finish reason is equal to function call, that means we need to call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=474" target="_blank">00:07:54.240</a></span> | <span class="t">a function. Okay. So we run that and okay. Yes, we should call a function. And then based on that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=480" target="_blank">00:08:00.880</a></span> | <span class="t">if it says we should call a function, we need to extract the name of that function. So if we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=486" target="_blank">00:08:06.800</a></span> | <span class="t">multiple functions, this will be useful. So we know which function to use. And we also need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=491" target="_blank">00:08:11.760</a></span> | <span class="t">extract the arguments that we should pass to that function. Okay. So we do that. Also note that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=499" target="_blank">00:08:19.600</a></span> | <span class="t">is actually a string. So we convert it into a dictionary. Okay. And we get this. Right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=507" target="_blank">00:08:27.360</a></span> | <span class="t">So with that, we can use the keyword arguments syntax here, and we can just pass all those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=514" target="_blank">00:08:34.640</a></span> | <span class="t">straight into our page builder function. Okay. We run that and we get this. So the manga master,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=521" target="_blank">00:08:41.760</a></span> | <span class="t">and we get some copy that is definitely better than anything I could write myself. So that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=528" target="_blank">00:08:48.640</a></span> | <span class="t">pretty cool. But I think we can probably do better, especially with all these other models that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=535" target="_blank">00:08:55.920</a></span> | <span class="t">available to us. Right. So this is, yeah, it's a nice text, but I don't know of any product pages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=542" target="_blank">00:09:02.720</a></span> | <span class="t">where it's just text. There's always images as well. So can we also get this GPT-4 or GPT-3.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=553" target="_blank">00:09:13.040</a></span> | <span class="t">function to also generate an image for us? And yes, we can, just not with GPT-4 or GPT-3.5. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=560" target="_blank">00:09:20.960</a></span> | <span class="t">need to use a different model. So we're going to go ahead and do that. So we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=566" target="_blank">00:09:26.480</a></span> | <span class="t">Stability AI's Stable Diffusion model. So this is Stable Diffusion 2.1. And this is just how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=575" target="_blank">00:09:35.840</a></span> | <span class="t">we initialize it. Okay. So we're using Hugging Face Diffusers here. Again, this is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=581" target="_blank">00:09:41.040</a></span> | <span class="t">where we need to use that keyword enabled GPU. You can use CPU. It's just going to take a long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=585" target="_blank">00:09:45.680</a></span> | <span class="t">time for it to generate the image for you. And all of this up to, all of this I've highlighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=594" target="_blank">00:09:54.480</a></span> | <span class="t">is what we need in order to initialize the model or the diffusion pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=600" target="_blank">00:10:00.320</a></span> | <span class="t">Then here, I'm just running a test. Okay. So my test prompt is a photo of an astronaut riding a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=608" target="_blank">00:10:08.320</a></span> | <span class="t">horse on Mars. And then we're going to generate that image with this. And I'm going to display</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=615" target="_blank">00:10:15.360</a></span> | <span class="t">that image to make sure it is actually working. So that will take, the first time we run this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=622" target="_blank">00:10:22.800</a></span> | <span class="t">it's going to take a long time to just download the model. So you'll just have to wait a moment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=627" target="_blank">00:10:27.760</a></span> | <span class="t">for that. Okay. So I've just switched across to this notebook, which I've already pre-run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=632" target="_blank">00:10:32.960</a></span> | <span class="t">But continuing from where we just were, after loading everything, you can just run the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=641" target="_blank">00:10:41.120</a></span> | <span class="t">thing and it will be very quick. So this is 20 seconds on the T4 GPU. So if you have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=650" target="_blank">00:10:50.400</a></span> | <span class="t">bigger, like an A100, it can also go faster. So this is what you get. So it's pretty decent. A</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=657" target="_blank">00:10:57.760</a></span> | <span class="t">photo of an astronaut riding a horse on Mars works relatively well. Now, the thing that we need to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=666" target="_blank">00:11:06.000</a></span> | <span class="t">now is integrate this image generation logic into the function that we were giving to GPT4 before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=675" target="_blank">00:11:15.200</a></span> | <span class="t">So our page builder function. So that's actually very simple. All we're going to do is we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=680" target="_blank">00:11:20.640</a></span> | <span class="t">to provide an image description. So this is going to be the prompt to generate the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=684" target="_blank">00:11:24.800</a></span> | <span class="t">And we're going to take that. We're going to pass it into the pipe that will generate the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=690" target="_blank">00:11:30.640</a></span> | <span class="t">we extract it, and then we're going to save its file. And then we're going to use this image on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=696" target="_blank">00:11:36.400</a></span> | <span class="t">file as the image in our product web page. Okay. So that means we're going to have some slight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=705" target="_blank">00:11:45.520</a></span> | <span class="t">differences in the HTML. So I think the actual HTML here is we just add an image and a source.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=713" target="_blank">00:11:53.680</a></span> | <span class="t">We don't need to make this dynamic because we're just going to save the image file. So it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=718" target="_blank">00:11:58.560</a></span> | <span class="t">to be product.jpg all the time. And yeah, I mean, that's basically it. We just have some CSS to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=726" target="_blank">00:12:06.320</a></span> | <span class="t">sure things are styled kind of correctly. And that's all we need. So from now we would just,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=735" target="_blank">00:12:15.600</a></span> | <span class="t">as before, we're going to save our index.html to file. And that is our function modified. We didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=745" target="_blank">00:12:25.440</a></span> | <span class="t">really change much. We just had that image generation step. Now, as well as modifying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=751" target="_blank">00:12:31.440</a></span> | <span class="t">our actual Python function, we also need to modify the function description that we're passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=757" target="_blank">00:12:37.600</a></span> | <span class="t">to GPT-4 3.5. So in this, we just need to add an extra parameter into our properties. And that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=767" target="_blank">00:12:47.200</a></span> | <span class="t">is going to be the image description parameter. Again, it's a string. And what we do is just give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=772" target="_blank">00:12:52.720</a></span> | <span class="t">a description of what we want. So I want a concise description of the product image using descriptive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=778" target="_blank">00:12:58.160</a></span> | <span class="t">language, but also no more than two sentences long. Okay. So I actually added this in later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=785" target="_blank">00:13:05.040</a></span> | <span class="t">because if we don't add that in, it's going to give us a very long piece of text to describe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=789" target="_blank">00:13:09.840</a></span> | <span class="t">the image, which is fine, but there is a token limit in the clip model that is used by Sable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=795" target="_blank">00:13:15.440</a></span> | <span class="t">Diffusion of 77 tokens, which is relatively short. So it means that things have been truncated and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=802" target="_blank">00:13:22.880</a></span> | <span class="t">we were not getting all of the detail that we actually wanted within the image prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=810" target="_blank">00:13:30.080</a></span> | <span class="t">So I added that little no more than two sentences long into the end there and it works well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=817" target="_blank">00:13:37.280</a></span> | <span class="t">And then we just add the image description to our list of required parameters. And yeah, that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=824" target="_blank">00:13:44.880</a></span> | <span class="t">So we're just going to, with this, we just run this whole logic again. The only difference here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=832" target="_blank">00:13:52.640</a></span> | <span class="t">is I've wrapped it all into a single function. So we make our request to OpenAI, we pass in our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=838" target="_blank">00:13:58.160</a></span> | <span class="t">page builder function description. And what it's going to do is we're going to check for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=844" target="_blank">00:14:04.240</a></span> | <span class="t">finish reason. If it's function call, then we extract the name and the arguments. If the name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=850" target="_blank">00:14:10.080</a></span> | <span class="t">is equal to page builder, then we're going to call the page builder function with those arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=856" target="_blank">00:14:16.640</a></span> | <span class="t">And then from there, we return the HTML of that page. And we get this. So this is actually just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=865" target="_blank">00:14:25.760</a></span> | <span class="t">a loading bar. It just doesn't display properly. But below that, we have our HTML here. We have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=872" target="_blank">00:14:32.560</a></span> | <span class="t">the title, the copy text, and then we have the image here. I couldn't find a good way of showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=879" target="_blank">00:14:39.360</a></span> | <span class="t">the image from Colab. So what you actually just need to do is you go to your files over here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=886" target="_blank">00:14:46.240</a></span> | <span class="t">download the index.html and product.jpg, and then just open it locally, and I will show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=894" target="_blank">00:14:54.640</a></span> | <span class="t">So if I open this, the HTML file locally, we'll get this. So we get this, I don't know, mango</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=901" target="_blank">00:15:01.280</a></span> | <span class="t">cutting machine-like thing in the background here. We get our title and our copy there as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=909" target="_blank">00:15:09.440</a></span> | <span class="t">Which I think is kind of cool. It was super quick to put that together. And it's decent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=916" target="_blank">00:15:16.080</a></span> | <span class="t">So yeah, that's it for this video. I just wanted to have a quick look at this new feature from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=922" target="_blank">00:15:22.560</a></span> | <span class="t">OpenAI, the function calling. Seems pretty interesting. And I suppose, realistically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=930" target="_blank">00:15:30.560</a></span> | <span class="t">we're already able to do this with a line chain. But I think having it as within the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=937" target="_blank">00:15:37.920</a></span> | <span class="t">check completion endpoint is pretty useful for when we just want to kind of keep things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=944" target="_blank">00:15:44.400</a></span> | <span class="t">simple and lighter in our code. So I think that will be pretty useful. And from what I've seen,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=953" target="_blank">00:15:53.200</a></span> | <span class="t">it seems to work really well as well. So I think this is, I think it's pretty interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=959" target="_blank">00:15:59.920</a></span> | <span class="t">Now, that's it for this video. I hope all this has been useful and interesting. So thank you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=966" target="_blank">00:16:06.800</a></span> | <span class="t">very much for watching and I will see you again in the next one. Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=7oZKIwz2wk8&t=970" target="_blank">00:16:10.560</a></span> | <span class="t">[MUSIC]</span></div></div></body></html>