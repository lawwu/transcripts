<html><head><title>Lesson 9 (2019) - How to train your model</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 9 (2019) - How to train your model</h2><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE"><img src="https://i.ytimg.com/vi_webp/AcA8HAYh7IE/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=20">0:20</a> Research<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=536">8:56</a> Climbing init function<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=803">13:23</a> Uniform random numbers<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=960">16:0</a> Confident<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1050">17:30</a> Climbing Uniform<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1118">18:38</a> Initializing<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1274">21:14</a> PiTorch<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1433">23:53</a> initialization approaches<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1627">27:7</a> manual linear layer<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1786">29:46</a> minibatch training<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2065">34:25</a> negative log likelihood<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2286">38:6</a> log some X<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2642">44:2</a> train the model<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2808">46:48</a> model parameters<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3077">51:17</a> add module<br><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3268">54:28</a> optimizer<br><br><div style="text-align: left;"><a href="./AcA8HAYh7IE.html">Whisper Transcript</a> | <a href="./transcript_AcA8HAYh7IE.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Welcome back to lesson 9 part 2, how to train your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8" target="_blank">00:00:08.000</a></span> | <span class="t">Before we talk about training our model, though, I wanted to revisit a couple of things that came up last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=15" target="_blank">00:00:15.000</a></span> | <span class="t">And the reason I really wanted to revisit them is because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=22" target="_blank">00:00:22.000</a></span> | <span class="t">I wanted to kind of give you an insight into how I do research.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=25" target="_blank">00:00:25.000</a></span> | <span class="t">I mean, a lot of this course really will be me showing you how I do research and how I do software development in the hope that that is somewhat helpful to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=33" target="_blank">00:00:33.000</a></span> | <span class="t">So one of the questions that came up last week was we looked at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=42" target="_blank">00:00:42.000</a></span> | <span class="t">That's the size of that. Okay, we looked at. We looked inside the NN dot com 2D that comes with PyTorch to see how it goes about initializing parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=56" target="_blank">00:00:56.000</a></span> | <span class="t">And we found that inside here, convn d dot reset parameters, we found the way that it does initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=63" target="_blank">00:01:03.000</a></span> | <span class="t">And we found this math dot square root 5 without any commentary, which was quite mysterious.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=71" target="_blank">00:01:11.000</a></span> | <span class="t">So I decided to do some research into, you know, kind of dual research.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=77" target="_blank">00:01:17.000</a></span> | <span class="t">One is like, what's the impact of this math dot square root 5?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=81" target="_blank">00:01:21.000</a></span> | <span class="t">And then at the same time, trying to get in touch with the PyTorch team about asking them where this math dot square root 5 comes from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=88" target="_blank">00:01:28.000</a></span> | <span class="t">So let me show you how I went about doing that research.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=92" target="_blank">00:01:32.000</a></span> | <span class="t">So I loaded up just what we had from last week, which was the ability to download the MNIST data and open it up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=113" target="_blank">00:01:53.000</a></span> | <span class="t">And then the function to normalize it, which I thought we'd export if we haven't already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=121" target="_blank">00:02:01.000</a></span> | <span class="t">And then we'd grab the data and would normalize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=124" target="_blank">00:02:04.000</a></span> | <span class="t">And because we're going to be talking a lot about convolutions towards the end of today's lesson and particularly next lesson, I suspect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=133" target="_blank">00:02:13.000</a></span> | <span class="t">So I'll skip over some of the details about convolutions for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=136" target="_blank">00:02:16.000</a></span> | <span class="t">But basically to do a convolution, as you know, we need a square or rectangular input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=142" target="_blank">00:02:22.000</a></span> | <span class="t">And our MNIST input, remember, was just a single vector per image 768 long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=147" target="_blank">00:02:27.000</a></span> | <span class="t">So I resized them all to 28 by 28 one channel images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=153" target="_blank">00:02:33.000</a></span> | <span class="t">So that we could test out the impact of this conv2d in it in PyTorch and set up the various variables that we wanted to have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=163" target="_blank">00:02:43.000</a></span> | <span class="t">And then I created a conv2d layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=166" target="_blank">00:02:46.000</a></span> | <span class="t">So we have one input because it's just one channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=168" target="_blank">00:02:48.000</a></span> | <span class="t">NH, which is number hidden, which is 32 outputs. And let's do a five by five kernel. And we're talking more about why five by five might be suitable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=177" target="_blank">00:02:57.000</a></span> | <span class="t">And just for testing, let's just grab the first hundred elements of the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=182" target="_blank">00:03:02.000</a></span> | <span class="t">So we've now got a tensor of one hundred by one by twenty eight by twenty eight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=187" target="_blank">00:03:07.000</a></span> | <span class="t">So it's a really good idea when you're playing with anything in software development, but including notebooks to refactor things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=198" target="_blank">00:03:18.000</a></span> | <span class="t">So I'm going to be wanting to look at the main and standard deviation of a bunch of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=202" target="_blank">00:03:22.000</a></span> | <span class="t">So let's create a little function called stats to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=206" target="_blank">00:03:26.000</a></span> | <span class="t">And I never plan ahead what I'm going to do when you see this in a notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=209" target="_blank">00:03:29.000</a></span> | <span class="t">It always means that I've written out that by hand and then I copied it and then I'm like, OK, I'm using it twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=215" target="_blank">00:03:35.000</a></span> | <span class="t">I'll chuck it in a function. So then I go back and create the function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=218" target="_blank">00:03:38.000</a></span> | <span class="t">So here I've got the mean and standard deviation of my L1, which is a conv2d layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=226" target="_blank">00:03:46.000</a></span> | <span class="t">And so a conv2d layer contains a weight tensor parameter and a bias tensor parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=233" target="_blank">00:03:53.000</a></span> | <span class="t">So just to remind you, L1.weight.shape is 32 output filters because that's what number hidden was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=246" target="_blank">00:04:06.000</a></span> | <span class="t">One input filter because we only have one channel and then five by five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=250" target="_blank">00:04:10.000</a></span> | <span class="t">OK, so that's the size of our tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=253" target="_blank">00:04:13.000</a></span> | <span class="t">And if you've forgotten why that's the size of a tensor, you can go back to the Excel directory, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=262" target="_blank">00:04:22.000</a></span> | <span class="t">from part one where you can find the conv example spreadsheet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=270" target="_blank">00:04:30.000</a></span> | <span class="t">And in the conv example spreadsheet, you can see what each of those parameters does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=278" target="_blank">00:04:38.000</a></span> | <span class="t">So we basically had a filter for each input channel and for each output channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=287" target="_blank">00:04:47.000</a></span> | <span class="t">So that's kind of what it looked like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=289" target="_blank">00:04:49.000</a></span> | <span class="t">And so the next layer, we now have a four dimensional tensor, a rank four tensor that we've got the three by three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=302" target="_blank">00:05:02.000</a></span> | <span class="t">We've got it for each input and for each output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=308" target="_blank">00:05:08.000</a></span> | <span class="t">OK, so that's the 32 by one by five by five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=314" target="_blank">00:05:14.000</a></span> | <span class="t">So the main and standard deviation of the weights zero and point one one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=322" target="_blank">00:05:22.000</a></span> | <span class="t">And this is because we know that behind the scenes, it's called this function to initialize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=332" target="_blank">00:05:32.000</a></span> | <span class="t">So the bias is initialized with a uniform random number between negative of this and positive of this and then the weights are initialized with timing uniform with this odd math dot square root five thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=350" target="_blank">00:05:50.000</a></span> | <span class="t">So that's fine. That's not particularly interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=352" target="_blank">00:05:52.000</a></span> | <span class="t">What's more interesting is to take our input tensor of M NIST numbers and put it through this layer, which we called L1, which remember is a conv2D layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=363" target="_blank">00:06:03.000</a></span> | <span class="t">So layer one and let's create an output T and let's look at the stats of T.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=369" target="_blank">00:06:09.000</a></span> | <span class="t">So this is the stats of the output of this layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=372" target="_blank">00:06:12.000</a></span> | <span class="t">We would like it to be a mean of zero and a standard deviation or a variance of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=378" target="_blank">00:06:18.000</a></span> | <span class="t">The mean of zero is there, but the deviation of one is not there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=384" target="_blank">00:06:24.000</a></span> | <span class="t">So that looks like a problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=387" target="_blank">00:06:27.000</a></span> | <span class="t">Let's compare this to the normal timing in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=391" target="_blank">00:06:31.000</a></span> | <span class="t">So the normal timing in it, remember, is designed to be used after a value layer or more generally a leaky value layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=405" target="_blank">00:06:45.000</a></span> | <span class="t">And recall that a leaky value layer has the y equals x here and here the gradient of this is called a or leak or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=425" target="_blank">00:07:05.000</a></span> | <span class="t">And now in our case, we're just looking at a conv layer, so we don't have anything kind of going on there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=433" target="_blank">00:07:13.000</a></span> | <span class="t">In fact, it's straight here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=436" target="_blank">00:07:16.000</a></span> | <span class="t">So effectively we have like a leak, if you like, of one or an A of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=441" target="_blank">00:07:21.000</a></span> | <span class="t">So to use climbing in it with no value, we can just put a equals one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=446" target="_blank">00:07:26.000</a></span> | <span class="t">And if we do that, then we get a mean of zero and a variance of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=451" target="_blank">00:07:31.000</a></span> | <span class="t">So climbing in it seems to be working nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=457" target="_blank">00:07:37.000</a></span> | <span class="t">OK, so let's now try it with value. So let's now define a function, which is the function for layer one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=465" target="_blank">00:07:45.000</a></span> | <span class="t">which is to pass it through our layer one conv and then do a value with some A, some leak amount,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=472" target="_blank">00:07:52.000</a></span> | <span class="t">which we'll set to zero by default. So this will be just a regular value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=478" target="_blank">00:07:58.000</a></span> | <span class="t">And you can see that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=481" target="_blank">00:08:01.000</a></span> | <span class="t">If we now run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=485" target="_blank">00:08:05.000</a></span> | <span class="t">If we now run that with climbing initialization, we get a variance of one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=490" target="_blank">00:08:10.000</a></span> | <span class="t">which is good and the main is no longer zero as we discussed last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=494" target="_blank">00:08:14.000</a></span> | <span class="t">It's about a half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=497" target="_blank">00:08:17.000</a></span> | <span class="t">But if we go back and reinitialize the com2d with this default PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=503" target="_blank">00:08:23.000</a></span> | <span class="t">this is not looking good at all with relu. It's even worse because remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=508" target="_blank">00:08:28.000</a></span> | <span class="t">They don't have anything kind of handling that relu case in the default con.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=514" target="_blank">00:08:34.000</a></span> | <span class="t">So this looks like a problem, so a variance of point three five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=518" target="_blank">00:08:38.000</a></span> | <span class="t">It may not sound a lot lower than one, but let's look. Take a look at what that means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=525" target="_blank">00:08:45.000</a></span> | <span class="t">So I forgot to mention where we are. This is the zero to a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=530" target="_blank">00:08:50.000</a></span> | <span class="t">Why square root five notebook so zero to a notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=536" target="_blank">00:08:56.000</a></span> | <span class="t">So in order to explore this, I decided that I would try and write my own.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=541" target="_blank">00:09:01.000</a></span> | <span class="t">Timing in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=544" target="_blank">00:09:04.000</a></span> | <span class="t">Function and so normally with the timing in it function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=549" target="_blank">00:09:09.000</a></span> | <span class="t">If we were working with just a regular fully connected matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=557" target="_blank">00:09:17.000</a></span> | <span class="t">We would basically be saying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=562" target="_blank">00:09:22.000</a></span> | <span class="t">How many output filters are there so what's the if this is the weight matrix then what's the what's the width of the weight matrix for a convolutional layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=570" target="_blank">00:09:30.000</a></span> | <span class="t">It's a little bit different is a little bit different right because what we actually want to know is each time like in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=580" target="_blank">00:09:40.000</a></span> | <span class="t">We're basically multiplying all these together with some sort of inputs and then adding them all up right that's basically what a single step of a matrix multiplication is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=590" target="_blank">00:09:50.000</a></span> | <span class="t">In a convolution we're also multiplying a bunch of things together and adding them up, but what we're actually adding together is if it was three by three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=599" target="_blank">00:09:59.000</a></span> | <span class="t">Is we're multiplying together each of the three by three elements.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=603" target="_blank">00:10:03.000</a></span> | <span class="t">Right and also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=605" target="_blank">00:10:05.000</a></span> | <span class="t">The channel dimension that we actually multiply all of those together and add them all up so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=612" target="_blank">00:10:12.000</a></span> | <span class="t">Because convolution and matrix multiplication are kind of one in the same thing as we know with some weight tying and with some with some zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=621" target="_blank">00:10:21.000</a></span> | <span class="t">So in order to calculate the total number of modifications and additions going on for a convolutional layer we need to basically take the kernel size which in this case is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=636" target="_blank">00:10:36.000</a></span> | <span class="t">5 by 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=639" target="_blank">00:10:39.000</a></span> | <span class="t">And multiply it by.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=641" target="_blank">00:10:41.000</a></span> | <span class="t">The number of filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=643" target="_blank">00:10:43.000</a></span> | <span class="t">Okay, so the general way to get that 5 by 5 piece is we can just grab any one piece of this weight tensor and that will return a 5 by 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=653" target="_blank">00:10:53.000</a></span> | <span class="t">Kernel and then say how many elements are in that part of the weight tensor and that's going to be the receptive field size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=661" target="_blank">00:11:01.000</a></span> | <span class="t">So the receptive field size for just the immediate layer before is how many.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=669" target="_blank">00:11:09.000</a></span> | <span class="t">How many elements are in that kernel so for this it's 25 it's 5 by 5 right and so if we then say okay let's grab the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=678" target="_blank">00:11:18.000</a></span> | <span class="t">Shape of the weight matrix and it gives us the number of filters out 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=683" target="_blank">00:11:23.000</a></span> | <span class="t">And then the number of filters in one and then I'll skip the rest because they're the only two things I want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=689" target="_blank">00:11:29.000</a></span> | <span class="t">So now for the timing her in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=692" target="_blank">00:11:32.000</a></span> | <span class="t">We can calculate fan in is the number of input filters times receptive field size so that's 1 times 25 fan out is 32 by 25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=705" target="_blank">00:11:45.000</a></span> | <span class="t">So there you can see this is how we calculate the effective fan in and fan out for a convolutional layer so we can do all that by hand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=718" target="_blank">00:11:58.000</a></span> | <span class="t">And then the timing in it formula you need to then for leaky value you need to multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=728" target="_blank">00:12:08.000</a></span> | <span class="t">By root 2 or if there's a leaky part in it so if the A is not equal to 0 then it is actually root 2 divided by 1 plus a squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=741" target="_blank">00:12:21.000</a></span> | <span class="t">So that's just the formula for the timing in it and that's often called the gain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=747" target="_blank">00:12:27.000</a></span> | <span class="t">For the in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=750" target="_blank">00:12:30.000</a></span> | <span class="t">And so there's a formula for the gain so you can see that if the gain is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=756" target="_blank">00:12:36.000</a></span> | <span class="t">Right then that's just linear there's no nonlinearity at all so there's no change to the calculation of how you do the initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=766" target="_blank">00:12:46.000</a></span> | <span class="t">On the other hand if it's a standard value then you've got the root 2 which we saw last week from the from the timing paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=775" target="_blank">00:12:55.000</a></span> | <span class="t">With a gain of .01 it's about root 2 as well is pretty close and this is a kind of a common leaky value amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=781" target="_blank">00:13:01.000</a></span> | <span class="t">But what about in the case of the pie torch in it in the case of the pie torch in it it's root 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=788" target="_blank">00:13:08.000</a></span> | <span class="t">Which is .577 which sounds like an odd.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=792" target="_blank">00:13:12.000</a></span> | <span class="t">Number it's a long way away from what we were expecting to see so that's a bit concerning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=803" target="_blank">00:13:23.000</a></span> | <span class="t">But one thing we have to account for here is that the initialization that they use for pie torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=814" target="_blank">00:13:34.000</a></span> | <span class="t">Is not climbing normal it's climbing uniform right and so normally distributed random numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=830" target="_blank">00:13:50.000</a></span> | <span class="t">Look like that but uniform random numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=838" target="_blank">00:13:58.000</a></span> | <span class="t">Look like that right and so the uniform random numbers they were using as their kind of starting point were between.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=848" target="_blank">00:14:08.000</a></span> | <span class="t">Minus one and one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=851" target="_blank">00:14:11.000</a></span> | <span class="t">The standard deviation of that obviously is not one right the standard deviation is obviously less than one and so you can Google for the standard deviation of a uniform distribution or you could jump into Excel or Python and just grab a bunch of random numbers and find out what the standard deviation is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=871" target="_blank">00:14:31.000</a></span> | <span class="t">And you'll find that you can I've got it here actually I've grabbed ten thousand random numbers in that uniform distribution and asked for this standard deviation and it turns out that it's one over root three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=887" target="_blank">00:14:47.000</a></span> | <span class="t">Okay so part of the reason for this difference actually. Is that they need a gain to handle uniform random numbers rather than just normal random numbers but it still doesn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=904" target="_blank">00:15:04.000</a></span> | <span class="t">Quite account for the difference so let's take a look so here's here's my version of climbing in which I've just grabbed all of the previous lines of code and merge them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=915" target="_blank">00:15:15.000</a></span> | <span class="t">And then I've just added this thing to multiply it by root three because of the uniform random number and so then if I run this timing to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=927" target="_blank">00:15:27.000</a></span> | <span class="t">On my weights and get the stats of that nice again get a variance of about one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=935" target="_blank">00:15:35.000</a></span> | <span class="t">And again confirming that if I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=940" target="_blank">00:15:40.000</a></span> | <span class="t">Well this is interesting if I do it with a equals math dot square root five I would expect to get the same result as the pie torch default which I do it's about point four which is what we found back here point three five so it seems like we've successfully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=957" target="_blank">00:15:57.000</a></span> | <span class="t">You know re implemented what they had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=960" target="_blank">00:16:00.000</a></span> | <span class="t">So at this point I was like okay well what is this what does this do what does this mean so to see kind of what this looks like I threw together a quick confident.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=972" target="_blank">00:16:12.000</a></span> | <span class="t">And I grabbed the first hundred dependent variables and so then I took my input and I ran it through the whole confident to get the stats out of the results so this is now telling me what happens when I use the default pie torch in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=987" target="_blank">00:16:27.000</a></span> | <span class="t">And put it through a four layer confident and the answer is I end up with a variance of point oh oh six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=996" target="_blank">00:16:36.000</a></span> | <span class="t">And that sounds likely to be a really big problem right because there's there's so little variation going on that last layer and also there's a huge difference between the first layer and the last layer that's the really big issue the first layer had a standard deviation of point four and the last layer had a standard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1013" target="_blank">00:16:53.000</a></span> | <span class="t">Well the input layers is one that's the first hidden layer is point four and the last layer is point oh six so these are all going at like totally different rates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1024" target="_blank">00:17:04.000</a></span> | <span class="t">And then what we could do is we could grab that prediction and put it through mean squared error this is the function we created last week run backward and get the stats on the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1037" target="_blank">00:17:17.000</a></span> | <span class="t">For the first layer weights so this is now going all the way forward and all the way back again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1041" target="_blank">00:17:21.000</a></span> | <span class="t">And again standard deviation is nowhere near one so that sounds like a big problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1050" target="_blank">00:17:30.000</a></span> | <span class="t">So let's try using climbing uniform instead and if you look at the climbing uniform source code you'll see that it's got this it's got the steps that we saw gain over root of the fan and here is the square root of three because it's uniform okay and so we can confirm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1070" target="_blank">00:17:50.000</a></span> | <span class="t">Let's go through and go through every layer and if it's a convolutional layer then let's call climbing uniform on the weights and set the biases to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1081" target="_blank">00:18:01.000</a></span> | <span class="t">So we'll initialize it ourselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1087" target="_blank">00:18:07.000</a></span> | <span class="t">And then we'll grab T.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1091" target="_blank">00:18:11.000</a></span> | <span class="t">And it's not one but it's a lot better than point oh eight so this is pretty encouraging that we can get through four layers we wouldn't want to probably have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1103" target="_blank">00:18:23.000</a></span> | <span class="t">A forty layer neural network which is losing this much variance but it should be fine plenty good enough for a four layer network and then let's also confirm on the backward and the backward the first layers gradient is point five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1117" target="_blank">00:18:37.000</a></span> | <span class="t">So that was my kind of starting point for the research here and at the end of this I kind of thought this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1126" target="_blank">00:18:46.000</a></span> | <span class="t">You know pretty concerning and why did I think it was concerning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1132" target="_blank">00:18:52.000</a></span> | <span class="t">We'll be saying a lot more about why it's concerning but let's quickly look at to be initializing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1138" target="_blank">00:18:58.000</a></span> | <span class="t">So I put this together today and he called this why you need a good in it and he's just he's pointed out here that if you grab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1147" target="_blank">00:19:07.000</a></span> | <span class="t">To grab a random vector X and a random matrix a which is random normally distributed mean zero and standard deviation of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1161" target="_blank">00:19:21.000</a></span> | <span class="t">Then a hundred times you basically go X is a times X and then you go so you're basically multiplying again and again and again after a hundred iterations your standard deviation and mean are not a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1179" target="_blank">00:19:39.000</a></span> | <span class="t">So basically the issue is that when you multiply by a matrix lots and lots of times you explode out to the point that your computer can't even keep track.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1189" target="_blank">00:19:49.000</a></span> | <span class="t">So what silver did next was he actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1192" target="_blank">00:19:52.000</a></span> | <span class="t">Put something in a loop to check whether it's not a number and he found it was twenty twenty twenty eight iterations before it before it died.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1204" target="_blank">00:20:04.000</a></span> | <span class="t">So it didn't take very long to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1209" target="_blank">00:20:09.000</a></span> | <span class="t">To explode now in the other hand what if we take the random numbers for the standard deviation of point or one instead of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1217" target="_blank">00:20:17.000</a></span> | <span class="t">And we do that a hundred times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1220" target="_blank">00:20:20.000</a></span> | <span class="t">Then it disappears to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1222" target="_blank">00:20:22.000</a></span> | <span class="t">So you can see like you know if you've got a hundred layer neural net because that's what it's doing it's doing a hundred matrix multipliers on itself on the on the output of each previous one you've got to be super careful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1233" target="_blank">00:20:33.000</a></span> | <span class="t">To find some set of weights that because because if this is your starting set of weights if it's point or one or if it's one standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1244" target="_blank">00:20:44.000</a></span> | <span class="t">You can't ever learn anything because there are no gradients the gradients are either zero or man right so you actually have to have a reasonable starting point and this is really why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1255" target="_blank">00:20:55.000</a></span> | <span class="t">For decades people weren't able to train deep neural networks because people hadn't figured out how to initialize them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1266" target="_blank">00:21:06.000</a></span> | <span class="t">So instead we have to use some.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1270" target="_blank">00:21:10.000</a></span> | <span class="t">In it okay and we'll talk about that in a moment for those who are interested Silvan's thing gone on to describe why it is that you have to divide by the square root of the fan.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1281" target="_blank">00:21:21.000</a></span> | <span class="t">And so feel free to keep reading that if you're interested it's it's cool but we don't need to know it for now it's just some derivation and further discussion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1292" target="_blank">00:21:32.000</a></span> | <span class="t">So in parallel I also asked the pipe torch team about this and I sent these results to them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1298" target="_blank">00:21:38.000</a></span> | <span class="t">And I said what's going on and so sumeth finally appeared and he said it was a historical accident because 15 years ago or for 15 years before Python appeared there was a product called torch a neural network product in lower and they did it that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1317" target="_blank">00:21:57.000</a></span> | <span class="t">And so then on Google Plus in 2014 he started talking to someone a dealer man who's now a deep mind and about at this time maybe a bit before he was our intern actually and.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1330" target="_blank">00:22:10.000</a></span> | <span class="t">Sonda said this is. At analytic. And Sonda said this this route five thing looks weird and sumeth said no no go look at the paper and Sonda said no that's not what the paper said and sumeth said oh it's a bug but it's a good bug because somebody at somebody went and checked it out and they thought that they were getting better results with this thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1354" target="_blank">00:22:34.000</a></span> | <span class="t">So so then I talked to sumeth and he was already aware of this issue to some extent and within a couple of hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1367" target="_blank">00:22:47.000</a></span> | <span class="t">I torch team had created an issue saying they're going to update their their edits so this is super cool like it so this is like partly to say well this is an awesome team super responsive and this is why pie torch works so well is that they see issues and they fix them but it's also to say like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1389" target="_blank">00:23:09.000</a></span> | <span class="t">When you see something in a library don't assume it's it's right or that it makes sense you know when it comes to deep learning none of us know what we're doing and you can see it doesn't take too much to kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1401" target="_blank">00:23:21.000</a></span> | <span class="t">Begin to something you know and then you can you know raise an issue and say his his analysis that I did there's a fantastic extension called just it just it for Jupiter notebooks that lets you take your little research notebook press a single button and it turns it into a shareable just that you can then put a link to say here's the analysis that I did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1425" target="_blank">00:23:45.000</a></span> | <span class="t">And so yeah that's that's a little bit of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1429" target="_blank">00:23:49.000</a></span> | <span class="t">A little bit of research idea to answering this question from last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1434" target="_blank">00:23:54.000</a></span> | <span class="t">There are lots of interesting initialization approaches you can use we've already talked about the lower and Ben Jio paper we've already talked about the timing her paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1445" target="_blank">00:24:05.000</a></span> | <span class="t">There's an interesting paper called all you need is a good in it which describes how you can kind of iteratively go through your network and set one layer of weights at a time to like literally like kind of do a little optimized to find out which set of parameters gets you a unit variance at every point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1464" target="_blank">00:24:24.000</a></span> | <span class="t">There's another cool paper which talks about something called orthogonal initialization if you've done some many algebra particularly if you've done Rachel's computational linear algebra course you'll know about the idea of orthogonal matrices and they make good in its.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1480" target="_blank">00:24:40.000</a></span> | <span class="t">We talked briefly last week about fix up initialization and then there's also something called self normalizing neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1488" target="_blank">00:24:48.000</a></span> | <span class="t">Fix up and self normalizing neural networks are both interesting papers because they describe how to try to set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1495" target="_blank">00:24:55.000</a></span> | <span class="t">A combination of kind of activation functions and in it such that you are guaranteed a unit variance as deep as you like and both of those 2 papers went to something like a thousand layers deep and train them successfully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1512" target="_blank">00:25:12.000</a></span> | <span class="t">In both cases the fix ups much more recent but in both cases people have kind of held them as.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1519" target="_blank">00:25:19.000</a></span> | <span class="t">Reasons we can get rid of batch norm I think it's very unlikely to be true very very few people use this sell you thing now because in both cases they're incredibly fiddly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1530" target="_blank">00:25:30.000</a></span> | <span class="t">You know so for example in this in the self normalizing neural networks case if you put in dropout you need to put a correction if you know if you do anything different in put in a correction as soon as you as you've seen as soon as something changes like the amount of leakiness in your activation function or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1546" target="_blank">00:25:46.000</a></span> | <span class="t">All you know all of your assumptions about what your variance will be in the next layer disappear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1553" target="_blank">00:25:53.000</a></span> | <span class="t">And for the cellular paper it was a particular problem because it relied on 2 specific numbers that were calculated in a famous 96 page long appendix of math in the cellular paper and so if you wanted to do a slightly different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1570" target="_blank">00:26:10.000</a></span> | <span class="t">You know architecture in any way and they only showed this a fully connected network so even if you want to do convolutions what are you going to do you know redo that 96 pages of math so that 96 pages of math is now so famous that it has its own Twitter handle the cellular appendix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1585" target="_blank">00:26:25.000</a></span> | <span class="t">Which has the pin tweet why does nobody want to read me and this is like literally what the entire 96 pages of the appendix looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1595" target="_blank">00:26:35.000</a></span> | <span class="t">I will mention that this in my opinion this is kind of a dumb way of finding those 2 numbers the all you need is a good in it paper is a much better approach to kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1606" target="_blank">00:26:46.000</a></span> | <span class="t">Doing these things in my opinion which is like if you've got a couple of parameters you need to set then why not kind of set them using a quick little loop or something you know so if you if you need those if you want to find.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1618" target="_blank">00:26:58.000</a></span> | <span class="t">To kind of sell you parameters that work for your architecture you can find them empirically pretty quickly and pretty easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1627" target="_blank">00:27:07.000</a></span> | <span class="t">Okay so that's a little bit about in it we'll come back to more of that very shortly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1634" target="_blank">00:27:14.000</a></span> | <span class="t">There was one other question from last week which was we noticed that the shape of the kind of manual linear layer we created and the shape of the pipe torch one were transposed and the question was why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1652" target="_blank">00:27:32.000</a></span> | <span class="t">And so again I did some digging into this until eventually sumeth from the high torch team pointed out to me this commit from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1662" target="_blank">00:27:42.000</a></span> | <span class="t">7 years ago in the old lure torch code where this actually happened and that basically it's because that old lure library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1671" target="_blank">00:27:51.000</a></span> | <span class="t">Couldn't handle batch matrix multiplication without doing it in this transposed way and that's why still to this day pie torch does it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1680" target="_blank">00:28:00.000</a></span> | <span class="t">And upside down which is fine like it's not slower it's not a problem but again it's kind of an interesting case of like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1688" target="_blank">00:28:08.000</a></span> | <span class="t">I find this happens all the time like in deep learning something's done a particular way forever and then everybody does it that way forever and nobody goes back and says why now this particular case it really doesn't matter I don't think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1702" target="_blank">00:28:22.000</a></span> | <span class="t">But often it does right so like things like how do we initialize neural networks and how many layers should they have and stuff like that they kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1710" target="_blank">00:28:30.000</a></span> | <span class="t">Nobody really thought of like nobody really changed challenged the normal practices for years so I'm hoping that with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1716" target="_blank">00:28:36.000</a></span> | <span class="t">You know really ground up approach you can see what the assumptions we're making are and see how to question them and see that you know even to me pie torch is the best library around at the moment and even pie torch has these weird kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1731" target="_blank">00:28:51.000</a></span> | <span class="t">Our cake edges to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1736" target="_blank">00:28:56.000</a></span> | <span class="t">OK so that was a little diversion to start with but a fun diversion because that's you know something I spend a couple of days this week on and think it's pretty interesting so to go back to how do we implement a basic modern CNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1750" target="_blank">00:29:10.000</a></span> | <span class="t">Model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1753" target="_blank">00:29:13.000</a></span> | <span class="t">We got to this point so we've done a matrix modification so that's our fine function we've done real you so that's our nonlinearity and so a fully connected network forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1767" target="_blank">00:29:27.000</a></span> | <span class="t">Is simply layering together those 2 things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1771" target="_blank">00:29:31.000</a></span> | <span class="t">So we did that and then we did the backward pass and we kind of refactored that nicely and it turned out that it looked pretty similar to pie torches way of doing things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1781" target="_blank">00:29:41.000</a></span> | <span class="t">And so now we're ready to train our model and that's where we're up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1787" target="_blank">00:29:47.000</a></span> | <span class="t">So here we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1789" target="_blank">00:29:49.000</a></span> | <span class="t">Oh 3 many batch training and we're going to train our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1793" target="_blank">00:29:53.000</a></span> | <span class="t">So we can start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1796" target="_blank">00:29:56.000</a></span> | <span class="t">By grabbing our MNIST data so again we're just importing the stuff that we just exported from the previous class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1804" target="_blank">00:30:04.000</a></span> | <span class="t">Here's the model we created in the previous class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1808" target="_blank">00:30:08.000</a></span> | <span class="t">And so let's get some predictions from that model and we'll call them pred.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1814" target="_blank">00:30:14.000</a></span> | <span class="t">And so now to train our model the first thing we need to do is we need a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1820" target="_blank">00:30:20.000</a></span> | <span class="t">Because without a loss function we can't train it now profuse previously we used mean squared error which I said was a total cheap.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1828" target="_blank">00:30:28.000</a></span> | <span class="t">Now that we've decided to trust pie torches auto grad we can use many more things because you don't have to write our own gradients and I'm too lazy to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1839" target="_blank">00:30:39.000</a></span> | <span class="t">So let's go ahead and use cross entropy because cross entropy makes a lot more sense to remind you from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1847" target="_blank">00:30:47.000</a></span> | <span class="t">The last class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1850" target="_blank">00:30:50.000</a></span> | <span class="t">There is an entropy example notebook where we learnt first of all that cross entropy requires doing two things first of all softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1861" target="_blank">00:31:01.000</a></span> | <span class="t">Well in the case it is multi class categorical cross entropy first to softmax and then you do the negative log likelihood so the softmax was if we have a bunch of different possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1873" target="_blank">00:31:13.000</a></span> | <span class="t">Predictions and we got some output for each one from our model then we take either the power of that output we sum them all up and then we take.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1885" target="_blank">00:31:25.000</a></span> | <span class="t">Either the power of divided by the sum of either the power of and that was our softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1890" target="_blank">00:31:30.000</a></span> | <span class="t">So there it is in math form there it is in summation math form and here it is in code form.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1905" target="_blank">00:31:45.000</a></span> | <span class="t">So either the X divided by X X some and then the whole thing we do a dot log and that's because in pie torch negative log likelihood expects a log softmax not just a softmax and we'll see why in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1924" target="_blank">00:32:04.000</a></span> | <span class="t">I'm sorry pop a log on the end so here's a lot longer softmax function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1929" target="_blank">00:32:09.000</a></span> | <span class="t">So now we can go ahead and create a softmax predictions by passing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1933" target="_blank">00:32:13.000</a></span> | <span class="t">Preds to log softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1936" target="_blank">00:32:16.000</a></span> | <span class="t">Now that we've done that we can calculate cross entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1941" target="_blank">00:32:21.000</a></span> | <span class="t">And cross entropy loss is generally expressed in this form which is this form some of actual times the log of the probability of that actual so in other words if we have is cat and is dog then here's our actual so it's one hot encoded is cat yes is dog no.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1966" target="_blank">00:32:46.000</a></span> | <span class="t">We have our predictions from our from our model from our softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1973" target="_blank">00:32:53.000</a></span> | <span class="t">We can then say well what's the log of the probability it's a cat so log of this what's the log of the probability it's a dog so log of one minus that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1983" target="_blank">00:33:03.000</a></span> | <span class="t">And so then our negative log likelihood is simply B times E plus C times F and then take the negative of all that that's negative log likelihood which is what this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=1996" target="_blank">00:33:16.000</a></span> | <span class="t">But remember and I know I keep saying this because people keep forgetting not you guys but people out in the world keep forgetting that when you're multiplying by stuff which is mainly 0 and one hot encoded multi categorical classification most of your categories are 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2012" target="_blank">00:33:32.000</a></span> | <span class="t">Every time you multiply by 0 you're doing nothing at all but you're doing it very slowly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2017" target="_blank">00:33:37.000</a></span> | <span class="t">So rather than multiplying by 0 and then adding up the one one that you have a much faster way as we know to do to multiply by a one hot encoded thing is to first of all simply say what's the location of the one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2033" target="_blank">00:33:53.000</a></span> | <span class="t">Here so in this case it's location to this case it's location one if we index from one and then we just look up into our array of probabilities directly offset by this amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2046" target="_blank">00:34:06.000</a></span> | <span class="t">Or put it in math terms for one hot encoded X's the above is simply log of PI where I is the index of our prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2060" target="_blank">00:34:20.000</a></span> | <span class="t">Sorry not our prediction of the actual so the index into here the actual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2066" target="_blank">00:34:26.000</a></span> | <span class="t">So how do we write this in PyTorch and I'll show you a really cool trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2075" target="_blank">00:34:35.000</a></span> | <span class="t">This is that this is what we're going to end up with this is our negative log likelihood.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2080" target="_blank">00:34:40.000</a></span> | <span class="t">Implementation and it's incredibly fast and incredibly concise and I'll show you how we do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2086" target="_blank">00:34:46.000</a></span> | <span class="t">Let's look at our dependent variable so let's just look at the first three values there five zero four so that's the first three elements of the dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2099" target="_blank">00:34:59.000</a></span> | <span class="t">And so what we want to do is we want to find what is the probability associated with five in our predictions and with zero and with four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2111" target="_blank">00:35:11.000</a></span> | <span class="t">So our predictions are softmax predictions remember fifty thousand by ten and so if we take the very first of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2125" target="_blank">00:35:25.000</a></span> | <span class="t">That I all are right and so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2130" target="_blank">00:35:30.000</a></span> | <span class="t">Said that the actual answer should be five so if we go into this zero one two three four five that's the answer that we're going to want right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2151" target="_blank">00:35:51.000</a></span> | <span class="t">So here's how we can grab all three of those at once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2155" target="_blank">00:35:55.000</a></span> | <span class="t">We can index into our array with the whole thing five zero four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2162" target="_blank">00:36:02.000</a></span> | <span class="t">And then for the first bit we pass in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2165" target="_blank">00:36:05.000</a></span> | <span class="t">Just contiguous integers zero one two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2169" target="_blank">00:36:09.000</a></span> | <span class="t">Why does this work this works because PyTorch supports all of the advanced indexing support from NumPy and so if you click on this link.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2180" target="_blank">00:36:20.000</a></span> | <span class="t">One of the many things that types of indexing that NumPy and therefore PyTorch supports is integer array indexing and what this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2190" target="_blank">00:36:30.000</a></span> | <span class="t">Is that you pass a list for each dimension so in this case we have two dimensions so we need to pass two lists and the first is the list of all of the row indexes you want and the second is the list of all of the column indexes you want so this is going to end up returning zero comma five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2209" target="_blank">00:36:49.000</a></span> | <span class="t">One comma zero and two comma four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2213" target="_blank">00:36:53.000</a></span> | <span class="t">Which is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2215" target="_blank">00:36:55.000</a></span> | <span class="t">The exact numbers that we wanted so example zero five is minus two point four nine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2221" target="_blank">00:37:01.000</a></span> | <span class="t">So to grab the entire list of the exact things that we want for our negative log likelihood.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2231" target="_blank">00:37:11.000</a></span> | <span class="t">Then we basically say OK let's look in our predict let's look in our predictions and then for our row indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2241" target="_blank">00:37:21.000</a></span> | <span class="t">It's every single row index so range of target dot shape zero so target dot shape zero is the number of rows so range of that is all of the numbers from zero to the number of rows so zero one two three blah blah blah fifty thousand four forty nine thousand ninety nine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2258" target="_blank">00:37:38.000</a></span> | <span class="t">And then which columns do we want for each of those rows or whatever our target is whatever the actual value so in this case five zero four etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2269" target="_blank">00:37:49.000</a></span> | <span class="t">So that returns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2273" target="_blank">00:37:53.000</a></span> | <span class="t">All of the values we need we then take minus because it's negative log likelihood and take the mean so that's all it takes to do negative log likelihood in PyTorch which is super wonderfully easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2287" target="_blank">00:38:07.000</a></span> | <span class="t">So now we can calculate our loss which is the negative log likelihood of the softmax predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2294" target="_blank">00:38:14.000</a></span> | <span class="t">That's what we had up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2297" target="_blank">00:38:17.000</a></span> | <span class="t">Compared to our actual why trading.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2301" target="_blank">00:38:21.000</a></span> | <span class="t">And so there it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2305" target="_blank">00:38:25.000</a></span> | <span class="t">Now this was our softmax formula which is a to the X over some of the X's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2316" target="_blank">00:38:36.000</a></span> | <span class="t">So we have a and then it's all logged so we've got a log of A over B and remember I keep telling you that like one thing you want to remember from high school math is how logs work so I do want you to try to recall that log of A over B is log of A minus log of B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2331" target="_blank">00:38:51.000</a></span> | <span class="t">And so we can rewrite this as log of A to the X minus log of all that and of course either the something and log are opposites of each other so a log of A to the X is just X so that ends up being X minus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2352" target="_blank">00:39:12.000</a></span> | <span class="t">X dot X dot some dot log.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2356" target="_blank">00:39:16.000</a></span> | <span class="t">So this is useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2358" target="_blank">00:39:18.000</a></span> | <span class="t">And let's just check that that actually works so as I kind of keep refactoring these things as even as I'd like to me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2364" target="_blank">00:39:24.000</a></span> | <span class="t">These mathematical manipulations are just refactoring right so just refactoring the math so you keep checking along so we created test near last time so let's use it to make sure that it's a similar the same as our loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2377" target="_blank">00:39:37.000</a></span> | <span class="t">Now you'll see here this is taking the log of the sum of the X and there's a trick called log some X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2391" target="_blank">00:39:51.000</a></span> | <span class="t">Now the reason we need this trick is that when you go into the power of something you can get ridiculously big numbers and if you've done Rachel's new computational linear algebra course then you'll know that very big numbers in floating point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2406" target="_blank">00:40:06.000</a></span> | <span class="t">On a computer are really inaccurate basically the further you get away from zero the less kind of fine grained they are you know gets to the point where like two numbers a thousand apart the computer thinks they're the same number so you don't want big numbers particularly when you're calculating gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2424" target="_blank">00:40:24.000</a></span> | <span class="t">So anywhere you see an eight of the X we get nervous we don't want X to be big but it turns out that if you do this little mathematical substitution you can actually subtract a number from your exes and add them back at the front and you get the same answer so what you could do is you can find the maximum of all of your exes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2450" target="_blank">00:40:50.000</a></span> | <span class="t">You can subtract it from all of your exes and then add it back afterwards outside the X and you get exactly the same answer so in other words let's find the maximum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2462" target="_blank">00:41:02.000</a></span> | <span class="t">That's subtracted from all of our exes and then let's do log some X and then at the end we'll add it back again and that gives you exactly the same number that without this numerical problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2474" target="_blank">00:41:14.000</a></span> | <span class="t">So when people talk about like numerical stability tricks they're talking about stuff like this and this is a really helpful numerical stability trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2483" target="_blank">00:41:23.000</a></span> | <span class="t">So this is how you do log some X in real life we can check that this one here is the same as and look in fact log some X is already a method in pytorch it's such a important and useful thing you can just actually use pytorches and you'll get the same result as the one we just wrote.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2503" target="_blank">00:41:43.000</a></span> | <span class="t">So now we can use it so log softmax is now just X minus X dot log some X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2509" target="_blank">00:41:49.000</a></span> | <span class="t">And let's check yep still the same so now that that's all working we may as well just use pytorches log softmax is and pytorches and our little loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2520" target="_blank">00:42:00.000</a></span> | <span class="t">But actually I know a loss of log softmax is called cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2529" target="_blank">00:42:09.000</a></span> | <span class="t">So finally we get test near F dot cross entropy is the same as loss and it is so we've now recreated by torches cross entropy so we're allowed to use it according to our rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2541" target="_blank">00:42:21.000</a></span> | <span class="t">OK so now that we have a loss function we can use it to train and we may as well also define a metric because it's nice to see accuracy to see how we're going just much more interpretable and remember from part one that the accuracy is simply grab the argmax OK to find out which which which of the numbers in our softmax is the highest and the index of that is our prediction and then check whether that's equal to the actual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2570" target="_blank">00:42:50.000</a></span> | <span class="t">And then we want to take the main but in pytorch you can't take the main of it's you have to take the main of floats which makes some sense so turn it into a float first so there's our accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2582" target="_blank">00:43:02.000</a></span> | <span class="t">So let's just check let's grab a batch size of 64 and let's grab our first X batch this is our first playing around with many batches right so our first X batch is going to be a training set from zero up to batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2596" target="_blank">00:43:16.000</a></span> | <span class="t">So our predictions is we're just going to run our model and remember our model was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2605" target="_blank">00:43:25.000</a></span> | <span class="t">Linear value linear those still using a super simple model so let's calculate some predictions and let's have a look at them and here's some predictions and it's 64 by 10 as you'd expect batch size 64 and 10 possible probabilities right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2622" target="_blank">00:43:42.000</a></span> | <span class="t">So now we can grab our first batch of dependent variables and calculate our loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2630" target="_blank">00:43:50.000</a></span> | <span class="t">OK that's 2.3 and calculate our accuracy and as you'd expect it's about 10% because we haven't trained our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2637" target="_blank">00:43:57.000</a></span> | <span class="t">So we've got a model that's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2639" target="_blank">00:43:59.000</a></span> | <span class="t">Giving basically random answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2642" target="_blank">00:44:02.000</a></span> | <span class="t">So let's train it so we need a learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2645" target="_blank">00:44:05.000</a></span> | <span class="t">We need to pick a number of epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2648" target="_blank">00:44:08.000</a></span> | <span class="t">And we need a training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2650" target="_blank">00:44:10.000</a></span> | <span class="t">So our training loop if you remember from part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2654" target="_blank">00:44:14.000</a></span> | <span class="t">Remember lesson to SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2657" target="_blank">00:44:17.000</a></span> | <span class="t">Our training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2659" target="_blank">00:44:19.000</a></span> | <span class="t">Looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2661" target="_blank">00:44:21.000</a></span> | <span class="t">Calculate your predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2663" target="_blank">00:44:23.000</a></span> | <span class="t">Calculate your loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2666" target="_blank">00:44:26.000</a></span> | <span class="t">Do backward subtract learning rate times gradients and zero the gradients so let's do exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2676" target="_blank">00:44:36.000</a></span> | <span class="t">We're going to go through a cheap walk and go through I up until and which is 50,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2681" target="_blank">00:44:41.000</a></span> | <span class="t">That's the number of rows but integer divide by batch size because we're going to do a batch at a time and so then we'll grab everything starting at times batch size and ending at that plus batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2693" target="_blank">00:44:53.000</a></span> | <span class="t">So this is going to be our first this is going to be a mini batch and so let's grab one X mini batch one Y mini batch and pass that through the model and our loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2705" target="_blank">00:45:05.000</a></span> | <span class="t">And then do backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2708" target="_blank">00:45:08.000</a></span> | <span class="t">And then we're going to do our update which remember we have to do with no grad because this is not part of the gradient calculation. This is the result of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2715" target="_blank">00:45:15.000</a></span> | <span class="t">But now we can't just go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2718" target="_blank">00:45:18.000</a></span> | <span class="t">A dot subtract learning rate times gradient we have to do that for every single one of our parameters so our model has.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2729" target="_blank">00:45:29.000</a></span> | <span class="t">3 layers. The value has no parameters in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2733" target="_blank">00:45:33.000</a></span> | <span class="t">So the linear layer has weight and bias and this linear layer has weight and bias so it basically got 4 tenses to deal with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2743" target="_blank">00:45:43.000</a></span> | <span class="t">So we're going to go through all of our layers and let's just check whether that layer has an attribute called weight or not that's a bit kind of more flexible than hard coding things and if it does then let's update the weight to minus equals the gradient of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2758" target="_blank">00:45:58.000</a></span> | <span class="t">By the learning rate the bias to the bias gradient by the learning rate and then 0 those gradients when we're done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2766" target="_blank">00:46:06.000</a></span> | <span class="t">So let's run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2769" target="_blank">00:46:09.000</a></span> | <span class="t">And then let's check the loss function and the accuracy and the loss has gone down from 2.3 to 0.05 and the accuracy has gone up from 0.12 to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2782" target="_blank">00:46:22.000</a></span> | <span class="t">Notice that this accuracy is for only a single mini batch and it's a mini batch from the training set so it doesn't mean too much, but obviously our model is learning something so this is good so this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2795" target="_blank">00:46:35.000</a></span> | <span class="t">This is there you know we're now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2801" target="_blank">00:46:41.000</a></span> | <span class="t">Well, we haven't really done calm, but I guess we've got a basic training. We're now here. We have a basic training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2808" target="_blank">00:46:48.000</a></span> | <span class="t">Which is great so we kind of got all the pieces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2812" target="_blank">00:46:52.000</a></span> | <span class="t">So let's try to make this simpler 'cause this is too much code right and it's too hard to fiddle around with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2818" target="_blank">00:46:58.000</a></span> | <span class="t">So the first bit will do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2822" target="_blank">00:47:02.000</a></span> | <span class="t">Is we're going to try and get rid of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2825" target="_blank">00:47:05.000</a></span> | <span class="t">This mess.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2827" target="_blank">00:47:07.000</a></span> | <span class="t">And we're going to replace it with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2831" target="_blank">00:47:11.000</a></span> | <span class="t">And so the difference here is rather than manually going through weight and bias for each one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2838" target="_blank">00:47:18.000</a></span> | <span class="t">We're going to loop through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2840" target="_blank">00:47:20.000</a></span> | <span class="t">Something called model dot parameters, so we're not even going to look through the layers. We're just going to loop directly through model dot parameters and for each parameter will say that parameter minus equals gradient times learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2852" target="_blank">00:47:32.000</a></span> | <span class="t">So somehow we need to be able to get all of the parameters of our model 'cause if we could do that we could greatly simplify this part of the loop and also make it much more flexible right so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2865" target="_blank">00:47:45.000</a></span> | <span class="t">To do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2870" target="_blank">00:47:50.000</a></span> | <span class="t">We could create something like this and is calling this dummy module right and in dummy module what I'm going to do is I'm going to say every time I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2880" target="_blank">00:48:00.000</a></span> | <span class="t">Set an attribute like L1 or L2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2884" target="_blank">00:48:04.000</a></span> | <span class="t">To a you know in this case to linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2887" target="_blank">00:48:07.000</a></span> | <span class="t">I want to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2889" target="_blank">00:48:09.000</a></span> | <span class="t">Update a list called underscore modules with a list of all of the modules I have so in other words after I create this dummy module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2897" target="_blank">00:48:17.000</a></span> | <span class="t">I want to be able to print out here's my representation I want to be able to print out the list of those modules and see the modules that are there 'cause then I can define a method called parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2909" target="_blank">00:48:29.000</a></span> | <span class="t">That will go through everything in my underscore modules list and then go through all of their parameters and that's what I'll be able to do see I could do here model dot parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2921" target="_blank">00:48:41.000</a></span> | <span class="t">So how did I create this just it's not inheriting from something right this is all written in pure Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2928" target="_blank">00:48:48.000</a></span> | <span class="t">How did I make it so that as soon as I said here's an attribute in my in my in it that somehow it magically appeared in this underscore modules list so that I could then create this parameters so that I could then do this refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2945" target="_blank">00:49:05.000</a></span> | <span class="t">And the trick is that Python has a special dunder set atra method and every time you assign to anything inside self inside Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2957" target="_blank">00:49:17.000</a></span> | <span class="t">It will call this method if you've.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2960" target="_blank">00:49:20.000</a></span> | <span class="t">Got one and so this method just checks that my the key so in other words the attribute name doesn't start with underscore 'cause if it does it might be underscore modules and then it's going to be like a recursive loop and also Python's got all kinds of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2974" target="_blank">00:49:34.000</a></span> | <span class="t">Internal stuff that starts with underscore so as long as it's not some internal private stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2979" target="_blank">00:49:39.000</a></span> | <span class="t">Put that value inside my modules dictionary and call it K.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2984" target="_blank">00:49:44.000</a></span> | <span class="t">That's it right then after you've done that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=2987" target="_blank">00:49:47.000</a></span> | <span class="t">Do whatever the super class does when it sets attributes and in this case the super class is object if you don't say what it is that it's just the Python highest level object so now we have something that has all of the stuff we need to do this refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3003" target="_blank">00:50:03.000</a></span> | <span class="t">But the good news is pie torch also has something that does that and it's called an end up module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3011" target="_blank">00:50:11.000</a></span> | <span class="t">So we can do the exact same thing rather than implementing that set attributes stuff ourselves we can just call just inherit from an end up module and it does it for us right and so this is now you know why you have to call super dunder in it first right because it has to set up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3030" target="_blank">00:50:30.000</a></span> | <span class="t">It's equivalent of this underscore modules dictionary right so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3035" target="_blank">00:50:35.000</a></span> | <span class="t">That's why you have to call super in it first and then after you've done that in pie torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3041" target="_blank">00:50:41.000</a></span> | <span class="t">It's exactly the same as what I just showed you it now creates something which you can access through named children and you can see here if I print out the name and the layer there is the name and the layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3053" target="_blank">00:50:53.000</a></span> | <span class="t">So this is how pie torch does the exact same thing just like I created a dunder repra pie torch also has a dunder repra so if you just print out model it prints it out like so you can grab the attributes just in the normal pythonic way it's just a normal python class it has a bit of bit of this extra behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3077" target="_blank">00:51:17.000</a></span> | <span class="t">So now we can run it with this refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3085" target="_blank">00:51:25.000</a></span> | <span class="t">Make sure everything works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3087" target="_blank">00:51:27.000</a></span> | <span class="t">And there we go okay so this is doing exactly the same thing as before but a little bit more conveniently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3093" target="_blank">00:51:33.000</a></span> | <span class="t">Not convenient enough for my liking so one thing we could try to do is to get rid of the need to write every layer separately maybe go back to having it as a list again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3106" target="_blank">00:51:46.000</a></span> | <span class="t">So if we made it a list of layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3111" target="_blank">00:51:51.000</a></span> | <span class="t">And then we want to be able to pass that to some model class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3116" target="_blank">00:51:56.000</a></span> | <span class="t">Pass in the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3118" target="_blank">00:51:58.000</a></span> | <span class="t">This is not enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3120" target="_blank">00:52:00.000</a></span> | <span class="t">To make them available as parameters right because the only thing that actually that pie torch is going to make available as parameters are things that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3128" target="_blank">00:52:08.000</a></span> | <span class="t">That it knows are proper and end up modules so but here's the cool thing you can just go through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3136" target="_blank">00:52:16.000</a></span> | <span class="t">All of those layers and call self dot add module that's just the equivalent of what I did here when I said self dot underscore modules blah blah right so in pie torch you can just call self dot add module and just like I did you give it a name and then you pass in the layer and so if you do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3156" target="_blank">00:52:36.000</a></span> | <span class="t">If you do that then you end up with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3161" target="_blank">00:52:41.000</a></span> | <span class="t">The same thing okay so that's one that's one thing you could do but this is kind of clunky so it'd be nice if pie torch would do it for you and it does that's what end up module list does so if you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3175" target="_blank">00:52:55.000</a></span> | <span class="t">If you create if you use an end up module list then it just.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3180" target="_blank">00:53:00.000</a></span> | <span class="t">Basically calls that line of code for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3184" target="_blank">00:53:04.000</a></span> | <span class="t">So you can see us doing it here we're going to create something called sequential model which just set self dot layers to that module list and then when we call it just goes through each layer X equals that layer of X and returns it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3198" target="_blank">00:53:18.000</a></span> | <span class="t">And there's that okay even this is a little bit on the clunky side why would we have to write it ourselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3205" target="_blank">00:53:25.000</a></span> | <span class="t">We don't pie torch has that code already it's called an end up sequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3210" target="_blank">00:53:30.000</a></span> | <span class="t">Okay so we've now recreated an end up sequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3216" target="_blank">00:53:36.000</a></span> | <span class="t">And there it is doing the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3219" target="_blank">00:53:39.000</a></span> | <span class="t">So again we're not creating like dumped down versions if you look at an end up sequential and you look at the source code and you look at forward it's just.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3230" target="_blank">00:53:50.000</a></span> | <span class="t">It's even the same name self go through each module and self underscore modules dot values input equals module input return input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3239" target="_blank">00:53:59.000</a></span> | <span class="t">So that's their version and remember our version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3243" target="_blank">00:54:03.000</a></span> | <span class="t">You know was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3247" target="_blank">00:54:07.000</a></span> | <span class="t">Basically the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3250" target="_blank">00:54:10.000</a></span> | <span class="t">And we could even put it in something called underscore modules so yeah that's what that's all an end up sequential is doing for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3259" target="_blank">00:54:19.000</a></span> | <span class="t">Okay so we're making some progress it's less ugly than it used to be still more ugly than we would like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3268" target="_blank">00:54:28.000</a></span> | <span class="t">This is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3273" target="_blank">00:54:33.000</a></span> | <span class="t">This is where we got our fifth function up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3277" target="_blank">00:54:37.000</a></span> | <span class="t">So let's try and simplify it a bit more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3281" target="_blank">00:54:41.000</a></span> | <span class="t">Let's replace all this torch dot no grad for PN model parameters blah blah blah with something where we can just write those two lines of code that would be nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3290" target="_blank">00:54:50.000</a></span> | <span class="t">So let's create a class called optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3294" target="_blank">00:54:54.000</a></span> | <span class="t">We're going to pass in some parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3297" target="_blank">00:54:57.000</a></span> | <span class="t">And store them away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3300" target="_blank">00:55:00.000</a></span> | <span class="t">And we're going to pass in the learning rate and we're going to store that away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3306" target="_blank">00:55:06.000</a></span> | <span class="t">And so if we're going to be able to go up dot step up dot step has to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3311" target="_blank">00:55:11.000</a></span> | <span class="t">This so here is step with torch not no grad go through each parameter and do that okay so it's just back to that out and zero grad we probably shouldn't actually go model zero grad because.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3325" target="_blank">00:55:25.000</a></span> | <span class="t">It's actually possible for the user as you know to say I don't want to include certain parameters in my optimizer so when we're doing like gradual unfreezing and stuff so really zero grad should actually do this it should go through the list of parameters that you asked to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3340" target="_blank">00:55:40.000</a></span> | <span class="t">Optimize and zero those gradients so here we've now created something called optimizer and we can now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3348" target="_blank">00:55:48.000</a></span> | <span class="t">Grab our model and so we remember that the model now we've created something called dot parameters so we can pass that to our optimizer and then we can now just go up dot step up dot zero grad and let's test it and it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3363" target="_blank">00:56:03.000</a></span> | <span class="t">OK now of course luckily for us pipe torture already has these lines of code it's called opt in dot SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3374" target="_blank">00:56:14.000</a></span> | <span class="t">Now opt in dot SGD does do a few more things weight decay momentum stuff like that so let's have a look here's opt in dot SGD and here's a step function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3388" target="_blank">00:56:28.000</a></span> | <span class="t">It's got weight decay momentum dampening this drop we're going to see all these things very shortly but basically all it does is it goes through each layer group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3397" target="_blank">00:56:37.000</a></span> | <span class="t">And it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3399" target="_blank">00:56:39.000</a></span> | <span class="t">Does the exact thing that we just see so once you remove the momentum and stuff and we're going to be implementing this in a much better way than pytorch in very soon so once you remove all that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3410" target="_blank">00:56:50.000</a></span> | <span class="t">Their opt in dot SGD is exactly the same as our optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3418" target="_blank">00:56:58.000</a></span> | <span class="t">So let's go ahead and use that instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3422" target="_blank">00:57:02.000</a></span> | <span class="t">And so it's kind of nice then if we're going to use all the parameters of the model it's just create a get model which creates a model and returns it as well as a SGD optimizer with all the parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3434" target="_blank">00:57:14.000</a></span> | <span class="t">And okay there's a training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3439" target="_blank">00:57:19.000</a></span> | <span class="t">And seems to be working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3443" target="_blank">00:57:23.000</a></span> | <span class="t">It's nice to put tests in from time to time and I like to put these tests in like hey my accuracy should be significantly better than 50%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3453" target="_blank">00:57:33.000</a></span> | <span class="t">You know note that these kind of stochastic tests are highly imperfect in many ways it's theoretically possible it could fail because you got really unlucky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3463" target="_blank">00:57:43.000</a></span> | <span class="t">I know though that this is really vanishingly unlikely to happen it's always much more than 90%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3472" target="_blank">00:57:52.000</a></span> | <span class="t">It's also possible that your code could be failing in a way that causes the accuracy to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3479" target="_blank">00:57:59.000</a></span> | <span class="t">A bit lower than it should be but not this low.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3482" target="_blank">00:58:02.000</a></span> | <span class="t">I still think it's a great idea to have these kinds of tests when you're doing machine learning because they give you a hint when something's going wrong and you'll notice I don't set a random seed at any point this is very intentional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3500" target="_blank">00:58:20.000</a></span> | <span class="t">I really like it that that if there's variation going on when I run my model at different times I want to see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3508" target="_blank">00:58:28.000</a></span> | <span class="t">I don't want it to be hidden away behind a fixed seat so there's a there's a big push in science for like reproducible science which is which is great for many reasons but it's not how you should develop your models and you're developing your models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3521" target="_blank">00:58:41.000</a></span> | <span class="t">You want to have a kind of good intuitive sense of what bits are stable and what bits are unstable and how much variation do you expect and so if you have a test which.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3531" target="_blank">00:58:51.000</a></span> | <span class="t">You know fails one every out of one every 100 times it's it's good to know that you know and so like in the first day I code there's lots of tests like that and so then sometimes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3543" target="_blank">00:59:03.000</a></span> | <span class="t">You know there'll be a test that fails it's nothing particularly to do with the push that just happened but it's it's really helpful for us because then we can look at it and be like oh.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3551" target="_blank">00:59:11.000</a></span> | <span class="t">This thing we thought should pretty much always be true sometimes isn't true and then we'll go back and we'll deeply study why that is and figure out how to make it more stable and how to make it reliably pass that test so this is a kind of a controversial kind of test to have that something that I found in practice is very very very helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3572" target="_blank">00:59:32.000</a></span> | <span class="t">It's not complete and it's not totally automated and it's imperfect in many ways but it's nonetheless helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3580" target="_blank">00:59:40.000</a></span> | <span class="t">OK let's get rid of these 2 lines of code these were the lines of code that grabbed X mini batch from the training set and the Y mini batch from the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3589" target="_blank">00:59:49.000</a></span> | <span class="t">Let's do them both in one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3592" target="_blank">00:59:52.000</a></span> | <span class="t">So it'd be nice to have one line of code we have some kind of object where we can pass in the indexes we want and get back both X and Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3600" target="_blank">01:00:00.000</a></span> | <span class="t">And that's quite a data set as you know so here's our data set class again not inheriting from anything it's all from scratch play Python we initialize it by passing in the X and the Y will store them away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3613" target="_blank">01:00:13.000</a></span> | <span class="t">It's very handy to have a length hopefully you know by now if you don't then now's a good time to realize that dunder Len is the thing that lets you go Len of something in Python and have it work that's what Len will call so now we've got the length of our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3629" target="_blank">01:00:29.000</a></span> | <span class="t">And dunder get item is a thing that when you index into it it will return that and so we just return the tuple of X I and Y I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3640" target="_blank">01:00:40.000</a></span> | <span class="t">So. Let's go ahead and create a data set for our training set and a validation set check that the lengths are right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3650" target="_blank">01:00:50.000</a></span> | <span class="t">Check the first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3670" target="_blank">01:01:10.000</a></span> | <span class="t">So the next thing we're going to do so that's a data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3674" target="_blank">01:01:14.000</a></span> | <span class="t">Next thing we're going to do is create a data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3677" target="_blank">01:01:17.000</a></span> | <span class="t">This is what the start of our training loop look like before and let's replace it with this single line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3685" target="_blank">01:01:25.000</a></span> | <span class="t">So to do that we're going to have a class we're going to have to have a class that takes a data set and a batch size and stores them away and when you go for blah in blah behind the scenes in python it calls dunder itter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3702" target="_blank">01:01:42.000</a></span> | <span class="t">And so what we're going to do is we're going to loop through range from zero up to the size of the data set jumping up batch size at a time so 064128 etc up to 50,000 and each time we go through we will.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3718" target="_blank">01:01:58.000</a></span> | <span class="t">Yield our data set at an index starting at I and ending up ending at I plus self dot batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3727" target="_blank">01:02:07.000</a></span> | <span class="t">Probably quite a lot of you haven't seen yield before it's an incredibly useful concept it's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3736" target="_blank">01:02:16.000</a></span> | <span class="t">If you're really interested it's something called a co routine it's basically this really interesting idea that you can have a function that doesn't return just one thing once back can return lots of things and you can kind of ask for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3747" target="_blank">01:02:27.000</a></span> | <span class="t">Lots of times so the way these iterators work in python is that when you when you call this it basically returns something which you can then call next on lots of times and each time you call next it will return the next thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3764" target="_blank">01:02:44.000</a></span> | <span class="t">That is yielded so it's not I don't have time to explain car routines in detail here but.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3772" target="_blank">01:02:52.000</a></span> | <span class="t">It's really worth looking up and learning about we'll be using them lots.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3777" target="_blank">01:02:57.000</a></span> | <span class="t">They're super valuable thing and it's not just for data science they're really handy for things like network programming web apps stuff like that as well so well worth being familiar with yield in python and nowadays most programming languages have something like this so you'll be able to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3793" target="_blank">01:03:13.000</a></span> | <span class="t">Take it to wherever you go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3797" target="_blank">01:03:17.000</a></span> | <span class="t">So now we have a data loader we can create a training one and a validation one and we can this is how we do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3804" target="_blank">01:03:24.000</a></span> | <span class="t">It's a valid deal is the thing that basically kind of generates our co routine for us and then next is the thing that grabs the next thing yielded out of that car routine so this is a very common thing you'll be doing lots next in a blah you probably did it a whole lot of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3822" target="_blank">01:03:42.000</a></span> | <span class="t">In part one because we kind of did it without diving in very deeply into what's going on and that returns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3831" target="_blank">01:03:51.000</a></span> | <span class="t">One thing from our data set in the data set returns two things because that's what we put in it so we expect to get two things back and we can check that those two things are the right size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3842" target="_blank">01:04:02.000</a></span> | <span class="t">So that's our data loader and so let's double check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3847" target="_blank">01:04:07.000</a></span> | <span class="t">There it is good stuff so now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3851" target="_blank">01:04:11.000</a></span> | <span class="t">There's our fitness function let's call the fitness function looking good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3856" target="_blank">01:04:16.000</a></span> | <span class="t">So this is about as neat as we're going to get that's that's quite beautiful right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3863" target="_blank">01:04:23.000</a></span> | <span class="t">It's kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3865" target="_blank">01:04:25.000</a></span> | <span class="t">All the steps you can think of if you said it in English there go through each epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3870" target="_blank">01:04:30.000</a></span> | <span class="t">Go through each batch grabbing the independent independent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3874" target="_blank">01:04:34.000</a></span> | <span class="t">Calculate the predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3877" target="_blank">01:04:37.000</a></span> | <span class="t">Calculate the losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3879" target="_blank">01:04:39.000</a></span> | <span class="t">Calculate the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3882" target="_blank">01:04:42.000</a></span> | <span class="t">Update with the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3885" target="_blank">01:04:45.000</a></span> | <span class="t">Reset the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3888" target="_blank">01:04:48.000</a></span> | <span class="t">So that's you know that's kind of where you want to get is to a point where you can read your code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3893" target="_blank">01:04:53.000</a></span> | <span class="t">In a very kind of intuitive way to a domain expert and until you get to that point it's very hard really I find to really maintain the code and understand the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3902" target="_blank">01:05:02.000</a></span> | <span class="t">And this is the trick for doing research as well as it's not just for you know hardcore software engineering a researcher that can't do those things to their code can't do research properly right because if you think of something you want to try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3917" target="_blank">01:05:17.000</a></span> | <span class="t">You know you don't know how to do it or it takes weeks or if there are bugs in it you don't know so you know you want your code to be quite beautiful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3925" target="_blank">01:05:25.000</a></span> | <span class="t">I think this is beautiful code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3930" target="_blank">01:05:30.000</a></span> | <span class="t">And this is at this point you know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3934" target="_blank">01:05:34.000</a></span> | <span class="t">This data set and this data loader are the same extractions that PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3940" target="_blank">01:05:40.000</a></span> | <span class="t">Uses so let's dig into this a little bit more we do have a problem which is that we're always looping through our training set in order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3949" target="_blank">01:05:49.000</a></span> | <span class="t">And that's very problematic because we lose the randomness of kind of shuffling it each time particularly if our training set was already like ordered by dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3959" target="_blank">01:05:59.000</a></span> | <span class="t">Then every batch is going to be exactly the same dependent variable so we really want to shuffle it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3966" target="_blank">01:06:06.000</a></span> | <span class="t">So let's try random sampling so for random sampling I'm going to create a sampler class and we're going to pass into it a data set to sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3977" target="_blank">01:06:17.000</a></span> | <span class="t">And a batch size and something that says whether to shuffle or not right and as per usual we just store those away I don't actually store away the data set I just store away the length of the data set so that we know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3988" target="_blank">01:06:28.000</a></span> | <span class="t">How much to how many items to sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=3992" target="_blank">01:06:32.000</a></span> | <span class="t">And then here's that here's that under it right so remember this is the thing that we can call next on lots of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4000" target="_blank">01:06:40.000</a></span> | <span class="t">And so if we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4003" target="_blank">01:06:43.000</a></span> | <span class="t">Shuffling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4007" target="_blank">01:06:47.000</a></span> | <span class="t">Then let's grab a random permutation of the numbers from naught to n minus one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4013" target="_blank">01:06:53.000</a></span> | <span class="t">And if we're not shuffling then let's grab all of the integers in order from zero to n minus one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4020" target="_blank">01:07:00.000</a></span> | <span class="t">And then this is the same we had before go through that range and yield the indexes so what does that look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4029" target="_blank">01:07:09.000</a></span> | <span class="t">Here's a sampler with shuffle equals false and a batch size of three oh one two three four five six seven eight nine and here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4041" target="_blank">01:07:21.000</a></span> | <span class="t">With shuffle equals true five four three seven six two eight nine oh one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4047" target="_blank">01:07:27.000</a></span> | <span class="t">So now that we've got these we can now replace our data loader with something where we pass it a sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4055" target="_blank">01:07:35.000</a></span> | <span class="t">And we then loop through for s in samplers that's going to loop through each of these right and the cool thing is that because we used yield these are only going to be calculated when we ask for them they're not all calculated up front so we can use these on really big data sets no problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4070" target="_blank">01:07:50.000</a></span> | <span class="t">And so it's kind of this is a common thing is where you're actually looping through something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4077" target="_blank">01:07:57.000</a></span> | <span class="t">Which is itself a core routine and then yielding something which does other things to that so this is like a really nice way of doing streaming computations it's being done lazily and not going to run out of memory it's a it's really neat way to do things and so then we're going to grab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4095" target="_blank">01:08:15.000</a></span> | <span class="t">All of the indexes in that sample and we're going to grab the data set at that index so now we've got a list of tenses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4104" target="_blank">01:08:24.000</a></span> | <span class="t">And then we need some way to collect them all together into a single pair of tenses and so we've created a function called collate which just grabs the X's and the Y's and stacks them up so torch stack just grabs a bunch of tenses and.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4121" target="_blank">01:08:41.000</a></span> | <span class="t">Glues them together on a new access you might want to do different things like add some padding or you know stuff like that so you can pass in a different collate function if you want to and it'll store it away and use it right so now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4137" target="_blank">01:08:57.000</a></span> | <span class="t">We can create our 2 samplers we can create our 2 data loaders with those samplers so the training one is shuffling the valid ones not shuffling so let's check as the validation data loader and the training data loader if we call it twice with exactly the same index we get different things in this case we got 2/8 but they're different 8's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4160" target="_blank">01:09:20.000</a></span> | <span class="t">Call it another 2 times we're getting different numbers okay so it's it is shuffling as we hoped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4166" target="_blank">01:09:26.000</a></span> | <span class="t">And so again we can train our model and that's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4172" target="_blank">01:09:32.000</a></span> | <span class="t">So the pie torch data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4175" target="_blank">01:09:35.000</a></span> | <span class="t">Does exactly that so let's import the pie torch data loader and you can see it takes exactly the same arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4183" target="_blank">01:09:43.000</a></span> | <span class="t">Okay and we can even pass in the exact collate function that we just wrote it's it doesn't have a single sampler that you pass shuffle equals true or false true it has 2 set samplers 1 called random 1 called sequential so slightly different to the API we just wrote but does exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4199" target="_blank">01:09:59.000</a></span> | <span class="t">And so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4201" target="_blank">01:10:01.000</a></span> | <span class="t">You can create those data loaders and works exactly the same so that's what a pie torch data loader does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4208" target="_blank">01:10:08.000</a></span> | <span class="t">Most of the time you don't need the flexibility of writing your own sampler and your own collation function so you can just pass in shuffle and it will use the default.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4219" target="_blank">01:10:19.000</a></span> | <span class="t">Sampler and collation function that work the way we just showed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4225" target="_blank">01:10:25.000</a></span> | <span class="t">Something that we did not implement in pie torches data loader is that in purchase data loader you can pass in an extra parameter called num workers and that will fire off that many processes and each one will separately grab stuff out of your data set and then it'll collect them together afterwards and so if your data sets doing things like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4247" target="_blank">01:10:47.000</a></span> | <span class="t">You know opening big jpeg files and doing all kinds of image transformations that's a really good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4254" target="_blank">01:10:54.000</a></span> | <span class="t">So we want to implement that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4257" target="_blank">01:10:57.000</a></span> | <span class="t">So finally for this section.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4260" target="_blank">01:11:00.000</a></span> | <span class="t">We should add validation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4263" target="_blank">01:11:03.000</a></span> | <span class="t">So to know if we're overfitting we need to have a separate validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4273" target="_blank">01:11:13.000</a></span> | <span class="t">So here's the same loop that we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4277" target="_blank">01:11:17.000</a></span> | <span class="t">And here's and here's the same loop pretty much again but with torch dot no grad going through the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4285" target="_blank">01:11:25.000</a></span> | <span class="t">So for this we grabbed the predictions and the losses before but we don't call backward and we don't step the optimizer because it's just a validation instead we just keep track of the loss and we also keep track of the accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4299" target="_blank">01:11:39.000</a></span> | <span class="t">The only other difference is that we've added here model dot train and here model dot novelle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4307" target="_blank">01:11:47.000</a></span> | <span class="t">What does that do well actually all it does is it sets a internal attribute called dot training to true or false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4315" target="_blank">01:11:55.000</a></span> | <span class="t">So let's try it if I put print model dot training after each one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4320" target="_blank">01:12:00.000</a></span> | <span class="t">And train this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4324" target="_blank">01:12:04.000</a></span> | <span class="t">See true false true false true false okay and so why does it set this thing called model dot training to true or false because some kinds of layers need to have different behavior depending on whether it's training or evaluation or validation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4342" target="_blank">01:12:22.000</a></span> | <span class="t">For example batch norm only updates its running statistics if it's training dropout only does randomized dropout if it's training they're the two main ones so that's why you always want to train and avail and if you forget to put something into a valve mode when you're done training you'll often be surprised because you'll be getting worse results than you expected.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4367" target="_blank">01:12:47.000</a></span> | <span class="t">Okay, so that's that's our fit loop one thing to note.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4372" target="_blank">01:12:52.000</a></span> | <span class="t">Are these validation results correct if the batch size varies spell that correctly if.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4381" target="_blank">01:13:01.000</a></span> | <span class="t">If the batch size varies because what we're doing here is we're adding up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4385" target="_blank">01:13:05.000</a></span> | <span class="t">The loss and we're adding up the accuracy and then at the end we see how big is our data loader how many batches are there and we divide.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4394" target="_blank">01:13:14.000</a></span> | <span class="t">But if you think about it if you had one mini batch of size 1000 and one mini batch of size one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4403" target="_blank">01:13:23.000</a></span> | <span class="t">You can't actually just do that right you can't you actually need a weighted average weighted by the size of the mini batch so this incorrect way is how nearly every library does it faster I does it the proper way and next time we do this we're going to do the proper way okay but for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4420" target="_blank">01:13:40.000</a></span> | <span class="t">Here's what most people do and it does not work correctly when your batch size varies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4428" target="_blank">01:13:48.000</a></span> | <span class="t">So it it's handy to have something that we can basically pass in a training data set in a validation data set in a batch size to and just grab the data loaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4437" target="_blank">01:13:57.000</a></span> | <span class="t">The training data set will be shuffled validation won't be shuffled also the validation data set we don't need to do the backward pass so we don't need to store the gradients so that means that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4449" target="_blank">01:14:09.000</a></span> | <span class="t">Twice as much room so we can make it twice this size twice the batch size so it's you know another nice thing to refactor out you don't have to type it anymore and also it means that you won't accidentally make a mistake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4462" target="_blank">01:14:22.000</a></span> | <span class="t">And so now we can go ahead and fit and let's do five epochs and so now these are actual validation accuracies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4472" target="_blank">01:14:32.000</a></span> | <span class="t">Okay great so we've successfully built a training loop let's have a six minute break come back at 755 and talk about callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4484" target="_blank">01:14:44.000</a></span> | <span class="t">Before we continue Rachel any questions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4491" target="_blank">01:14:51.000</a></span> | <span class="t">So why do we have to zero out our gradients and pie torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4496" target="_blank">01:14:56.000</a></span> | <span class="t">Why do you have to zero out your gradients and pie torch so yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4506" target="_blank">01:15:06.000</a></span> | <span class="t">The way we.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4508" target="_blank">01:15:08.000</a></span> | <span class="t">Let's go back to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4512" target="_blank">01:15:12.000</a></span> | <span class="t">So it is our here's our optimizer right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4516" target="_blank">01:15:16.000</a></span> | <span class="t">Or let's go back even further here's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4522" target="_blank">01:15:22.000</a></span> | <span class="t">Here's our first version so this is just.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4528" target="_blank">01:15:28.000</a></span> | <span class="t">With no additional help from pie torch at all if we didn't go grad zero here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4538" target="_blank">01:15:38.000</a></span> | <span class="t">Then what's going to happen the next time we go through and say lost up backward is it's going to add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4544" target="_blank">01:15:44.000</a></span> | <span class="t">The new gradients to those existing gradients now why does that happen or that happens because we often have kind of lots of sources of gradients you know there's lots of kind of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4556" target="_blank">01:15:56.000</a></span> | <span class="t">Different modules all connected together and so they're getting their gradients from lots of different places and they all have to be added up so so when we call backward we wouldn't want backward to zero the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4568" target="_blank">01:16:08.000</a></span> | <span class="t">Because then we would lose this ability to kind of plug in lots of things together and just have them have them work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4576" target="_blank">01:16:16.000</a></span> | <span class="t">So that's why we need the grad dot zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4580" target="_blank">01:16:20.000</a></span> | <span class="t">Here so then you know that's part that's part one of the answer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4585" target="_blank">01:16:25.000</a></span> | <span class="t">Part two of the answer is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4588" target="_blank">01:16:28.000</a></span> | <span class="t">Why did we write our optimizer so there was one thing called step and one thing called zero grad because what we could have done is we could have removed these lines and push this up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4600" target="_blank">01:16:40.000</a></span> | <span class="t">And so that step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4603" target="_blank">01:16:43.000</a></span> | <span class="t">Could have done both and then since we've actually got this kind of twice now we could put it all inside the for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4612" target="_blank">01:16:52.000</a></span> | <span class="t">So we could certainly have written our optimizer like this as a switch parameter and does the update and sets the gradient to zero and then we would be able to remove this line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4625" target="_blank">01:17:05.000</a></span> | <span class="t">So.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4628" target="_blank">01:17:08.000</a></span> | <span class="t">The problem with that is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4633" target="_blank">01:17:13.000</a></span> | <span class="t">Within remove the ability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4637" target="_blank">01:17:17.000</a></span> | <span class="t">To not zero the gradients here and that means any time that we don't want to zero the gradients we now can't use the optimizer so for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4648" target="_blank">01:17:28.000</a></span> | <span class="t">What if you are working with some pretty big objects so like if you're doing super resolution and you're trying to create a two K output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4658" target="_blank">01:17:38.000</a></span> | <span class="t">You know your batch size you can only fit two images on the GPU at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4665" target="_blank">01:17:45.000</a></span> | <span class="t">And.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4667" target="_blank">01:17:47.000</a></span> | <span class="t">The stability of the gradients that you get from a batch size of two is so poor that you need to use a larger batch size so well that would be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4678" target="_blank">01:17:58.000</a></span> | <span class="t">Really easy to do if you did it like this right because we could say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4688" target="_blank">01:18:08.000</a></span> | <span class="t">If.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4690" target="_blank">01:18:10.000</a></span> | <span class="t">I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4692" target="_blank">01:18:12.000</a></span> | <span class="t">Percent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4695" target="_blank">01:18:15.000</a></span> | <span class="t">Two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4697" target="_blank">01:18:17.000</a></span> | <span class="t">Then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4700" target="_blank">01:18:20.000</a></span> | <span class="t">Right and so this is now going to only run these things every two iterations and so that means that our effective batch size is now double.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4712" target="_blank">01:18:32.000</a></span> | <span class="t">So that's handy right that's called gradient accumulation the gradient accumulation is where you change your training loop so that your your optimizer step and your zero grads only happen occasionally so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4728" target="_blank">01:18:48.000</a></span> | <span class="t">That's really the reason is it is it there might be times you don't want to zero the gradients every time you do a step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4738" target="_blank">01:18:58.000</a></span> | <span class="t">And if you if there's no way to do that that's a problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4743" target="_blank">01:19:03.000</a></span> | <span class="t">That you could argue that I can't think of a reason that this isn't a good idea we could make our optimizer we could say kind of like auto zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4752" target="_blank">01:19:12.000</a></span> | <span class="t">Equals true say and then we could have something in here which kind of says like if self dot auto zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4763" target="_blank">01:19:23.000</a></span> | <span class="t">Then self dot zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4767" target="_blank">01:19:27.000</a></span> | <span class="t">Right something like that and then that could even be the default and then you wouldn't have to worry about it unless you're explicitly wanted to do gradient accumulation I think that would be really be a better API design maybe but that's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4781" target="_blank">01:19:41.000</a></span> | <span class="t">Not what they've done but it's so easy to write your own optimizers you could totally do that but I mean that you know the upside is removing a single line of code which.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4791" target="_blank">01:19:51.000</a></span> | <span class="t">Isn't a huge upside anyway so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4795" target="_blank">01:19:55.000</a></span> | <span class="t">Any other questions Rachel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4798" target="_blank">01:19:58.000</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4803" target="_blank">01:20:03.000</a></span> | <span class="t">Okay so that's our training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4807" target="_blank">01:20:07.000</a></span> | <span class="t">But it's not quite where we wanted to be and I'm stealing some slides here from silver who had a really cool talk recently called an infinitely customizable training loop so I'll steal her slides.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4821" target="_blank">01:20:21.000</a></span> | <span class="t">Before I do I would like to do a big thank you to silver.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4827" target="_blank">01:20:27.000</a></span> | <span class="t">He has been working full time with fast day I for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4834" target="_blank">01:20:34.000</a></span> | <span class="t">Well over a year now I guess and a huge amount of what you see in the fast day I library and research and courses is is him so massive thank you to silver who's the most awesome person I've worked within my whole life so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4853" target="_blank">01:20:53.000</a></span> | <span class="t">That's pretty cool but also thank you to lots of other people huge thanks to stairs who a lot of you all have come across in the forum and he's he's done a lot of the stuff that makes faster I work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4865" target="_blank">01:21:05.000</a></span> | <span class="t">Well and he's entirely a volunteer so like super grateful to him.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4871" target="_blank">01:21:11.000</a></span> | <span class="t">You know the stuff that lets you check with your installation works properly that lets you quickly check with your performance is what it should be also like organizing lots of helpful projects through the forums he's been fantastic lots of other folks as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4886" target="_blank">01:21:26.000</a></span> | <span class="t">Andrew Shaw wrote a lot of the original kind of documentation stuff that we have Fred Monroe has been helpful in thousands of ways and it's just incredibly generous.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4897" target="_blank">01:21:37.000</a></span> | <span class="t">Jason a lot of you will already be aware of who helped a lot with the final lesson of the last course and is hard at work now on taking it even further to doing some stuff that's going to blow you away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4911" target="_blank">01:21:51.000</a></span> | <span class="t">I particularly want to point out Radik because this is the list of the I can't quite count as a 20 most helpful people on the forum as ranked by a number of likes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4923" target="_blank">01:22:03.000</a></span> | <span class="t">You know when somebody clicks that like button that means they're saying you know you've you've helped me and more people have said that about Radik than anybody else and it's not surprising because Radik is just not just an incredibly helpful person but extremely thoughtful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4939" target="_blank">01:22:19.000</a></span> | <span class="t">And he's now I mean he.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4943" target="_blank">01:22:23.000</a></span> | <span class="t">You know when he started with as a fast student he.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4947" target="_blank">01:22:27.000</a></span> | <span class="t">Considered himself if I remember correctly basically a failed ML student he had tried a number of times to learn ML and hadn't succeeded but he's just applied himself so well for the last couple of years and he's now a Kaggle winner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4960" target="_blank">01:22:40.000</a></span> | <span class="t">You know a world recognized deep learning practitioner and so thank you to all of these people and everybody else who's contributed in so many ways and of course Rachel who's sitting right next to me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4976" target="_blank">01:22:56.000</a></span> | <span class="t">So this is the. Fit function that we just wrote or the one this slightly more elegant one before we added validation to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=4988" target="_blank">01:23:08.000</a></span> | <span class="t">So go through each epoch go through each sort of mini back to go through each mini batch get the prediction the loss backward pass update your parameters and then zero the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5001" target="_blank">01:23:21.000</a></span> | <span class="t">So that's basically what we're doing model predictions loss gradients step at each time we grab a bit more training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5014" target="_blank">01:23:34.000</a></span> | <span class="t">But. That's not really all we want to do in a training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5020" target="_blank">01:23:40.000</a></span> | <span class="t">We might want to add the beautiful fast progress progress bars and animations that silver created in his fast progress library or tense aboard or whatever and thanks to Jason actually we now have tense aboard integration in fast AI so be sure to check that out if you want extra pretty graphs like these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5041" target="_blank">01:24:01.000</a></span> | <span class="t">Hyper parameter scheduling. You might want to add all kinds of different regularization techniques these are all examples of regularization techniques that we support in fast AI and many more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5053" target="_blank">01:24:13.000</a></span> | <span class="t">Mixed precision training and also take advantage of the tensor cause in a voter GPU to train much faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5062" target="_blank">01:24:22.000</a></span> | <span class="t">There's more tweaks you might want to do the training loop than than we could possibly think of and even if we did think of all of the ones that exist now somebody will come up with a new one tomorrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5070" target="_blank">01:24:30.000</a></span> | <span class="t">So the so you've got some possible ways you could solve this problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5076" target="_blank">01:24:36.000</a></span> | <span class="t">And you know some of the things are talking about or even things like how do you add gains more complex stuff so one approach is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5085" target="_blank">01:24:45.000</a></span> | <span class="t">Write a training loop for every possible way you want to train and this is particularly problematic when you start to like want to combine multiple different tweaks right as you like cutting and pasting or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5099" target="_blank">01:24:59.000</a></span> | <span class="t">So that's certainly not going to work for fast AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5105" target="_blank">01:25:05.000</a></span> | <span class="t">There's what I tried for fast AI zero point seven this is my training loop the last time I tried this which is like throw in every damn thing and it and it just got.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5119" target="_blank">01:25:19.000</a></span> | <span class="t">So every time somebody would say like a new papers come out can you please implement and I just be like no I couldn't bear it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5129" target="_blank">01:25:29.000</a></span> | <span class="t">So now we have something better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5133" target="_blank">01:25:33.000</a></span> | <span class="t">Callbacks and callbacks are something which like every library has callbacks but nobody else have callbacks anything like our callbacks and you'll see what I mean our callbacks let you not only look at but fully customize every one of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5148" target="_blank">01:25:48.000</a></span> | <span class="t">Steps right and so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5154" target="_blank">01:25:54.000</a></span> | <span class="t">Here's our starting training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5157" target="_blank">01:25:57.000</a></span> | <span class="t">Here's the fast AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5160" target="_blank">01:26:00.000</a></span> | <span class="t">Version one training loop it's the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5164" target="_blank">01:26:04.000</a></span> | <span class="t">Right there's the exact same lines of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5168" target="_blank">01:26:08.000</a></span> | <span class="t">Plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5170" target="_blank">01:26:10.000</a></span> | <span class="t">A bunch of calls to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5173" target="_blank">01:26:13.000</a></span> | <span class="t">Callbacks and so each one basically says.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5177" target="_blank">01:26:17.000</a></span> | <span class="t">Before I do a step on step again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5180" target="_blank">01:26:20.000</a></span> | <span class="t">After I do a step on step and after I do a batch on batch and after I do an epoch on epoch and after finish training on training and right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5189" target="_blank">01:26:29.000</a></span> | <span class="t">And they have the ability to also change things or even.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5193" target="_blank">01:26:33.000</a></span> | <span class="t">They have the ability to say please skip the next step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5196" target="_blank">01:26:36.000</a></span> | <span class="t">I returning a bullion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5199" target="_blank">01:26:39.000</a></span> | <span class="t">So with this we can create and have created all kinds of things and fast AI like learning rate schedulers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5206" target="_blank">01:26:46.000</a></span> | <span class="t">And early stopping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5209" target="_blank">01:26:49.000</a></span> | <span class="t">And parallel trainer this is literally when I wrote parallel trainer this is the entire call back I wrote.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5215" target="_blank">01:26:55.000</a></span> | <span class="t">This is the entire gradient clipping call back right after you do the backward pass clip the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5223" target="_blank">01:27:03.000</a></span> | <span class="t">So you can do a lot with a little.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5228" target="_blank">01:27:08.000</a></span> | <span class="t">And then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5230" target="_blank">01:27:10.000</a></span> | <span class="t">You can mix them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5232" target="_blank">01:27:12.000</a></span> | <span class="t">Because all of the callbacks work with all of the other callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5236" target="_blank">01:27:16.000</a></span> | <span class="t">So these are some of the callbacks that we have in fast AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5240" target="_blank">01:27:20.000</a></span> | <span class="t">Right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5243" target="_blank">01:27:23.000</a></span> | <span class="t">So for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5245" target="_blank">01:27:25.000</a></span> | <span class="t">How did we do gains.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5247" target="_blank">01:27:27.000</a></span> | <span class="t">Last.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5248" target="_blank">01:27:28.000</a></span> | <span class="t">Course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5250" target="_blank">01:27:30.000</a></span> | <span class="t">So what we did behind the scenes was we created again module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5255" target="_blank">01:27:35.000</a></span> | <span class="t">That was ridiculously simple we created again module that had a forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5260" target="_blank">01:27:40.000</a></span> | <span class="t">That just said what's your generator mode is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5265" target="_blank">01:27:45.000</a></span> | <span class="t">Sorry are you in generator mode or not and we're not means discriminator mode if you're in generator mode called the generator otherwise called the critic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5274" target="_blank">01:27:54.000</a></span> | <span class="t">And then there's a function called switch that just change generator mode backwards and forwards between generator and just discriminator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5282" target="_blank">01:28:02.000</a></span> | <span class="t">Same thing if we created a loss function where there was a generator loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5287" target="_blank">01:28:07.000</a></span> | <span class="t">And a critic loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5290" target="_blank">01:28:10.000</a></span> | <span class="t">And so then we created a call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5293" target="_blank">01:28:13.000</a></span> | <span class="t">Right which had a switch that just switch the generator mode on and off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5298" target="_blank">01:28:18.000</a></span> | <span class="t">And past that along to the model I just showed you and the loss function I just showed you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5306" target="_blank">01:28:26.000</a></span> | <span class="t">And then it would set requires grad to the generator or discriminator as appropriate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5314" target="_blank">01:28:34.000</a></span> | <span class="t">And then would have on train begin on train end on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5319" target="_blank">01:28:39.000</a></span> | <span class="t">Callbacks to do the right thing at the right time so most importantly at the start of an epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5324" target="_blank">01:28:44.000</a></span> | <span class="t">Set your generator mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5326" target="_blank">01:28:46.000</a></span> | <span class="t">And at the end of training set your generator mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5329" target="_blank">01:28:49.000</a></span> | <span class="t">So if you look at kind of other libraries implementation of GANS there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5335" target="_blank">01:28:55.000</a></span> | <span class="t">Basically kind of a whole new training loop whole new.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5339" target="_blank">01:28:59.000</a></span> | <span class="t">Data load is whole new everything and it was really cool in fast AI we were able to create a GAN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5347" target="_blank">01:29:07.000</a></span> | <span class="t">In this you know incredibly small amount of code for such a complex task.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5353" target="_blank">01:29:13.000</a></span> | <span class="t">So let's let's do that ourselves right because we've got a training loop if we add callbacks we should now then be able to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5360" target="_blank">01:29:20.000</a></span> | <span class="t">Everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5363" target="_blank">01:29:23.000</a></span> | <span class="t">So let's start out by grabbing our data as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5369" target="_blank">01:29:29.000</a></span> | <span class="t">So we've got the number of hidden is 50 batch size 64 loss function is cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5377" target="_blank">01:29:37.000</a></span> | <span class="t">This is the signature of our fit function before and I got very nervous when I see functions with lots of things being passed to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5388" target="_blank">01:29:48.000</a></span> | <span class="t">And it makes me think do we really need to pass all those things to it or can some of them be packaged up together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5393" target="_blank">01:29:53.000</a></span> | <span class="t">There's a lot of benefits to packaging up things together when you can package up things together where they're kind of alike things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5400" target="_blank">01:30:00.000</a></span> | <span class="t">You can pass them around to everything that needs them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5404" target="_blank">01:30:04.000</a></span> | <span class="t">You can create them using kind of factory methods that create them together and you can do smart things like look at the combination of them and make smart decisions for your users.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5415" target="_blank">01:30:15.000</a></span> | <span class="t">Rather than having to have them set everything themselves so there's lots of reasons that I would prefer to keep a pox right but I'd like to put all these other things into a single object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5429" target="_blank">01:30:29.000</a></span> | <span class="t">And specifically we can do that in 2 steps first of all let's take this data and say training and valid data conceptually should be 1 thing it's my data that maybe there's test data there as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5441" target="_blank">01:30:41.000</a></span> | <span class="t">So let's create a class called data bunch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5445" target="_blank">01:30:45.000</a></span> | <span class="t">That we're going to pass in training data and validation data and we'll store them away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5451" target="_blank">01:30:51.000</a></span> | <span class="t">And that's the entirety there's no logic here but for convenience let's make it easy to grab the data set out of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5457" target="_blank">01:30:57.000</a></span> | <span class="t">As well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5459" target="_blank">01:30:59.000</a></span> | <span class="t">Remember we're now using you can either use the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5464" target="_blank">01:31:04.000</a></span> | <span class="t">That the handmade data loader that we built in the last 1 or you can use the pie torch data loader they're both providing exactly the same API at this point except for the numb workers issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5478" target="_blank">01:31:18.000</a></span> | <span class="t">So the remember that we passed these data load as a data set that you can access and then it would be nice if we could create a get model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5486" target="_blank">01:31:26.000</a></span> | <span class="t">Function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5488" target="_blank">01:31:28.000</a></span> | <span class="t">Which could create our model but automatically set the last layer to have the correct number of activations because the data knows how many activations it needs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5499" target="_blank">01:31:39.000</a></span> | <span class="t">So let's also optionally make it that you can pass in C which is going to get stored away so that then when we create our data we can pass in C which remember we set to our.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5511" target="_blank">01:31:51.000</a></span> | <span class="t">Maximum y value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5513" target="_blank">01:31:53.000</a></span> | <span class="t">And so that way we never have to think about that again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5519" target="_blank">01:31:59.000</a></span> | <span class="t">So that's our.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5522" target="_blank">01:32:02.000</a></span> | <span class="t">So that's our data bunch class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5526" target="_blank">01:32:06.000</a></span> | <span class="t">So there's our get model so it's just going to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5530" target="_blank">01:32:10.000</a></span> | <span class="t">Create a model with the number of inputs is the size of the input data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5537" target="_blank">01:32:17.000</a></span> | <span class="t">Number of hidden is whatever we had earlier, whatever we pass in and a value and then a linear from hidden to data dot C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5546" target="_blank">01:32:26.000</a></span> | <span class="t">And return the model and an optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5549" target="_blank">01:32:29.000</a></span> | <span class="t">And we all know all about dot parameters now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5552" target="_blank">01:32:32.000</a></span> | <span class="t">So then the other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5556" target="_blank">01:32:36.000</a></span> | <span class="t">The rest of the stuff model lost funk opt and data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5559" target="_blank">01:32:39.000</a></span> | <span class="t">Let's store them in something but all up lost funk data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5564" target="_blank">01:32:44.000</a></span> | <span class="t">I want to store them away and that thing will call a learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5568" target="_blank">01:32:48.000</a></span> | <span class="t">So notice a learner class has no logic at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5572" target="_blank">01:32:52.000</a></span> | <span class="t">It's just a storage device for these 4 things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5578" target="_blank">01:32:58.000</a></span> | <span class="t">So now we can create a learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5581" target="_blank">01:33:01.000</a></span> | <span class="t">Passing in the model and the optimizer since they're returned in this order from get model we can just say star get model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5589" target="_blank">01:33:09.000</a></span> | <span class="t">So that's going to pass in the model and the optimizer and we've got our lost function already at the top here we set it to cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5596" target="_blank">01:33:16.000</a></span> | <span class="t">And we've got our data because it's that data bunch we just created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5600" target="_blank">01:33:20.000</a></span> | <span class="t">So this there's nothing magic going on with data bunches and learners are just like wrappers for the information that we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5609" target="_blank">01:33:29.000</a></span> | <span class="t">So now we'll take the fit function we had before and I just pasted it here but every time I had model I replaced it with learned up model every time I had data I replaced it with learned up data and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5621" target="_blank">01:33:41.000</a></span> | <span class="t">Okay, so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5623" target="_blank">01:33:43.000</a></span> | <span class="t">There's the exact same thing that we had before still working fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5628" target="_blank">01:33:48.000</a></span> | <span class="t">And so now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5631" target="_blank">01:33:51.000</a></span> | <span class="t">Let's add callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5635" target="_blank">01:33:55.000</a></span> | <span class="t">So our fit function before basically said for epoch in range epochs for batch in train dl and then it had these contents right predictions lost backwards step zero grad I factored out the contents into something called one batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5651" target="_blank">01:34:11.000</a></span> | <span class="t">Okay, and then I added.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5654" target="_blank">01:34:14.000</a></span> | <span class="t">All these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5658" target="_blank">01:34:18.000</a></span> | <span class="t">Callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5660" target="_blank">01:34:20.000</a></span> | <span class="t">At cb dot after backwards cd dot after step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5664" target="_blank">01:34:24.000</a></span> | <span class="t">I did one other refactoring which is that the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5669" target="_blank">01:34:29.000</a></span> | <span class="t">Training loop has to loop through every batch and the validation loop has to loop through every batch so I just created something called all batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5679" target="_blank">01:34:39.000</a></span> | <span class="t">Okay, so this is my fit loop right begin fit the epoch in epochs begin epoch or batches with the training set begin validate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5689" target="_blank">01:34:49.000</a></span> | <span class="t">No grad or batches with a validation set after epoch after fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5695" target="_blank">01:34:55.000</a></span> | <span class="t">Okay, so that's that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5699" target="_blank">01:34:59.000</a></span> | <span class="t">So here's a call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5702" target="_blank">01:35:02.000</a></span> | <span class="t">Right, which has.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5704" target="_blank">01:35:04.000</a></span> | <span class="t">All the stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5708" target="_blank">01:35:08.000</a></span> | <span class="t">And so then we need a call back handler and that's going to be something which you just say here's all my callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5716" target="_blank">01:35:16.000</a></span> | <span class="t">And basically it's just going to go through for each thing and say go through every call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5722" target="_blank">01:35:22.000</a></span> | <span class="t">And call it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5724" target="_blank">01:35:24.000</a></span> | <span class="t">And keep track of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5727" target="_blank">01:35:27.000</a></span> | <span class="t">Whether we've received a false yet or not false means don't keep going anymore and then return it so we do that for begin fit after fit begin epoch begin validate after epoch begin batch after loss after backward after step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5743" target="_blank">01:35:43.000</a></span> | <span class="t">So here's an example of a little call back we could create.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5747" target="_blank">01:35:47.000</a></span> | <span class="t">And it's one that's going to at the start of the fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5752" target="_blank">01:35:52.000</a></span> | <span class="t">It'll set number of iterations to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5755" target="_blank">01:35:55.000</a></span> | <span class="t">And then after every step it'll say number of iterations plus equals one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5760" target="_blank">01:36:00.000</a></span> | <span class="t">And print that out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5762" target="_blank">01:36:02.000</a></span> | <span class="t">And if we get past 10 iterations then it'll tell the learner to stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5769" target="_blank">01:36:09.000</a></span> | <span class="t">Because we have this little thing called do stop that gets checked at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5775" target="_blank">01:36:15.000</a></span> | <span class="t">So let's test it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5780" target="_blank">01:36:20.000</a></span> | <span class="t">And so it called fit and it only did 10 batches and this is actually a really handy call back because quite often you want to like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5788" target="_blank">01:36:28.000</a></span> | <span class="t">Just run a few batches to make sure things seem to be working you don't want to run a whole epoch so here's a quick way you can do something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5797" target="_blank">01:36:37.000</a></span> | <span class="t">This is basically what fast AI be one looks like right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5803" target="_blank">01:36:43.000</a></span> | <span class="t">It does have a little bit of extra stuff that lets you pass back and different loss and different data but it's nearly exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5811" target="_blank">01:36:51.000</a></span> | <span class="t">But.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5813" target="_blank">01:36:53.000</a></span> | <span class="t">I really like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5815" target="_blank">01:36:55.000</a></span> | <span class="t">Rewriting stuff because when I rewrite stuff it lets me kind of look and see what I've written and when I looked back at this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5822" target="_blank">01:37:02.000</a></span> | <span class="t">I saw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5830" target="_blank">01:37:10.000</a></span> | <span class="t">It's like it's it's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5832" target="_blank">01:37:12.000</a></span> | <span class="t">There's this object this is the CB is the call back handler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5837" target="_blank">01:37:17.000</a></span> | <span class="t">That's being passed everywhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5839" target="_blank">01:37:19.000</a></span> | <span class="t">And that's a code smell that code smell says something should have that state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5845" target="_blank">01:37:25.000</a></span> | <span class="t">And specifically these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5847" target="_blank">01:37:27.000</a></span> | <span class="t">Three functions should be the methods of something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5853" target="_blank">01:37:33.000</a></span> | <span class="t">That has this state so after I kind of wrote this part of the lesson I suddenly realized oh fast AI is doing it the dumb way so let's fix it so and this is likely to appear in a future version of fast AI I created a new thing called runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5869" target="_blank">01:37:49.000</a></span> | <span class="t">And so runner is a new class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5876" target="_blank">01:37:56.000</a></span> | <span class="t">Runner is a new class that contains the three things I just said one batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5881" target="_blank">01:38:01.000</a></span> | <span class="t">All batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5883" target="_blank">01:38:03.000</a></span> | <span class="t">And fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5885" target="_blank">01:38:05.000</a></span> | <span class="t">Right and the runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5889" target="_blank">01:38:09.000</a></span> | <span class="t">So here's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5891" target="_blank">01:38:11.000</a></span> | <span class="t">Is fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5893" target="_blank">01:38:13.000</a></span> | <span class="t">Right it's incredibly simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5895" target="_blank">01:38:15.000</a></span> | <span class="t">We're going to keep track of how many epochs we're doing we're going to keep track of the learner that we're running and remember the learner has no logic in it the stores for things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5906" target="_blank">01:38:26.000</a></span> | <span class="t">And then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5910" target="_blank">01:38:30.000</a></span> | <span class="t">We tell each of our callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5912" target="_blank">01:38:32.000</a></span> | <span class="t">What runner they're currently working with and then we call begin fit and then we go through each epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5919" target="_blank">01:38:39.000</a></span> | <span class="t">Set the epoch we call begin epoch we call all batches and then with no grad we call begin validate and then we call all batches and then we call after epoch and then we call after fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5932" target="_blank">01:38:52.000</a></span> | <span class="t">That's it now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5934" target="_blank">01:38:54.000</a></span> | <span class="t">This self.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5936" target="_blank">01:38:56.000</a></span> | <span class="t">String might look a bit weird.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5939" target="_blank">01:38:59.000</a></span> | <span class="t">But look at what we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5942" target="_blank">01:39:02.000</a></span> | <span class="t">Again horrible code smell is lots of duplicate code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5947" target="_blank">01:39:07.000</a></span> | <span class="t">Res equals true for call back blah blah blah blah blah blah begin a park.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5952" target="_blank">01:39:12.000</a></span> | <span class="t">Res equals true for call back blah blah blah blah blah begin validate so that's bad right code duplication means cognitive overhead to understand what's going on lots of opportunities to accidentally have one or instead of an and lots of places you have to change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5969" target="_blank">01:39:29.000</a></span> | <span class="t">If you need to edit something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5971" target="_blank">01:39:31.000</a></span> | <span class="t">So basically I took that out and I factored it out into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5977" target="_blank">01:39:37.000</a></span> | <span class="t">Dunder call so done to call is the thing that we've seen it before it's the thing that lets you treat an object as if it was a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=5987" target="_blank">01:39:47.000</a></span> | <span class="t">So I could have called this lots of things I could have called it self dot run call back or whatever right but it's the thing that happens absolutely everywhere and so my kind of rule of thumb is if you do something lots of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6000" target="_blank">01:40:00.000</a></span> | <span class="t">Make it small so done to call is the smallest possible way you can call something you don't have to give it a name at all when you call it so we say call the call back called after epoch it also makes sense right we're calling a call back so why not use done to call to call a call back so after epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6021" target="_blank">01:40:21.000</a></span> | <span class="t">I gotta go through all of my callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6025" target="_blank">01:40:25.000</a></span> | <span class="t">Talk about this sorted in a moment and then the other thing I didn't like before is that all of my callbacks had to inherit from this call back super class because if they didn't then they would have been missing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6040" target="_blank">01:40:40.000</a></span> | <span class="t">And one of these methods and so then when it tried to call the method there would have been an exception and I don't like forcing people to have to inherit from something they should be able to do whatever they like so what we did here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6054" target="_blank">01:40:54.000</a></span> | <span class="t">So what we did here was we used get attribute which is the python thing which says look inside this object and try to find something of this name a G begin validate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6067" target="_blank">01:41:07.000</a></span> | <span class="t">And default to none if you can't find it right so tries to find that call back and there will be none if the call back doesn't exist and if you find it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6078" target="_blank">01:41:18.000</a></span> | <span class="t">Then you can call it right so this is a nice way to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6084" target="_blank">01:41:24.000</a></span> | <span class="t">Call any call back but when you implement a call back as you can see look how much easier our test call back is now right it's just super simple just just implement what you need and we inherit from a new call back class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6100" target="_blank">01:41:40.000</a></span> | <span class="t">But we don't have to anymore right the main reason why is that our call back class now has an underscore order which we can use to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6110" target="_blank">01:41:50.000</a></span> | <span class="t">Choose what order callbacks running we'll talk about that after we handle this question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6117" target="_blank">01:41:57.000</a></span> | <span class="t">What is the difference between hooks and pie torch and callbacks and fast ai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6124" target="_blank">01:42:04.000</a></span> | <span class="t">We're going to do hooks very shortly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6129" target="_blank">01:42:09.000</a></span> | <span class="t">If you think about it if I want to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6134" target="_blank">01:42:14.000</a></span> | <span class="t">Kind of add a call back after I calculate the forward pass of the second layer of my model there's no way for me to do that right because the point at which I do the forward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6149" target="_blank">01:42:29.000</a></span> | <span class="t">Looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6151" target="_blank">01:42:31.000</a></span> | <span class="t">Self dot model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6153" target="_blank">01:42:33.000</a></span> | <span class="t">Or if I want to hook into the point at which I've just called the backward pass if my penultimate layer I can't do that either because the whole thing appears here is self lost a backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6164" target="_blank">01:42:44.000</a></span> | <span class="t">So hawks pie torch hawks are callbacks that you can add to specific pie torch modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6173" target="_blank">01:42:53.000</a></span> | <span class="t">And we're going to see them in very shortly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6177" target="_blank">01:42:57.000</a></span> | <span class="t">Might be next class we'll see how we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6181" target="_blank">01:43:01.000</a></span> | <span class="t">Okay so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6186" target="_blank">01:43:06.000</a></span> | <span class="t">Very often you want to be able to inject behavior into something but the different things can influence each other for example transformations we're going to be seeing this when we do data data augmentation so quite often you'll need things to run in a particular order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6204" target="_blank">01:43:24.000</a></span> | <span class="t">So when I add this kind of injectable behavior like callbacks I like to just add something which is what order should it run in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6214" target="_blank">01:43:34.000</a></span> | <span class="t">You don't have to put this here you might have noticed that what I do when I call this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6220" target="_blank">01:43:40.000</a></span> | <span class="t">Is I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6222" target="_blank">01:43:42.000</a></span> | <span class="t">This currently does sorry actually when we look at transformations it won't require order this one does require an order so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6229" target="_blank">01:43:49.000</a></span> | <span class="t">Yeah okay so your callbacks need to be something that have an underscore order attribute in them and this way we can make sure that some things run after other things so for example you might have noticed that our.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6244" target="_blank">01:44:04.000</a></span> | <span class="t">Our runner in the fit function never calls model dot eval never calls model dot train so like it literally doesn't do anything you know it just.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6254" target="_blank">01:44:14.000</a></span> | <span class="t">Says these are the steps I have to run and the callbacks do the running.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6259" target="_blank">01:44:19.000</a></span> | <span class="t">So I created a train eval call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6263" target="_blank">01:44:23.000</a></span> | <span class="t">That at the beginning of an epoch calls model dot train and the beginning of validation calls model dot eval and I also added stuff to keep track of how many epochs has it done and this is quite nice it actually does it as a floating point not just as an end so you could be like 2.3 epochs in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6284" target="_blank">01:44:44.000</a></span> | <span class="t">It also keeps track of how many iterations do you want so now we have this thing keeping track of iterations test call back that should stop training after 10 iterations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6295" target="_blank">01:44:55.000</a></span> | <span class="t">Rather than keeping track of and it is itself it should just use the end it a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6302" target="_blank">01:45:02.000</a></span> | <span class="t">That was defined in this call back so what we can do is we can say all right well train eval call back has an order of 0 because it inherits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6313" target="_blank">01:45:13.000</a></span> | <span class="t">So what we can just do here is make sure that this is later underscore order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6318" target="_blank">01:45:18.000</a></span> | <span class="t">Equals one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6321" target="_blank">01:45:21.000</a></span> | <span class="t">And so that way we can now refer to stuff that's inside the train eval call back like an inner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6331" target="_blank">01:45:31.000</a></span> | <span class="t">Sorry actually we don't even need to do that because it's putting an inner inside self dot run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6337" target="_blank">01:45:37.000</a></span> | <span class="t">So we can just go self dot and it if we if our order if this ran before train eval call back that would be a problem because and it might not have been.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6347" target="_blank">01:45:47.000</a></span> | <span class="t">Updated yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6350" target="_blank">01:45:50.000</a></span> | <span class="t">So that's what the orders for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6354" target="_blank">01:45:54.000</a></span> | <span class="t">Another nice thing about runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6361" target="_blank">01:46:01.000</a></span> | <span class="t">So a nice thing about class call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6366" target="_blank">01:46:06.000</a></span> | <span class="t">Is that I have to find dunder get atra.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6369" target="_blank">01:46:09.000</a></span> | <span class="t">And I have to find it to say return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6372" target="_blank">01:46:12.000</a></span> | <span class="t">Get atra self dot run comma K.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6376" target="_blank">01:46:16.000</a></span> | <span class="t">An important thing to know about dunder get atra is that it is only called by Python if it can't find the attribute that you've asked for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6385" target="_blank">01:46:25.000</a></span> | <span class="t">So if something asks for self dot name well I have self dot name so it's never going to get to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6391" target="_blank">01:46:31.000</a></span> | <span class="t">So if you get to here it means python look for this attribute and it couldn't find it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6396" target="_blank">01:46:36.000</a></span> | <span class="t">And so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6398" target="_blank">01:46:38.000</a></span> | <span class="t">Very very often the thing you actually want in the call back is actually inside the runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6405" target="_blank">01:46:45.000</a></span> | <span class="t">Which restore away is self dot run so this means that in all of our callbacks let's look at one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6414" target="_blank">01:46:54.000</a></span> | <span class="t">You can basically just use self dot pretty much everything and it will grab what you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6421" target="_blank">01:47:01.000</a></span> | <span class="t">Even though most of the stuff you want is inside the runner so you'll see this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6426" target="_blank">01:47:06.000</a></span> | <span class="t">Pattern in fast AI a lot is that when one object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6432" target="_blank">01:47:12.000</a></span> | <span class="t">Contains another object or composes another object we very often delegate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6437" target="_blank">01:47:17.000</a></span> | <span class="t">Get attribute to the other object so for example if you're looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6443" target="_blank">01:47:23.000</a></span> | <span class="t">A data set then I think we delegate to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6448" target="_blank">01:47:28.000</a></span> | <span class="t">X if you're looking at a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6451" target="_blank">01:47:31.000</a></span> | <span class="t">Stuff in the data box API will often delegate to stuff lower in the data box API and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6458" target="_blank">01:47:38.000</a></span> | <span class="t">So I find this pretty handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6462" target="_blank">01:47:42.000</a></span> | <span class="t">OK so we have a call back that as you see this very little to it one interesting thing you might notice is that a call back has a name property.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6473" target="_blank">01:47:53.000</a></span> | <span class="t">And the name property.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6476" target="_blank">01:47:56.000</a></span> | <span class="t">Works like this if you have a property called train eval call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6480" target="_blank">01:48:00.000</a></span> | <span class="t">Then we've got a function called camel to snake this is called camel case means you got uppercase and lowercase letters like a camel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6488" target="_blank">01:48:08.000</a></span> | <span class="t">And snake case looks like this so camel to snake turns this into a snake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6493" target="_blank">01:48:13.000</a></span> | <span class="t">And then what we do here is we remove call back from the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6500" target="_blank">01:48:20.000</a></span> | <span class="t">And that's its name so train eval call back has a name which is just train eval underscore and then in the runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6508" target="_blank">01:48:28.000</a></span> | <span class="t">Any call back functions that you pass in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6512" target="_blank">01:48:32.000</a></span> | <span class="t">Which it uses to create new callbacks it actually assigns them to an attribute with that name so we now have something called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6523" target="_blank">01:48:43.000</a></span> | <span class="t">Runner dot train eval for example so we do this in the faster library when you say learned recorder we didn't actually add an attribute called recorder to learner it just automatically sets that because there's a learner call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6541" target="_blank">01:49:01.000</a></span> | <span class="t">So.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6543" target="_blank">01:49:03.000</a></span> | <span class="t">So let's see how to use this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6547" target="_blank">01:49:07.000</a></span> | <span class="t">As a question okay let's do that in a moment so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6552" target="_blank">01:49:12.000</a></span> | <span class="t">Let's use this to add metrics because it's no fun having a training loop where we can't actually see how we're going and part of the whole point of this is that our actual training loop is now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6562" target="_blank">01:49:22.000</a></span> | <span class="t">So incredibly tight and neat and easy but we actually want to do all the stuff we want to do so what if we create a little call back called average stats call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6570" target="_blank">01:49:30.000</a></span> | <span class="t">Where we're going to stick into it a couple of objects to keep track of our loss and metrics one for training one for valid and at the start of an epoch will reset the statistics at the end of an epoch will print out the statistics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6587" target="_blank">01:49:47.000</a></span> | <span class="t">And after we've got the loss calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6591" target="_blank">01:49:51.000</a></span> | <span class="t">We will accumulate the statistics so then all we need is an object that has an accumulate method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6599" target="_blank">01:49:59.000</a></span> | <span class="t">So let's create a class that does that and here's our accumulate method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6605" target="_blank">01:50:05.000</a></span> | <span class="t">It's going to add up the total loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6608" target="_blank">01:50:08.000</a></span> | <span class="t">And for each metric.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6611" target="_blank">01:50:11.000</a></span> | <span class="t">It'll add up the total metrics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6614" target="_blank">01:50:14.000</a></span> | <span class="t">And then we'll give it a property called average stats that will go through all of those losses and metrics and return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6621" target="_blank">01:50:21.000</a></span> | <span class="t">The average and you might notice here I fixed the problem of having different batch sizes in the average we're actually adding lost times the size of the batch and count plus the size of the batch and metrics times the size of the batch and so then we're dividing here by the total.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6640" target="_blank">01:50:40.000</a></span> | <span class="t">Batch size so this is going to keep track of our stats will add a dunder Repra so that it prints out those statistics in a nice way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6652" target="_blank">01:50:52.000</a></span> | <span class="t">And so now we can create a learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6656" target="_blank">01:50:56.000</a></span> | <span class="t">And our average stats call back and when we call fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6670" target="_blank">01:51:10.000</a></span> | <span class="t">Metrics and loss tracking to our minimal training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6677" target="_blank">01:51:17.000</a></span> | <span class="t">Runner dunder call exits early when the first call back returns true why is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6689" target="_blank">01:51:29.000</a></span> | <span class="t">So one of the things I noticed was really annoying in the first way I wrote the call back handler was I had it so that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6701" target="_blank">01:51:41.000</a></span> | <span class="t">Something had to return something had to return true to mean keep going so basically false meant stop and that was really awkward because if you don't add a return in in python that it actually returns none and none is false and I thought oh if I forget to return something that should mean keep going that should be like the default so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6726" target="_blank">01:52:06.000</a></span> | <span class="t">The first thing to point out is that the basic lope now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6732" target="_blank">01:52:12.000</a></span> | <span class="t">Actually says if not rather than if right so if not begin a park so in other words if if your call back handler returns false then keep going and so that means that basically none of my callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6749" target="_blank">01:52:29.000</a></span> | <span class="t">Need to return anything most of the time except for test call back which returns true so true means cancel means stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6763" target="_blank">01:52:43.000</a></span> | <span class="t">So if one of my callbacks says stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6769" target="_blank">01:52:49.000</a></span> | <span class="t">Then I mean I could I could certainly imagine an argument in either way that but the way I thought it if it says stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6778" target="_blank">01:52:58.000</a></span> | <span class="t">Let's just stop right now you know why do we need to run the other callbacks so if it says stop then it returns stop says we don't want to go anymore and then we can depending on where you are so if it's after a park returns stop and it's actually going to stop the loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6797" target="_blank">01:53:17.000</a></span> | <span class="t">Entirely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6799" target="_blank">01:53:19.000</a></span> | <span class="t">So that's why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6803" target="_blank">01:53:23.000</a></span> | <span class="t">Yeah, so this is a little awkward we had to like construct our average stats call back and then we had to pass that to run and then later on we can refer to stats valid stats average stats because remember average stats was where we grab this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6823" target="_blank">01:53:43.000</a></span> | <span class="t">So that's OK, but it's a little awkward so instead what I do is I create a accuracy call back function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6833" target="_blank">01:53:53.000</a></span> | <span class="t">So that is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6835" target="_blank">01:53:55.000</a></span> | <span class="t">The average stats call back constructor passing an accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6841" target="_blank">01:54:01.000</a></span> | <span class="t">But with partial so partial returns is a function that returns a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6847" target="_blank">01:54:07.000</a></span> | <span class="t">And so this is now a function which can create a call back and so I can pass this to CB funks and now I don't have to store it away because the runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6861" target="_blank">01:54:21.000</a></span> | <span class="t">This is what we saw before the runner will go through each CB funks it will call that function to create the call back and then it will stick that call back inside the runner giving it this name as the attribute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6877" target="_blank">01:54:37.000</a></span> | <span class="t">So this way we can say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6883" target="_blank">01:54:43.000</a></span> | <span class="t">This is our call back function. This is our runner fit and now it's automatically available inside run dot average stats so so this is what faster IV one does except it puts them inside a winner because we don't have a runner concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6900" target="_blank">01:55:00.000</a></span> | <span class="t">So I think that's pretty handy it's kind of like it looks a little bit awkward the first time you do it but you can kind of create a standard set of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6908" target="_blank">01:55:08.000</a></span> | <span class="t">Call back functions that you want to use for particular types of models and then you can just store them away in a list and you don't have to think about them again which is what you'll see will do lots of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6921" target="_blank">01:55:21.000</a></span> | <span class="t">So. How like a lot of things in this part 2 of the course you can choose how deep to go on different things I think our approach to callbacks is super interesting and if you do too you might want to go deep here and really look into like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6940" target="_blank">01:55:40.000</a></span> | <span class="t">You know what kind of callbacks you can build and what things you can do with them that we haven't done yet but you know then a lot of these details around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6948" target="_blank">01:55:48.000</a></span> | <span class="t">Exactly how I do this if you're not as interested in the details of software engineering this might be something you care less about which is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6957" target="_blank">01:55:57.000</a></span> | <span class="t">The main thing that everybody should take away is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6961" target="_blank">01:56:01.000</a></span> | <span class="t">That that's our training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6964" target="_blank">01:56:04.000</a></span> | <span class="t">Okay. So you know the other stuff about like exactly how did we create our average stats call back and exactly what is done to call do a fairly minor details but you should recognize that the fit function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6982" target="_blank">01:56:22.000</a></span> | <span class="t">Stores how many epochs we're doing what learner we're working with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=6987" target="_blank">01:56:27.000</a></span> | <span class="t">Calls each of the different callbacks at each time right and it and like I never remember which ones are at which place if you go to docs.fast.ai the callbacks documentation will show you personally I just always look at the source code because it's just so easy to see exactly what happens at each time and exactly what's available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7011" target="_blank">01:56:51.000</a></span> | <span class="t">At each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7014" target="_blank">01:56:54.000</a></span> | <span class="t">So let's use this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7018" target="_blank">01:56:58.000</a></span> | <span class="t">And let's use this to do one cycle training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7023" target="_blank">01:57:03.000</a></span> | <span class="t">Because it's pretty hard when you have to have a constant learning rate all the time particularly because I was really wanting to show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7033" target="_blank">01:57:13.000</a></span> | <span class="t">A deep dive which about to see using hooks a deep dive into how.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7039" target="_blank">01:57:19.000</a></span> | <span class="t">The mechanics or kind of how the dynamics of training models looks like and what we'll learn is that the first batches everything if you can get the first batches working well then things will tend to be things are going to be good and this is how you can get super convergence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7057" target="_blank">01:57:37.000</a></span> | <span class="t">So if you want your first batches to be good it turns out that good annealing is critical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7064" target="_blank">01:57:44.000</a></span> | <span class="t">So let's do that right away let's set up good annealing because we have the mechanics we need because we have callbacks so we're inside of five and Neil.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7074" target="_blank">01:57:54.000</a></span> | <span class="t">Get our data this is all the same as before here's something to create a learner with one line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7079" target="_blank">01:57:59.000</a></span> | <span class="t">So let's create a learner with that same little model we had before and lost function data and we'll create a runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7088" target="_blank">01:58:08.000</a></span> | <span class="t">With a average stats call back this defaulted to a learning rate of point five maybe we could try it with learning rate of point three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7098" target="_blank">01:58:18.000</a></span> | <span class="t">Pretty handy being able to like quickly create things with different learning rates so let's create a function that's just going to be partial get model with a learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7108" target="_blank">01:58:28.000</a></span> | <span class="t">And so now we can just call get model funk and pass a learning rate in and we'll immediately have something with a different learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7116" target="_blank">01:58:36.000</a></span> | <span class="t">Yes tell me the question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7121" target="_blank">01:58:41.000</a></span> | <span class="t">So what is your typical debugging process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7126" target="_blank">01:58:46.000</a></span> | <span class="t">My debugging process is to use the debugger so if I got an exception while I was running a cell then I just go into the next cell and type percent debug.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7138" target="_blank">01:58:58.000</a></span> | <span class="t">And that pops open the debugger if things aren't working the way I expected but it wasn't an exception then I'll just add set underscore trace somewhere around the point I care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7149" target="_blank">01:59:09.000</a></span> | <span class="t">That's about it yeah I find that's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7154" target="_blank">01:59:14.000</a></span> | <span class="t">That works pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7157" target="_blank">01:59:17.000</a></span> | <span class="t">Most of the time then it's just a case of looking at what's it what's the shape of everything and what is everything contain like a couple of couple of objects in the batch I normally find something's got names or zeros or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7172" target="_blank">01:59:32.000</a></span> | <span class="t">Yeah it's really rare that using that debugger that I find debugging is that difficult if it is then it's just a case of stepping away and questioning your assumptions but with the help of a debugger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7189" target="_blank">01:59:49.000</a></span> | <span class="t">All of the states right there in front of you just one of the great things about pytorch is that it supports this kind of development.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7201" target="_blank">02:00:01.000</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7203" target="_blank">02:00:03.000</a></span> | <span class="t">All right so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7206" target="_blank">02:00:06.000</a></span> | <span class="t">We're going to create a call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7211" target="_blank">02:00:11.000</a></span> | <span class="t">That's going to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7214" target="_blank">02:00:14.000</a></span> | <span class="t">Hyper parameter scheduling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7216" target="_blank">02:00:16.000</a></span> | <span class="t">And so for this notebook we're just going to do learning rate as a hyper parameter but it's in the last 12 months one of the really successful areas of research have been people pointing out that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7230" target="_blank">02:00:30.000</a></span> | <span class="t">You can you can and should schedule everything your dropout amount what kind of data augmentation you do weight decay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7240" target="_blank">02:00:40.000</a></span> | <span class="t">Learning rate momentum everything which makes sense right because the other thing that we've been learning about a lot about in the last 12 months is how as you train a model it kind of goes through this different phases of like that the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7256" target="_blank">02:00:56.000</a></span> | <span class="t">The kind of weight landscapes the sorry the lost function the lost landscapes of neural nets look very different at the start in the middle and at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7269" target="_blank">02:01:09.000</a></span> | <span class="t">And so it's very unlikely that you would want the same hyper parameters throughout so being able to schedule anything is super handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7279" target="_blank">02:01:19.000</a></span> | <span class="t">So we'll create a parameter schedule a call back and you're just going to pass in a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7285" target="_blank">02:01:25.000</a></span> | <span class="t">Right and a parameter schedule so we're going to be passing in lr cuz lr is what pytorch calls learning rate and then this function will be something which takes a single argument.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7298" target="_blank">02:01:38.000</a></span> | <span class="t">Which is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7300" target="_blank">02:01:40.000</a></span> | <span class="t">Number of epochs divided by total epochs remember I told you that that train eval call back we added is going to set this to be a float so this will be the number of this will be like epoch number 2.35.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7313" target="_blank">02:01:53.000</a></span> | <span class="t">Out of 6 so this will be a float of exactly how far through training are we and we'll pass that to some function that we're going to write and the result of that function will be used to set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7325" target="_blank">02:02:05.000</a></span> | <span class="t">The hyper parameter in this case learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7329" target="_blank">02:02:09.000</a></span> | <span class="t">As you know from part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7332" target="_blank">02:02:12.000</a></span> | <span class="t">You don't necessarily want to have the same value of a hyper parameter for all of your layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7337" target="_blank">02:02:17.000</a></span> | <span class="t">So pytorch has something called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7339" target="_blank">02:02:19.000</a></span> | <span class="t">Parameter groups which we use an abstraction we call layer groups in fast AI but they're basically the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7347" target="_blank">02:02:27.000</a></span> | <span class="t">And so a pytorch optimizer contains a number of parameter groups unless you explicitly create more than one it'll all be in one but anytime we do stuff with hyper parameters you have to loop through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7362" target="_blank">02:02:42.000</a></span> | <span class="t">Pg in self dot opt dot parameter groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7365" target="_blank">02:02:45.000</a></span> | <span class="t">So then parameter group so learning rate for this parameter group this layer group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7371" target="_blank">02:02:51.000</a></span> | <span class="t">Is equal to the result of this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7374" target="_blank">02:02:54.000</a></span> | <span class="t">And then every time we start a new batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7378" target="_blank">02:02:58.000</a></span> | <span class="t">If we're training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7380" target="_blank">02:03:00.000</a></span> | <span class="t">And we'll run our schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7383" target="_blank">02:03:03.000</a></span> | <span class="t">Pretty hard to know if our schedule is working if we can't actually see what's happening to the learning rate as we go so let's create another call back called recorder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7392" target="_blank">02:03:12.000</a></span> | <span class="t">That at the start of fit fitting sets the allies and losses are raised to being empty.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7399" target="_blank">02:03:19.000</a></span> | <span class="t">And then after each batch as long as you're training it depends the current.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7405" target="_blank">02:03:25.000</a></span> | <span class="t">Learning rate and the current loss now there's actually lots of learning rates potentially because there's lots of layer groups so in fast AI we tend to use the final layer group as a learning rate we actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7418" target="_blank">02:03:38.000</a></span> | <span class="t">Point out but you don't have to do it that way and then we'll add something to plot the learning rates and we'll add something to plot the losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7425" target="_blank">02:03:45.000</a></span> | <span class="t">So hopefully this looks pretty familiar compared to the recorder in faster IV one so with that in place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7431" target="_blank">02:03:51.000</a></span> | <span class="t">We now need to create a function that takes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7436" target="_blank">02:03:56.000</a></span> | <span class="t">The percentage through the learning which we're going to call pause for position and returns the value of learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7445" target="_blank">02:04:05.000</a></span> | <span class="t">And so let's create one for linear schedules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7449" target="_blank">02:04:09.000</a></span> | <span class="t">So what we want to be able to pass this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7452" target="_blank">02:04:12.000</a></span> | <span class="t">Is a starting learning rate and an ending learning rate so you might pass it 10 and one and it was started the learning rate of 10 and go down to one that would be ridiculously high but whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7467" target="_blank">02:04:27.000</a></span> | <span class="t">But we need a function that just takes position so this is a function that's going to return a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7474" target="_blank">02:04:34.000</a></span> | <span class="t">So here's a function that takes a start learning rate and an end learning rate and a position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7481" target="_blank">02:04:41.000</a></span> | <span class="t">And returns the learning rate so to start plus position times difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7487" target="_blank">02:04:47.000</a></span> | <span class="t">So to convert that function into one which only takes position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7494" target="_blank">02:04:54.000</a></span> | <span class="t">We do partial passing in that function and the start and the end we were given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7500" target="_blank">02:05:00.000</a></span> | <span class="t">So now this function just takes position because that's the only thing from inner that we haven't set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7510" target="_blank">02:05:10.000</a></span> | <span class="t">So that's going to work fine but it's inconvenient because we're going to create lots of different schedule is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7517" target="_blank">02:05:17.000</a></span> | <span class="t">And I don't want to have to write all this every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7520" target="_blank">02:05:20.000</a></span> | <span class="t">So we can simplify the way that you can create these by using a decorator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7526" target="_blank">02:05:26.000</a></span> | <span class="t">Here's the version with a decorator with a decorator you create.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7531" target="_blank">02:05:31.000</a></span> | <span class="t">Linear scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7533" target="_blank">02:05:33.000</a></span> | <span class="t">In the natural way it's something that takes a start learning rate and end learning rate and a position and returns this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7541" target="_blank">02:05:41.000</a></span> | <span class="t">And then we add an annealer decorator and the annealer decorator is the thing that does all this in a partial nonsense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7549" target="_blank">02:05:49.000</a></span> | <span class="t">What's a decorator? A decorator is a function that returns a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7556" target="_blank">02:05:56.000</a></span> | <span class="t">And what Python does is if it sees the name of a function here with an at sign before it that it takes this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7564" target="_blank">02:06:04.000</a></span> | <span class="t">Passes it into this function and replaces the definition of this function with whatever this returns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7571" target="_blank">02:06:11.000</a></span> | <span class="t">So it's going to take this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7574" target="_blank">02:06:14.000</a></span> | <span class="t">It's going to pass it over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7577" target="_blank">02:06:17.000</a></span> | <span class="t">And then it's going to say return inner where inner is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7582" target="_blank">02:06:22.000</a></span> | <span class="t">Partial as we described before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7586" target="_blank">02:06:26.000</a></span> | <span class="t">So let's see that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7589" target="_blank">02:06:29.000</a></span> | <span class="t">So now shed Lynn we wrote it as taking start and end and pause, but if I hit shift tab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7599" target="_blank">02:06:39.000</a></span> | <span class="t">This says it only takes start and end. Why is that? Because we've replaced this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7606" target="_blank">02:06:46.000</a></span> | <span class="t">With this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7608" target="_blank">02:06:48.000</a></span> | <span class="t">And this function just takes start and end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7611" target="_blank">02:06:51.000</a></span> | <span class="t">And this is where Jupiter is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7615" target="_blank">02:06:55.000</a></span> | <span class="t">Going to give you a lot more happy times and pretty much any idea because this kind of dynamic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7623" target="_blank">02:07:03.000</a></span> | <span class="t">Code generation. It's pretty hard for an idea to do that for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7628" target="_blank">02:07:08.000</a></span> | <span class="t">Where else in Jupiter. It's actually running the code in an actual Python process so it knows exactly what shed Lynn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7635" target="_blank">02:07:15.000</a></span> | <span class="t">Means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7637" target="_blank">02:07:17.000</a></span> | <span class="t">So this is now created a function that takes start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7642" target="_blank">02:07:22.000</a></span> | <span class="t">And end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7643" target="_blank">02:07:23.000</a></span> | <span class="t">And returns a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7645" target="_blank">02:07:25.000</a></span> | <span class="t">Which takes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7648" target="_blank">02:07:28.000</a></span> | <span class="t">Which is what we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7650" target="_blank">02:07:30.000</a></span> | <span class="t">For our schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7653" target="_blank">02:07:33.000</a></span> | <span class="t">So let's try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7654" target="_blank">02:07:34.000</a></span> | <span class="t">Let's say f equals shed Lynn one comma two so this is a schedule that starts at learning rate one ends at learning rate two and then we'll say hey what should that be 30% of the way through training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7667" target="_blank">02:07:47.000</a></span> | <span class="t">And again if I hit shift tab here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7671" target="_blank">02:07:51.000</a></span> | <span class="t">It knows that f is something that takes pause right so it's really nice in Jupiter you can you can take advantage of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7679" target="_blank">02:07:59.000</a></span> | <span class="t">Python's dynamic nature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7682" target="_blank">02:08:02.000</a></span> | <span class="t">And like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7683" target="_blank">02:08:03.000</a></span> | <span class="t">There's no point using a dynamic language if you're not taking advantage of his dynamic nature right so things like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7690" target="_blank">02:08:10.000</a></span> | <span class="t">Decorators are super convenient way to do this stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7694" target="_blank">02:08:14.000</a></span> | <span class="t">There are other languages like Julia that can do similar things with macros like it's this is not the only way to get this kind of nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7703" target="_blank">02:08:23.000</a></span> | <span class="t">A very expressive ability but it's one good way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7708" target="_blank">02:08:28.000</a></span> | <span class="t">So now we can just go ahead and define all of our different schedule is by passing it each is start and pause.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7714" target="_blank">02:08:34.000</a></span> | <span class="t">So for example no schedule is something which.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7718" target="_blank">02:08:38.000</a></span> | <span class="t">Always return start or cosine scheduling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7722" target="_blank">02:08:42.000</a></span> | <span class="t">Exponential scheduling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7728" target="_blank">02:08:48.000</a></span> | <span class="t">So.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7730" target="_blank">02:08:50.000</a></span> | <span class="t">Let's define those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7732" target="_blank">02:08:52.000</a></span> | <span class="t">And then let's try to plot them and it doesn't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7736" target="_blank">02:08:56.000</a></span> | <span class="t">Why doesn't it work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7738" target="_blank">02:08:58.000</a></span> | <span class="t">Because you can't plot PyTorch tenses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7742" target="_blank">02:09:02.000</a></span> | <span class="t">But it turns out the only reason you can't plot PyTorch tenses is because tenses don't have an end in attribute which tells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7750" target="_blank">02:09:10.000</a></span> | <span class="t">Matplotlib how many dimensions there are so watch this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7755" target="_blank">02:09:15.000</a></span> | <span class="t">Torch dot tensor dot end in equals a property that is the length of the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7762" target="_blank">02:09:22.000</a></span> | <span class="t">And now replaced the definition again using the dynamic features of Python replace the def replace or actually insert into the definition of tensor a new property called end in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7774" target="_blank">02:09:34.000</a></span> | <span class="t">And now we can plot tenses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7776" target="_blank">02:09:36.000</a></span> | <span class="t">So like the nice thing about Python is you never have to be like oh this isn't supported because you can change everything you can insert things you can replace things whatever so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7789" target="_blank">02:09:49.000</a></span> | <span class="t">Here we've now got a nice print out of our four different schedule is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7796" target="_blank">02:09:56.000</a></span> | <span class="t">Which isn't really enough because if you want to do one cycle scheduling then in fact you know most of the time nowadays you want some kind of warm up and some kind of cool down or if you're doing something like SGDR you've got like multiple cool downs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7813" target="_blank">02:10:13.000</a></span> | <span class="t">So we really need to be able to paste some of these schedule is together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7818" target="_blank">02:10:18.000</a></span> | <span class="t">So let's create another function called combined schedule is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7823" target="_blank">02:10:23.000</a></span> | <span class="t">And it's going to look like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7825" target="_blank">02:10:25.000</a></span> | <span class="t">We're going to pass in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7828" target="_blank">02:10:28.000</a></span> | <span class="t">We're going to pass in the kind of the phases we want so phase one will be a cosine schedule from a learning rate of point three to point six phase two will be a learning rate as cosine schedule with a learning rate going from point six to point two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7842" target="_blank">02:10:42.000</a></span> | <span class="t">And phase one will take up 30% of our batches and phase two will take up 70%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7848" target="_blank">02:10:48.000</a></span> | <span class="t">So that's what we're going to pass in how long is each phase and what's the schedule in each phase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7854" target="_blank">02:10:54.000</a></span> | <span class="t">So.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7857" target="_blank">02:10:57.000</a></span> | <span class="t">Here's how we do that I don't think I need to go through the code it's there's nothing interesting about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7864" target="_blank">02:11:04.000</a></span> | <span class="t">But what we do once we have that is that we can then plot that schedule and you can kind of see why we're very fond of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7875" target="_blank">02:11:15.000</a></span> | <span class="t">Cosine one cycle schedule so I don't think this has ever been published anywhere but it's what fast AI uses by default nowadays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7885" target="_blank">02:11:25.000</a></span> | <span class="t">It's you kind of get a nice gentle warm up at the start and this is the time when things are just super sensitive and fall apart really quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7893" target="_blank">02:11:33.000</a></span> | <span class="t">But it doesn't take long as you'll see in next week's lesson when we do a deep dive into into stuff using hooks it doesn't take long for it to get into a decent part of the lost landscape and so you can quite quickly increase the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7908" target="_blank">02:11:48.000</a></span> | <span class="t">And then something that people have and we'll start looking at papers next week for this something that people have realized in the last.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7915" target="_blank">02:11:55.000</a></span> | <span class="t">4 months or so although Leslie Smith really kind of showed us this 2 years ago but it's only been the last 4 months or so that people have really understood this in the wider academic literature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7926" target="_blank">02:12:06.000</a></span> | <span class="t">You need to train at a high learning rate for a long time and so with this kind of coach cosine schedule we keep it up high for a long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7936" target="_blank">02:12:16.000</a></span> | <span class="t">But then you also need to fine tune at a very low learning rate for a long time so this has all of the kind of nice features that we want so cosine one cycle schedules are terrific and we now can build them from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7952" target="_blank">02:12:32.000</a></span> | <span class="t">So let's try training like this so with let's create a list of call back functions that has a recorder in it an average stats call back with accuracy in it and a parameter scheduler that schedules the learning rate using this schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7968" target="_blank">02:12:48.000</a></span> | <span class="t">And then fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7971" target="_blank">02:12:51.000</a></span> | <span class="t">That's looking pretty good we're getting up towards 94% pretty quickly and we can now go plot lr and it's the shape that we hope for and we can even say plot loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=7985" target="_blank">02:13:05.000</a></span> | <span class="t">We now have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8005" target="_blank">02:13:25.000</a></span> | <span class="t">We still haven't looked at convolutions really will do that next week and a lot more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8015" target="_blank">02:13:35.000</a></span> | <span class="t">But you kind of have the ability now to hopefully think of lots of things that you might want to try and and try them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8026" target="_blank">02:13:46.000</a></span> | <span class="t">So next week we're going to be starting with confidence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8036" target="_blank">02:13:56.000</a></span> | <span class="t">We're going to be kind of and we're going to be finally using a GPU because once we because once we start creating confidence of this size it starts taking a little bit too long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8048" target="_blank">02:14:08.000</a></span> | <span class="t">But just to read ahead a little bit how what's it going to take to put stuff on the CPU this is the entirety of the call back right so we've now got the mechanics we need to do things unbelievably quickly right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8064" target="_blank">02:14:24.000</a></span> | <span class="t">And then we'll be able to oh and also we'll be wanting to add some transformations this is the entirety of what it takes to do batch wise transformations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8074" target="_blank">02:14:34.000</a></span> | <span class="t">Without call back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8077" target="_blank">02:14:37.000</a></span> | <span class="t">As we discussed though we can't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8081" target="_blank">02:14:41.000</a></span> | <span class="t">Add callbacks between layers so we will add callbacks between layers initially manually and then using pytorch hooks and that way we're going to be able to plot and see exactly what's going on inside our models as they train and we'll find ways to train them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8103" target="_blank">02:15:03.000</a></span> | <span class="t">Much much more nicely so that by the end of next by the end of the next notebook will be up over 98% accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8113" target="_blank">02:15:13.000</a></span> | <span class="t">And that's going to be super cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8115" target="_blank">02:15:15.000</a></span> | <span class="t">And then we're going to do a deep dive into batch norm data blocks API optimizers and transforms and at that point I think we'll have basically all the mechanics we need to go into some more advanced architectures and training methods and see how we did some of the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=AcA8HAYh7IE&t=8139" target="_blank">02:15:39.000</a></span> | <span class="t">Cool stuff that we did in part one so I'll see you next week.</span></div></div></body></html>