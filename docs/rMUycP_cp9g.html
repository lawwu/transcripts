<html><head><title>Advanced Guardrails for AI Agents | Full Tutorial</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Advanced Guardrails for AI Agents | Full Tutorial</h2><a href="https://www.youtube.com/watch?v=rMUycP_cp9g"><img src="https://i.ytimg.com/vi_webp/rMUycP_cp9g/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=0">0:0</a> Why Guardrails<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=20">0:20</a> Guardrails for Agents<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=220">3:40</a> Sparse and Dense Vectors<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=480">8:0</a> Hybrid Guardrails with Python<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=749">12:29</a> Initializing the HybridRouter<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=901">15:1</a> Optimizing our Hybrid Guardrails<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1156">19:16</a> Testing our Hybrid Router<br><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1246">20:46</a> AI Guardrails in Context<br><br><div style="text-align: left;"><a href="./rMUycP_cp9g.html">Whisper Transcript</a> | <a href="./transcript_rMUycP_cp9g.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today, we are going to be taking a look at how we can build, to be honest, pretty spectacular guardrails for AI agents, chat applications, or just anything conversational,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=12" target="_blank">00:00:12.200</a></span> | <span class="t">or anything where we need to classify incoming natural language queries from a user, or even from an LLM itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=20" target="_blank">00:00:20.120</a></span> | <span class="t">When we're building these guardrails, there are a few different components that we would usually put together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=26" target="_blank">00:00:26.780</a></span> | <span class="t">We wouldn't just have one. We would typically have a routing layer, and that may even be broken down into multiple routing layers, or even a hierarchy of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=38" target="_blank">00:00:38.080</a></span> | <span class="t">That routing layer may be our guardrails, or it could be the opposite. It could be defining the scope of what we can talk about, or maybe even both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=51" target="_blank">00:00:51.060</a></span> | <span class="t">So we could have where we're allowed to talk about over here in yellow, and where we're not allowed to talk about over here in red,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=58" target="_blank">00:00:58.260</a></span> | <span class="t">and maybe we even overlap a little bit for very specific topics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=62" target="_blank">00:01:02.340</a></span> | <span class="t">Now, this fits in as, for example, a user over here will be chatting, and their queries will be hitting our initial set of guardrails,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=74" target="_blank">00:01:14.800</a></span> | <span class="t">and saying, "Okay, you can come through, or you cannot."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=77" target="_blank">00:01:17.800</a></span> | <span class="t">Now, depending on whether we get a "okay, you can continue," or we hit a guardrail, we may do different things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=87" target="_blank">00:01:27.600</a></span> | <span class="t">We may, with a guardrail, we may decide, "Okay, we're just going to provide a pre-written response,"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=93" target="_blank">00:01:33.680</a></span> | <span class="t">or we might say, "Okay, we need to go to another LLM and tell it it needs to deal with this situation in a good way."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=102" target="_blank">00:01:42.120</a></span> | <span class="t">So that will be the first layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=104" target="_blank">00:01:44.920</a></span> | <span class="t">Let's say we do get through our initial set of guardrails.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=108" target="_blank">00:01:48.760</a></span> | <span class="t">Then what we might want to do is have our LLM down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=114" target="_blank">00:01:54.560</a></span> | <span class="t">But of course, we're not just going to rely solely on those guardrails.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=120" target="_blank">00:02:00.480</a></span> | <span class="t">We also want to be prompting our LLM to be as secure as possible as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=125" target="_blank">00:02:05.280</a></span> | <span class="t">So there's another layer of protection also here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=128" target="_blank">00:02:08.540</a></span> | <span class="t">And that LLM, if a guardrail is hit, might decide, "Okay, we don't respond directly, or we provide a specific response that goes back to the user."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=139" target="_blank">00:02:19.040</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=140" target="_blank">00:02:20.800</a></span> | <span class="t">Let's say that did get through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=142" target="_blank">00:02:22.320</a></span> | <span class="t">Then what we might do is we come back around to the user and we hit either the same guardrails or, more likely, a different set of guardrails</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=154" target="_blank">00:02:34.560</a></span> | <span class="t">to make sure that the LLM isn't responding to something that we don't particularly like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=160" target="_blank">00:02:40.480</a></span> | <span class="t">Now, this structure here is what I would say is the essentials of guardrail protection for a public chat agent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=175" target="_blank">00:02:55.280</a></span> | <span class="t">There are still more things that we could add here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=178" target="_blank">00:02:58.240</a></span> | <span class="t">We could add things like specific codified rules that look for specific terms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=184" target="_blank">00:03:04.480</a></span> | <span class="t">Or we can have different classification models that also look at the incoming and outgoing text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=191" target="_blank">00:03:11.360</a></span> | <span class="t">But with what we have here, we can actually get pretty far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=196" target="_blank">00:03:16.320</a></span> | <span class="t">Now, what we are focusing on is this layer here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=201" target="_blank">00:03:21.440</a></span> | <span class="t">This is our semantic routing layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=205" target="_blank">00:03:25.040</a></span> | <span class="t">And I've spoken a lot about the semantic router before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=208" target="_blank">00:03:28.320</a></span> | <span class="t">But what I want to talk about in this video is making semantic router better by not just relying on semantics,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=216" target="_blank">00:03:36.480</a></span> | <span class="t">but also involving term matching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=220" target="_blank">00:03:40.480</a></span> | <span class="t">Now, what does that actually mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=221" target="_blank">00:03:41.680</a></span> | <span class="t">So, let's start with the semantic router.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=225" target="_blank">00:03:45.680</a></span> | <span class="t">Our user will say something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=228" target="_blank">00:03:48.160</a></span> | <span class="t">And what we do is we process a query through an embedding model such as OpenAeyes takes embedding 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=235" target="_blank">00:03:55.040</a></span> | <span class="t">And what that does is it creates this vector representation of their query within a semantic space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=242" target="_blank">00:04:02.720</a></span> | <span class="t">And what that means is that similar queries, when embedded with the same embedding model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=250" target="_blank">00:04:10.080</a></span> | <span class="t">would appear in a similar space to other queries that have similar semantics, i.e. they have a similar human meaning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=260" target="_blank">00:04:20.720</a></span> | <span class="t">So, for example, one of the queries that we're going to be using later is "Can I sell my Tesla?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=268" target="_blank">00:04:28.800</a></span> | <span class="t">Right, let's say that this is "Can I sell my Tesla?" in vector space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=273" target="_blank">00:04:33.280</a></span> | <span class="t">Okay, so we can imagine this as a 2D area.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=277" target="_blank">00:04:37.200</a></span> | <span class="t">Let's say this one is "Can I sell my Tesla?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=280" target="_blank">00:04:40.480</a></span> | <span class="t">Then what we would find is, okay, over here we might have another query, which is "Can I sell my Pulsar?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=288" target="_blank">00:04:48.800</a></span> | <span class="t">Okay, which is another EV.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=290" target="_blank">00:04:50.320</a></span> | <span class="t">And the human meaning of both of those queries is pretty similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=294" target="_blank">00:04:54.400</a></span> | <span class="t">So they end up in a similar vector space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=296" target="_blank">00:04:56.480</a></span> | <span class="t">And that means that for our user query here, what they might be saying is "Can I sell my some other car?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=304" target="_blank">00:05:04.560</a></span> | <span class="t">Okay, and what the semantic router by itself is doing is looking at a user's query and it's saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=312" target="_blank">00:05:12.560</a></span> | <span class="t">"How similar is that user's query to a set of other queries that we have predefined?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=319" target="_blank">00:05:19.840</a></span> | <span class="t">Okay, so we could say here, okay, these two red queries,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=322" target="_blank">00:05:22.880</a></span> | <span class="t">they are very similar and they are above a certain similarity threshold to our user's query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=329" target="_blank">00:05:29.440</a></span> | <span class="t">So we then know to flag the user's query as a particular route or a particular guardrail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=336" target="_blank">00:05:36.480</a></span> | <span class="t">based on those predefined queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=338" target="_blank">00:05:38.800</a></span> | <span class="t">Now this works pretty well, but there are some issues with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=345" target="_blank">00:05:45.280</a></span> | <span class="t">So for example, if our use case is we are a chatbot on a EVMaker's website.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=352" target="_blank">00:05:52.320</a></span> | <span class="t">Let's say our chatbot is from BYD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=356" target="_blank">00:05:56.800</a></span> | <span class="t">And we only want our users to be able to talk about BYD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=360" target="_blank">00:06:00.640</a></span> | <span class="t">We don't want them to talk about Pulsar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=362" target="_blank">00:06:02.080</a></span> | <span class="t">We don't want them to talk about Tesla.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=364" target="_blank">00:06:04.080</a></span> | <span class="t">Now, the problem with semantics here is that the semantic meaning is general.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=371" target="_blank">00:06:11.600</a></span> | <span class="t">It's not the semantic meaning based on whether this is BYD or Tesla.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=376" target="_blank">00:06:16.320</a></span> | <span class="t">It's the semantic meaning of general language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=379" target="_blank">00:06:19.440</a></span> | <span class="t">So what you will find is if someone's asking about BYD,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=383" target="_blank">00:06:23.360</a></span> | <span class="t">the semantic similarity between that and someone asking about Tesla is going to be pretty similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=388" target="_blank">00:06:28.480</a></span> | <span class="t">So this is where semantic routing alone can fall down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=393" target="_blank">00:06:33.040</a></span> | <span class="t">However, before we had dense embedding models, which create these semantic vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=399" target="_blank">00:06:39.440</a></span> | <span class="t">we had the more traditional embedding models, which are things like BM25 or TF-IDF.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=407" target="_blank">00:06:47.920</a></span> | <span class="t">And the way that these work is that they actually look at the words or terms between two sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=415" target="_blank">00:06:55.680</a></span> | <span class="t">And where we see that there is a lot of term overlap, we would score them more highly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=422" target="_blank">00:07:02.720</a></span> | <span class="t">And with that, we can create what we would call sparse embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=426" target="_blank">00:07:06.720</a></span> | <span class="t">And these sparse embeddings base their similarity scores on how much term overlap there is between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=433" target="_blank">00:07:13.760</a></span> | <span class="t">two queries rather than the semantic similarity between them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=438" target="_blank">00:07:18.080</a></span> | <span class="t">So this is a really good use case for a scenario where we are a brand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=443" target="_blank">00:07:23.360</a></span> | <span class="t">And we want to say queries that include information about our brand are okay, we can talk about them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=450" target="_blank">00:07:30.000</a></span> | <span class="t">But queries about other brands, especially our competitors, we do not want to answer to them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=455" target="_blank">00:07:35.120</a></span> | <span class="t">But at the same time, we still do want to include that semantic similarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=459" target="_blank">00:07:39.680</a></span> | <span class="t">Just because someone says something about BYD or Tesla, it doesn't mean that it would be Inscope or our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=465" target="_blank">00:07:45.760</a></span> | <span class="t">particular chatbot, which is something that semantic vectors can capture better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=471" target="_blank">00:07:51.520</a></span> | <span class="t">So we can merge these two methods and use a hybrid approach to create our guardrails.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=479" target="_blank">00:07:59.760</a></span> | <span class="t">Now we're going to be working through this example here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=482" target="_blank">00:08:02.640</a></span> | <span class="t">It's in the semantic router docs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=484" target="_blank">00:08:04.240</a></span> | <span class="t">And I'm going to go ahead and just open this in colab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=487" target="_blank">00:08:07.440</a></span> | <span class="t">And we can see the initial setup.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=489" target="_blank">00:08:09.280</a></span> | <span class="t">And we're going to start by just installing the semantic router library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=492" target="_blank">00:08:12.960</a></span> | <span class="t">And then what we're going to do is create a set of routes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=498" target="_blank">00:08:18.160</a></span> | <span class="t">So these are the routes that we would like to allow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=501" target="_blank">00:08:21.840</a></span> | <span class="t">Okay, so in this case, we are BYD and we want a customer facing chatbot that allows users to ask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=508" target="_blank">00:08:28.960</a></span> | <span class="t">about our products.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=510" target="_blank">00:08:30.240</a></span> | <span class="t">But then we want to block our competitors products from being spoken about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=517" target="_blank">00:08:37.200</a></span> | <span class="t">So in this case, we are looking at Tesla, Pulsar, and Rivian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=522" target="_blank">00:08:42.720</a></span> | <span class="t">Now, all of the utterances that you see here are just example queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=526" target="_blank">00:08:46.800</a></span> | <span class="t">So these are things that we could imagine users asking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=530" target="_blank">00:08:50.640</a></span> | <span class="t">And what we are essentially doing here is populating that semantic space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=535" target="_blank">00:08:55.280</a></span> | <span class="t">but also the sparse vector space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=537" target="_blank">00:08:57.840</a></span> | <span class="t">So we'll see that queries that mention BYD will share a high similarity to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=546" target="_blank">00:09:06.960</a></span> | <span class="t">route, whereas queries that include Tesla will share high similarity to this other route.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=552" target="_blank">00:09:12.560</a></span> | <span class="t">So let's go ahead and run those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=557" target="_blank">00:09:17.680</a></span> | <span class="t">We gather all those routes within a single routes variable here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=563" target="_blank">00:09:23.760</a></span> | <span class="t">Now we will need a OpenAI API key for this part here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=567" target="_blank">00:09:27.760</a></span> | <span class="t">And we can get that from platformopenai.com/apikeys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=573" target="_blank">00:09:33.040</a></span> | <span class="t">And we should find ourselves on this page.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=576" target="_blank">00:09:36.080</a></span> | <span class="t">So we're going to go ahead and create a new key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=578" target="_blank">00:09:38.800</a></span> | <span class="t">I'm just going to call this one the hybrid chat demo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=582" target="_blank">00:09:42.080</a></span> | <span class="t">Of course, you call it whatever you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=583" target="_blank">00:09:43.600</a></span> | <span class="t">Whatever is useful to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=586" target="_blank">00:09:46.320</a></span> | <span class="t">And we're just going to run this cell and enter our API key there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=591" target="_blank">00:09:51.680</a></span> | <span class="t">And what I just want to show you is I just want to show you some examples of similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=597" target="_blank">00:09:57.200</a></span> | <span class="t">or semantic only similarity between various queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=601" target="_blank">00:10:01.760</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=602" target="_blank">00:10:02.000</a></span> | <span class="t">So in this one, we have can I start my Tesla, Pulsar, BYD, and Rivian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=606" target="_blank">00:10:06.000</a></span> | <span class="t">And you can see the similarity between these is like 0.65, 67, 69.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=612" target="_blank">00:10:12.800</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=613" target="_blank">00:10:13.280</a></span> | <span class="t">So fairly high similarities for this embedding model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=617" target="_blank">00:10:17.120</a></span> | <span class="t">Now, what about if we just talk about BYD?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=622" target="_blank">00:10:22.400</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=623" target="_blank">00:10:23.040</a></span> | <span class="t">So we're asking various queries about BYD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=625" target="_blank">00:10:25.840</a></span> | <span class="t">Let's just see how similar those are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=628" target="_blank">00:10:28.160</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=630" target="_blank">00:10:30.400</a></span> | <span class="t">And you can actually see overall the similarities between these queries here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=635" target="_blank">00:10:35.440</a></span> | <span class="t">which are all talking about BYD, are actually score lower than the similarity scores that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=642" target="_blank">00:10:42.080</a></span> | <span class="t">from asking how to sell the various EVs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=645" target="_blank">00:10:45.840</a></span> | <span class="t">So this is a perfect scenario where we can't just rely on semantic embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=652" target="_blank">00:10:52.640</a></span> | <span class="t">And instead, we might want to bring in the hybrid approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=657" target="_blank">00:10:57.040</a></span> | <span class="t">So to do that, we're going to be using a sparse encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=662" target="_blank">00:11:02.400</a></span> | <span class="t">And this will actually be using BM25, but it's a BM25 model that is compatible with VectorSearch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=670" target="_blank">00:11:10.080</a></span> | <span class="t">Not all of them are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=671" target="_blank">00:11:11.040</a></span> | <span class="t">And it has also been trained on a large internet scale dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=676" target="_blank">00:11:16.160</a></span> | <span class="t">Now, what that does is essentially proxies using BM25 on your own dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=682" target="_blank">00:11:22.800</a></span> | <span class="t">Because in many cases, you might want to later train your own BM25 model on your own data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=689" target="_blank">00:11:29.360</a></span> | <span class="t">But you can actually use this and get pretty solid results out of the box.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=694" target="_blank">00:11:34.240</a></span> | <span class="t">So for this, we will need another API key, which we get from platform.aurelio.ai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=702" target="_blank">00:11:42.080</a></span> | <span class="t">You would need to create an account.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=704" target="_blank">00:11:44.400</a></span> | <span class="t">Now, assuming that you haven't already used the Aurelio platform, you can get some free credits to follow along with me on this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=712" target="_blank">00:11:52.400</a></span> | <span class="t">And to do that, we'd go to billing, add credits, put $5 for USD here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=720" target="_blank">00:12:00.640</a></span> | <span class="t">Go through to purchase, and then you just add your promotion code here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=727" target="_blank">00:12:07.840</a></span> | <span class="t">And that will give you $5 of free credits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=730" target="_blank">00:12:10.960</a></span> | <span class="t">Once you have your credits, you can then go to settings, API keys, and create a new API key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=738" target="_blank">00:12:18.880</a></span> | <span class="t">I'm going to, again, just call this hybrid chat demo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=743" target="_blank">00:12:23.120</a></span> | <span class="t">I'm just going to copy that and use it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=748" target="_blank">00:12:28.160</a></span> | <span class="t">Okay, great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=748" target="_blank">00:12:28.880</a></span> | <span class="t">So we have that, and we can now move on to setting up our hybrid router.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=752" target="_blank">00:12:32.960</a></span> | <span class="t">So we're using from semantic router routers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=756" target="_blank">00:12:36.080</a></span> | <span class="t">And rather than using the semantic router, which I'm sure probably a lot of you have used, we would be using the hybrid router.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=763" target="_blank">00:12:43.920</a></span> | <span class="t">And the only real difference in terms of using the hybrid router is that we need to include this sparse encoder, which is, of course, is what we have initialized up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=774" target="_blank">00:12:54.720</a></span> | <span class="t">So we initialize our sparse encoder, pass it through to our hybrid router, and then we're actually good to go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=780" target="_blank">00:13:00.800</a></span> | <span class="t">Now, one unique thing with hybrid is that it's much harder to define what a good similarity threshold is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=790" target="_blank">00:13:10.720</a></span> | <span class="t">Because your similarity threshold is a merger between your dense semantic vector space and your sparse term matching vector space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=800" target="_blank">00:13:20.960</a></span> | <span class="t">So we provide these default thresholds here, and these are mostly fine, depending on your use case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=810" target="_blank">00:13:30.640</a></span> | <span class="t">So in this use case, if we're just blocking mentions of these, but allowing mentions of these, and we don't really care about any other queries,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=818" target="_blank">00:13:38.800</a></span> | <span class="t">this would actually probably be completely fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=821" target="_blank">00:13:41.200</a></span> | <span class="t">But in the scenario where you have other conversations that you would allow without including them within our predefined set of utterances,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=834" target="_blank">00:13:54.160</a></span> | <span class="t">this will not work as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=837" target="_blank">00:13:57.600</a></span> | <span class="t">So let me go through how we can optimize our routes and those specifically those route thresholds to support more use cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=849" target="_blank">00:14:09.040</a></span> | <span class="t">So, okay, just to start with, if we are looking at very specific queries, okay, about Rivian, Pulsar, Tesla, BYD, we can actually get pretty good performance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=859" target="_blank">00:14:19.280</a></span> | <span class="t">Okay, so we can test that by creating a set of test data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=863" target="_blank">00:14:23.200</a></span> | <span class="t">Okay, we have our utterance on the left and the target route on the right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=871" target="_blank">00:14:31.440</a></span> | <span class="t">So we create a list of tuples that looks like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=874" target="_blank">00:14:34.160</a></span> | <span class="t">From that, we get our list of X, which is the queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=880" target="_blank">00:14:40.000</a></span> | <span class="t">So these items here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=881" target="_blank">00:14:41.600</a></span> | <span class="t">And then we have our targets, a Y, which is BYD, Tesla, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=886" target="_blank">00:14:46.880</a></span> | <span class="t">Okay, and we evaluate our performance of our router on this test data set, which is a very small test data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=894" target="_blank">00:14:54.240</a></span> | <span class="t">But nonetheless, you can see, okay, yeah, we get 100% accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=897" target="_blank">00:14:57.280</a></span> | <span class="t">That's not too surprising, given we don't have many examples here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=901" target="_blank">00:15:01.040</a></span> | <span class="t">However, if we make that a little more complicated, so we add many more examples, so many more utterances here, they are a lot more complex.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=913" target="_blank">00:15:13.040</a></span> | <span class="t">So for example, BYD, we're including, you know, mentions about Tesla and other EVs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=918" target="_blank">00:15:18.320</a></span> | <span class="t">And we're just including far more utterance to route pairs here than we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=926" target="_blank">00:15:26.640</a></span> | <span class="t">So that obviously increases the scope of what we are testing, which is important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=930" target="_blank">00:15:30.960</a></span> | <span class="t">You should always have as big as possible a test data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=935" target="_blank">00:15:35.600</a></span> | <span class="t">So we have all these, and then we have also added these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=939" target="_blank">00:15:39.760</a></span> | <span class="t">So this is if we would like to allow our users to talk about other things, which in, honestly, in a lot of cases, we might actually not want to do that, but it makes it harder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=952" target="_blank">00:15:52.640</a></span> | <span class="t">So I do want to, in this example, show you how we do handle that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=957" target="_blank">00:15:57.120</a></span> | <span class="t">So if we provide a non-route within our test data, the hybrid router is going to perceive that as, okay, this should not trigger any routes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=969" target="_blank">00:16:09.520</a></span> | <span class="t">And it should pass through the router without any issues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=972" target="_blank">00:16:12.960</a></span> | <span class="t">Okay, so we just have a lot of generic queries here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=975" target="_blank">00:16:15.520</a></span> | <span class="t">Like, how do I start a vegetable garden?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=977" target="_blank">00:16:17.920</a></span> | <span class="t">What was the best way to cook a steak?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=979" target="_blank">00:16:19.760</a></span> | <span class="t">Who's the first person to walk on the moon?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=981" target="_blank">00:16:21.680</a></span> | <span class="t">Like things that are nothing to do with our earlier queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=985" target="_blank">00:16:25.120</a></span> | <span class="t">And it's also very important to include a lot of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=989" target="_blank">00:16:29.520</a></span> | <span class="t">If you are aiming to build that sort of general purpose chat bot that will not be blocked on everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=996" target="_blank">00:16:36.960</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=997" target="_blank">00:16:37.600</a></span> | <span class="t">So we run that and we would pass that through to our evaluate method again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1004" target="_blank">00:16:44.240</a></span> | <span class="t">Before we do that, this is what X and Y look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1007" target="_blank">00:16:47.680</a></span> | <span class="t">So what I mentioned before, X is our utterances.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1010" target="_blank">00:16:50.800</a></span> | <span class="t">So the input data and Y includes our target routes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1015" target="_blank">00:16:55.840</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1016" target="_blank">00:16:56.240</a></span> | <span class="t">You can go all the way to the unknown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1017" target="_blank">00:16:57.440</a></span> | <span class="t">We should see some of those nones as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1020" target="_blank">00:17:00.480</a></span> | <span class="t">I'm not sure we need to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1022" target="_blank">00:17:02.160</a></span> | <span class="t">But if you like, you can set your thresholds here via the set threshold.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1027" target="_blank">00:17:07.600</a></span> | <span class="t">Also, if you wanted to, you can set threshold for all of your routes like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1031" target="_blank">00:17:11.920</a></span> | <span class="t">But I don't think we necessarily need to do that, to be honest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1037" target="_blank">00:17:17.120</a></span> | <span class="t">So let me even show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1038" target="_blank">00:17:18.720</a></span> | <span class="t">So we'll just stick with those default route thresholds and let's see what the accuracy is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1044" target="_blank">00:17:24.240</a></span> | <span class="t">Okay, pretty shocking to be honest, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1048" target="_blank">00:17:28.400</a></span> | <span class="t">51%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1049" target="_blank">00:17:29.360</a></span> | <span class="t">That's not great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1050" target="_blank">00:17:30.400</a></span> | <span class="t">Now, a big part of that is because these route thresholds here are so low that essentially all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1056" target="_blank">00:17:36.720</a></span> | <span class="t">those non-test cases are going to be hitting like BYD or Tesla or Pulsar no matter what,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1063" target="_blank">00:17:43.120</a></span> | <span class="t">even though they're completely unrelated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1065" target="_blank">00:17:45.280</a></span> | <span class="t">Because this is an incredibly low similarity score.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1069" target="_blank">00:17:49.440</a></span> | <span class="t">So anything with a high similarity than that is going to be triggering one of those routes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1074" target="_blank">00:17:54.000</a></span> | <span class="t">Which is fine if you're creating guardrails for everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1077" target="_blank">00:17:57.840</a></span> | <span class="t">But it's not fine if you want to allow some pass through of unknown queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1083" target="_blank">00:18:03.040</a></span> | <span class="t">So what we need to do is call the fit method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1086" target="_blank">00:18:06.400</a></span> | <span class="t">And what this will do is based on our test data up here, it's going to say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1090" target="_blank">00:18:10.880</a></span> | <span class="t">okay, I'm going to find the optimal thresholds given your test data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1096" target="_blank">00:18:16.880</a></span> | <span class="t">So we run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1098" target="_blank">00:18:18.640</a></span> | <span class="t">And we can see already, so this actually runs for probably far longer than it needs to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1105" target="_blank">00:18:25.360</a></span> | <span class="t">But you can see already that the accuracy here, it was a little lower at the start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1110" target="_blank">00:18:30.880</a></span> | <span class="t">It's increased and now it's at 94%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1112" target="_blank">00:18:32.720</a></span> | <span class="t">Now let's leave this to continue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1115" target="_blank">00:18:35.920</a></span> | <span class="t">We see it's increased up to 95, 96% now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1120" target="_blank">00:18:40.000</a></span> | <span class="t">We could possibly even leave it for longer, but that is pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1124" target="_blank">00:18:44.000</a></span> | <span class="t">Okay, so now let's see what our new thresholds are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1126" target="_blank">00:18:46.800</a></span> | <span class="t">So we have 0.57, 4.4 for Tesla.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1132" target="_blank">00:18:52.320</a></span> | <span class="t">Pulsar, 3.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1135" target="_blank">00:18:55.120</a></span> | <span class="t">And for Rivian, 71.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1136" target="_blank">00:18:56.960</a></span> | <span class="t">Interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1137" target="_blank">00:18:57.920</a></span> | <span class="t">Okay, so these are thresholds that the hybrid router has identified as being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1143" target="_blank">00:19:03.600</a></span> | <span class="t">the best performing thresholds for our test data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1147" target="_blank">00:19:07.600</a></span> | <span class="t">And the accuracy, whereas before we had 51%, has now increased up to 96%, which is a huge improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1155" target="_blank">00:19:15.680</a></span> | <span class="t">And we can also evaluate that again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1157" target="_blank">00:19:17.760</a></span> | <span class="t">So it's 95.61% now, which, yeah, great improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1163" target="_blank">00:19:23.280</a></span> | <span class="t">And it was not really that hard to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1166" target="_blank">00:19:26.560</a></span> | <span class="t">Now, that is with a relatively small data set here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1171" target="_blank">00:19:31.280</a></span> | <span class="t">This is not huge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1172" target="_blank">00:19:32.160</a></span> | <span class="t">As I said, the bigger, the better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1176" target="_blank">00:19:36.000</a></span> | <span class="t">But what you can also do, which I like to do anyway, is you can go to like ChatGPT or some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1182" target="_blank">00:19:42.800</a></span> | <span class="t">other LLM and just ask it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1185" target="_blank">00:19:45.280</a></span> | <span class="t">Okay, these are my scenarios I want to cover.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1188" target="_blank">00:19:48.080</a></span> | <span class="t">These are scenarios I want to let through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1189" target="_blank">00:19:49.920</a></span> | <span class="t">Can you create a set, a big training data set for me?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1192" target="_blank">00:19:52.960</a></span> | <span class="t">And it's actually pretty good at doing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1195" target="_blank">00:19:55.360</a></span> | <span class="t">So I wouldn't rely solely on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1198" target="_blank">00:19:58.320</a></span> | <span class="t">But you can at least fill up that data set quite easily by doing so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1205" target="_blank">00:20:05.360</a></span> | <span class="t">So with that, we can ask some other queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1208" target="_blank">00:20:08.800</a></span> | <span class="t">Like, okay, can I buy a Tesla from you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1212" target="_blank">00:20:12.720</a></span> | <span class="t">Okay, I don't think that was in the train set, but I'm not sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1216" target="_blank">00:20:16.480</a></span> | <span class="t">And we see, okay, route choice is Tesla.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1219" target="_blank">00:20:19.920</a></span> | <span class="t">Okay, that's great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1221" target="_blank">00:20:21.120</a></span> | <span class="t">Now I can say, okay, something random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1224" target="_blank">00:20:24.720</a></span> | <span class="t">How much is a flight to Australia from Europe?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1233" target="_blank">00:20:33.680</a></span> | <span class="t">Very generic, but fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1236" target="_blank">00:20:36.640</a></span> | <span class="t">And we see that our route choice is none, so no guardrails were triggered.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1242" target="_blank">00:20:42.320</a></span> | <span class="t">Okay, so that looks to be working pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1245" target="_blank">00:20:45.680</a></span> | <span class="t">Now, that is actually it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1248" target="_blank">00:20:48.400</a></span> | <span class="t">This is, as I mentioned at the start, this is one component of what I think should be,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1253" target="_blank">00:20:53.840</a></span> | <span class="t">you should have multiple layers of guardrails,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1255" target="_blank">00:20:55.680</a></span> | <span class="t">especially for anything that you're putting in production.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1258" target="_blank">00:20:58.080</a></span> | <span class="t">That should be, as we've seen here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1260" target="_blank">00:21:00.240</a></span> | <span class="t">essentially the input guardrails using hybrid routes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1264" target="_blank">00:21:04.240</a></span> | <span class="t">But you should also, of course, cover, okay, what's coming out from your LLM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1268" target="_blank">00:21:08.560</a></span> | <span class="t">You should be covering your LLM prompting guardrails</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1272" target="_blank">00:21:12.960</a></span> | <span class="t">and putting in various other safety components to ensure that, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1278" target="_blank">00:21:18.720</a></span> | <span class="t">people aren't going to be misusing whatever it is that you're building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1282" target="_blank">00:21:22.960</a></span> | <span class="t">But as you can see, you can get pretty far already with these hybrid routers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1289" target="_blank">00:21:29.440</a></span> | <span class="t">And they're insanely, just insanely fast and also insanely cost effective compared to,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1296" target="_blank">00:21:36.000</a></span> | <span class="t">let's say, just using their LLM as your guardrails,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1298" target="_blank">00:21:38.880</a></span> | <span class="t">whilst also providing that extra layer of safety.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1303" target="_blank">00:21:43.360</a></span> | <span class="t">Now, that is it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1306" target="_blank">00:21:46.640</a></span> | <span class="t">I hope all of this has been useful and interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1309" target="_blank">00:21:49.360</a></span> | <span class="t">But for now, I'll leave there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1310" target="_blank">00:21:50.560</a></span> | <span class="t">So, thank you very much for watching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1312" target="_blank">00:21:52.800</a></span> | <span class="t">And I will see you again in the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1315" target="_blank">00:21:55.200</a></span> | <span class="t">Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=rMUycP_cp9g&t=1317" target="_blank">00:21:57.200</a></span> | <span class="t">Bye.</span></div></div></body></html>