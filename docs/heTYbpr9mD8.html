<html><head><title>Building MLM Training Input Pipeline - Transformers From Scratch #3</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Building MLM Training Input Pipeline - Transformers From Scratch #3</h2><a href="https://www.youtube.com/watch?v=heTYbpr9mD8"><img src="https://i.ytimg.com/vi_webp/heTYbpr9mD8/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=136">2:16</a> Create Our Mass Language Modeling Function<br><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1319">21:59</a> Initialize Our Data Set<br><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1340">22:20</a> Data Loader<br><br><div style="text-align: left;"><a href="./heTYbpr9mD8.html">Whisper Transcript</a> | <a href="./transcript_heTYbpr9mD8.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi, welcome to this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=2" target="_blank">00:00:02.240</a></span> | <span class="t">So this is the third video in our Transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=6" target="_blank">00:00:06.800</a></span> | <span class="t">from Scratch miniseries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=10" target="_blank">00:00:10.400</a></span> | <span class="t">And in the last two videos, we basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=14" target="_blank">00:00:14.480</a></span> | <span class="t">got a load of data and trained our tokenizer, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=18" target="_blank">00:00:18.480</a></span> | <span class="t">is what you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=20" target="_blank">00:00:20.880</a></span> | <span class="t">So I'm going to have to rerun these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=29" target="_blank">00:00:29.080</a></span> | <span class="t">And we just tokenize some Italian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=33" target="_blank">00:00:33.560</a></span> | <span class="t">So this is a Italian BERT model, Roberta model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=39" target="_blank">00:00:39.040</a></span> | <span class="t">So we can write something like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=41" target="_blank">00:00:41.520</a></span> | <span class="t">which means, hello, how are you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=43" target="_blank">00:00:43.780</a></span> | <span class="t">And it will tokenize our text here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=48" target="_blank">00:00:48.520</a></span> | <span class="t">Now, this is where we got to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=51" target="_blank">00:00:51.000</a></span> | <span class="t">What we now want to do is build out a input pipeline</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=55" target="_blank">00:00:55.400</a></span> | <span class="t">and train a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=56" target="_blank">00:00:56.960</a></span> | <span class="t">Now, this is reasonably, I would say, involved,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=63" target="_blank">00:01:03.200</a></span> | <span class="t">because we need to do a few things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=67" target="_blank">00:01:07.520</a></span> | <span class="t">First thing is we need three different tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=73" target="_blank">00:01:13.640</a></span> | <span class="t">in our model here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=74" target="_blank">00:01:14.400</a></span> | <span class="t">We need the input IDs and attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=77" target="_blank">00:01:17.920</a></span> | <span class="t">We also need the labels tensor as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=81" target="_blank">00:01:21.200</a></span> | <span class="t">So the labels tensor is actually just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=84" target="_blank">00:01:24.000</a></span> | <span class="t">going to be our input IDs as they are at the moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=88" target="_blank">00:01:28.320</a></span> | <span class="t">But our input IDs are not going to be that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=90" target="_blank">00:01:30.640</a></span> | <span class="t">Our input IDs, they need to be passed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=94" target="_blank">00:01:34.760</a></span> | <span class="t">through a mass language modeling script, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=98" target="_blank">00:01:38.400</a></span> | <span class="t">will mask around 15% of the tokens within that tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=104" target="_blank">00:01:44.280</a></span> | <span class="t">And then whilst we're training, our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=107" target="_blank">00:01:47.080</a></span> | <span class="t">is essentially going to try and guess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=109" target="_blank">00:01:49.560</a></span> | <span class="t">what those masked tokens are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=112" target="_blank">00:01:52.280</a></span> | <span class="t">And we'll optimize the model using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=114" target="_blank">00:01:54.280</a></span> | <span class="t">the loss between the guesses that the model outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=118" target="_blank">00:01:58.200</a></span> | <span class="t">from the input IDs and the real values that are our labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=125" target="_blank">00:02:05.160</a></span> | <span class="t">So that's essentially how it's going to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=131" target="_blank">00:02:11.720</a></span> | <span class="t">I suppose it's a lot easier said than done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=133" target="_blank">00:02:13.840</a></span> | <span class="t">So first thing we're going to do is create our mass language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=138" target="_blank">00:02:18.120</a></span> | <span class="t">modeling function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=140" target="_blank">00:02:20.600</a></span> | <span class="t">If you have watched some of my videos before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=144" target="_blank">00:02:24.760</a></span> | <span class="t">we quite recently did, I think, two videos, maybe two videos</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=150" target="_blank">00:02:30.680</a></span> | <span class="t">on mass language modeling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=152" target="_blank">00:02:32.960</a></span> | <span class="t">I'll leave a link to those in the description</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=155" target="_blank">00:02:35.440</a></span> | <span class="t">because the code is pretty much the same as what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=158" target="_blank">00:02:38.080</a></span> | <span class="t">we cover there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=159" target="_blank">00:02:39.200</a></span> | <span class="t">And I will cover it very quickly here, but not too in-depth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=166" target="_blank">00:02:46.080</a></span> | <span class="t">So if you're interested, those links</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=170" target="_blank">00:02:50.320</a></span> | <span class="t">will be there in the description.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=173" target="_blank">00:02:53.920</a></span> | <span class="t">So the very first thing we need to do, which I haven't done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=179" target="_blank">00:02:59.360</a></span> | <span class="t">yet, is import torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=183" target="_blank">00:03:03.360</a></span> | <span class="t">So we're using PyTorch here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=187" target="_blank">00:03:07.120</a></span> | <span class="t">And we need to create a random array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=191" target="_blank">00:03:11.760</a></span> | <span class="t">So we write torch rand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=194" target="_blank">00:03:14.800</a></span> | <span class="t">And this random array needs to be in the same shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=197" target="_blank">00:03:17.560</a></span> | <span class="t">as our tensor that we've input up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=200" target="_blank">00:03:20.400</a></span> | <span class="t">So let's write tensor dot shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=205" target="_blank">00:03:25.120</a></span> | <span class="t">And then we want to mass around 15% of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=212" target="_blank">00:03:32.200</a></span> | <span class="t">So to do that, we can use rand, where rand is less than 0.15.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=220" target="_blank">00:03:40.040</a></span> | <span class="t">Because what we've created here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=223" target="_blank">00:03:43.560</a></span> | <span class="t">an array in the shape of our input tensor, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=226" target="_blank">00:03:46.720</a></span> | <span class="t">is going to be our input IDs, where every value is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=230" target="_blank">00:03:50.480</a></span> | <span class="t">within the range of 0 to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=235" target="_blank">00:03:55.160</a></span> | <span class="t">And that's completely random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=236" target="_blank">00:03:56.400</a></span> | <span class="t">So that means there should be--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=240" target="_blank">00:04:00.280</a></span> | <span class="t">or for each token, there's a roughly 15% chance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=243" target="_blank">00:04:03.640</a></span> | <span class="t">of that value being under 0.15.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=246" target="_blank">00:04:06.920</a></span> | <span class="t">So that's our first criteria for our random masking array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=254" target="_blank">00:04:14.280</a></span> | <span class="t">The roughly 15% can call this mask array as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=259" target="_blank">00:04:19.680</a></span> | <span class="t">But there's a few other criteria as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=261" target="_blank">00:04:21.440</a></span> | <span class="t">And again, I covered that in the other videos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=265" target="_blank">00:04:25.720</a></span> | <span class="t">But in short, we don't want to mask special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=270" target="_blank">00:04:30.680</a></span> | <span class="t">So we can see up here we have two special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=273" target="_blank">00:04:33.200</a></span> | <span class="t">If we add padding--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=275" target="_blank">00:04:35.160</a></span> | <span class="t">so I'm just going to add a little bit of padding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=277" target="_blank">00:04:37.920</a></span> | <span class="t">not loads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=278" target="_blank">00:04:38.680</a></span> | <span class="t">Let's go max length 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=280" target="_blank">00:04:40.960</a></span> | <span class="t">And we write padding equals max length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=284" target="_blank">00:04:44.840</a></span> | <span class="t">If we do that, we get these extra ones here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=288" target="_blank">00:04:48.000</a></span> | <span class="t">They're our padding tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=289" target="_blank">00:04:49.440</a></span> | <span class="t">So we basically want to say we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=291" target="_blank">00:04:51.480</a></span> | <span class="t">want to mask our 0's, 2's, or 1's,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=295" target="_blank">00:04:55.600</a></span> | <span class="t">because they're special tokens that we don't want to mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=298" target="_blank">00:04:58.520</a></span> | <span class="t">So we also just put where tensor is not equal to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=306" target="_blank">00:05:06.000</a></span> | <span class="t">And let's just copy that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=308" target="_blank">00:05:08.760</a></span> | <span class="t">It's a little bit easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=311" target="_blank">00:05:11.160</a></span> | <span class="t">And also not equal to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=312" target="_blank">00:05:12.640</a></span> | <span class="t">And it will also not be equal to 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=314" target="_blank">00:05:14.880</a></span> | <span class="t">And I do wonder if--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=323" target="_blank">00:05:23.320</a></span> | <span class="t">yeah, we could make that a bit nicer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=325" target="_blank">00:05:25.480</a></span> | <span class="t">So if we just do--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=328" target="_blank">00:05:28.680</a></span> | <span class="t">so you can either do this, where you specify each token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=332" target="_blank">00:05:32.160</a></span> | <span class="t">And you will want to do that sometimes, maybe,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=334" target="_blank">00:05:34.760</a></span> | <span class="t">like with BERT, because your special tokens are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=337" target="_blank">00:05:37.280</a></span> | <span class="t">in the range of, like, 100, 0, 101, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=342" target="_blank">00:05:42.280</a></span> | <span class="t">There's a few different ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=343" target="_blank">00:05:43.520</a></span> | <span class="t">But because we've got everything,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=345" target="_blank">00:05:45.040</a></span> | <span class="t">it's either 2 or below, we could just write this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=348" target="_blank">00:05:48.760</a></span> | <span class="t">So we could say where it is not or where it is greater than 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=354" target="_blank">00:05:54.680</a></span> | <span class="t">So this is like an AND statement saying,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=357" target="_blank">00:05:57.480</a></span> | <span class="t">we're going to mask tokens that have a randomly generated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=362" target="_blank">00:06:02.840</a></span> | <span class="t">value of less than 0.15.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=364" target="_blank">00:06:04.640</a></span> | <span class="t">That's our 15% criteria.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=368" target="_blank">00:06:08.120</a></span> | <span class="t">And they're not a special token, e.g.,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=370" target="_blank">00:06:10.440</a></span> | <span class="t">they are greater than the value 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=372" target="_blank">00:06:12.640</a></span> | <span class="t">because our special tokens are 0, 1, and 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=377" target="_blank">00:06:17.120</a></span> | <span class="t">So that's cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=378" target="_blank">00:06:18.320</a></span> | <span class="t">And now what we want to do is loop through each row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=385" target="_blank">00:06:25.600</a></span> | <span class="t">in our tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=386" target="_blank">00:06:26.760</a></span> | <span class="t">So we want to do for i in range tensor dot shape 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=395" target="_blank">00:06:35.520</a></span> | <span class="t">So this is how many rows we have in our tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=398" target="_blank">00:06:38.040</a></span> | <span class="t">And we can't do this in parallel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=400" target="_blank">00:06:40.440</a></span> | <span class="t">because each row is going to have a different number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=404" target="_blank">00:06:44.840</a></span> | <span class="t">of tokens that will be masked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=407" target="_blank">00:06:47.320</a></span> | <span class="t">So if we did this in parallel, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=409" target="_blank">00:06:49.600</a></span> | <span class="t">end up trying to fit different size rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=412" target="_blank">00:06:52.640</a></span> | <span class="t">into an equally sized tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=415" target="_blank">00:06:55.200</a></span> | <span class="t">So we can't do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=417" target="_blank">00:06:57.560</a></span> | <span class="t">Again, if this is confusing, I have those videos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=422" target="_blank">00:07:02.680</a></span> | <span class="t">But I mean, you don't need to specifically know everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=428" target="_blank">00:07:08.040</a></span> | <span class="t">that's going on here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=429" target="_blank">00:07:09.560</a></span> | <span class="t">This is just how we mask those roughly 15% of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=434" target="_blank">00:07:14.600</a></span> | <span class="t">So we want torch flatten.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=440" target="_blank">00:07:20.720</a></span> | <span class="t">And this bit is a bit confusing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=443" target="_blank">00:07:23.800</a></span> | <span class="t">But we want to take the mask array at the current position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=448" target="_blank">00:07:28.800</a></span> | <span class="t">I want to say where it's not 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=450" target="_blank">00:07:30.960</a></span> | <span class="t">So when we create this mask array,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=454" target="_blank">00:07:34.240</a></span> | <span class="t">we essentially get a load of true or false values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=457" target="_blank">00:07:37.880</a></span> | <span class="t">in the size of our tensor shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=461" target="_blank">00:07:41.760</a></span> | <span class="t">Where we have 1s, that is a mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=466" target="_blank">00:07:46.760</a></span> | <span class="t">And what we're doing here is we're saying,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=468" target="_blank">00:07:48.800</a></span> | <span class="t">get me a list of all the values that are not 0,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=472" target="_blank">00:07:52.520</a></span> | <span class="t">which are 1s.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=474" target="_blank">00:07:54.160</a></span> | <span class="t">And that gives us a list within a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=478" target="_blank">00:07:58.520</a></span> | <span class="t">So we get something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=479" target="_blank">00:07:59.760</a></span> | <span class="t">And it will say, indices 2, 4, 18.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=486" target="_blank">00:08:06.440</a></span> | <span class="t">I don't know why I said 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=487" target="_blank">00:08:07.520</a></span> | <span class="t">It's 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=488" target="_blank">00:08:08.560</a></span> | <span class="t">2, 5, 18.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=491" target="_blank">00:08:11.280</a></span> | <span class="t">They are where your mask tokens will be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=494" target="_blank">00:08:14.440</a></span> | <span class="t">And then we use torch flatten here to remove that outer list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=499" target="_blank">00:08:19.960</a></span> | <span class="t">And at the end here, we're going to convert to a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=503" target="_blank">00:08:23.440</a></span> | <span class="t">so that we can do some fancy indexing in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=508" target="_blank">00:08:28.240</a></span> | <span class="t">And that fancy indexing looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=510" target="_blank">00:08:30.480</a></span> | <span class="t">So we have our tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=511" target="_blank">00:08:31.800</a></span> | <span class="t">We're specifying the current row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=514" target="_blank">00:08:34.800</a></span> | <span class="t">So we're going row at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=517" target="_blank">00:08:37.400</a></span> | <span class="t">And then we want to specify that selected number of indices,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=522" target="_blank">00:08:42.480</a></span> | <span class="t">which are where we're going to place our mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=526" target="_blank">00:08:46.880</a></span> | <span class="t">Now, what does the mask token look like?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=531" target="_blank">00:08:51.360</a></span> | <span class="t">Well, we can actually find it over here in our vocab.json.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=544" target="_blank">00:09:04.680</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=546" target="_blank">00:09:06.000</a></span> | <span class="t">So scroll to the top, and we see our mappings here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=551" target="_blank">00:09:11.120</a></span> | <span class="t">So the mask token is number 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=555" target="_blank">00:09:15.000</a></span> | <span class="t">So that's what we're going to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=559" target="_blank">00:09:19.280</a></span> | <span class="t">Switch back over.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=561" target="_blank">00:09:21.960</a></span> | <span class="t">So we're going to make those values equal to 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=566" target="_blank">00:09:26.560</a></span> | <span class="t">That's our mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=567" target="_blank">00:09:27.800</a></span> | <span class="t">Then at that point, we have successfully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=572" target="_blank">00:09:32.200</a></span> | <span class="t">masked our input IDs, and we want to return the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=578" target="_blank">00:09:38.120</a></span> | <span class="t">So that's our masking function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=581" target="_blank">00:09:41.360</a></span> | <span class="t">That's a big part of this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=583" target="_blank">00:09:43.680</a></span> | <span class="t">That's one of the harder parts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=586" target="_blank">00:09:46.280</a></span> | <span class="t">So now what we're going to do is I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=588" target="_blank">00:09:48.240</a></span> | <span class="t">going to scroll up a little bit to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=592" target="_blank">00:09:52.520</a></span> | <span class="t">So we have-- I'm just going to take this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=597" target="_blank">00:09:57.880</a></span> | <span class="t">So this will give us a list of all of our training files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=603" target="_blank">00:10:03.120</a></span> | <span class="t">So here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=605" target="_blank">00:10:05.720</a></span> | <span class="t">And we just need to do from path lib, import path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=611" target="_blank">00:10:11.160</a></span> | <span class="t">OK, let's have a look at what we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=615" target="_blank">00:10:15.640</a></span> | <span class="t">So this is just a list of everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=620" target="_blank">00:10:20.680</a></span> | <span class="t">that we have over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=621" target="_blank">00:10:21.640</a></span> | <span class="t">So these are text files containing our Italian samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=626" target="_blank">00:10:26.720</a></span> | <span class="t">Each sample is separated by a newline character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=630" target="_blank">00:10:30.720</a></span> | <span class="t">And each file also contains about 10,000 samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=635" target="_blank">00:10:35.000</a></span> | <span class="t">So we have quite a bit of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=638" target="_blank">00:10:38.040</a></span> | <span class="t">And what we're going to do here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=641" target="_blank">00:10:41.120</a></span> | <span class="t">we're going to create our three tensors that I mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=646" target="_blank">00:10:46.400</a></span> | <span class="t">before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=647" target="_blank">00:10:47.040</a></span> | <span class="t">We have-- before I make a list, I didn't make a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=652" target="_blank">00:10:52.480</a></span> | <span class="t">So we have the labels and input IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=654" target="_blank">00:10:54.880</a></span> | <span class="t">and then we also have the attention mask as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=657" target="_blank">00:10:57.760</a></span> | <span class="t">So let's first initialize a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=662" target="_blank">00:11:02.800</a></span> | <span class="t">So input IDs, attention mask, or I'm just going to call it mask,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=673" target="_blank">00:11:13.240</a></span> | <span class="t">and labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=676" target="_blank">00:11:16.280</a></span> | <span class="t">And what we're going to do is I also--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=679" target="_blank">00:11:19.840</a></span> | <span class="t">so we're going to use a progress bar here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=681" target="_blank">00:11:21.600</a></span> | <span class="t">So I'm just going to import.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=683" target="_blank">00:11:23.800</a></span> | <span class="t">So from TQDM, auto import TQDM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=689" target="_blank">00:11:29.640</a></span> | <span class="t">So I'm just going to import that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=693" target="_blank">00:11:33.840</a></span> | <span class="t">And what I'm going to do is loop through each path in our--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=698" target="_blank">00:11:38.720</a></span> | <span class="t">I'm going to wrap it in TQDM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=700" target="_blank">00:11:40.360</a></span> | <span class="t">This creates our progress bar in our paths.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=702" target="_blank">00:11:42.560</a></span> | <span class="t">For each path, we're going to load it, extract our data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=710" target="_blank">00:11:50.480</a></span> | <span class="t">convert it into the correct format that we need here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=713" target="_blank">00:11:53.720</a></span> | <span class="t">and append each one of those to these lists,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=718" target="_blank">00:11:58.080</a></span> | <span class="t">and then create a big tensor out of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=721" target="_blank">00:12:01.400</a></span> | <span class="t">So we want to write with open.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=725" target="_blank">00:12:05.120</a></span> | <span class="t">And then here we have our path, our reading,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=728" target="_blank">00:12:08.560</a></span> | <span class="t">and the encoding is UTF-8 as F. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=735" target="_blank">00:12:15.040</a></span> | <span class="t">want to write text equals F.read.split, like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=742" target="_blank">00:12:22.920</a></span> | <span class="t">So I'm going to rename it lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=747" target="_blank">00:12:27.320</a></span> | <span class="t">So this is just a big list of 10,000 samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=752" target="_blank">00:12:32.800</a></span> | <span class="t">that are all Italian, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=755" target="_blank">00:12:35.680</a></span> | <span class="t">So then we want to encode that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=757" target="_blank">00:12:37.360</a></span> | <span class="t">So we write sample equals tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=760" target="_blank">00:12:40.920</a></span> | <span class="t">Lines, we want our max length, which is going to be 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=766" target="_blank">00:12:46.440</a></span> | <span class="t">We want padding up to that max length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=770" target="_blank">00:12:50.200</a></span> | <span class="t">And we also want to truncate anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=771" target="_blank">00:12:51.800</a></span> | <span class="t">that is further than that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=773" target="_blank">00:12:53.840</a></span> | <span class="t">So truncation equals trunc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=778" target="_blank">00:12:58.840</a></span> | <span class="t">OK, that's our tokenization done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=783" target="_blank">00:13:03.360</a></span> | <span class="t">Then we want to extract.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=785" target="_blank">00:13:05.640</a></span> | <span class="t">We want to extract all of those and add them to our list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=791" target="_blank">00:13:11.560</a></span> | <span class="t">So we get our labels first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=794" target="_blank">00:13:14.180</a></span> | <span class="t">Now, the labels are just the input IDs produced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=796" target="_blank">00:13:16.880</a></span> | <span class="t">by our sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=798" target="_blank">00:13:18.280</a></span> | <span class="t">So sample, input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=801" target="_blank">00:13:21.360</a></span> | <span class="t">And I'm thinking here we can do turn tensors, use PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=808" target="_blank">00:13:28.000</a></span> | <span class="t">So append our input IDs to labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=813" target="_blank">00:13:33.680</a></span> | <span class="t">And then we have our mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=814" target="_blank">00:13:34.760</a></span> | <span class="t">We want to append the sample attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=818" target="_blank">00:13:38.680</a></span> | <span class="t">And then we can also see that up here, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=825" target="_blank">00:13:45.360</a></span> | <span class="t">Here, this is what we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=826" target="_blank">00:13:46.600</a></span> | <span class="t">We're taking those out, putting them into our list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=830" target="_blank">00:13:50.040</a></span> | <span class="t">And then-- so we have labels, mask,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=831" target="_blank">00:13:51.840</a></span> | <span class="t">and we want to create our input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=833" target="_blank">00:13:53.440</a></span> | <span class="t">Now, input IDs, that's what we built this mass language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=838" target="_blank">00:13:58.360</a></span> | <span class="t">modeling function for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=840" target="_blank">00:14:00.520</a></span> | <span class="t">And in there, we need to pass our tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=843" target="_blank">00:14:03.720</a></span> | <span class="t">So to do that, we just want to write sample input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=850" target="_blank">00:14:10.720</a></span> | <span class="t">And before I forget, that needs to go within MLM, like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=856" target="_blank">00:14:16.720</a></span> | <span class="t">Like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=858" target="_blank">00:14:18.160</a></span> | <span class="t">Now, I don't want to modify that tensor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=861" target="_blank">00:14:21.280</a></span> | <span class="t">because it's being appended to labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=863" target="_blank">00:14:23.640</a></span> | <span class="t">So I'm going to create a clone of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=867" target="_blank">00:14:27.160</a></span> | <span class="t">And that will be done using detach and .clone, like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=874" target="_blank">00:14:34.680</a></span> | <span class="t">So it's pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=879" target="_blank">00:14:39.800</a></span> | <span class="t">Let's run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=884" target="_blank">00:14:44.960</a></span> | <span class="t">OK, and it's going to take a long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=887" target="_blank">00:14:47.960</a></span> | <span class="t">So, yeah, I'm not going to use all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=893" target="_blank">00:14:53.800</a></span> | <span class="t">It was going up as well, so I have no idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=895" target="_blank">00:14:55.880</a></span> | <span class="t">how long that would take.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=898" target="_blank">00:14:58.080</a></span> | <span class="t">Let's leave that for a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=900" target="_blank">00:15:00.360</a></span> | <span class="t">Let's go with the first 50 for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=904" target="_blank">00:15:04.160</a></span> | <span class="t">Still got to wait a little while,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=905" target="_blank">00:15:05.560</a></span> | <span class="t">but at least not as long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=908" target="_blank">00:15:08.960</a></span> | <span class="t">So I'll leave that to run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=914" target="_blank">00:15:14.800</a></span> | <span class="t">Hopefully it shouldn't take too long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=916" target="_blank">00:15:16.360</a></span> | <span class="t">And, yeah, I'll see you when it's done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=920" target="_blank">00:15:20.040</a></span> | <span class="t">OK, so that's done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=923" target="_blank">00:15:23.920</a></span> | <span class="t">It wasn't too long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=926" target="_blank">00:15:26.200</a></span> | <span class="t">And if we just have a look--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=928" target="_blank">00:15:28.280</a></span> | <span class="t">so input IDs at the moment is just a big list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=932" target="_blank">00:15:32.680</a></span> | <span class="t">I don't know if it's a good idea, but here we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=935" target="_blank">00:15:35.520</a></span> | <span class="t">So we just have a list of tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=939" target="_blank">00:15:39.280</a></span> | <span class="t">What we can do is, rather than having a list of tensors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=943" target="_blank">00:15:43.640</a></span> | <span class="t">we can use something called TorchCAT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=946" target="_blank">00:15:46.440</a></span> | <span class="t">And TorchCAT expects a list of tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=950" target="_blank">00:15:50.720</a></span> | <span class="t">to be passed to it, which is why I've done this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=953" target="_blank">00:15:53.600</a></span> | <span class="t">where we have lists and we just append tensors to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=957" target="_blank">00:15:57.920</a></span> | <span class="t">And we can do that, and it will concatenate our tensors, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=962" target="_blank">00:16:02.440</a></span> | <span class="t">is pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=963" target="_blank">00:16:03.720</a></span> | <span class="t">So what we want to do now is we write input IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=970" target="_blank">00:16:10.040</a></span> | <span class="t">and we're just going to concatenate all of our tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=975" target="_blank">00:16:15.260</a></span> | <span class="t">So then they're ready for formatting into a data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=982" target="_blank">00:16:22.920</a></span> | <span class="t">So we have mask here and labels here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=991" target="_blank">00:16:31.640</a></span> | <span class="t">We can also see, just worth pointing out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=996" target="_blank">00:16:36.920</a></span> | <span class="t">we have that mask token there, so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=998" target="_blank">00:16:38.600</a></span> | <span class="t">know that we have mask tokens in our input IDs now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1002" target="_blank">00:16:42.160</a></span> | <span class="t">If we-- let's run that, and let's just compare.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1007" target="_blank">00:16:47.800</a></span> | <span class="t">So let's go input IDs, 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1011" target="_blank">00:16:51.640</a></span> | <span class="t">That's quite a lot, so can I--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1017" target="_blank">00:16:57.720</a></span> | <span class="t">I'll just do the first 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1020" target="_blank">00:17:00.200</a></span> | <span class="t">And then let's do the same for labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1022" target="_blank">00:17:02.240</a></span> | <span class="t">We'll see that we don't have these 4s,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1023" target="_blank">00:17:03.920</a></span> | <span class="t">or we hopefully shouldn't have those 4s.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1028" target="_blank">00:17:08.360</a></span> | <span class="t">So that's essentially a masking operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1031" target="_blank">00:17:11.040</a></span> | <span class="t">So cover this with a mask here, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1034" target="_blank">00:17:14.040</a></span> | <span class="t">same here and here, here and here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1037" target="_blank">00:17:17.320</a></span> | <span class="t">OK, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1039" target="_blank">00:17:19.080</a></span> | <span class="t">Now the format that our data set needs and our model needs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1045" target="_blank">00:17:25.280</a></span> | <span class="t">is a dictionary where we have input IDs, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1050" target="_blank">00:17:30.280</a></span> | <span class="t">maps to input IDs, obviously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1052" target="_blank">00:17:32.120</a></span> | <span class="t">And you can guess either two as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1054" target="_blank">00:17:34.520</a></span> | <span class="t">So input IDs, this one, attention mask to mask,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1061" target="_blank">00:17:41.600</a></span> | <span class="t">and the final one is labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1066" target="_blank">00:17:46.320</a></span> | <span class="t">So there are encodings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1069" target="_blank">00:17:49.640</a></span> | <span class="t">Now we create a data set object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1072" target="_blank">00:17:52.880</a></span> | <span class="t">To create a data set object-- in fact,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1076" target="_blank">00:17:56.120</a></span> | <span class="t">actually, we create a data set object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1078" target="_blank">00:17:58.880</a></span> | <span class="t">to create a data loader object, which is what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1081" target="_blank">00:18:01.920</a></span> | <span class="t">use to load data into our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1083" target="_blank">00:18:03.840</a></span> | <span class="t">And that's essentially our input pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1089" target="_blank">00:18:09.480</a></span> | <span class="t">But to create that data loader, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1091" target="_blank">00:18:11.160</a></span> | <span class="t">need to create a data set object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1094" target="_blank">00:18:14.640</a></span> | <span class="t">Now the data set object, we create that by--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1098" target="_blank">00:18:18.400</a></span> | <span class="t">well, like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1099" target="_blank">00:18:19.560</a></span> | <span class="t">So we do class data set, color, whatever you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1103" target="_blank">00:18:23.240</a></span> | <span class="t">And we want torch, utils, data, data set, like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1110" target="_blank">00:18:30.440</a></span> | <span class="t">We need a initialization function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1116" target="_blank">00:18:36.920</a></span> | <span class="t">which is going to store our encodings internally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1121" target="_blank">00:18:41.480</a></span> | <span class="t">Don't forget the def there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1124" target="_blank">00:18:44.680</a></span> | <span class="t">So we want to write self encodings equals encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1128" target="_blank">00:18:48.240</a></span> | <span class="t">So this is initializing our data set object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1133" target="_blank">00:18:53.280</a></span> | <span class="t">And then there's two other methods that this object needs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1136" target="_blank">00:18:56.760</a></span> | <span class="t">We need a length method so that we can say length data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1141" target="_blank">00:19:01.320</a></span> | <span class="t">And it will return the number of samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1143" target="_blank">00:19:03.280</a></span> | <span class="t">that are in the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1144" target="_blank">00:19:04.800</a></span> | <span class="t">And we also need a get item method,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1146" target="_blank">00:19:06.840</a></span> | <span class="t">which will allow the data loader to extract a certain--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1153" target="_blank">00:19:13.680</a></span> | <span class="t">so say if it says, give me number one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1157" target="_blank">00:19:17.640</a></span> | <span class="t">it's going to go into this data set object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1159" target="_blank">00:19:19.880</a></span> | <span class="t">and extract the tensors, the input IDs, attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1163" target="_blank">00:19:23.240</a></span> | <span class="t">marks, and labels at position one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1167" target="_blank">00:19:27.360</a></span> | <span class="t">So that's what we need to do there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1171" target="_blank">00:19:31.280</a></span> | <span class="t">So we'll do length first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1175" target="_blank">00:19:35.000</a></span> | <span class="t">And length, we don't need to pass anything in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1177" target="_blank">00:19:37.440</a></span> | <span class="t">We're just calling length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1178" target="_blank">00:19:38.560</a></span> | <span class="t">So from that, we just want to return the self encodings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1184" target="_blank">00:19:44.120</a></span> | <span class="t">do input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1185" target="_blank">00:19:45.400</a></span> | <span class="t">And remember before, we did this shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1187" target="_blank">00:19:47.040</a></span> | <span class="t">And we took the first one, which is the length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1189" target="_blank">00:19:49.480</a></span> | <span class="t">So if I take input IDs, in fact, I can just do it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1195" target="_blank">00:19:55.560</a></span> | <span class="t">So I'll copy that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1196" target="_blank">00:19:56.440</a></span> | <span class="t">If I go here, we get that 500K, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1202" target="_blank">00:20:02.800</a></span> | <span class="t">is the number of samples we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1204" target="_blank">00:20:04.280</a></span> | <span class="t">That's what we want to return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1205" target="_blank">00:20:05.520</a></span> | <span class="t">So that's our length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1209" target="_blank">00:20:09.720</a></span> | <span class="t">And then we also have the get item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1211" target="_blank">00:20:11.720</a></span> | <span class="t">So here, we do want to pass an index value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1217" target="_blank">00:20:17.880</a></span> | <span class="t">So this is going to be--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1219" target="_blank">00:20:19.280</a></span> | <span class="t">our data load is requesting a certain position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1223" target="_blank">00:20:23.600</a></span> | <span class="t">And for that, we want to return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1225" target="_blank">00:20:25.200</a></span> | <span class="t">So we're going to return dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1226" target="_blank">00:20:26.700</a></span> | <span class="t">It needs to be in this format here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1228" target="_blank">00:20:28.960</a></span> | <span class="t">But we need to specify the correct index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1233" target="_blank">00:20:33.200</a></span> | <span class="t">Now, what we could do is we could do self encodings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1240" target="_blank">00:20:40.520</a></span> | <span class="t">and then access our input IDs like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1244" target="_blank">00:20:44.480</a></span> | <span class="t">We also-- I need to change that here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1247" target="_blank">00:20:47.400</a></span> | <span class="t">So it'll give us an error, dot shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1253" target="_blank">00:20:53.920</a></span> | <span class="t">And we could do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1255" target="_blank">00:20:55.640</a></span> | <span class="t">So we could take that like so, and then just say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1265" target="_blank">00:21:05.240</a></span> | <span class="t">index position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1266" target="_blank">00:21:06.640</a></span> | <span class="t">That's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1267" target="_blank">00:21:07.560</a></span> | <span class="t">You can do that if you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1269" target="_blank">00:21:09.280</a></span> | <span class="t">But an easier way of doing it, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1271" target="_blank">00:21:11.000</a></span> | <span class="t">we don't need to specify the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1273" target="_blank">00:21:13.040</a></span> | <span class="t">we don't care about the structure of the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1276" target="_blank">00:21:16.200</a></span> | <span class="t">We just want to get it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1279" target="_blank">00:21:19.400</a></span> | <span class="t">We don't need to specify it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1281" target="_blank">00:21:21.760</a></span> | <span class="t">We can just do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1285" target="_blank">00:21:25.000</a></span> | <span class="t">You write key tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1288" target="_blank">00:21:28.760</a></span> | <span class="t">So the specific index of that tensor for key tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1296" target="_blank">00:21:36.200</a></span> | <span class="t">in self encodings, dot items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1300" target="_blank">00:21:40.840</a></span> | <span class="t">So if we were to go encodings, dot items--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1305" target="_blank">00:21:45.480</a></span> | <span class="t">so we can do that here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1307" target="_blank">00:21:47.760</a></span> | <span class="t">See, we get essentially everything in our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1311" target="_blank">00:21:51.960</a></span> | <span class="t">So we're just looping through that, returning it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1314" target="_blank">00:21:54.160</a></span> | <span class="t">and specifying which index we're returning here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1318" target="_blank">00:21:58.240</a></span> | <span class="t">So once we have written that, we can initialize our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1322" target="_blank">00:22:02.680</a></span> | <span class="t">So write data set equals data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1328" target="_blank">00:22:08.880</a></span> | <span class="t">And then we just pass in our encodings there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1331" target="_blank">00:22:11.220</a></span> | <span class="t">So just remove that, and encodings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1334" target="_blank">00:22:14.760</a></span> | <span class="t">That's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1336" target="_blank">00:22:16.000</a></span> | <span class="t">So that's our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1338" target="_blank">00:22:18.400</a></span> | <span class="t">And now we initialize our data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1342" target="_blank">00:22:22.280</a></span> | <span class="t">So this is pretty much it for our input pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1345" target="_blank">00:22:25.880</a></span> | <span class="t">So data loader equals torch utils.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1349" target="_blank">00:22:29.240</a></span> | <span class="t">This is coming from the same area as our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1353" target="_blank">00:22:33.240</a></span> | <span class="t">Data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1354" target="_blank">00:22:34.920</a></span> | <span class="t">Now we pass in our data set object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1357" target="_blank">00:22:37.680</a></span> | <span class="t">We want to specify batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1360" target="_blank">00:22:40.360</a></span> | <span class="t">So I typically go with 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1363" target="_blank">00:22:43.680</a></span> | <span class="t">This will depend on how much your computer can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1367" target="_blank">00:22:47.320</a></span> | <span class="t">handle it once as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1368" target="_blank">00:22:48.820</a></span> | <span class="t">So just play around with that, see what works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1372" target="_blank">00:22:52.040</a></span> | <span class="t">And we also want to shuffle our data set as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1374" target="_blank">00:22:54.400</a></span> | <span class="t">So yeah, that's our input pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1380" target="_blank">00:23:00.400</a></span> | <span class="t">After that, obviously, we want to feed it in and train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1383" target="_blank">00:23:03.120</a></span> | <span class="t">our model with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1383" target="_blank">00:23:03.880</a></span> | <span class="t">So we're going to cover that in the next video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=heTYbpr9mD8&t=1388" target="_blank">00:23:08.160</a></span> | <span class="t">So thank you for watching, and I will see you in the next one.</span></div></div></body></html>