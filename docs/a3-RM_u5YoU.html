<html><head><title>Medical Search Engine with SPLADE + Sentence Transformers in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Medical Search Engine with SPLADE + Sentence Transformers in Python</h2><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU"><img src="https://i.ytimg.com/vi/a3-RM_u5YoU/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=0">0:0</a> Hybrid search for medical field<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=18">0:18</a> Hybrid search process<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=162">2:42</a> Prerequisites and Installs<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=206">3:26</a> Pubmed QA data preprocessing step<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=505">8:25</a> Creating dense vectors with sentence-transformers<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=630">10:30</a> Creating sparse vector embeddings with SPLADE<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1092">18:12</a> Preparing sparse-dense format for Pinecone<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1262">21:2</a> Creating the Pinecone sparse-dense index<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1465">24:25</a> Making hybrid search queries<br><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1799">29:59</a> Final thoughts on sparse-dense with SPLADE<br><br><div style="text-align: left;"><a href="./a3-RM_u5YoU.html">Whisper Transcript</a> | <a href="./transcript_a3-RM_u5YoU.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're going to take a look at how to implement a hybrid search engine using both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=7" target="_blank">00:00:07.240</a></span> | <span class="t">Splayed and a sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=11" target="_blank">00:00:11.180</a></span> | <span class="t">This is going to be very hands on, so I'm going to outline the architecture of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=15" target="_blank">00:00:15.820</a></span> | <span class="t">thing and then we'll jump straight into building it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=18" target="_blank">00:00:18.360</a></span> | <span class="t">So as for the process that we're going to be going through here, we're going to start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=23" target="_blank">00:00:23.500</a></span> | <span class="t">off with data, obviously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=25" target="_blank">00:00:25.420</a></span> | <span class="t">So we have our data over here and it's just going to be paragraphs of text, like loads</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=31" target="_blank">00:00:31.760</a></span> | <span class="t">and loads of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=32" target="_blank">00:00:32.760</a></span> | <span class="t">What we're going to have to do is we're going to have to create a chunking mechanism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=37" target="_blank">00:00:37.400</a></span> | <span class="t">So when we are encoding these chunks of text or just general information, we can't encode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=44" target="_blank">00:00:44.980</a></span> | <span class="t">too much information in any one go, depending on which models you're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=50" target="_blank">00:00:50.900</a></span> | <span class="t">So if you're using Cohere or OpenAI, the chunks that you can use will be much larger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=56" target="_blank">00:00:56.220</a></span> | <span class="t">We're going to be using a sentence transformer on one side and then Splayed on the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=60" target="_blank">00:01:00.900</a></span> | <span class="t">side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=61" target="_blank">00:01:01.900</a></span> | <span class="t">Splayed and the sentence transformer are somewhat limited.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=64" target="_blank">00:01:04.520</a></span> | <span class="t">You're definitely not going to go over around 500 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=68" target="_blank">00:01:08.620</a></span> | <span class="t">And with the Dennis Vector Embedding model, the sentence transformer, I believe it's like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=73" target="_blank">00:01:13.040</a></span> | <span class="t">384 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=75" target="_blank">00:01:15.100</a></span> | <span class="t">So you think that's probably around a thousand characters at most.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=79" target="_blank">00:01:19.540</a></span> | <span class="t">So you're thinking a few sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=81" target="_blank">00:01:21.980</a></span> | <span class="t">So we're going to take that through a chunking mechanism to just break it apart into chunks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=86" target="_blank">00:01:26.900</a></span> | <span class="t">of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=87" target="_blank">00:01:27.900</a></span> | <span class="t">Right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=88" target="_blank">00:01:28.900</a></span> | <span class="t">And then those chunks of text, we're going to take them on one side, we're going to feed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=94" target="_blank">00:01:34.380</a></span> | <span class="t">them into Splayed, which is going to create our sparse vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=102" target="_blank">00:01:42.020</a></span> | <span class="t">And then on the other side, we have our sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=105" target="_blank">00:01:45.780</a></span> | <span class="t">Can't remember which one we're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=108" target="_blank">00:01:48.020</a></span> | <span class="t">So I'll just put ST for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=110" target="_blank">00:01:50.540</a></span> | <span class="t">And that will give us our Dennis Vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=114" target="_blank">00:01:54.420</a></span> | <span class="t">Right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=115" target="_blank">00:01:55.780</a></span> | <span class="t">With both of those, we're going to take them both and we're going to create with both of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=120" target="_blank">00:02:00.260</a></span> | <span class="t">them a sparse Dennis Vector, which we then take into Pinecone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=124" target="_blank">00:02:04.380</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=125" target="_blank">00:02:05.380</a></span> | <span class="t">So that's our vector database where we're going to store everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=128" target="_blank">00:02:08.460</a></span> | <span class="t">And then what we can do is we can ask like a question, we ask a question up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=133" target="_blank">00:02:13.820</a></span> | <span class="t">That gets encoded again by Splayed, so since this is Splayed, this is our dense embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=140" target="_blank">00:02:20.660</a></span> | <span class="t">model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=141" target="_blank">00:02:21.660</a></span> | <span class="t">Put those both together to create a sparse Dennis Vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=147" target="_blank">00:02:27.340</a></span> | <span class="t">And we actually take it over here, feed it into Pinecone and get a ton of responses based</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=154" target="_blank">00:02:34.460</a></span> | <span class="t">on both the sparse and the dense information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=157" target="_blank">00:02:37.980</a></span> | <span class="t">So that is what we're going to be building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=160" target="_blank">00:02:40.540</a></span> | <span class="t">Let's actually go ahead and build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=162" target="_blank">00:02:42.380</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=163" target="_blank">00:02:43.380</a></span> | <span class="t">So we're going to start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=164" target="_blank">00:02:44.380</a></span> | <span class="t">The first thing, we're using transformers, sentence transformers here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=167" target="_blank">00:02:47.620</a></span> | <span class="t">That means we're going to be creating these embeddings on our local machine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=172" target="_blank">00:02:52.820</a></span> | <span class="t">In this case, it's actually Colab, but I'll call it local rather than the alternative,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=177" target="_blank">00:02:57.900</a></span> | <span class="t">which would be called an API like OpenAI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=180" target="_blank">00:03:00.300</a></span> | <span class="t">So what we'll do is we go to runtime.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=182" target="_blank">00:03:02.860</a></span> | <span class="t">We need to change runtime type and we need to make sure that we're using a GPU here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=187" target="_blank">00:03:07.420</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=188" target="_blank">00:03:08.420</a></span> | <span class="t">So save that, run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=190" target="_blank">00:03:10.420</a></span> | <span class="t">And these are just the libraries that we're going to be using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=192" target="_blank">00:03:12.940</a></span> | <span class="t">So HungFace datasets for our data, obviously transformers, sentence transformers for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=198" target="_blank">00:03:18.220</a></span> | <span class="t">encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=200" target="_blank">00:03:20.060</a></span> | <span class="t">This is a dense encoder, our database, and also our SPLADE model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=205" target="_blank">00:03:25.900</a></span> | <span class="t">Okay, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=207" target="_blank">00:03:27.060</a></span> | <span class="t">So we're going to first load the PubMedQA dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=211" target="_blank">00:03:31.420</a></span> | <span class="t">So this is a medical question answering dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=214" target="_blank">00:03:34.060</a></span> | <span class="t">So with medical things, you'll find that there's a lot of kind of specific terminology and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=220" target="_blank">00:03:40.700</a></span> | <span class="t">within that sort of domain that models like SPLADE or just general sparse embedding models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=227" target="_blank">00:03:47.880</a></span> | <span class="t">will perform better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=229" target="_blank">00:03:49.660</a></span> | <span class="t">However, if you are able to train your sentence transformer, your dense embedding model on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=234" target="_blank">00:03:54.420</a></span> | <span class="t">the dataset, then in that case, you can actually improve the performance to beyond that of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=241" target="_blank">00:04:01.300</a></span> | <span class="t">a sparse embedding model, usually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=243" target="_blank">00:04:03.680</a></span> | <span class="t">So let's have a look at what we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=246" target="_blank">00:04:06.900</a></span> | <span class="t">So we just have our ID here, and then we have this data, this context, and we have all these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=252" target="_blank">00:04:12.160</a></span> | <span class="t">paragraphs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=254" target="_blank">00:04:14.140</a></span> | <span class="t">And what we're going to need to do with these paragraphs is put them all together and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=257" target="_blank">00:04:17.820</a></span> | <span class="t">chunk them into the smaller chunks that will fit into our models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=263" target="_blank">00:04:23.020</a></span> | <span class="t">So I think we mentioned here, we're going to, yeah, into digestible chunks for our models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=268" target="_blank">00:04:28.980</a></span> | <span class="t">We are going to be using BERT, which has, you know, the default BERT model has this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=273" target="_blank">00:04:33.720</a></span> | <span class="t">max sequence length, 512 tokens, which is fairly big, but your typical sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=279" target="_blank">00:04:39.900</a></span> | <span class="t">actually limits this to 128, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=283" target="_blank">00:04:43.320</a></span> | <span class="t">So we're going to be pretty naive in our assumptions here, but we're going to just assume this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=288" target="_blank">00:04:48.780</a></span> | <span class="t">128 token limit, and we're actually going to assume that the average token length is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=293" target="_blank">00:04:53.260</a></span> | <span class="t">three characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=294" target="_blank">00:04:54.260</a></span> | <span class="t">In reality, it will vary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=295" target="_blank">00:04:55.820</a></span> | <span class="t">We should realistically actually create our tokens and then count the number of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=301" target="_blank">00:05:01.380</a></span> | <span class="t">in there, but it's just more complicated logic, and I want this to be as simple as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=306" target="_blank">00:05:06.220</a></span> | <span class="t">So we're just doing this for now, but if you're interested in that, let me know and I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=309" target="_blank">00:05:09.560</a></span> | <span class="t">send you a link to some code that does actually do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=312" target="_blank">00:05:12.300</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=313" target="_blank">00:05:13.300</a></span> | <span class="t">So to create these chunks, we're going to create a processing function called chunker,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=317" target="_blank">00:05:17.180</a></span> | <span class="t">which is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=318" target="_blank">00:05:18.180</a></span> | <span class="t">We're just going to feed in that list of context that we've got up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=321" target="_blank">00:05:21.660</a></span> | <span class="t">So this literally, this list here, and what it's going to do is join them and then split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=327" target="_blank">00:05:27.940</a></span> | <span class="t">based on sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=329" target="_blank">00:05:29.220</a></span> | <span class="t">So we're going to create our chunks at a sentence level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=333" target="_blank">00:05:33.300</a></span> | <span class="t">So what we do is we loop through each sentence in here, and we say, okay, if we add it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=340" target="_blank">00:05:40.060</a></span> | <span class="t">the chunk here, and once the length of that exceeds our limit, which is here, the limit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=348" target="_blank">00:05:48.060</a></span> | <span class="t">is 384 tokens, we will say, okay, we've got enough here, we're not going to go any higher,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=354" target="_blank">00:05:54.420</a></span> | <span class="t">so we then add that to the chunk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=357" target="_blank">00:05:57.580</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=358" target="_blank">00:05:58.580</a></span> | <span class="t">So here, what we're doing is, let's say we have four sentences, or no, five sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=364" target="_blank">00:06:04.620</a></span> | <span class="t">in a single chunk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=366" target="_blank">00:06:06.340</a></span> | <span class="t">What we're going to do is so that we're not cutting off between sentences that are relevant,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=372" target="_blank">00:06:12.780</a></span> | <span class="t">like have some continuum logic between them, what we're going to do is between each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=376" target="_blank">00:06:16.820</a></span> | <span class="t">our chunks, we're actually going to have some overlap.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=379" target="_blank">00:06:19.500</a></span> | <span class="t">So let's say we take chunks zero to four, and then what we're going to do for the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=384" target="_blank">00:06:24.980</a></span> | <span class="t">chunk is take chunks two to seven, or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=390" target="_blank">00:06:30.900</a></span> | <span class="t">So there's always a bit of overlap between the chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=393" target="_blank">00:06:33.340</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=394" target="_blank">00:06:34.340</a></span> | <span class="t">So once we are done, and we get to the end of our sentences, we might still have a smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=400" target="_blank">00:06:40.340</a></span> | <span class="t">chunk that's left over, so we just append that to our chunks list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=405" target="_blank">00:06:45.300</a></span> | <span class="t">So that's our chunking function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=408" target="_blank">00:06:48.180</a></span> | <span class="t">So let's run that, and we'll apply it to our first context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=412" target="_blank">00:06:52.500</a></span> | <span class="t">All right, and then we get these smaller chunks now, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=417" target="_blank">00:06:57.020</a></span> | <span class="t">And they've been split between sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=419" target="_blank">00:06:59.060</a></span> | <span class="t">We're not just splitting in the middle of a sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=421" target="_blank">00:07:01.220</a></span> | <span class="t">But one thing you will also notice is, like here, it says, "The leaf server plan consists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=426" target="_blank">00:07:06.340</a></span> | <span class="t">of a lattice work of," and we also have that here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=431" target="_blank">00:07:11.680</a></span> | <span class="t">So we always have, like, basically half the chunk is overlapped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=435" target="_blank">00:07:15.820</a></span> | <span class="t">So we have a lot of repetition in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=439" target="_blank">00:07:19.300</a></span> | <span class="t">Depending on what you're doing, you can minimize that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=441" target="_blank">00:07:21.020</a></span> | <span class="t">Just this example is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=442" target="_blank">00:07:22.740</a></span> | <span class="t">You should realistically have some overlap there, so you're not cutting between sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=450" target="_blank">00:07:30.380</a></span> | <span class="t">that have some logical continuation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=453" target="_blank">00:07:33.260</a></span> | <span class="t">We basically don't want to lose information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=456" target="_blank">00:07:36.540</a></span> | <span class="t">So that's why we have those overlaps in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=458" target="_blank">00:07:38.900</a></span> | <span class="t">This is probably a more reasonable one, so you have all this, and then the overlap starts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=463" target="_blank">00:07:43.140</a></span> | <span class="t">from around here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=465" target="_blank">00:07:45.180</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=466" target="_blank">00:07:46.180</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=467" target="_blank">00:07:47.180</a></span> | <span class="t">So what we want to do is give each chunk a unique ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=472" target="_blank">00:07:52.020</a></span> | <span class="t">So we're using the pub_id here, followed by the chunk number, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=478" target="_blank">00:07:58.740</a></span> | <span class="t">And what we do is we create the full...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=482" target="_blank">00:08:02.620</a></span> | <span class="t">So this is for the full dataset, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=484" target="_blank">00:08:04.820</a></span> | <span class="t">Let me...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=485" target="_blank">00:08:05.820</a></span> | <span class="t">Okay, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=486" target="_blank">00:08:06.820</a></span> | <span class="t">So we're going to go through the entire PubMed dataset here, we're going to get the context,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=492" target="_blank">00:08:12.660</a></span> | <span class="t">and we're going to create our chunks, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=494" target="_blank">00:08:14.700</a></span> | <span class="t">Again, we're using that PubMed ID and the chunk number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=498" target="_blank">00:08:18.940</a></span> | <span class="t">So we're in that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=499" target="_blank">00:08:19.940</a></span> | <span class="t">All right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=500" target="_blank">00:08:20.940</a></span> | <span class="t">And we get a list, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=503" target="_blank">00:08:23.560</a></span> | <span class="t">So that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=506" target="_blank">00:08:26.060</a></span> | <span class="t">Now what I want to do is move on to creating our vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=509" target="_blank">00:08:29.540</a></span> | <span class="t">All right, so the first one I'm going to do is the dense vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=513" target="_blank">00:08:33.740</a></span> | <span class="t">We're using a sentence transformer for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=515" target="_blank">00:08:35.740</a></span> | <span class="t">All right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=516" target="_blank">00:08:36.740</a></span> | <span class="t">And the first thing we want to do is make sure that we're using CUDA if it's available,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=521" target="_blank">00:08:41.500</a></span> | <span class="t">otherwise you can use CPU, it's just going to be slower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=524" target="_blank">00:08:44.220</a></span> | <span class="t">It's not going to be too slow, it's not a huge dataset that we're processing here, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=528" target="_blank">00:08:48.220</a></span> | <span class="t">you know, just be aware of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=530" target="_blank">00:08:50.220</a></span> | <span class="t">And the model that we're using is this base model that has been trained on MS Marco, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=535" target="_blank">00:08:55.940</a></span> | <span class="t">is like an information retrieval dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=539" target="_blank">00:08:59.580</a></span> | <span class="t">And specifically, so this is important, it has been trained to use dot product similarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=545" target="_blank">00:09:05.300</a></span> | <span class="t">And we need that for it to function with the sparse dense vectors that we are putting into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=551" target="_blank">00:09:11.460</a></span> | <span class="t">Panko.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=552" target="_blank">00:09:12.460</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=553" target="_blank">00:09:13.460</a></span> | <span class="t">So they're basically, they're compared in a dot product similarity space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=557" target="_blank">00:09:17.460</a></span> | <span class="t">So that is important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=559" target="_blank">00:09:19.740</a></span> | <span class="t">And we initialize it on CUDA if we can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=562" target="_blank">00:09:22.820</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=563" target="_blank">00:09:23.820</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=564" target="_blank">00:09:24.820</a></span> | <span class="t">So we see the sentence transformer details here, and we can actually see here that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=569" target="_blank">00:09:29.140</a></span> | <span class="t">max sequence length for this sentence transformer is 512 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=573" target="_blank">00:09:33.180</a></span> | <span class="t">So early on when we went for the 128 token limit, with this one, we can actually do 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=580" target="_blank">00:09:40.700</a></span> | <span class="t">So we could increase that quite a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=583" target="_blank">00:09:43.020</a></span> | <span class="t">So I think we set like 380 something for the character limit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=587" target="_blank">00:09:47.540</a></span> | <span class="t">With this, we could actually set like 1,500, which is quite a bit more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=595" target="_blank">00:09:55.100</a></span> | <span class="t">But anyway, we'll stick with what we have because with a lot of sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=599" target="_blank">00:09:59.900</a></span> | <span class="t">they are restricted to that smaller size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=603" target="_blank">00:10:03.140</a></span> | <span class="t">And then we create a embedding like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=605" target="_blank">00:10:05.340</a></span> | <span class="t">So we have our dense model, we encode, and then we pass in our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=609" target="_blank">00:10:09.860</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=610" target="_blank">00:10:10.900</a></span> | <span class="t">And we'll get a, we'll see in a moment, 768 dimensional dense vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=618" target="_blank">00:10:18.980</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=619" target="_blank">00:10:19.980</a></span> | <span class="t">You can also see that in the model, get sentence embedding dimension here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=625" target="_blank">00:10:25.100</a></span> | <span class="t">This is important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=626" target="_blank">00:10:26.100</a></span> | <span class="t">We'll need this when we're actually initializing our vector index later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=630" target="_blank">00:10:30.060</a></span> | <span class="t">So moving on to the sparse vectors, we're using the splayed co-condenser assembled distil.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=637" target="_blank">00:10:37.600</a></span> | <span class="t">So it's basically like an efficient splayed model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=641" target="_blank">00:10:41.460</a></span> | <span class="t">We do we want, I think this all looks good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=645" target="_blank">00:10:45.460</a></span> | <span class="t">So one thing, we move it to CUDA if we can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=649" target="_blank">00:10:49.180</a></span> | <span class="t">The aggregation here is max.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=651" target="_blank">00:10:51.840</a></span> | <span class="t">So it's basically how it's creating its single vectors from the many vectors I initially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=658" target="_blank">00:10:58.900</a></span> | <span class="t">create.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=659" target="_blank">00:10:59.900</a></span> | <span class="t">And I created a video on splayed so you can go and take a look at that if you're interested.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=665" target="_blank">00:11:05.100</a></span> | <span class="t">There'll be a link to that in the video at the top somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=668" target="_blank">00:11:08.140</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=669" target="_blank">00:11:09.140</a></span> | <span class="t">So it takes tokenized inputs that need to be built with a tokenizer initialized with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=674" target="_blank">00:11:14.860</a></span> | <span class="t">the same model ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=676" target="_blank">00:11:16.420</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=677" target="_blank">00:11:17.420</a></span> | <span class="t">So this model here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=678" target="_blank">00:11:18.740</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=679" target="_blank">00:11:19.740</a></span> | <span class="t">So we create our tokens like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=682" target="_blank">00:11:22.500</a></span> | <span class="t">We make sure to return PyTorch tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=686" target="_blank">00:11:26.780</a></span> | <span class="t">And then to create our sparse vectors, we do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=689" target="_blank">00:11:29.140</a></span> | <span class="t">So we're saying torch no grad, which basically means like, don't calculate the gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=693" target="_blank">00:11:33.860</a></span> | <span class="t">of the model because it takes more time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=697" target="_blank">00:11:37.380</a></span> | <span class="t">And we only need that for training the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=699" target="_blank">00:11:39.660</a></span> | <span class="t">Right now we're just performing inference or prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=702" target="_blank">00:11:42.500</a></span> | <span class="t">So it's not needed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=703" target="_blank">00:11:43.620</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=704" target="_blank">00:11:44.620</a></span> | <span class="t">And what we do is we move the tokens to CUDA if we're using it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=709" target="_blank">00:11:49.820</a></span> | <span class="t">And then we feed them into the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=711" target="_blank">00:11:51.280</a></span> | <span class="t">So the reason we move to CUDA is because if we don't, the tokens feeding into the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=717" target="_blank">00:11:57.580</a></span> | <span class="t">are on CPU and the model is on GPU, we're going to see an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=721" target="_blank">00:12:01.780</a></span> | <span class="t">So we need to make sure we include that in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=724" target="_blank">00:12:04.420</a></span> | <span class="t">And then here is the splayed vector representations output by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=730" target="_blank">00:12:10.580</a></span> | <span class="t">And we use squeeze to reduce the dimensionality of that vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=734" target="_blank">00:12:14.640</a></span> | <span class="t">So initially it's like, I think it's like 30,000 comma one, the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=740" target="_blank">00:12:20.420</a></span> | <span class="t">We don't need that one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=741" target="_blank">00:12:21.420</a></span> | <span class="t">So we just remove it like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=744" target="_blank">00:12:24.820</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=746" target="_blank">00:12:26.020</a></span> | <span class="t">So that gives us this dimensional vector, which is huge, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=750" target="_blank">00:12:30.260</a></span> | <span class="t">So 30.5 thousand items, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=754" target="_blank">00:12:34.660</a></span> | <span class="t">So that is actually the vocab size of the BERT model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=759" target="_blank">00:12:39.100</a></span> | <span class="t">So every token that BERT recognizes is represented by one of these values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=765" target="_blank">00:12:45.540</a></span> | <span class="t">And essentially we're creating a score for each one of those tokens through splayed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=771" target="_blank">00:12:51.300</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=772" target="_blank">00:12:52.300</a></span> | <span class="t">Most of them are going to be zero, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=775" target="_blank">00:12:55.420</a></span> | <span class="t">That's what makes it a sparse vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=778" target="_blank">00:12:58.060</a></span> | <span class="t">Now to create the data format that we'll be feeding into Pinecone, it's essentially going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=785" target="_blank">00:13:05.460</a></span> | <span class="t">to be like a dictionary of the position of the nonzero values to the scores that they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=795" target="_blank">00:13:15.740</a></span> | <span class="t">were assigned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=797" target="_blank">00:13:17.140</a></span> | <span class="t">So what's that look like?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=798" target="_blank">00:13:18.500</a></span> | <span class="t">Let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=800" target="_blank">00:13:20.940</a></span> | <span class="t">So here we can see we have 174 nonzero values here, should say that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=809" target="_blank">00:13:29.860</a></span> | <span class="t">And we create this, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=811" target="_blank">00:13:31.460</a></span> | <span class="t">So let me show you what that is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=813" target="_blank">00:13:33.900</a></span> | <span class="t">This is a kind of bad example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=817" target="_blank">00:13:37.500</a></span> | <span class="t">So we come up to here and we have our indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=820" target="_blank">00:13:40.940</a></span> | <span class="t">So at position number 1,000, the score of that token is this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=829" target="_blank">00:13:49.620</a></span> | <span class="t">And I think I have a little example of what that actually means here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=833" target="_blank">00:13:53.880</a></span> | <span class="t">We don't need to do this for processing things by Pinecone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=837" target="_blank">00:13:57.480</a></span> | <span class="t">We are just doing this so that we can understand what this actually means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=842" target="_blank">00:14:02.580</a></span> | <span class="t">So I'm going to create this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=843" target="_blank">00:14:03.580</a></span> | <span class="t">This is an index to token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=845" target="_blank">00:14:05.820</a></span> | <span class="t">So like I said, all of those 30.5,000 values in that vector that was output by splayed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=855" target="_blank">00:14:15.400</a></span> | <span class="t">they all refer to a particular token, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=858" target="_blank">00:14:18.580</a></span> | <span class="t">And in this, these tokens are just numbers because that's what the transform model splayed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=864" target="_blank">00:14:24.940</a></span> | <span class="t">will read, which we can't read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=867" target="_blank">00:14:27.120</a></span> | <span class="t">We don't understand that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=868" target="_blank">00:14:28.860</a></span> | <span class="t">We need actual text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=870" target="_blank">00:14:30.540</a></span> | <span class="t">So this is mapping those positions, those integer values to the actual text tokens that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=878" target="_blank">00:14:38.740</a></span> | <span class="t">they represent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=881" target="_blank">00:14:41.300</a></span> | <span class="t">And we process the dictionary that we just created up here through that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=887" target="_blank">00:14:47.440</a></span> | <span class="t">And then we get this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=889" target="_blank">00:14:49.180</a></span> | <span class="t">So let's see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=891" target="_blank">00:14:51.780</a></span> | <span class="t">So this is for, can I see what this is for?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=901" target="_blank">00:15:01.380</a></span> | <span class="t">It's for this here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=903" target="_blank">00:15:03.180</a></span> | <span class="t">Let's just have a look at what this is and then we'll see if it makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=907" target="_blank">00:15:07.940</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=910" target="_blank">00:15:10.700</a></span> | <span class="t">So program cell death is a regular death of cells of an organism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=915" target="_blank">00:15:15.880</a></span> | <span class="t">The lace plant produces so on and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=920" target="_blank">00:15:20.080</a></span> | <span class="t">Lattice work of longitudinal and transverse veins, including areoles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=926" target="_blank">00:15:26.920</a></span> | <span class="t">You know, I don't know what any of that means, but we can at least see that in this sparse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=932" target="_blank">00:15:32.160</a></span> | <span class="t">dictionary we have, so we have PC, which is, I think this is like, it's coming from here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=937" target="_blank">00:15:37.160</a></span> | <span class="t">It's not ideal, but it's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=939" target="_blank">00:15:39.680</a></span> | <span class="t">Lace, which is mentioned here, programmed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=944" target="_blank">00:15:44.540</a></span> | <span class="t">We have this up here, Madagascar, I don't know where that's coming from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=950" target="_blank">00:15:50.240</a></span> | <span class="t">Death D is the D at the end there, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=953" target="_blank">00:15:53.640</a></span> | <span class="t">So we have all of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=955" target="_blank">00:15:55.120</a></span> | <span class="t">And then I think we should also have some other words in here that are not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=960" target="_blank">00:16:00.240</a></span> | <span class="t">from this, because what SPLADE does is actually identifies the words that are in the vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=965" target="_blank">00:16:05.680</a></span> | <span class="t">already, or within this, it identifies the most important words, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=971" target="_blank">00:16:11.040</a></span> | <span class="t">So I would say it's probably got that right with, like, lace programmed, the PC, and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=976" target="_blank">00:16:16.720</a></span> | <span class="t">D here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=979" target="_blank">00:16:19.400</a></span> | <span class="t">And death, lattice, cell, all those are probably the most important words in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=984" target="_blank">00:16:24.400</a></span> | <span class="t">It's not giving us the word the, or the word within, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=988" target="_blank">00:16:28.300</a></span> | <span class="t">Because it doesn't view those as being what are important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=992" target="_blank">00:16:32.120</a></span> | <span class="t">But if we go down, we'll probably see, we'll probably see some words that are not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=998" target="_blank">00:16:38.360</a></span> | <span class="t">in here, but are similar to words in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1002" target="_blank">00:16:42.160</a></span> | <span class="t">Because part of what SPLADE does is it expands, it does term expansion, which basically means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1008" target="_blank">00:16:48.640</a></span> | <span class="t">based on the words it sees, it adds other words that it doesn't see, but that we might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1014" target="_blank">00:16:54.760</a></span> | <span class="t">expect a document that we're searching for to contain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1019" target="_blank">00:16:59.640</a></span> | <span class="t">So I think the word, okay, so the word die, I don't think is in here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1025" target="_blank">00:17:05.860</a></span> | <span class="t">But you come down here and it is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1029" target="_blank">00:17:09.000</a></span> | <span class="t">Regulated, okay, regulated is in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1033" target="_blank">00:17:13.100</a></span> | <span class="t">Lacy, it's probably not, so we have lace plant, all right, so lacy is in there, I don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1039" target="_blank">00:17:19.920</a></span> | <span class="t">if that is actually relevant, I don't understand any of what this says.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1044" target="_blank">00:17:24.780</a></span> | <span class="t">We have plant and plants, I wonder if both of those are in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1049" target="_blank">00:17:29.540</a></span> | <span class="t">So we've got plant, plant, okay, we don't have plants, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1054" target="_blank">00:17:34.580</a></span> | <span class="t">But that might be useful, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1055" target="_blank">00:17:35.840</a></span> | <span class="t">So imagine in your document that this, well, actually, this is a document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1060" target="_blank">00:17:40.980</a></span> | <span class="t">Let's say in the query, the user is searching for program cell death in plants, or how do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1067" target="_blank">00:17:47.460</a></span> | <span class="t">plants die from PCD, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1070" target="_blank">00:17:50.660</a></span> | <span class="t">They would have the term die and plants in there, but they wouldn't have the term death</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1075" target="_blank">00:17:55.740</a></span> | <span class="t">or plant, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1077" target="_blank">00:17:57.220</a></span> | <span class="t">So that's why the term expansion is really useful, because then you do have that term</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1082" target="_blank">00:18:02.220</a></span> | <span class="t">overlap, which is what traditional sparse vector methods kind of lack, so like BM25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1089" target="_blank">00:18:09.820</a></span> | <span class="t">They don't have that automatic term expansion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1092" target="_blank">00:18:12.740</a></span> | <span class="t">So we create our sparse vectors, or we have seen how to create our dense vectors and seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1098" target="_blank">00:18:18.040</a></span> | <span class="t">how to create our sparse vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1099" target="_blank">00:18:19.860</a></span> | <span class="t">Now let's have a look at how we do this for everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1103" target="_blank">00:18:23.820</a></span> | <span class="t">So we're going to create a help function called builder, which is first going to transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1109" target="_blank">00:18:29.500</a></span> | <span class="t">a list of records from our data, so the context, into this format here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1115" target="_blank">00:18:35.580</a></span> | <span class="t">So this is the format that we're going to be feeding into PyCone, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1118" target="_blank">00:18:38.940</a></span> | <span class="t">So we have our ID, we have our dense vector here, we have our sparse vector in the dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1124" target="_blank">00:18:44.840</a></span> | <span class="t">format that we saw already, and then we have this metadata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1128" target="_blank">00:18:48.300</a></span> | <span class="t">Metadata is just additional information that we can attach to our vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1132" target="_blank">00:18:52.360</a></span> | <span class="t">In this case, I'm going to include the text, like a human readable text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1138" target="_blank">00:18:58.180</a></span> | <span class="t">So what we'll do is we create builder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1142" target="_blank">00:19:02.460</a></span> | <span class="t">This is just going to go through everything, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1144" target="_blank">00:19:04.140</a></span> | <span class="t">So let me go through everything here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1147" target="_blank">00:19:07.520</a></span> | <span class="t">So we get our IDs from the records that we have there, so we have our IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1152" target="_blank">00:19:12.820</a></span> | <span class="t">So records is just everything, I believe, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1156" target="_blank">00:19:16.600</a></span> | <span class="t">So records is everything nowadays, so it's going to extract the IDs for everything, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1160" target="_blank">00:19:20.620</a></span> | <span class="t">then it's going to extract the context, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1164" target="_blank">00:19:24.200</a></span> | <span class="t">So that's why we have the pub ID followed by the chunk number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1169" target="_blank">00:19:29.580</a></span> | <span class="t">That's the ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1170" target="_blank">00:19:30.580</a></span> | <span class="t">And then we have those kind of smaller sentence, couple sentences, chunks of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1176" target="_blank">00:19:36.480</a></span> | <span class="t">And then from those chunks of text, what we're going to do is we're going to encode everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1183" target="_blank">00:19:43.580</a></span> | <span class="t">That creates our dense vectors, then we're going to create our sparse vectors, so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1187" target="_blank">00:19:47.620</a></span> | <span class="t">get our, what is this bit, so input IDs, that's creating our tokens, and then we process our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1194" target="_blank">00:19:54.120</a></span> | <span class="t">tokens through the sparse or the splayed model, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1199" target="_blank">00:19:59.380</a></span> | <span class="t">Then what we do is we initialize an empty list, which is where we're going to store</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1202" target="_blank">00:20:02.800</a></span> | <span class="t">everything to add to Pinecone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1205" target="_blank">00:20:05.500</a></span> | <span class="t">And what we do is we go through the IDs, the dense vectors, the sparse vectors, and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1209" target="_blank">00:20:09.960</a></span> | <span class="t">context that we've just created, and we create this format here, all right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1215" target="_blank">00:20:15.680</a></span> | <span class="t">So this is for every record, we have this format, the ID, values, sparse values, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1220" target="_blank">00:20:20.280</a></span> | <span class="t">metadata, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1221" target="_blank">00:20:21.280</a></span> | <span class="t">Which is what I showed you just here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1225" target="_blank">00:20:25.280</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1226" target="_blank">00:20:26.400</a></span> | <span class="t">So with that, we'll run this cell, and let's try it with the first three records first,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1234" target="_blank">00:20:34.680</a></span> | <span class="t">okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1235" target="_blank">00:20:35.680</a></span> | <span class="t">So we'll just kind of loop through, there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1239" target="_blank">00:20:39.040</a></span> | <span class="t">So we get these, there's a lot of numbers in there, but we have the metadata, we have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1243" target="_blank">00:20:43.240</a></span> | <span class="t">if I come up to here, we have the, these are the values and the indices for our splayed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1249" target="_blank">00:20:49.800</a></span> | <span class="t">vector, right, indices for the sparse values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1253" target="_blank">00:20:53.480</a></span> | <span class="t">We have our dense values, our dense vector, which is very big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1259" target="_blank">00:20:59.720</a></span> | <span class="t">And then we have the ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1261" target="_blank">00:21:01.640</a></span> | <span class="t">All right, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1262" target="_blank">00:21:02.760</a></span> | <span class="t">So now what we want to do is initialize our connection to Pinecone using free API keys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1267" target="_blank">00:21:07.520</a></span> | <span class="t">So for that, you will go here, it's actually app.pinecone.io, and you will end up on this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1275" target="_blank">00:21:15.120</a></span> | <span class="t">page.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1276" target="_blank">00:21:16.120</a></span> | <span class="t">Initially, you go to API keys, and you will have your API key here, it will probably say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1281" target="_blank">00:21:21.280</a></span> | <span class="t">default.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1282" target="_blank">00:21:22.280</a></span> | <span class="t">You click copy, say that over here, and you just put it into your API key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1287" target="_blank">00:21:27.560</a></span> | <span class="t">I've stored mine in a variable called your API key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1291" target="_blank">00:21:31.440</a></span> | <span class="t">And then for your environment, you go back over to your console, and you just copy whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1296" target="_blank">00:21:36.400</a></span> | <span class="t">is in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1297" target="_blank">00:21:37.680</a></span> | <span class="t">So for me, us-east1-gcp, yours, there's a good chance it'll be the same, but it may</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1303" target="_blank">00:21:43.640</a></span> | <span class="t">vary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1304" target="_blank">00:21:44.640</a></span> | <span class="t">All right, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1305" target="_blank">00:21:45.640</a></span> | <span class="t">So we run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1308" target="_blank">00:21:48.040</a></span> | <span class="t">So that just initializes our connection with Pinecone, and then what we want to do is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1311" target="_blank">00:21:51.920</a></span> | <span class="t">create a index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1314" target="_blank">00:21:54.340</a></span> | <span class="t">So we run this, there's a few things that are important here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1317" target="_blank">00:21:57.640</a></span> | <span class="t">So the index name is not so important, you can kind of use whatever you want there, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1322" target="_blank">00:22:02.160</a></span> | <span class="t">you do need to pass an index name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1324" target="_blank">00:22:04.160</a></span> | <span class="t">Dimensionality, so that is the 768 dimensions of the dense vector embedding model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1331" target="_blank">00:22:11.000</a></span> | <span class="t">Not the displayed model, the dense model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1333" target="_blank">00:22:13.520</a></span> | <span class="t">We have to use the dot product metric to use the sparse dense vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1338" target="_blank">00:22:18.800</a></span> | <span class="t">And for the pod type, we must use either S1 or P1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1343" target="_blank">00:22:23.760</a></span> | <span class="t">So that will just create the index, and we can actually go to the console, we go to indexes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1350" target="_blank">00:22:30.200</a></span> | <span class="t">and we should see it if we refresh.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1353" target="_blank">00:22:33.520</a></span> | <span class="t">All right, so we have this PubMed displayed, one in there now, go to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1362" target="_blank">00:22:42.040</a></span> | <span class="t">And what we then need to do is initialize the connection to our index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1367" target="_blank">00:22:47.360</a></span> | <span class="t">For this, we can use either index or we can use gRPC index, which is just essentially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1374" target="_blank">00:22:54.300</a></span> | <span class="t">faster and also a little bit more reliable in terms of your connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1379" target="_blank">00:22:59.760</a></span> | <span class="t">It holds a stable connection to Pinecone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1382" target="_blank">00:23:02.120</a></span> | <span class="t">The index one is still very stable and still very fast, but just not as good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1387" target="_blank">00:23:07.560</a></span> | <span class="t">So we run those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1388" target="_blank">00:23:08.560</a></span> | <span class="t">Okay, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1389" target="_blank">00:23:09.560</a></span> | <span class="t">That will just give us some index statistics, of course, our index is completely empty right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1394" target="_blank">00:23:14.400</a></span> | <span class="t">now, and the dimensionality is what we set before, the 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1400" target="_blank">00:23:20.480</a></span> | <span class="t">Now to add some vectors, we just do this, so index upsert, and we pass in what we created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1405" target="_blank">00:23:25.880</a></span> | <span class="t">with Builder, because Builder is outputting the format that we need to add things to Pinecone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1411" target="_blank">00:23:31.440</a></span> | <span class="t">Okay, so we can see that we upsert three items if we do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1417" target="_blank">00:23:37.040</a></span> | <span class="t">Upsert just means like insert, like three items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1419" target="_blank">00:23:39.840</a></span> | <span class="t">All right, so cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1422" target="_blank">00:23:42.000</a></span> | <span class="t">We can repeat that for the full index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1425" target="_blank">00:23:45.520</a></span> | <span class="t">So you can also increase the batch size depending on what hardware you're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1430" target="_blank">00:23:50.720</a></span> | <span class="t">We'll stick with 64, which is pretty low, just to be safe depending on what you're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1436" target="_blank">00:23:56.900</a></span> | <span class="t">And with this, it's not going to take long, so we've got like a minute 20 here, so I'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1442" target="_blank">00:24:02.360</a></span> | <span class="t">skip ahead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1443" target="_blank">00:24:03.360</a></span> | <span class="t">Okay, so that is complete, it took one and a half minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1447" target="_blank">00:24:07.440</a></span> | <span class="t">And then what we want to do is we're just going to check that the number of upserted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1451" target="_blank">00:24:11.440</a></span> | <span class="t">records aligns with the length of our original data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1454" target="_blank">00:24:14.820</a></span> | <span class="t">Okay, so here is our original data, and here's a number of items that are inside our index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1462" target="_blank">00:24:22.200</a></span> | <span class="t">now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1463" target="_blank">00:24:23.200</a></span> | <span class="t">So it looks like everything is in there, and we can move on to querying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1468" target="_blank">00:24:28.180</a></span> | <span class="t">So our queries will need to contain both sparse and dense vectors, so we're going to use this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1474" target="_blank">00:24:34.760</a></span> | <span class="t">function here called encode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1477" target="_blank">00:24:37.160</a></span> | <span class="t">And what that will allow us to do is, it's just going to handle everything for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1482" target="_blank">00:24:42.380</a></span> | <span class="t">So we create our dense vectors, we then create our sparse dictionary and we just return those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1489" target="_blank">00:24:49.440</a></span> | <span class="t">So we're going to start with, can clinicians use the PHQ-9 to assess depression in people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1495" target="_blank">00:24:55.460</a></span> | <span class="t">with vision loss?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1497" target="_blank">00:24:57.600</a></span> | <span class="t">So we run this, and we say, straight away, I think to investigate, we have a PHQ-9, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1508" target="_blank">00:25:08.560</a></span> | <span class="t">essential psychometric characteristics to measure depressive symptoms in people with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1513" target="_blank">00:25:13.240</a></span> | <span class="t">visual impairment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1514" target="_blank">00:25:14.500</a></span> | <span class="t">So I would say that is probably correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1518" target="_blank">00:25:18.320</a></span> | <span class="t">So you see that we have depressive symptoms, depression, vision loss, and visual impairment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1525" target="_blank">00:25:25.760</a></span> | <span class="t">So it's not, the words don't align perfectly, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1529" target="_blank">00:25:29.900</a></span> | <span class="t">But they have the same meaning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1533" target="_blank">00:25:33.080</a></span> | <span class="t">So my question here would be, what is doing this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1536" target="_blank">00:25:36.540</a></span> | <span class="t">Is it the dense component, or is it the sparse component?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1540" target="_blank">00:25:40.580</a></span> | <span class="t">And actually, we'll see that it's kind of both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1543" target="_blank">00:25:43.760</a></span> | <span class="t">But what I want to show you is that we can actually scale the dense versus sparse components.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1551" target="_blank">00:25:51.720</a></span> | <span class="t">So the way that we do this is that we use this hybrid scale function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1556" target="_blank">00:25:56.160</a></span> | <span class="t">And what it's going to do is it's going to take an alpha value, where the alpha, when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1560" target="_blank">00:26:00.600</a></span> | <span class="t">it is equal to 1, it will maximize the dense vector, but it will basically make the sparse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1567" target="_blank">00:26:07.860</a></span> | <span class="t">vector completely irrelevant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1570" target="_blank">00:26:10.780</a></span> | <span class="t">If we use an alpha value of 0, it means the sparse vector is the only thing being used,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1576" target="_blank">00:26:16.940</a></span> | <span class="t">and the dense vector is completely irrelevant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1579" target="_blank">00:26:19.220</a></span> | <span class="t">And if we just want an equal blend between the two of them, we use 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1583" target="_blank">00:26:23.980</a></span> | <span class="t">So let's first try a pure dense search and see what happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1590" target="_blank">00:26:30.040</a></span> | <span class="t">I need to run this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1594" target="_blank">00:26:34.400</a></span> | <span class="t">And you see that we actually get the right answer up here straight away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1597" target="_blank">00:26:37.580</a></span> | <span class="t">The score is different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1599" target="_blank">00:26:39.060</a></span> | <span class="t">This is 181, whereas up here it is 203.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1603" target="_blank">00:26:43.220</a></span> | <span class="t">It's not that much different, but it's different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1606" target="_blank">00:26:46.940</a></span> | <span class="t">So does that mean it's only the dense vector doing this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1610" target="_blank">00:26:50.780</a></span> | <span class="t">Let's try an alpha value of 0.0, and we actually get the same answer at the top again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1617" target="_blank">00:26:57.340</a></span> | <span class="t">So I think there is some variation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1619" target="_blank">00:26:59.060</a></span> | <span class="t">I think that maybe this changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1621" target="_blank">00:27:01.340</a></span> | <span class="t">Yeah, so with the dense embedding, I'm not sure if the performance on that is better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1628" target="_blank">00:27:08.020</a></span> | <span class="t">or not, but we do get slightly different results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1631" target="_blank">00:27:11.580</a></span> | <span class="t">So when we have a mix of both, we actually get the star result there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1635" target="_blank">00:27:15.400</a></span> | <span class="t">So let's try some other questions that maybe will help us get slightly different responses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1643" target="_blank">00:27:23.400</a></span> | <span class="t">What is going on here is that both models are actually very good for this data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1648" target="_blank">00:27:28.460</a></span> | <span class="t">So we don't see that much difference when we try and vary them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1652" target="_blank">00:27:32.320</a></span> | <span class="t">So does ibuprofen increase perioperative blood loss during hip arthroplasty?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1662" target="_blank">00:27:42.140</a></span> | <span class="t">This is a sparse search, and when we run it, we get to the term where the prior exposure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1667" target="_blank">00:27:47.900</a></span> | <span class="t">of non-okay, this is ibuprofen from what I understand, anti-inflammatory drugs, increases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1676" target="_blank">00:27:56.540</a></span> | <span class="t">this thing here, perioperative blood loss, associated with major orthopaedic surgery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1685" target="_blank">00:28:05.420</a></span> | <span class="t">So I checked what this means, and this basically means a hip replacement, or sorry, no, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1691" target="_blank">00:28:11.620</a></span> | <span class="t">means hip replacement, and the words, I think both of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1698" target="_blank">00:28:18.340</a></span> | <span class="t">So this is like major surgery, and this is a hip replacement, which is major surgery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1703" target="_blank">00:28:23.540</a></span> | <span class="t">That's what I understood, it could be completely wrong, but I'm not sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1707" target="_blank">00:28:27.980</a></span> | <span class="t">This one, and then they mentioned hip replacement here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1710" target="_blank">00:28:30.820</a></span> | <span class="t">So I think this one is relevant, and this is using the pure sparse method, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1717" target="_blank">00:28:37.400</a></span> | <span class="t">And then we get this, and this actually does talk about ibuprofen and this sort of stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1723" target="_blank">00:28:43.380</a></span> | <span class="t">but I don't know if that is, it doesn't mention the arthroplasty thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1729" target="_blank">00:28:49.740</a></span> | <span class="t">So I just assume it's not as relevant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1733" target="_blank">00:28:53.840</a></span> | <span class="t">If we'd go pure dense, okay, we actually get the best answer at position number two, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1740" target="_blank">00:29:00.340</a></span> | <span class="t">is still good, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1742" target="_blank">00:29:02.540</a></span> | <span class="t">It's not that it's not performing well, that is a good performance, but it's not quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1747" target="_blank">00:29:07.540</a></span> | <span class="t">as good as when we have the pure sparse, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1751" target="_blank">00:29:11.380</a></span> | <span class="t">So what we'll find, and I put a ton of example questions in here from this PubMed QA paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1759" target="_blank">00:29:19.240</a></span> | <span class="t">So you can try a few of these, but what we find is that some of them perform better with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1764" target="_blank">00:29:24.520</a></span> | <span class="t">sparse, some of them perform better with dense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1767" target="_blank">00:29:27.460</a></span> | <span class="t">So what is a good approach to use here is to use a mix of both using the hybrid search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1772" target="_blank">00:29:32.620</a></span> | <span class="t">So we set like alpha to 0.3, 0.5, whatever seems to work best overall, depending on your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1781" target="_blank">00:29:41.140</a></span> | <span class="t">particular use case, and overall we're going to get generally better performance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1786" target="_blank">00:29:46.960</a></span> | <span class="t">Now, once you're done with all of this, if you've asked a couple more questions and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1790" target="_blank">00:29:50.700</a></span> | <span class="t">on, what you need to do is just delete your index at the end, save resources so that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1796" target="_blank">00:29:56.080</a></span> | <span class="t">not using more than what is needed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1798" target="_blank">00:29:58.820</a></span> | <span class="t">So that's it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1801" target="_blank">00:30:01.380</a></span> | <span class="t">We've just kind of quickly been through an example of actually using hybrid search in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1807" target="_blank">00:30:07.300</a></span> | <span class="t">Pinecone with Splayed and a dense vector sentence transform model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1813" target="_blank">00:30:13.260</a></span> | <span class="t">And I think the results are pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1814" target="_blank">00:30:14.580</a></span> | <span class="t">Now this is just one example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1816" target="_blank">00:30:16.500</a></span> | <span class="t">What we'll find is that the performance of hybrid search versus just pure dense or pure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1823" target="_blank">00:30:23.280</a></span> | <span class="t">sparse search generally is a lot better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1827" target="_blank">00:30:27.440</a></span> | <span class="t">So if you're able to implement this in your search applications, it's 100% worth doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1835" target="_blank">00:30:35.000</a></span> | <span class="t">But anyway, for now, we'll leave it there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1837" target="_blank">00:30:37.440</a></span> | <span class="t">So I hope this video has been interesting and useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1842" target="_blank">00:30:42.600</a></span> | <span class="t">So thank you very much for watching, and I will see you again in the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1846" target="_blank">00:30:46.880</a></span> | <span class="t">Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1846" target="_blank">00:30:46.880</a></span> | <span class="t">[MUSIC PLAYING]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1850" target="_blank">00:30:50.240</a></span> | <span class="t">[END PLAYBACK]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1853" target="_blank">00:30:53.760</a></span> | <span class="t">[MUSIC PLAYING]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1857" target="_blank">00:30:57.120</a></span> | <span class="t">[END PLAYBACK]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a3-RM_u5YoU&t=1860" target="_blank">00:31:00.480</a></span> | <span class="t">[MUSIC]</span></div></div></body></html>