<html><head><title>Lesson 7: Practical Deep Learning for Coders 2022</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 7: Practical Deep Learning for Coders 2022</h2><a href="https://www.youtube.com/watch?v=p4ZZq0736Po"><img src="https://i.ytimg.com/vi_webp/p4ZZq0736Po/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=0">0:0</a> Tweaking first and last layers<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=167">2:47</a> What are the benefits of using larger models<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=358">5:58</a> Understanding GPU memory usage<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=484">8:4</a> What is GradientAccumulation?<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1252">20:52</a> How to run all the models with specifications<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1375">22:55</a> Ensembling<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2271">37:51</a> Multi-target models<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2484">41:24</a> What does `F.cross_entropy` do<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2743">45:43</a> When do you use softmax and when not to?<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2775">46:15</a> Cross_entropy loss<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2993">49:53</a> How to calculate binary-cross-entropy<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3139">52:19</a> Two versions of cross-entropy in pytorch<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3264">54:24</a> How to create a learner for prediction two targets<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3720">62:0</a> Collaborative filtering deep dive<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4135">68:55</a> What are latent factors?<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4288">71:28</a> Dot product model<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4717">78:37</a> What is embedding<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4938">82:18</a> How do you choose the number of latent factors<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5233">87:13</a> How to build a collaborative filtering model from scratch<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5397">89:57</a> How to understand the `forward` function<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5567">92:47</a> Adding a bias term<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5669">94:29</a> Model interpretation<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5946">99:6</a> What is weight decay and How does it help<br><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6227">103:47</a> What is regularization<br><br><div style="text-align: left;"><a href="./p4ZZq0736Po.html">Whisper Transcript</a> | <a href="./transcript_p4ZZq0736Po.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">All right, welcome to lesson seven, the penultimate lesson of practical deep learning for coders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=8" target="_blank">00:00:08.760</a></span> | <span class="t">part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=12" target="_blank">00:00:12.920</a></span> | <span class="t">And today we're going to be digging into what's inside a neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=19" target="_blank">00:00:19.160</a></span> | <span class="t">We've already seen what's inside a kind of the most basic possible neural net, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=24" target="_blank">00:00:24.720</a></span> | <span class="t">is a sandwich of fully connected layers, or linear layers, and rellues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=36" target="_blank">00:00:36.520</a></span> | <span class="t">And so we built that from scratch, but there's a lot of tweaks that we can do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=43" target="_blank">00:00:43.580</a></span> | <span class="t">And so most of the tweaks actually that we probably care about are the tweaking the very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=48" target="_blank">00:00:48.820</a></span> | <span class="t">first layer or the very last layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=55" target="_blank">00:00:55.980</a></span> | <span class="t">So that's where we'll focus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=58" target="_blank">00:00:58.180</a></span> | <span class="t">But over the next couple of weeks, we'll look at some of the tricks we can do inside as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=62" target="_blank">00:01:02.880</a></span> | <span class="t">well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=65" target="_blank">00:01:05.720</a></span> | <span class="t">So I'm going to do this through the lens of the patty, rice patty competition we've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=74" target="_blank">00:01:14.240</a></span> | <span class="t">talking about, and we got to a point where-- let's have a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=90" target="_blank">00:01:30.920</a></span> | <span class="t">So we created a conf next model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=95" target="_blank">00:01:35.000</a></span> | <span class="t">We tried a few different types of basic preprocessing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=101" target="_blank">00:01:41.100</a></span> | <span class="t">We added test time augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=106" target="_blank">00:01:46.040</a></span> | <span class="t">And then we scaled that up to larger images and rectangular images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=116" target="_blank">00:01:56.440</a></span> | <span class="t">And that got us into the top 25% of the competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=124" target="_blank">00:02:04.180</a></span> | <span class="t">So that's part two of the so-called road to the top series, which is increasingly misnamed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=132" target="_blank">00:02:12.620</a></span> | <span class="t">since we've been presenting these notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=137" target="_blank">00:02:17.620</a></span> | <span class="t">More and more of our students have been passing me on the leaderboard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=142" target="_blank">00:02:22.520</a></span> | <span class="t">So currently first and second place for both people from this class, Kurian and Nick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=155" target="_blank">00:02:35.200</a></span> | <span class="t">Go to hell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=156" target="_blank">00:02:36.200</a></span> | <span class="t">You're in my target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=159" target="_blank">00:02:39.520</a></span> | <span class="t">And leave my class immediately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=163" target="_blank">00:02:43.860</a></span> | <span class="t">And congratulations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=164" target="_blank">00:02:44.920</a></span> | <span class="t">Good luck to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=167" target="_blank">00:02:47.280</a></span> | <span class="t">So in part three, I'm going to show you a really interesting trick, a very simple trick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=176" target="_blank">00:02:56.200</a></span> | <span class="t">for scaling up these models further.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=179" target="_blank">00:02:59.800</a></span> | <span class="t">Watch or discover if you've tried to use larger models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=182" target="_blank">00:03:02.700</a></span> | <span class="t">So you can replace the word small with the word large in those architectures and try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=187" target="_blank">00:03:07.760</a></span> | <span class="t">to train a larger model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=188" target="_blank">00:03:08.920</a></span> | <span class="t">A larger model has more parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=191" target="_blank">00:03:11.320</a></span> | <span class="t">More parameters means it can find more tricky little features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=196" target="_blank">00:03:16.240</a></span> | <span class="t">And broadly speaking models with more parameters therefore ought to be more accurate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=201" target="_blank">00:03:21.340</a></span> | <span class="t">Problem is that those activations or more specifically the gradients that have to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=209" target="_blank">00:03:29.080</a></span> | <span class="t">calculated choose up memory on your GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=214" target="_blank">00:03:34.000</a></span> | <span class="t">And your GPU is not as clever as your CPU, that kind of sticking stuff it doesn't need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=220" target="_blank">00:03:40.000</a></span> | <span class="t">right now into virtual memory on the hard drive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=222" target="_blank">00:03:42.600</a></span> | <span class="t">When it runs out of memory, it runs out of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=225" target="_blank">00:03:45.760</a></span> | <span class="t">And it also doesn't do such a good job as your CPU, it kind of shuffling things around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=229" target="_blank">00:03:49.580</a></span> | <span class="t">to try and find memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=230" target="_blank">00:03:50.580</a></span> | <span class="t">It just allocates blocks of memory and it stays allocated until you remove them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=236" target="_blank">00:03:56.660</a></span> | <span class="t">So if you try to scale up your models to bigger models unless you have very expensive GPUs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=244" target="_blank">00:04:04.020</a></span> | <span class="t">you will run out of space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=247" target="_blank">00:04:07.840</a></span> | <span class="t">And you'll get an error, something like CUDA out of memory error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=252" target="_blank">00:04:12.120</a></span> | <span class="t">So if that happens, first thing I'll mention is it's not a bad idea to restart your notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=258" target="_blank">00:04:18.080</a></span> | <span class="t">because they can be a bit tricky to recover from otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=262" target="_blank">00:04:22.320</a></span> | <span class="t">And then I'll show you how you can use as large a model as you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=267" target="_blank">00:04:27.640</a></span> | <span class="t">Almost is, you know, basically you'll be able to use an X large model on Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=277" target="_blank">00:04:37.200</a></span> | <span class="t">So let me explain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=280" target="_blank">00:04:40.920</a></span> | <span class="t">Now when you run something on Kaggle, like actually on Kaggle, you're generally going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=288" target="_blank">00:04:48.040</a></span> | <span class="t">to be on a 16 gig GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=291" target="_blank">00:04:51.840</a></span> | <span class="t">And you don't have to run stuff on Kaggle, you can run stuff on your home computer or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=295" target="_blank">00:04:55.200</a></span> | <span class="t">paper space or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=298" target="_blank">00:04:58.080</a></span> | <span class="t">But sometimes if you want to do Kaggle competition, sometimes you have to run stuff on Kaggle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=302" target="_blank">00:05:02.600</a></span> | <span class="t">because a lot of competitions are what they call code competitions, which is where the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=306" target="_blank">00:05:06.560</a></span> | <span class="t">only way to submit is from a notebook that you're running on Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=310" target="_blank">00:05:10.920</a></span> | <span class="t">And then a second reason to run stuff on Kaggle is that, you know, your notebooks will appear,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=320" target="_blank">00:05:20.560</a></span> | <span class="t">you know, with the leaderboard score on them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=322" target="_blank">00:05:22.600</a></span> | <span class="t">And so people can see which notebooks are actually good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=326" target="_blank">00:05:26.920</a></span> | <span class="t">And I kind of like, even in things that aren't code competitions, I love trying to be the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=330" target="_blank">00:05:30.800</a></span> | <span class="t">person who's number one on the notebook score leaderboard, because that's something which,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=336" target="_blank">00:05:36.960</a></span> | <span class="t">you know, you can't just work at Nvidia and use 1000 GPUs and win a competition through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=343" target="_blank">00:05:43.560</a></span> | <span class="t">a combination of skill and brute force.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=346" target="_blank">00:05:46.760</a></span> | <span class="t">Everybody has the same nine hour timeout to work with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=351" target="_blank">00:05:51.680</a></span> | <span class="t">So I think it's a good way of keeping the, you know, things a bit more fair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=358" target="_blank">00:05:58.240</a></span> | <span class="t">Now so my home GPU has 24 gig.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=362" target="_blank">00:06:02.720</a></span> | <span class="t">So I wanted to find out what can I get away with, you know, in 16 gig.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=367" target="_blank">00:06:07.800</a></span> | <span class="t">And the way I did that is I think a useful thing to discuss because again, it's all about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=372" target="_blank">00:06:12.840</a></span> | <span class="t">fast iteration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=374" target="_blank">00:06:14.800</a></span> | <span class="t">So I wanted to really quickly find out how much memory will a model use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=382" target="_blank">00:06:22.440</a></span> | <span class="t">So there's a really quick hacky way I can do that, which is to say, okay, for the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=386" target="_blank">00:06:26.480</a></span> | <span class="t">set, let's not use, so here's the value counts of labels, so the number of each disease.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=392" target="_blank">00:06:32.400</a></span> | <span class="t">Let's not look at all the diseases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=394" target="_blank">00:06:34.720</a></span> | <span class="t">Let's just pick one, the smallest one, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=397" target="_blank">00:06:37.960</a></span> | <span class="t">And let's make that our training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=399" target="_blank">00:06:39.360</a></span> | <span class="t">Our training set is the bacterial panicle blight images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=403" target="_blank">00:06:43.640</a></span> | <span class="t">And now I can train a model with just 337 images without changing anything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=409" target="_blank">00:06:49.200</a></span> | <span class="t">Not that I care about that model, but then I can see how much memory it used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=414" target="_blank">00:06:54.920</a></span> | <span class="t">It's important to realize that, you know, each image you pass through is the same size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=418" target="_blank">00:06:58.840</a></span> | <span class="t">each batch size is the same size, so training for longer won't use more memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=423" target="_blank">00:07:03.640</a></span> | <span class="t">So that'll tell us how much memory we're going to need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=429" target="_blank">00:07:09.680</a></span> | <span class="t">So what I then did was I then tried training different models to see how much memory they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=440" target="_blank">00:07:20.120</a></span> | <span class="t">used up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=441" target="_blank">00:07:21.120</a></span> | <span class="t">Now, what happens if we train a model, so obviously ConvNec Small doesn't use too much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=445" target="_blank">00:07:25.440</a></span> | <span class="t">memory, so here's something that reports the amount of GPU memory just by basically printing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=451" target="_blank">00:07:31.240</a></span> | <span class="t">out CUDA's GPU processes, and you can see ConvNec Small took up 4 gig.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=461" target="_blank">00:07:41.440</a></span> | <span class="t">And also this might be interesting to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=463" target="_blank">00:07:43.400</a></span> | <span class="t">If you then call Python's garbage collection, gc.collect, and then call PyTorch's empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=470" target="_blank">00:07:50.920</a></span> | <span class="t">cache, that should basically get your GPU back to a clean state of not using any more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=477" target="_blank">00:07:57.480</a></span> | <span class="t">memory than it needs to when you can start training the next model without restarting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=482" target="_blank">00:08:02.220</a></span> | <span class="t">the kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=484" target="_blank">00:08:04.920</a></span> | <span class="t">So what would happen if we tried to train this little model and it crashed with a CUDA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=489" target="_blank">00:08:09.600</a></span> | <span class="t">out of memory error?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=490" target="_blank">00:08:10.600</a></span> | <span class="t">What do we do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=493" target="_blank">00:08:13.200</a></span> | <span class="t">We can use a cool little trick called gradient accumulation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=499" target="_blank">00:08:19.000</a></span> | <span class="t">What's gradient accumulation?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=501" target="_blank">00:08:21.580</a></span> | <span class="t">So what's gradient accumulation?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=504" target="_blank">00:08:24.080</a></span> | <span class="t">Well I added this parameter to my train method here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=508" target="_blank">00:08:28.040</a></span> | <span class="t">So my train method creates by data loaders, creates my learner, and then depending on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=516" target="_blank">00:08:36.360</a></span> | <span class="t">whether I'm fine-tuning or not either fits or fine-tunes it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=524" target="_blank">00:08:44.440</a></span> | <span class="t">But there's one other thing it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=525" target="_blank">00:08:45.440</a></span> | <span class="t">It does this gradient accumulation thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=527" target="_blank">00:08:47.240</a></span> | <span class="t">What's that about?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=528" target="_blank">00:08:48.240</a></span> | <span class="t">Well the key step is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=530" target="_blank">00:08:50.560</a></span> | <span class="t">I set my batch size, so that's the number of images that I pass through to the GPU all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=535" target="_blank">00:08:55.960</a></span> | <span class="t">at once, to 64, which is my default, divided by -- // means integer divide in Python -- divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=544" target="_blank">00:09:04.520</a></span> | <span class="t">by this number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=546" target="_blank">00:09:06.860</a></span> | <span class="t">So if I pass 2, it's going to use a batch size of 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=550" target="_blank">00:09:10.680</a></span> | <span class="t">If I pass 4, it'll use a batch size of 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=555" target="_blank">00:09:15.560</a></span> | <span class="t">Now that obviously should let me cure any memory problems, use a smaller batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=562" target="_blank">00:09:22.460</a></span> | <span class="t">But the problem is that now the dynamics of my training are different, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=567" target="_blank">00:09:27.240</a></span> | <span class="t">The smaller your batch size, the more volatility there is from batch to batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=571" target="_blank">00:09:31.240</a></span> | <span class="t">So now your learning rates are all messed up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=573" target="_blank">00:09:33.480</a></span> | <span class="t">You don't want to be messing around with trying to find a different set of optimal parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=578" target="_blank">00:09:38.760</a></span> | <span class="t">for every batch size, for every architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=584" target="_blank">00:09:44.200</a></span> | <span class="t">So what we want to do is find a way to run just let's say accumulate equals 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=591" target="_blank">00:09:51.400</a></span> | <span class="t">Let's say we just want to run 32 images at a time through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=595" target="_blank">00:09:55.740</a></span> | <span class="t">How do we make it behave as if it was 64 images?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=600" target="_blank">00:10:00.520</a></span> | <span class="t">Well the solution to that problem is to consider our training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=605" target="_blank">00:10:05.320</a></span> | <span class="t">This is basically the training loop we used from a couple of lessons ago, the one we created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=609" target="_blank">00:10:09.880</a></span> | <span class="t">manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=610" target="_blank">00:10:10.880</a></span> | <span class="t">So each x, y pair in the data loader, we calculate the loss using some coefficients based on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=618" target="_blank">00:10:18.240</a></span> | <span class="t">that x, y pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=620" target="_blank">00:10:20.280</a></span> | <span class="t">And then we call backward on that loss to calculate the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=625" target="_blank">00:10:25.120</a></span> | <span class="t">And then we subtract from the coefficients the gradients times the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=630" target="_blank">00:10:30.640</a></span> | <span class="t">And then we zero out the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=631" target="_blank">00:10:31.920</a></span> | <span class="t">So I've skipped a bit of stuff like the with torch.nograd thing, actually no I don't need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=638" target="_blank">00:10:38.320</a></span> | <span class="t">that because I've got .data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=639" target="_blank">00:10:39.320</a></span> | <span class="t">No that's it, that should all work fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=641" target="_blank">00:10:41.400</a></span> | <span class="t">I've skipped out printing the loss that's about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=646" target="_blank">00:10:46.640</a></span> | <span class="t">So here is a variation of that loop where I do not always subtract the gradient times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=656" target="_blank">00:10:56.960</a></span> | <span class="t">the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=659" target="_blank">00:10:59.320</a></span> | <span class="t">Instead I go through each x, y pair in the data loader, I calculate the loss, I look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=667" target="_blank">00:11:07.400</a></span> | <span class="t">at how many images are in this batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=671" target="_blank">00:11:11.120</a></span> | <span class="t">So initially I start at zero and this count is going to be 32, say if I've divided the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=675" target="_blank">00:11:15.600</a></span> | <span class="t">batch size by two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=677" target="_blank">00:11:17.720</a></span> | <span class="t">And then if count is greater than 64, I do my coefficients update, well it's not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=686" target="_blank">00:11:26.800</a></span> | <span class="t">So I skip back to here and I do this again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=692" target="_blank">00:11:32.560</a></span> | <span class="t">And if you remember there was this interesting subtlety in PyTorch which is if you call back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=697" target="_blank">00:11:37.280</a></span> | <span class="t">word again without zeroing out the gradients then it adds this set of gradients to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=706" target="_blank">00:11:46.680</a></span> | <span class="t">old gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=709" target="_blank">00:11:49.360</a></span> | <span class="t">So by doing these two half size batches without zeroing out the gradients between them it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=715" target="_blank">00:11:55.760</a></span> | <span class="t">adding them up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=716" target="_blank">00:11:56.940</a></span> | <span class="t">So I'm going to end up with the total gradient of a 64 image batch size but passing only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=724" target="_blank">00:12:04.560</a></span> | <span class="t">32 at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=727" target="_blank">00:12:07.920</a></span> | <span class="t">If I used accumulate equals four it would go through this four times adding them up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=733" target="_blank">00:12:13.400</a></span> | <span class="t">before it subtracted out the coefficients.grad times learning rate and zeroed it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=741" target="_blank">00:12:21.180</a></span> | <span class="t">If I put in a Q equals 64 it would go through into a single image one at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=748" target="_blank">00:12:28.360</a></span> | <span class="t">And after 64 passes through eventually count would be greater than 64 and we would do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=754" target="_blank">00:12:34.280</a></span> | <span class="t">update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=755" target="_blank">00:12:35.280</a></span> | <span class="t">So that's gradient accumulation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=757" target="_blank">00:12:37.600</a></span> | <span class="t">It's a very simple idea which is that you don't have to actually update your weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=767" target="_blank">00:12:47.040</a></span> | <span class="t">every loop through for every mini-batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=771" target="_blank">00:12:51.280</a></span> | <span class="t">You can just do it from time to time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=775" target="_blank">00:12:55.200</a></span> | <span class="t">But it has quite significant implications which I find most people seem not to realize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=782" target="_blank">00:13:02.360</a></span> | <span class="t">which is if you look on like Twitter or Reddit or whatever people can say oh I need to buy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=788" target="_blank">00:13:08.140</a></span> | <span class="t">a bigger GPU to train bigger models but they don't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=793" target="_blank">00:13:13.240</a></span> | <span class="t">They could just use gradient accumulation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=796" target="_blank">00:13:16.040</a></span> | <span class="t">And so given the huge price differential between say a RTX 3080 and an RTX 3090 Ti huge price</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=807" target="_blank">00:13:27.120</a></span> | <span class="t">differential the performance is not that different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=810" target="_blank">00:13:30.880</a></span> | <span class="t">The big difference is the memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=813" target="_blank">00:13:33.840</a></span> | <span class="t">So what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=815" target="_blank">00:13:35.040</a></span> | <span class="t">Just put in a bit smaller batch size and do gradient accumulation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=817" target="_blank">00:13:37.960</a></span> | <span class="t">So there's actually not that much reason to buy giant GPUs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=823" target="_blank">00:13:43.480</a></span> | <span class="t">John.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=827" target="_blank">00:13:47.160</a></span> | <span class="t">Other results with gradient accumulation numerically identical?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=830" target="_blank">00:13:50.760</a></span> | <span class="t">They're numerically identical for this particular architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=839" target="_blank">00:13:59.200</a></span> | <span class="t">There is something called batch normalization which we will look at in part two of the course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=846" target="_blank">00:14:06.840</a></span> | <span class="t">which keeps track of the moving average of standard deviations and averages and does it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=860" target="_blank">00:14:20.040</a></span> | <span class="t">in a mathematically slightly incorrect way as a result of which if you've got batch normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=865" target="_blank">00:14:25.640</a></span> | <span class="t">then it basically will introduce more volatility which is not necessarily a bad thing but because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=871" target="_blank">00:14:31.120</a></span> | <span class="t">it's not mathematically identical you won't necessarily get the same results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=875" target="_blank">00:14:35.240</a></span> | <span class="t">One next doesn't use batch normalization so it is the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=880" target="_blank">00:14:40.640</a></span> | <span class="t">And in fact a lot of the models people want to use really big versions of which is NLP</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=886" target="_blank">00:14:46.000</a></span> | <span class="t">ones transformers tend not to use batch normalization but instead they use something called layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=891" target="_blank">00:14:51.720</a></span> | <span class="t">normalization which doesn't have the same issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=897" target="_blank">00:14:57.400</a></span> | <span class="t">I think that's probably fair to say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=898" target="_blank">00:14:58.520</a></span> | <span class="t">I haven't thought about it that deeply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=901" target="_blank">00:15:01.360</a></span> | <span class="t">In practice I found adding gradient accumulation for ConfNEXT has not caused any issues for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=909" target="_blank">00:15:09.400</a></span> | <span class="t">me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=910" target="_blank">00:15:10.400</a></span> | <span class="t">I don't have to change any parameters when I do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=914" target="_blank">00:15:14.560</a></span> | <span class="t">Any other questions on the forum, John?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=918" target="_blank">00:15:18.600</a></span> | <span class="t">Tamori asking shouldn't it be count greater than equal to 64 if BS equals 64?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=924" target="_blank">00:15:24.000</a></span> | <span class="t">No, I don't think so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=931" target="_blank">00:15:31.160</a></span> | <span class="t">So we start at zero then it's going to be 32 then it's going to be, yeah, yeah, probably.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=937" target="_blank">00:15:37.160</a></span> | <span class="t">You can probably tell I didn't actually run this code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=939" target="_blank">00:15:39.320</a></span> | <span class="t">Madhav is asking does this mean that LR find is based on the batch size set during the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=946" target="_blank">00:15:46.400</a></span> | <span class="t">data block?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=947" target="_blank">00:15:47.400</a></span> | <span class="t">Yeah, so LR find just uses your data loaders batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=955" target="_blank">00:15:55.400</a></span> | <span class="t">Edward is asking why do we need gradient accumulation rather than just using a smaller batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=962" target="_blank">00:16:02.040</a></span> | <span class="t">and follows up with how would we pick a good batch size?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=965" target="_blank">00:16:05.080</a></span> | <span class="t">Well just if you use a smaller batch size, here's the thing, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=969" target="_blank">00:16:09.760</a></span> | <span class="t">But architectures have different amounts of memory, you know, which they take up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=979" target="_blank">00:16:19.000</a></span> | <span class="t">And so you'll end up with different batch sizes for different architectures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=986" target="_blank">00:16:26.140</a></span> | <span class="t">Which is not necessarily a bad thing but each of them is going to then need a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=989" target="_blank">00:16:29.360</a></span> | <span class="t">learning rate and maybe even different weight decay or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=993" target="_blank">00:16:33.640</a></span> | <span class="t">Like the kind of the settings that's working really well for batch size 64 won't necessarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=998" target="_blank">00:16:38.080</a></span> | <span class="t">work really well for batch size 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1000" target="_blank">00:16:40.880</a></span> | <span class="t">And you know you want to be able to experiment as easily and quickly as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1006" target="_blank">00:16:46.760</a></span> | <span class="t">I think the second part of your question was how do you pick an optimal batch size?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1011" target="_blank">00:16:51.200</a></span> | <span class="t">Honestly the standard approach is to pick the largest one you can just because it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1017" target="_blank">00:16:57.720</a></span> | <span class="t">faster that way you're getting more parallel processing going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1025" target="_blank">00:17:05.200</a></span> | <span class="t">So to be honest I quite often use batch sizes that are quite a bit smaller than I need because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1031" target="_blank">00:17:11.560</a></span> | <span class="t">quite often it doesn't make that much difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1034" target="_blank">00:17:14.000</a></span> | <span class="t">But yeah the rule of thumb would be you know pick a batch size that fits in your GPU and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1042" target="_blank">00:17:22.360</a></span> | <span class="t">for performance reasons I think it's generally a good idea to have it be a multiple of eight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1048" target="_blank">00:17:28.720</a></span> | <span class="t">Everybody seems to always use powers of two I don't know like I don't think it actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1051" target="_blank">00:17:31.640</a></span> | <span class="t">matters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1053" target="_blank">00:17:33.640</a></span> | <span class="t">Look there's one other just a clarification or a check if the learning rate should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1057" target="_blank">00:17:37.800</a></span> | <span class="t">scaled according to the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1060" target="_blank">00:17:40.320</a></span> | <span class="t">Yeah so generally speaking the rule of thumb is that if you divide the batch size by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1064" target="_blank">00:17:44.640</a></span> | <span class="t">you divide the learning rate by two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1066" target="_blank">00:17:46.720</a></span> | <span class="t">But unfortunately it's not quite perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1070" target="_blank">00:17:50.360</a></span> | <span class="t">Did you have a question Nick if you do you can okay cool yeah now that's us all caught</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1076" target="_blank">00:17:56.240</a></span> | <span class="t">up thanks Jeremy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1077" target="_blank">00:17:57.640</a></span> | <span class="t">Good questions thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1082" target="_blank">00:18:02.680</a></span> | <span class="t">So gradient accumulation in fast AI is very straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1088" target="_blank">00:18:08.840</a></span> | <span class="t">You just divide the batch size by however much you want to divide it by and then add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1094" target="_blank">00:18:14.920</a></span> | <span class="t">something called a callback and a callback is something which changes the way the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1098" target="_blank">00:18:18.680</a></span> | <span class="t">trains this call that's called gradient accumulation and you pass in the effective batch size you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1104" target="_blank">00:18:24.720</a></span> | <span class="t">want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1106" target="_blank">00:18:26.520</a></span> | <span class="t">And then you say when you create the learner you say these are the callbacks I want and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1111" target="_blank">00:18:31.360</a></span> | <span class="t">so it's going to pass in gradient accumulation callbacks so it's going to only update the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1116" target="_blank">00:18:36.080</a></span> | <span class="t">weights once it's got 64 images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1125" target="_blank">00:18:45.280</a></span> | <span class="t">So if we pass in a Q equals one it won't do any gradient accumulation and that uses four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1131" target="_blank">00:18:51.720</a></span> | <span class="t">gig if we use Q equals two about three gig Q equals four about two and a half gig and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1141" target="_blank">00:19:01.600</a></span> | <span class="t">generally the bigger the model the closer you'll get to a kind of a linear scaling because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1146" target="_blank">00:19:06.360</a></span> | <span class="t">models have a kind of a bit of overhead that they have anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1153" target="_blank">00:19:13.240</a></span> | <span class="t">So what I then did was I just went through all the different models I wanted to try so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1156" target="_blank">00:19:16.600</a></span> | <span class="t">I wanted to try conf next large add a 320 by 240, VIT large, SWIN V2 large, SWIN large</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1166" target="_blank">00:19:26.960</a></span> | <span class="t">and on each of these I just tried running it with a Q equals one and actually every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1171" target="_blank">00:19:31.800</a></span> | <span class="t">time for all of these I got them out of memory error and then I tried each of them independently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1176" target="_blank">00:19:36.200</a></span> | <span class="t">with a Q equals two and it turns out that all of these worked with a Q equals two and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1181" target="_blank">00:19:41.200</a></span> | <span class="t">it only took me 12 seconds each time so that was a very quick thing for me then okay and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1186" target="_blank">00:19:46.440</a></span> | <span class="t">I now know how to train all of these models on a 16 gigabyte card so I can check here they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1191" target="_blank">00:19:51.400</a></span> | <span class="t">all in less than 16 gig.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1196" target="_blank">00:19:56.360</a></span> | <span class="t">So then I just created a little dictionary of all the architectures I wanted and for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1203" target="_blank">00:20:03.880</a></span> | <span class="t">each architecture all of the resize methods I wanted and final sizes I wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1211" target="_blank">00:20:11.560</a></span> | <span class="t">Now these models VIT, SWIN V2 and SWIN are all transformers models which means that well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1223" target="_blank">00:20:23.400</a></span> | <span class="t">most transformers models nearly all of them have a fixed size this one's 224 this one's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1227" target="_blank">00:20:27.960</a></span> | <span class="t">192 this one's 224 so I have to make sure that my final size is a square of the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1233" target="_blank">00:20:33.600</a></span> | <span class="t">required otherwise I get an error. There is a way of working around this but I haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1243" target="_blank">00:20:43.160</a></span> | <span class="t">experimented with it enough to know when it works well and when it doesn't so we'll probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1246" target="_blank">00:20:46.580</a></span> | <span class="t">come back to that in part two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1249" target="_blank">00:20:49.600</a></span> | <span class="t">So for now it's going to use the size that they ask us to use so with this dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1254" target="_blank">00:20:54.680</a></span> | <span class="t">of architectures and for each architecture kind of pre-processing details we switch the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1260" target="_blank">00:21:00.400</a></span> | <span class="t">training path back to using all of our images and then we can loop through each architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1266" target="_blank">00:21:06.960</a></span> | <span class="t">and loop through each item transforms and sizes and train the model and then the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1281" target="_blank">00:21:21.480</a></span> | <span class="t">script if you're fine-tuning returns the TTA predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1298" target="_blank">00:21:38.520</a></span> | <span class="t">So I append all those TTA predictions for each model for each type into a list and after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1304" target="_blank">00:21:44.800</a></span> | <span class="t">each one it's a good idea to do this garbage collection and empty cache that because otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1309" target="_blank">00:21:49.780</a></span> | <span class="t">I find what happens is your GPU memory kind of I don't know I think it gets fragmented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1315" target="_blank">00:21:55.920</a></span> | <span class="t">or something and after a while it runs out of memory even when you thought it wouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1319" target="_blank">00:21:59.680</a></span> | <span class="t">so this way you can really do as much as you like without running out of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1323" target="_blank">00:22:03.960</a></span> | <span class="t">So they all train train train train and one key thing to note here is that in my train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1331" target="_blank">00:22:11.800</a></span> | <span class="t">script my data loaders does not have the seed equals parameter so I'm using a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1344" target="_blank">00:22:24.820</a></span> | <span class="t">training set every time so that means that for each of these different runs they're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1355" target="_blank">00:22:35.560</a></span> | <span class="t">also different validation sets so they're not directly comparable but you can kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1359" target="_blank">00:22:39.880</a></span> | <span class="t">see they're all doing pretty well 2.1 percent 2.3 percent 1.7 percent and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1367" target="_blank">00:22:47.400</a></span> | <span class="t">So why am I using different training and validation sets for each of these that's because I want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1374" target="_blank">00:22:54.060</a></span> | <span class="t">to ensemble them so I'm going to use bagging which is I am going to take the average of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1386" target="_blank">00:23:06.040</a></span> | <span class="t">their predictions now I mean really when we talked about random forest bagging we were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1390" target="_blank">00:23:10.240</a></span> | <span class="t">taking the average of like intentionally weak models these are not intentionally weak models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1395" target="_blank">00:23:15.120</a></span> | <span class="t">they have to be good models but they're all different they're using different architectures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1398" target="_blank">00:23:18.720</a></span> | <span class="t">and different pre-processing approaches and so in general we would hope that these different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1403" target="_blank">00:23:23.240</a></span> | <span class="t">approaches some might work well for some images and some might work well for other images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1408" target="_blank">00:23:28.000</a></span> | <span class="t">and so when we average them out hopefully we'll get a good blend of kind of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1412" target="_blank">00:23:32.120</a></span> | <span class="t">ideas which is kind of what you want in bagging so we can stack up that list of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1421" target="_blank">00:23:41.080</a></span> | <span class="t">of all the different probabilities and take their main and so that's going to give us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1426" target="_blank">00:23:46.680</a></span> | <span class="t">3469 predictions that's our test set size and each one has 10 probabilities the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1435" target="_blank">00:23:55.080</a></span> | <span class="t">of each disease and so then we can use arg max to find which probability index is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1444" target="_blank">00:24:04.760</a></span> | <span class="t">highest so that's what it's going to give us our list of indexes so this is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1450" target="_blank">00:24:10.560</a></span> | <span class="t">the same steps as we used before to create our CSV submission file so at the time of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1458" target="_blank">00:24:18.460</a></span> | <span class="t">creating this analysis that got me to the top of the leaderboard and in fact these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1464" target="_blank">00:24:24.360</a></span> | <span class="t">my four submissions and you can see each one got better now you're not always going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1470" target="_blank">00:24:30.080</a></span> | <span class="t">get this nice monotonic improvement right but you want to be trying to submit something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1474" target="_blank">00:24:34.200</a></span> | <span class="t">every day to kind of like try out something new right and the more you practice the more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1482" target="_blank">00:24:42.880</a></span> | <span class="t">you'll get a good intuition of what's going to help right so partly I'm showing you this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1487" target="_blank">00:24:47.640</a></span> | <span class="t">to say it's not like purely random as to whether things work or don't once you've been doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1493" target="_blank">00:24:53.200</a></span> | <span class="t">this for a while you know you will generally be improving things most of the time so as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1502" target="_blank">00:25:02.000</a></span> | <span class="t">you can see from the descriptions my first submission was our conf next small for 12</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1506" target="_blank">00:25:06.440</a></span> | <span class="t">epochs with TTA and then a ensemble of confidence so it's basically this exact same thing but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1514" target="_blank">00:25:14.120</a></span> | <span class="t">just retraining a few with different training subsets and then this is the same thing again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1520" target="_blank">00:25:20.200</a></span> | <span class="t">this is the thing we just saw basically the ensemble of large bottles with TTA and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1527" target="_blank">00:25:27.400</a></span> | <span class="t">the last one was something I skipped over which was I the the VIT models were the best</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1535" target="_blank">00:25:35.800</a></span> | <span class="t">in my testing so I basically weighted them as double in the ensemble a pretty unscientific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1542" target="_blank">00:25:42.560</a></span> | <span class="t">but again it gave it a another boost and so that was that was it all right John yes thanks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1555" target="_blank">00:25:55.520</a></span> | <span class="t">Jeremy so no particular order Korean is asking would trying out cross-validation with K folds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1562" target="_blank">00:26:02.120</a></span> | <span class="t">with the same architecture makes sense okay so and sombling of models yes a popular thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1568" target="_blank">00:26:08.400</a></span> | <span class="t">is to do K fold cross-validation so K fold cross-validation is something very very similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1575" target="_blank">00:26:15.080</a></span> | <span class="t">to what I've done here so what I've done here is I've trained a bunch of models with different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1584" target="_blank">00:26:24.000</a></span> | <span class="t">training sets each one is a different random 80% of the data five fold cross-validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1591" target="_blank">00:26:31.320</a></span> | <span class="t">does something as similar but what it says is rather than picking like say five samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1598" target="_blank">00:26:38.440</a></span> | <span class="t">out with different random subsets in fact instead first like do all except for the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1606" target="_blank">00:26:46.600</a></span> | <span class="t">20% of the data and then all but the second 20% and then all but the third third and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1610" target="_blank">00:26:50.760</a></span> | <span class="t">forth and so you end up with five subsets each of which have non-overlapping validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1617" target="_blank">00:26:57.200</a></span> | <span class="t">sets and then you'll ensemble those you know in a thin theory maybe that could be slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1625" target="_blank">00:27:05.920</a></span> | <span class="t">better because you're kind of guaranteed that every row is appears four times you know effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1636" target="_blank">00:27:16.440</a></span> | <span class="t">it also has a benefit that you could average those five validation sets because there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1642" target="_blank">00:27:22.200</a></span> | <span class="t">no kind of overlap between them to get a cross-validation personally I generally don't bother but the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1649" target="_blank">00:27:29.640</a></span> | <span class="t">reason I don't is because this way I can add and remove models very easily I don't you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1659" target="_blank">00:27:39.600</a></span> | <span class="t">know I can just you know add another architecture and whatever to my ensemble without trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1666" target="_blank">00:27:46.200</a></span> | <span class="t">to find a different overlapping non-overlapping subset so yeah cross-validation is therefore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1673" target="_blank">00:27:53.820</a></span> | <span class="t">something that I use probably less than most people or almost or almost never awesome thank</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1681" target="_blank">00:28:01.880</a></span> | <span class="t">you are there any just come back to gradient accumulation any other kind of drawbacks or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1687" target="_blank">00:28:07.760</a></span> | <span class="t">potential gotchas with gradient accumulation no not really yeah like amazingly it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1697" target="_blank">00:28:17.600</a></span> | <span class="t">even really slow things down much you know going from a batch size of 64 to a batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1702" target="_blank">00:28:22.320</a></span> | <span class="t">of 32 by definition you had to do it because your GPU is full so you're obviously giving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1708" target="_blank">00:28:28.040</a></span> | <span class="t">a lot of data so it's probably going to be using its processing speed pretty effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1713" target="_blank">00:28:33.640</a></span> | <span class="t">so yeah no it's just it's just a good technique that we should all be buying cheaper graphics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1722" target="_blank">00:28:42.600</a></span> | <span class="t">cards with less memory in them and using you know have like I don't know the prices I suspect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1728" target="_blank">00:28:48.620</a></span> | <span class="t">like you could probably buy like 230 80s for the price of 130 90 ti or something that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1734" target="_blank">00:28:54.760</a></span> | <span class="t">be a very good deal yes clearly you're not on the nvidia payroll so look this is a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1742" target="_blank">00:29:02.480</a></span> | <span class="t">segue then we did have a question about sort of GPU recommendations and there's been a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1747" target="_blank">00:29:07.280</a></span> | <span class="t">of chat on that as well I bet so any any you know commentary any additional commentary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1752" target="_blank">00:29:12.520</a></span> | <span class="t">around GPU recommendations no not really I mean obviously at the moment nvidia is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1761" target="_blank">00:29:21.040</a></span> | <span class="t">only game in town you know if you buy if you trying to use a you know apple m1 or m2 or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1768" target="_blank">00:29:28.200</a></span> | <span class="t">or an AMD card you're basically in for a world of pain in terms of compatibility and stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1773" target="_blank">00:29:33.880</a></span> | <span class="t">and unoptimized libraries and whatever the the nvidia consumer cards so the ones that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1785" target="_blank">00:29:45.360</a></span> | <span class="t">start with RTX are much cheaper but are just as good as the expensive enterprise cards</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1796" target="_blank">00:29:56.720</a></span> | <span class="t">so you might be wondering why anybody would buy the expensive enterprise cards and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1800" target="_blank">00:30:00.760</a></span> | <span class="t">reason is that there's a licensing issue that nvidia will not allow you to use an RTX consumer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1807" target="_blank">00:30:07.640</a></span> | <span class="t">card in a data center which is also why cloud computing is more expensive than they kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1815" target="_blank">00:30:15.600</a></span> | <span class="t">of ought to be because everybody selling cloud computing GPUs is selling these cards that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1821" target="_blank">00:30:21.600</a></span> | <span class="t">are like I can't remember I think they're like three times more expensive for kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1824" target="_blank">00:30:24.760</a></span> | <span class="t">the same features so yeah if you do get serious about deep learning to the point that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1831" target="_blank">00:30:31.200</a></span> | <span class="t">prepared to invest you know a few days in administering a box and you know I guess depending</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1839" target="_blank">00:30:39.880</a></span> | <span class="t">on prices hopefully will start to come down but currently a thousand or two thousand or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1843" target="_blank">00:30:43.320</a></span> | <span class="t">two thousand dollars on buying a GPU then you know that'll probably pay you back pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1848" target="_blank">00:30:48.680</a></span> | <span class="t">quickly great thank you um let's see another one's come in uh if you have a back on models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1858" target="_blank">00:30:58.320</a></span> | <span class="t">not hardware if you have a well functioning but large model can it make sense to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1863" target="_blank">00:31:03.240</a></span> | <span class="t">a smaller model to produce the same final activations as the larger model oh yeah absolutely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1870" target="_blank">00:31:10.120</a></span> | <span class="t">i'm not sure we'll get into that this time around but um yeah um we'll cover that in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1877" target="_blank">00:31:17.400</a></span> | <span class="t">part two i think but yeah basically there's a kind of teacher student models and model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1883" target="_blank">00:31:23.000</a></span> | <span class="t">distillation which broadly speaking there there are ways to make inference faster by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1889" target="_blank">00:31:29.680</a></span> | <span class="t">training small models that work the same way as large models great thank you all right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1897" target="_blank">00:31:37.240</a></span> | <span class="t">so that is the actual real end of road to the top because beyond that we don't actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1905" target="_blank">00:31:45.120</a></span> | <span class="t">cover how to get closer to the top you'd have to ask korean to share his techniques to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1910" target="_blank">00:31:50.080</a></span> | <span class="t">out that or nick to get the second place in the top um part four is actually um something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1918" target="_blank">00:31:58.900</a></span> | <span class="t">that i think is very useful to know about for for learning and it's going to teach us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1922" target="_blank">00:32:02.120</a></span> | <span class="t">a whole lot about how the last layer of a neural networks and specifically what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1930" target="_blank">00:32:10.600</a></span> | <span class="t">going to try to do is we're going to try to build a model that doesn't just predict the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1937" target="_blank">00:32:17.320</a></span> | <span class="t">disease but also predicts the type of rice so how would you do that so here's the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1945" target="_blank">00:32:25.640</a></span> | <span class="t">loader we're going to try to build it's going to be something that for each image it tells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1952" target="_blank">00:32:32.320</a></span> | <span class="t">us the disease and the type of rice i say disease sometimes normal i guess some of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1957" target="_blank">00:32:37.920</a></span> | <span class="t">are not diseased so to build a model that can predict two things the first thing is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1966" target="_blank">00:32:46.720</a></span> | <span class="t">you're going to need data loaders that have two dependent variables and that is shockingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1973" target="_blank">00:32:53.560</a></span> | <span class="t">easy to do in fastai thanks to the data block so we've seen the data block before we haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1982" target="_blank">00:33:02.920</a></span> | <span class="t">been using it for the patty competition so far because we haven't needed it we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1986" target="_blank">00:33:06.680</a></span> | <span class="t">just use image data loader dot from folder so that's like the the highest level api the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1992" target="_blank">00:33:12.920</a></span> | <span class="t">simplest api if we go down a level deeper into the data block we have a lot more flexibility</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=1999" target="_blank">00:33:19.960</a></span> | <span class="t">so if you've been following the walkthroughs you'll know that as i built this the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2004" target="_blank">00:33:24.720</a></span> | <span class="t">thing i actually did was to simply replicate the previous notebook but replace the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2011" target="_blank">00:33:31.040</a></span> | <span class="t">data loader dot from folders with the data block to try to do first of all exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2015" target="_blank">00:33:35.240</a></span> | <span class="t">same thing and then i added the second dependent variable so if we look at the previous image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2025" target="_blank">00:33:45.360</a></span> | <span class="t">data loader from folders thingy here it is where you're passing in some item transforms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2035" target="_blank">00:33:55.440</a></span> | <span class="t">and some batch transforms and we had something saying what percentage should be the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2041" target="_blank">00:34:01.600</a></span> | <span class="t">set so in a data block if you remember we have to pass in a blocks argument saying what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2052" target="_blank">00:34:12.920</a></span> | <span class="t">kind of data is the independent variable and what is the dependent variable so to replicate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2058" target="_blank">00:34:18.280</a></span> | <span class="t">what we had before we would just pass in image block comma category block because we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2062" target="_blank">00:34:22.440</a></span> | <span class="t">an image as our independent variable and a category one type of rice is the dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2067" target="_blank">00:34:27.400</a></span> | <span class="t">variable so the new thing i'm going to show you here is that you don't have to only put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2071" target="_blank">00:34:31.600</a></span> | <span class="t">in two things you can put in as many as you like so if you put in three things we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2077" target="_blank">00:34:37.200</a></span> | <span class="t">to generate one image and two categories now fastai if you're saying i want three things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2084" target="_blank">00:34:44.360</a></span> | <span class="t">fastai doesn't know which of those is the independent variable and which is the dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2088" target="_blank">00:34:48.800</a></span> | <span class="t">variable so the next thing you have to tell it is how many inputs are there number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2093" target="_blank">00:34:53.120</a></span> | <span class="t">inputs and so here i've said there's one input so that means this is the input and therefore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2098" target="_blank">00:34:58.240</a></span> | <span class="t">by definition two categories will be the output because remember we're trying to predict two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2102" target="_blank">00:35:02.960</a></span> | <span class="t">things the type of rice and the disease okay this is the same as what we've seen before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2109" target="_blank">00:35:09.000</a></span> | <span class="t">to find out to get our list of items we'll call get image files now here's something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2114" target="_blank">00:35:14.280</a></span> | <span class="t">we haven't seen before get y is our labeling function normally we pass to get y a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2120" target="_blank">00:35:20.720</a></span> | <span class="t">thing such as the parent label function which looks at the name of the parent directory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2127" target="_blank">00:35:27.520</a></span> | <span class="t">which remember is how these images are structured and that would tell us the label but get y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2134" target="_blank">00:35:34.320</a></span> | <span class="t">can also take an array and in this case we want two different labels one is the name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2141" target="_blank">00:35:41.640</a></span> | <span class="t">of the parent directory because that's the disease the second is the variety so what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2146" target="_blank">00:35:46.880</a></span> | <span class="t">get variety get variety is a function so let me explain how this function works so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2154" target="_blank">00:35:54.480</a></span> | <span class="t">create a data frame containing our training data that came from Kaggle so for each image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2161" target="_blank">00:36:01.240</a></span> | <span class="t">it tells us the disease and the variety and what i did is something i haven't shown before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2169" target="_blank">00:36:09.720</a></span> | <span class="t">in pandas you can set one column to be the index and when you do that in this case image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2175" target="_blank">00:36:15.560</a></span> | <span class="t">id it makes this series this sorry this data frame kind of like a dictionary i can index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2183" target="_blank">00:36:23.200</a></span> | <span class="t">into it by saying tell me the row for this image and to do that you use the lock attribute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2190" target="_blank">00:36:30.560</a></span> | <span class="t">the location so we want in the data frame the location of this image and then you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2199" target="_blank">00:36:39.600</a></span> | <span class="t">also say optionally what column you want this column and so here's this image and here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2207" target="_blank">00:36:47.320</a></span> | <span class="t">this column and as you can see it returns that thing so hopefully now you can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2213" target="_blank">00:36:53.160</a></span> | <span class="t">pretty easy for us to create a function that takes a row sorry a path and returns the location</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2226" target="_blank">00:37:06.480</a></span> | <span class="t">in the data frame of the name of that file because remember these are the names of files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2234" target="_blank">00:37:14.080</a></span> | <span class="t">for the variety column so that's our second get y okay and then we've seen this before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2242" target="_blank">00:37:22.800</a></span> | <span class="t">randomly split the data into the 20 percent and so 80 percent and so we could just squish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2250" target="_blank">00:37:30.720</a></span> | <span class="t">them all to 192 just for this example and then use data augmentation to get us down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2255" target="_blank">00:37:35.920</a></span> | <span class="t">to 128 square images just for this example um and so that's what we get when we say show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2264" target="_blank">00:37:44.880</a></span> | <span class="t">batch we get what we just discussed so now we need a model that predicts two things how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2280" target="_blank">00:38:00.000</a></span> | <span class="t">do we create a model that predicts two things well the key thing to realize is we never</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2285" target="_blank">00:38:05.920</a></span> | <span class="t">actually had a model that predicts two things we had a model that predicts 10 things before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2292" target="_blank">00:38:12.880</a></span> | <span class="t">the 10 things we predicted is the probability of each disease so we don't actually now want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2299" target="_blank">00:38:19.520</a></span> | <span class="t">a model that predicts two things we want a model that predicts 20 things the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2304" target="_blank">00:38:24.280</a></span> | <span class="t">of each of the 10 diseases and the probability of each of the 10 varieties so how could we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2315" target="_blank">00:38:35.480</a></span> | <span class="t">do that well let's first of all try to just create the same disease model we had before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2324" target="_blank">00:38:44.320</a></span> | <span class="t">with our new data loader and so this is going to be reasonably straightforward the key thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2330" target="_blank">00:38:50.240</a></span> | <span class="t">to know is that since we told fastai that there's one input and therefore by definition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2337" target="_blank">00:38:57.960</a></span> | <span class="t">there's two outputs it's going to pass to our metrics and to our um loss functions three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2347" target="_blank">00:39:07.560</a></span> | <span class="t">things instead of two the predictions from the model and the disease and the variety</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2355" target="_blank">00:39:15.760</a></span> | <span class="t">so if we're gonna so we can't just use error rate as our metric anymore because error rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2360" target="_blank">00:39:20.680</a></span> | <span class="t">takes two things instead we have to create a function that takes three things and return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2366" target="_blank">00:39:26.320</a></span> | <span class="t">error rate are the two things we want which is the predictions from the model and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2373" target="_blank">00:39:33.120</a></span> | <span class="t">disease okay so predictions the model this is the target so that's actually all we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2378" target="_blank">00:39:38.760</a></span> | <span class="t">to do to define a metric that's going to work with our new data set with a new data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2386" target="_blank">00:39:46.880</a></span> | <span class="t">this is not going to actually tell us anything about variety first it's going to try to replicate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2390" target="_blank">00:39:50.680</a></span> | <span class="t">something that can do just disease so when we create our learner we'll pass in this new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2396" target="_blank">00:39:56.840</a></span> | <span class="t">disease error function okay so halfway there the other thing we're going to need is to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2404" target="_blank">00:40:04.740</a></span> | <span class="t">change our loss function now we never actually talked about what loss function to use and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2412" target="_blank">00:40:12.320</a></span> | <span class="t">that's because vision learner guessed what loss function to use vision learner saw that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2420" target="_blank">00:40:20.120</a></span> | <span class="t">our dependent variable is a single category and it knows the best loss function that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2425" target="_blank">00:40:25.200</a></span> | <span class="t">probably going to be the case for things with a single category and it knows how big the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2428" target="_blank">00:40:28.440</a></span> | <span class="t">category is so it just didn't bother us at all just said okay I'll figure it out for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2433" target="_blank">00:40:33.520</a></span> | <span class="t">you so the only time we've provided our own loss function is when we were kind of doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2441" target="_blank">00:40:41.880</a></span> | <span class="t">linear models and neural nets from scratch and we did I think mean squared error we might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2447" target="_blank">00:40:47.160</a></span> | <span class="t">also have done mean absolute error neither of those work when the dependent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2455" target="_blank">00:40:55.720</a></span> | <span class="t">is a category how would you use mean squared error or mean absolute error to say how close</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2462" target="_blank">00:41:02.760</a></span> | <span class="t">were these 10 probability predictions to this one correct answer so in this case we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2471" target="_blank">00:41:11.120</a></span> | <span class="t">to use a different loss function we have to use something called cross entropy loss and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2475" target="_blank">00:41:15.440</a></span> | <span class="t">this is actually the loss function that fast AI picked for us before without us knowing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2481" target="_blank">00:41:21.680</a></span> | <span class="t">but now that we are having to pick it out manually I'm going to explain to you exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2486" target="_blank">00:41:26.480</a></span> | <span class="t">what cross entropy loss does okay and you know these details are very important indeed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2497" target="_blank">00:41:37.720</a></span> | <span class="t">like remember I said at the start of this class the stuff that happens in the middle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2501" target="_blank">00:41:41.120</a></span> | <span class="t">of the model you're not going to have to care about much in your life if ever but the stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2506" target="_blank">00:41:46.080</a></span> | <span class="t">that happens in the first layer and the last layer including the loss function that sits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2510" target="_blank">00:41:50.440</a></span> | <span class="t">between the last layer and the loss you're going to have to care about a lot right this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2514" target="_blank">00:41:54.340</a></span> | <span class="t">stuff comes up all the time so you definitely want to know about cross entropy loss and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2520" target="_blank">00:42:00.640</a></span> | <span class="t">so I'm going to explain it using a spreadsheet the spreadsheets in the course repo and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2529" target="_blank">00:42:09.520</a></span> | <span class="t">let's say you are predicting something like a kind of a mini image net thing where you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2535" target="_blank">00:42:15.360</a></span> | <span class="t">trying to predict whether something an image is a cat a dog a plane a fish or a building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2540" target="_blank">00:42:20.480</a></span> | <span class="t">so you set up some model whatever it is a conf next model or just a big bunch of linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2547" target="_blank">00:42:27.320</a></span> | <span class="t">layers connected up or whatever and initially you've got some random weights and it spits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2554" target="_blank">00:42:34.640</a></span> | <span class="t">out at the end five predictions right so remember to predict something with five categories</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2561" target="_blank">00:42:41.840</a></span> | <span class="t">your model will spit out five probabilities now it doesn't initially spit out probabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2566" target="_blank">00:42:46.920</a></span> | <span class="t">there's nothing making them probabilities it just spits out five numbers could be negative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2572" target="_blank">00:42:52.680</a></span> | <span class="t">could be positive okay so here's the output of the model so what we want to do is we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2582" target="_blank">00:43:02.720</a></span> | <span class="t">to convert these into probabilities and so we do that in two steps the first thing we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2592" target="_blank">00:43:12.600</a></span> | <span class="t">do is we go exp that's e to the power of we go e to the power of each of those things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2603" target="_blank">00:43:23.360</a></span> | <span class="t">like so okay and so here's the mathematical formula we're using this is called the soft</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2607" target="_blank">00:43:27.920</a></span> | <span class="t">max what we're working through we're going to go through each of the categories so these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2618" target="_blank">00:43:38.040</a></span> | <span class="t">are our five categories so here K is five we're going to go through each of our categories</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2621" target="_blank">00:43:41.600</a></span> | <span class="t">and we're going to go e to the power of the output so ZJ is the output for the jth category</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2630" target="_blank">00:43:50.880</a></span> | <span class="t">so here's that and then we're going to sum them all together here it is sum up together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2637" target="_blank">00:43:57.320</a></span> | <span class="t">okay so this is the denominator and then the numerator is just e to the power of the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2646" target="_blank">00:44:06.480</a></span> | <span class="t">we care about so this row so the numerator is e to the power of cat on this row e to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2657" target="_blank">00:44:17.240</a></span> | <span class="t">the power of dog on this row and so forth now if you think about it since the denominator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2665" target="_blank">00:44:25.580</a></span> | <span class="t">adds up all the e to the power ofs and when we do each one divided by the sum that means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2673" target="_blank">00:44:33.280</a></span> | <span class="t">the sum of these will equal one by definition right and so now we have things that can be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2682" target="_blank">00:44:42.120</a></span> | <span class="t">treated as probabilities they're all numbers between zero and one numbers that were bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2688" target="_blank">00:44:48.720</a></span> | <span class="t">in the output will be bigger here but there's something else interesting which is because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2693" target="_blank">00:44:53.560</a></span> | <span class="t">we did either the power of it means that the bigger numbers will be like pushed up to numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2700" target="_blank">00:45:00.200</a></span> | <span class="t">closer to one like we're saying like oh really try to pick one thing as having most of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2706" target="_blank">00:45:06.680</a></span> | <span class="t">probability because we are trying to predict you know one thing we're trying to predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2712" target="_blank">00:45:12.240</a></span> | <span class="t">which one is it and so this is called softmax so sometimes you'll see people complaining</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2720" target="_blank">00:45:20.640</a></span> | <span class="t">about the fact that their model which they said let's say is it a teddy bear or a grizzly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2727" target="_blank">00:45:27.560</a></span> | <span class="t">bear or a black bear and they faded a picture of the cat and they say oh the models wrong</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2733" target="_blank">00:45:33.440</a></span> | <span class="t">because it predicted grizzly bear it's not a grizzly bear as you can see there's no way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2737" target="_blank">00:45:37.440</a></span> | <span class="t">for this to predict anything other than the categories we're giving it we're forcing it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2742" target="_blank">00:45:42.680</a></span> | <span class="t">to that now we don't if you want that like it's something else you could do which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2748" target="_blank">00:45:48.640</a></span> | <span class="t">you could actually have them not add up to one right you could instead have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2753" target="_blank">00:45:53.880</a></span> | <span class="t">which simply says what's the probability it's a cat what's probably it's a dog was put it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2757" target="_blank">00:45:57.680</a></span> | <span class="t">by totally separately and they could add up to less than one out of that situation you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2763" target="_blank">00:46:03.280</a></span> | <span class="t">can say you know or more than one which case you could have like more than one thing being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2767" target="_blank">00:46:07.160</a></span> | <span class="t">true or zero things being true but in this particular case where we want to predict one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2772" target="_blank">00:46:12.760</a></span> | <span class="t">and one thing only we use softmax the first part of the cross entropy formula the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2784" target="_blank">00:46:24.560</a></span> | <span class="t">part of the cross entropy formula in fact let's look it up and end up cross entropy loss the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2794" target="_blank">00:46:34.840</a></span> | <span class="t">first part of what cross entropy loss in PyTorch does is to calculate the softmax it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2806" target="_blank">00:46:46.640</a></span> | <span class="t">the log of the softmax but don't worry about that too much it's just a slightly faster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2811" target="_blank">00:46:51.240</a></span> | <span class="t">to do the log okay so now for each one of our five things we've got a probability the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2823" target="_blank">00:47:03.920</a></span> | <span class="t">next step is the actual cross entropy calculation which is we take our five things we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2829" target="_blank">00:47:09.360</a></span> | <span class="t">our five probabilities and then we've got our axials now the truth is the actual you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2836" target="_blank">00:47:16.640</a></span> | <span class="t">know the five things would have indices right zero one two three or four the actual turned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2842" target="_blank">00:47:22.040</a></span> | <span class="t">out to be the number one but what we tend to do is we think of it as being one hot encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2847" target="_blank">00:47:27.880</a></span> | <span class="t">which is we put a one next to the thing for which it's true and a zero everywhere else</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2856" target="_blank">00:47:36.020</a></span> | <span class="t">and so now we can compare these five numbers to these five numbers and we would expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2862" target="_blank">00:47:42.920</a></span> | <span class="t">to have a smaller loss if the softmax was high where the actual is high and so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2873" target="_blank">00:47:53.520</a></span> | <span class="t">how we calculate this is the formula the cross entropy loss we sum up they switch to M this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2883" target="_blank">00:48:03.000</a></span> | <span class="t">time for some reason but the same thing we sum up across the five categories M is five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2888" target="_blank">00:48:08.240</a></span> | <span class="t">and for each one we multiply the actual target value so that's zero so here it is here the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2896" target="_blank">00:48:16.000</a></span> | <span class="t">actual target value and we multiply that by the log of the predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2907" target="_blank">00:48:27.840</a></span> | <span class="t">probability the log of red the predicted probability and so of course for four of these that value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2917" target="_blank">00:48:37.960</a></span> | <span class="t">is zero because here yj equals zero by definition for all but one of them because it's one hot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2927" target="_blank">00:48:47.520</a></span> | <span class="t">encoded so for the one that it's not we've got our actual times the log softmax okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2940" target="_blank">00:49:00.640</a></span> | <span class="t">and so now actually you can see why PyTorch prefers to use log softmax because that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2946" target="_blank">00:49:06.640</a></span> | <span class="t">kind of skips over having to do this log at all so this equation looks slightly frightening</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2956" target="_blank">00:49:16.260</a></span> | <span class="t">but when you think about it all it's actually doing is it's finding the probability for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2961" target="_blank">00:49:21.680</a></span> | <span class="t">the one that is one and taking its log right it's kind of weird doing it as a sum but in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2968" target="_blank">00:49:28.040</a></span> | <span class="t">math it can be a little bit tricky to kind of say oh look this up in an array which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2971" target="_blank">00:49:31.440</a></span> | <span class="t">basically all it's doing but yeah basically at least in this case first for a single result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2977" target="_blank">00:49:37.320</a></span> | <span class="t">where it's softmax this is all it's doing because it's finding the point eight seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2981" target="_blank">00:49:41.040</a></span> | <span class="t">where it's one four and taking the log and then finally negative so that is what cross</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=2989" target="_blank">00:49:49.960</a></span> | <span class="t">entropy loss does we add that together for every row so here's what it looks like if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3004" target="_blank">00:50:04.440</a></span> | <span class="t">we add it together over every row right so n is the number of rows and here's a special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3011" target="_blank">00:50:11.080</a></span> | <span class="t">case this is called binary cross entropy what happens if we're not predicting which of five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3017" target="_blank">00:50:17.840</a></span> | <span class="t">things it is but we're just predicting is it a cat so that case if you look at this approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3024" target="_blank">00:50:24.040</a></span> | <span class="t">you end up with this formula which it's it's this is identical to this formula but in for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3033" target="_blank">00:50:33.840</a></span> | <span class="t">just two cases which is you've either you either are a cat or you're not a cat right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3041" target="_blank">00:50:41.480</a></span> | <span class="t">and so if you're not a cat it's one minus you are a cat and same with the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3046" target="_blank">00:50:46.320</a></span> | <span class="t">you've got the probability you are a cat and then not a cat is one minus that so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3052" target="_blank">00:50:52.360</a></span> | <span class="t">this special case of binary cross entropy and now our rows represent rows of data okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3059" target="_blank">00:50:59.200</a></span> | <span class="t">each one of these is a different image a different prediction and so for each one I'm just predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3064" target="_blank">00:51:04.760</a></span> | <span class="t">are you a cat and this is the actual and so the actual are you not a cat is just one minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3070" target="_blank">00:51:10.720</a></span> | <span class="t">that and so then these are the predictions that came out of the model again we can use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3078" target="_blank">00:51:18.720</a></span> | <span class="t">softmax or it's it's binary equivalent and so that will give you a prediction that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3084" target="_blank">00:51:24.580</a></span> | <span class="t">a cat and the prediction that it's not a cat is one minus that and so here is each of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3095" target="_blank">00:51:35.880</a></span> | <span class="t">part yi times log of p yi and here is why did I subtract that's weird oh because I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3109" target="_blank">00:51:49.960</a></span> | <span class="t">got minus of both so I just do it this way avoids parentheses yeah minus the are you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3116" target="_blank">00:51:56.880</a></span> | <span class="t">not a cat times the log of the prediction of are you not a cat and then we can add those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3122" target="_blank">00:52:02.640</a></span> | <span class="t">together and so that would be the binary cross entropy loss of this data set of five cat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3129" target="_blank">00:52:09.320</a></span> | <span class="t">or not cat images now if you've got an eagle eye you may have noticed that I am currently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3148" target="_blank">00:52:28.920</a></span> | <span class="t">looking at the documentation for something called Anna and cross entropy loss but over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3154" target="_blank">00:52:34.680</a></span> | <span class="t">here I had something called f cross entropy basically it turns out that all of the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3161" target="_blank">00:52:41.400</a></span> | <span class="t">functions in pytorch have two versions there's a version which is a class this is a class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3170" target="_blank">00:52:50.320</a></span> | <span class="t">which you can instantiate passing in various tweaks you might want and there's also a version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3177" target="_blank">00:52:57.120</a></span> | <span class="t">which is just a function and so if you don't need any of these tweaks you can just use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3182" target="_blank">00:53:02.720</a></span> | <span class="t">the function the functions live in a kind of remember what the sub module called I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3190" target="_blank">00:53:10.480</a></span> | <span class="t">it might be like torch dot n n dot functional but everybody including the pytorch official</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3195" target="_blank">00:53:15.560</a></span> | <span class="t">docs just calls a capital F so that's what this capital F refers to so our loss if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3203" target="_blank">00:53:23.400</a></span> | <span class="t">just care about disease we're going to be past the three things but just going to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3206" target="_blank">00:53:26.880</a></span> | <span class="t">cross entropy on our input versus disease all right so that's all fine we passed so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3214" target="_blank">00:53:34.680</a></span> | <span class="t">now when we create a vision learner you can't rely on fast AI to know what loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3219" target="_blank">00:53:39.400</a></span> | <span class="t">to use because we've got multiple targets so you have to say this is the loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3223" target="_blank">00:53:43.860</a></span> | <span class="t">I want to use this is the metrics I want to use and the other thing you can't rely on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3228" target="_blank">00:53:48.280</a></span> | <span class="t">is that fast AI no longer knows how many activations to create because again it there's more than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3235" target="_blank">00:53:55.100</a></span> | <span class="t">one target so you have to say the number of outputs to create at the last layer is 10</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3240" target="_blank">00:54:00.160</a></span> | <span class="t">this is just saying what's the size of the last matrix and once we've done that we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3248" target="_blank">00:54:08.120</a></span> | <span class="t">train it and we get you know basically the same kind of result as we always get because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3253" target="_blank">00:54:13.280</a></span> | <span class="t">this model at this point is identical to our previous conf next small model we've just done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3261" target="_blank">00:54:21.040</a></span> | <span class="t">it in a slightly more roundabout way so finally before our break I'll show you how to expand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3269" target="_blank">00:54:29.520</a></span> | <span class="t">this now into a multi-target model and the trick is actually very simple and you might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3276" target="_blank">00:54:36.120</a></span> | <span class="t">have almost got the idea of it when I talked about it earlier our vision learner now requires</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3282" target="_blank">00:54:42.680</a></span> | <span class="t">20 outputs we now need that last matrix to have to produce 20 activations not 10 10 of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3291" target="_blank">00:54:51.360</a></span> | <span class="t">those activations are going to predict the disease and 10 of the activations are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3297" target="_blank">00:54:57.800</a></span> | <span class="t">to predict the variety so you might be then asking like well how does the model know what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3303" target="_blank">00:55:03.360</a></span> | <span class="t">it's meant to be predicting and the answer is with the loss function you're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3308" target="_blank">00:55:08.920</a></span> | <span class="t">have to tell it so for example disease loss remember it's going to get the input the disease</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3318" target="_blank">00:55:18.000</a></span> | <span class="t">in the variety this is now going to have 20 columns in so we're just going to decide all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3325" target="_blank">00:55:25.480</a></span> | <span class="t">right we're just going to decide the first 10 columns we're going to decide are the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3329" target="_blank">00:55:29.640</a></span> | <span class="t">of what the disease is which of the probability of each disease so we can now passed across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3334" target="_blank">00:55:34.560</a></span> | <span class="t">entropy the first 10 columns and the disease target so the way you read this colon means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3344" target="_blank">00:55:44.460</a></span> | <span class="t">every row and then colon 10 means every column up to the 10th so these are the first 10 columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3356" target="_blank">00:55:56.400</a></span> | <span class="t">and that will that's a loss function that just works on predicting disease using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3361" target="_blank">00:56:01.120</a></span> | <span class="t">first 10 columns for variety we'll use cross entropy loss with the target of variety and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3368" target="_blank">00:56:08.480</a></span> | <span class="t">this time we'll use the second 10 columns so here's column 10 onwards so then the overall</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3375" target="_blank">00:56:15.960</a></span> | <span class="t">loss function is the sum of those two things disease loss plus variety loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3387" target="_blank">00:56:27.200</a></span> | <span class="t">and that's actually it that's all the model needs to basically it's now going to if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3394" target="_blank">00:56:34.080</a></span> | <span class="t">kind of think through the manual neural nets we've created this loss function will be reduced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3402" target="_blank">00:56:42.160</a></span> | <span class="t">when the first 10 columns are doing a good job of predicting disease probabilities and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3406" target="_blank">00:56:46.760</a></span> | <span class="t">the second 10 columns are doing a good job of predicting the variety probabilities and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3410" target="_blank">00:56:50.240</a></span> | <span class="t">therefore the gradients will point in an appropriate direction that the coefficients will get better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3416" target="_blank">00:56:56.160</a></span> | <span class="t">and better at using those columns for those purposes it would be nice to see the error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3424" target="_blank">00:57:04.520</a></span> | <span class="t">rate as well for each of disease and variety so we can call error rate passing in the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3430" target="_blank">00:57:10.280</a></span> | <span class="t">10 columns and disease and then variety the second 10 columns and variety and we may as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3438" target="_blank">00:57:18.240</a></span> | <span class="t">well also add to the metrics the losses and so now when we create a learner we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3444" target="_blank">00:57:24.560</a></span> | <span class="t">to pass in as the loss function the combined loss and as the metrics our list of all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3451" target="_blank">00:57:31.480</a></span> | <span class="t">metrics and n out equals 20 and now look what happens when we train as well as telling us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3460" target="_blank">00:57:40.000</a></span> | <span class="t">the overall train in valid loss it also tells us the disease and variety error and the disease</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3464" target="_blank">00:57:44.880</a></span> | <span class="t">and variety loss and you can see our disease error is getting down to similar levels it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3470" target="_blank">00:57:50.680</a></span> | <span class="t">was before it's slightly less good but it's similar it's not surprising it's slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3479" target="_blank">00:57:59.920</a></span> | <span class="t">less good because we've only given it the same number of epochs and we're now asking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3485" target="_blank">00:58:05.720</a></span> | <span class="t">it to try to do more stuff which is to learn to recognize what the rice variety looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3490" target="_blank">00:58:10.760</a></span> | <span class="t">and also learns to recognize what the disease looks like here's the counterintuitive thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3496" target="_blank">00:58:16.600</a></span> | <span class="t">though if we train it for longer it may well turn out that this model which is trying to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3503" target="_blank">00:58:23.680</a></span> | <span class="t">predict two things actually gets better at predicting disease than our disease specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3510" target="_blank">00:58:30.240</a></span> | <span class="t">model why is that like that sounds weird right because we're trying to have to do more stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3517" target="_blank">00:58:37.080</a></span> | <span class="t">that's the same size model well the reason is that quite often it'll turn out that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3524" target="_blank">00:58:44.400</a></span> | <span class="t">kinds of features that help you recognize a variety of rice are also useful for recognizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3531" target="_blank">00:58:51.760</a></span> | <span class="t">the disease you know maybe there are certain textures right or maybe some diseases impact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3539" target="_blank">00:58:59.440</a></span> | <span class="t">different varieties different ways so it'd be really helpful to know what variety it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3545" target="_blank">00:59:05.280</a></span> | <span class="t">so I haven't tried training this for a long time and I don't know the answer is in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3550" target="_blank">00:59:10.400</a></span> | <span class="t">particular case does a multi-target model do better than a single target model at predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3555" target="_blank">00:59:15.200</a></span> | <span class="t">disease but I just want to let you know sometimes it does right so for example a few years ago</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3560" target="_blank">00:59:20.960</a></span> | <span class="t">there was a Kaggle competition for recognizing the kinds of fish on a boat and I remember we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3568" target="_blank">00:59:28.400</a></span> | <span class="t">ended up doing a multi-target model where we tried to predict a second thing I can't even remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3575" target="_blank">00:59:35.040</a></span> | <span class="t">what it was maybe it was a type of boat or something and it definitely turned out in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3578" target="_blank">00:59:38.560</a></span> | <span class="t">Kaggle competition that predicting two things helped you predict the type of fish better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3582" target="_blank">00:59:42.880</a></span> | <span class="t">than predicting just the type of fish so there's at least you know there's two reasons to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3589" target="_blank">00:59:49.840</a></span> | <span class="t">about multi-target models one is that sometimes you just want to be able to predict more than one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3595" target="_blank">00:59:55.040</a></span> | <span class="t">thing so this is useful and the second is sometimes this will actually be better at predicting just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3600" target="_blank">01:00:00.560</a></span> | <span class="t">one thing than a just one thing model and of course the third reason is it really forced us to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3607" target="_blank">01:00:07.840</a></span> | <span class="t">dig quite deeply into these loss functions and activations in a way we haven't quite done before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3613" target="_blank">01:00:13.920</a></span> | <span class="t">so it's okay it's absolutely okay if this is confusing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3623" target="_blank">01:00:23.760</a></span> | <span class="t">the way to make it not confusing is well the first thing I do is like go back to our earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3632" target="_blank">01:00:32.640</a></span> | <span class="t">models where we did stuff by hand on like the Titanic data set and built our own architectures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3639" target="_blank">01:00:39.600</a></span> | <span class="t">and maybe you could try to build a model that predicts two things in the Titanic dataset maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3646" target="_blank">01:00:46.080</a></span> | <span class="t">you could try to predict both sex and survival or something like that or or class and survival</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3654" target="_blank">01:00:54.320</a></span> | <span class="t">because that's kind of kind of forced you to look at it on very small data sets and then the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3659" target="_blank">01:00:59.520</a></span> | <span class="t">thing I'd say is run this notebook and really experiment at trying to see what kind of outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3668" target="_blank">01:01:08.000</a></span> | <span class="t">you get like actually look at the inputs and look at the outputs and look at the data loaders and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3672" target="_blank">01:01:12.000</a></span> | <span class="t">forth all right let's have a six minute break um so I'll see you back here at 10 past seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3684" target="_blank">01:01:24.480</a></span> | <span class="t">okay welcome back um oh before I continue I very rudely forgot to mention this very nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3692" target="_blank">01:01:32.560</a></span> | <span class="t">equation image here is from an article by Chris said called things that confused me about cross</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3700" target="_blank">01:01:40.560</a></span> | <span class="t">entropy it's a very good article so I recommend you check it out if you want to go a bit deeper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3706" target="_blank">01:01:46.960</a></span> | <span class="t">there there's a link to it inside the spreadsheet so the next notebook we're going to be looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3719" target="_blank">01:01:59.440</a></span> | <span class="t">is this one called collaborative filtering deep dive and this is going to cover our last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3727" target="_blank">01:02:07.040</a></span> | <span class="t">of the four major application areas collaborative filtering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3735" target="_blank">01:02:15.200</a></span> | <span class="t">and this is actually the first time I'm going to be presenting a chapter of the book largely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3741" target="_blank">01:02:21.360</a></span> | <span class="t">without variation um because this is one where I looked back at the chapter and I was like oh I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3748" target="_blank">01:02:28.160</a></span> | <span class="t">can't think of any way to improve this so I thought I'll just leave it as is um but we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3754" target="_blank">01:02:34.800</a></span> | <span class="t">put the whole chapter up on Kaggle um so that's for the way I'm going to be showing it to you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3762" target="_blank">01:02:42.960</a></span> | <span class="t">and so we're going to be looking at a data set called the movie lens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3766" target="_blank">01:02:46.480</a></span> | <span class="t">data set which is a data set of movie ratings and we're going to grab a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3775" target="_blank">01:02:55.360</a></span> | <span class="t">smaller version of it 100,000 record version of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3779" target="_blank">01:02:59.280</a></span> | <span class="t">and it comes as a csv file which we can read in well it's not really a csv file it's a tsv file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3789" target="_blank">01:03:09.840</a></span> | <span class="t">this here means a tab in python um these are the names of the columns so here's what it looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3801" target="_blank">01:03:21.600</a></span> | <span class="t">it's got a user a movie a rating and a timestamp we're not going to use the timestamp</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3806" target="_blank">01:03:26.320</a></span> | <span class="t">at all so basically three columns we care about this is a user id so maybe 196 is Jeremy and maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3814" target="_blank">01:03:34.880</a></span> | <span class="t">186 is Rachel and 22 is John I don't know um maybe this movie is Return of the Jedi and this one's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3824" target="_blank">01:03:44.480</a></span> | <span class="t">Casablanca this one's LA Confidential and then this rating says how did Jeremy feel about Return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3831" target="_blank">01:03:51.600</a></span> | <span class="t">of the Jedi he gave it a three out of five that's how we can read this data set um this kind of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3840" target="_blank">01:04:00.000</a></span> | <span class="t">is very common uh anytime you've got a user and a product or service and you might not even have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3851" target="_blank">01:04:11.040</a></span> | <span class="t">ratings maybe just the fact that they bought that product you could have a similar table with zeros</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3856" target="_blank">01:04:16.400</a></span> | <span class="t">and ones um so for example um uh Radek who's in the audience here is now at nvidia doing like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3866" target="_blank">01:04:26.960</a></span> | <span class="t">basically does this right recommendation systems so recommendation systems you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3871" target="_blank">01:04:31.120</a></span> | <span class="t">it's it's a huge industry um and so what we're learning today is you know a really key foundation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3877" target="_blank">01:04:37.600</a></span> | <span class="t">of it um so these are the first few rows this is not a particularly great way to see it i prefer to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3886" target="_blank">01:04:46.560</a></span> | <span class="t">kind of cross tabulate it like that like this this is the same information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3891" target="_blank">01:04:51.600</a></span> | <span class="t">uh so for each movie for each user here's the rating so user 212 never watched movie 49</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3899" target="_blank">01:04:59.600</a></span> | <span class="t">now if you're wondering uh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3903" target="_blank">01:05:03.760</a></span> | <span class="t">why there's so few empty cells here i actually grabbed the the most watched movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3913" target="_blank">01:05:13.280</a></span> | <span class="t">and the most movie watching users for this particular sample matrix so that's why it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3919" target="_blank">01:05:19.600</a></span> | <span class="t">particularly full so yeah so this is what kind of a collaborative filtering data set looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3926" target="_blank">01:05:26.560</a></span> | <span class="t">when we cross tabulate it so how do we fill in this gap so maybe user 212 is nick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3938" target="_blank">01:05:38.400</a></span> | <span class="t">and movie 49 what's the movie you haven't seen nick and you'd quite like to maybe not sure about it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3947" target="_blank">01:05:47.280</a></span> | <span class="t">the new elvis movie baz limon good choice australian director filmed in queen's land</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3952" target="_blank">01:05:52.640</a></span> | <span class="t">yeah okay so that's movie two and that's movie number 49 so is nick gonna like the new elvis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3960" target="_blank">01:06:00.720</a></span> | <span class="t">movie well to figure this out what we could do ideally would like to know for each movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3975" target="_blank">01:06:15.680</a></span> | <span class="t">what kind of movie is it like what are the kind of features of it is it like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3979" target="_blank">01:06:19.760</a></span> | <span class="t">actiony science fictiony dialogue driven critical acclaimed you know um so let's say for example we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3988" target="_blank">01:06:28.480</a></span> | <span class="t">were trying to look at the last guy walker maybe that was the movie the nick's wondering about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=3993" target="_blank">01:06:33.600</a></span> | <span class="t">watching and so if we like had three categories being science fiction action or kind of classic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4003" target="_blank">01:06:43.120</a></span> | <span class="t">old movies would say the last guy walker is very science fiction let's see this is from like negative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4008" target="_blank">01:06:48.240</a></span> | <span class="t">one to one pretty action definitely not an old classic or at least not yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4015" target="_blank">01:06:55.760</a></span> | <span class="t">and so then maybe we then could say like okay well maybe like nick's tastes in movies are that he</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4026" target="_blank">01:07:06.640</a></span> | <span class="t">really likes science fiction quite likes action movies and doesn't really like old classics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4032" target="_blank">01:07:12.480</a></span> | <span class="t">right so then we could kind of like match these up to see how much we think this user might like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4039" target="_blank">01:07:19.840</a></span> | <span class="t">this movie to calculate the match we could just multiply the corresponding values user one times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4049" target="_blank">01:07:29.600</a></span> | <span class="t">last guy walker and add them up point nine times point nine eight plus point eight times point nine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4054" target="_blank">01:07:34.800</a></span> | <span class="t">plus negative point six times negative point nine that's going to give us a pretty high number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4059" target="_blank">01:07:39.280</a></span> | <span class="t">right with a maximum of three so that would suggest nick probably would like the last guy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4065" target="_blank">01:07:45.680</a></span> | <span class="t">walker on the other hand the movie casablanca we would say definitely not very science fiction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4075" target="_blank">01:07:55.680</a></span> | <span class="t">not really very action definitely very old classic so then we'd do exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4081" target="_blank">01:08:01.520</a></span> | <span class="t">calculation and get this negative result here so you probably wouldn't like casablanca</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4088" target="_blank">01:08:08.720</a></span> | <span class="t">this thing here when we multiply the corresponding parts of a vector together and add them up is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4096" target="_blank">01:08:16.240</a></span> | <span class="t">called a dot product in math so this is the dot product of the user's preferences and the type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4105" target="_blank">01:08:25.040</a></span> | <span class="t">of movie now the problem is we weren't given that information we know nothing about these users</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4113" target="_blank">01:08:33.600</a></span> | <span class="t">or about the movies so what are we going to do we want to try to create these factors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4122" target="_blank">01:08:42.320</a></span> | <span class="t">without knowing ahead of time what they are we wouldn't even know what factors to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4129" target="_blank">01:08:49.440</a></span> | <span class="t">what are the things that really matters when it just people decide what movies they want to watch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4133" target="_blank">01:08:53.680</a></span> | <span class="t">what we can do is we can create things called latent factors latent factors is this weird idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4140" target="_blank">01:09:00.160</a></span> | <span class="t">that we can say i don't know what things about movies matter to people but there's probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4147" target="_blank">01:09:07.600</a></span> | <span class="t">something and let's just try like using sgd to find them and we can do it and everybody's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4159" target="_blank">01:09:19.760</a></span> | <span class="t">favorite mathematical optimization software microsoft xl so here is that table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4171" target="_blank">01:09:31.760</a></span> | <span class="t">and what we can do let's head over here actually here's that table so what we could do is we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4182" target="_blank">01:09:42.640</a></span> | <span class="t">say for each of those movies so let's say for movie 27 let's assume there are five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4189" target="_blank">01:09:49.920</a></span> | <span class="t">latent factors i don't know what they're for they're just five latent factors we'll figure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4197" target="_blank">01:09:57.760</a></span> | <span class="t">them out later and for now i certainly don't know what the value of those five latent factors for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4203" target="_blank">01:10:03.920</a></span> | <span class="t">movie 27 so we're going to just chuck a little random numbers in them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4211" target="_blank">01:10:11.120</a></span> | <span class="t">and we're going to do the same thing for movie 49 pick another five random numbers and the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4216" target="_blank">01:10:16.000</a></span> | <span class="t">thing for movie 57 pick another five numbers and you might not be surprised to hear we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4221" target="_blank">01:10:21.840</a></span> | <span class="t">going to do the same thing for each user so for user 14 we're going to pick five random numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4227" target="_blank">01:10:27.840</a></span> | <span class="t">for them and for user 29 we'll pick five random numbers for them and so the idea is that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4234" target="_blank">01:10:34.800</a></span> | <span class="t">number here 0.19 is saying if it was true that user id 14 feels not very strongly about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4244" target="_blank">01:10:44.960</a></span> | <span class="t">factor that for movie 27 has a value of 0.71 so therefore in here we do the dot product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4252" target="_blank">01:10:52.960</a></span> | <span class="t">the details of why i don't matter too much but well actually you can figure this out from what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4260" target="_blank">01:11:00.640</a></span> | <span class="t">we've said so far if you go back to our definition of matrix product you might notice that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4267" target="_blank">01:11:07.040</a></span> | <span class="t">matrix product of a row with a column is the same thing as a dot product and so here in excel i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4275" target="_blank">01:11:15.760</a></span> | <span class="t">have a row in a column so therefore i say matrix multiply that by that that gives us the dot product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4281" target="_blank">01:11:21.280</a></span> | <span class="t">so here's the dot product of that by that or the matrix multiply given that they're row and column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4289" target="_blank">01:11:29.680</a></span> | <span class="t">the only other slight quirk here is that if the actual rating is zero is empty i'm just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4301" target="_blank">01:11:41.360</a></span> | <span class="t">leave it blank i'm going to set it to zero actually so here is everybody's rating predicted rating of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4312" target="_blank">01:11:52.240</a></span> | <span class="t">movies i say predicted of course these are currently random numbers so they are terrible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4317" target="_blank">01:11:57.920</a></span> | <span class="t">predictions but when we have some way to predict things and we start with terrible random predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4323" target="_blank">01:12:03.920</a></span> | <span class="t">we know how to make them better don't we we use stochastic gradient descent now to do that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4330" target="_blank">01:12:10.160</a></span> | <span class="t">going to need a loss function so that's easy enough we can just calculate the sum of x minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4339" target="_blank">01:12:19.520</a></span> | <span class="t">y squared divided by the count that is the mean squared error and if we take the square root that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4345" target="_blank">01:12:25.680</a></span> | <span class="t">is the root mean squared error so here is the root mean squared error in excel between these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4352" target="_blank">01:12:32.880</a></span> | <span class="t">predictions and these axials and so now that we have a loss function we can optimize it data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4363" target="_blank">01:12:43.040</a></span> | <span class="t">solver set objective this one here by changing cells these ones here and these ones here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4376" target="_blank">01:12:56.400</a></span> | <span class="t">solve okay and initially our loss is 2.81 so we hope it's going to go down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4388" target="_blank">01:13:08.720</a></span> | <span class="t">and as it solves not a great choice of background color but it says 0.68 so this number is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4394" target="_blank">01:13:14.720</a></span> | <span class="t">down so this is using um actually in excel it's not quite using stochastic gradient descent because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4402" target="_blank">01:13:22.640</a></span> | <span class="t">excel doesn't know how to calculate gradients there are actually optimization techniques that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4407" target="_blank">01:13:27.440</a></span> | <span class="t">don't need gradients they calculate them numerically as they go but that's a minor quirk um one thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4414" target="_blank">01:13:34.640</a></span> | <span class="t">you'll notice is it's doing it very very slowly um there's not much data here and it's still going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4420" target="_blank">01:13:40.640</a></span> | <span class="t">um one reason for that is that if it's because it's not using gradients it's much slower and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4427" target="_blank">01:13:47.200</a></span> | <span class="t">the second is excel is much slower than pythage anyway it's come up with an answer and look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4433" target="_blank">01:13:53.520</a></span> | <span class="t">that it's got to 0.42 so it's got a pretty good prediction and so we can kind of get a sense of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4442" target="_blank">01:14:02.480</a></span> | <span class="t">this for example um looking at the last three movie uh user 14 likes dislikes likes let's see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4458" target="_blank">01:14:18.240</a></span> | <span class="t">somebody else like that here's somebody else this person likes dislikes likes so based on our kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4465" target="_blank">01:14:25.440</a></span> | <span class="t">of approach we're saying okay since they have the same feeling about these three movies maybe they'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4470" target="_blank">01:14:30.160</a></span> | <span class="t">feel the same about these three movies so this person likes all three of those movies and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4475" target="_blank">01:14:35.440</a></span> | <span class="t">this person likes two out of three of them so you know you kind of this is the idea right as if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4482" target="_blank">01:14:42.240</a></span> | <span class="t">somebody says to you i like this movie this movie this movie and you're like oh they like those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4486" target="_blank">01:14:46.560</a></span> | <span class="t">movies too what other movies do you like and they'll say oh how about this there's a chance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4491" target="_blank">01:14:51.760</a></span> | <span class="t">good chance that you're going to like the same thing that's the basis of collaborative filtering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4496" target="_blank">01:14:56.640</a></span> | <span class="t">okay um it's and and mathematically we call this matrix completion so this matrix is missing values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4504" target="_blank">01:15:04.560</a></span> | <span class="t">we just want to complete them so the core of collaborative filtering is it's a matrix completion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4510" target="_blank">01:15:10.560</a></span> | <span class="t">exercise can you grab a microphone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4522" target="_blank">01:15:22.800</a></span> | <span class="t">my question was is with um the dot products right so if we think about the math of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4528" target="_blank">01:15:28.640</a></span> | <span class="t">for a minute is yeah if we think about the cosine of the angle between the two vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4533" target="_blank">01:15:33.040</a></span> | <span class="t">that's going to roughly approximate the correlation is that essentially what's going on here in one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4538" target="_blank">01:15:38.480</a></span> | <span class="t">sense with the way that we're so is the cosine of the angle between the vectors much the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4543" target="_blank">01:15:43.680</a></span> | <span class="t">as the dot product um the answer is yes um they're the same once you normalize them so yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4551" target="_blank">01:15:51.360</a></span> | <span class="t">um is that still on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4554" target="_blank">01:15:54.480</a></span> | <span class="t">it's correlation what we're doing here at scale as well yeah you can yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4562" target="_blank">01:16:02.000</a></span> | <span class="t">you can think of it that way okay cool um now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4567" target="_blank">01:16:07.840</a></span> | <span class="t">this looks pretty different to how pytorch looks pytorch has things in rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4578" target="_blank">01:16:18.160</a></span> | <span class="t">right we've got a user a movie rating user movie rating right so how do we do the same kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4585" target="_blank">01:16:25.520</a></span> | <span class="t">thing in pytorch so let's do the same kind of thing in excel but using the table in the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4591" target="_blank">01:16:31.760</a></span> | <span class="t">format that pytorch has it okay so to do that in excel the first thing i'm going to do is i'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4598" target="_blank">01:16:38.560</a></span> | <span class="t">going to see okay this i've got to look at user number 14 and i want to know what index like how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4606" target="_blank">01:16:46.080</a></span> | <span class="t">far down this list is 14 okay so we'll just match means find the index so this is user index one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4611" target="_blank">01:16:51.520</a></span> | <span class="t">and then what i'm going to do is i'm going to say the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4617" target="_blank">01:16:57.040</a></span> | <span class="t">these five numbers is basically i want to find row one over here and in excel that's called offset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4627" target="_blank">01:17:07.920</a></span> | <span class="t">so we're going to offset from here by one row and so you can see here it is 0.19 0.63 0.19 0.63 etc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4638" target="_blank">01:17:18.400</a></span> | <span class="t">right so here's the second user 0.25 0.03 etc and we can do the same thing for movies right so movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4647" target="_blank">01:17:27.920</a></span> | <span class="t">four one seven is index 14 that's going to be 0.75 0.47 etc and so same thing right but now we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4658" target="_blank">01:17:38.960</a></span> | <span class="t">going to offset from here by 14 to get this row which is 0.75 0.47 etc and so the prediction now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4674" target="_blank">01:17:54.080</a></span> | <span class="t">is the dot product is called sum product in excel this is sum product of those two things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4681" target="_blank">01:18:01.760</a></span> | <span class="t">so this is exactly the same as we had before right but when we kind of put everything next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4688" target="_blank">01:18:08.400</a></span> | <span class="t">to each other we have to like manually look up the index and so then for each one we can calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4696" target="_blank">01:18:16.400</a></span> | <span class="t">the error squared prediction minus rating squared and then we could add those all up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4702" target="_blank">01:18:22.960</a></span> | <span class="t">and if you remember this is actually the same root mean squared error we had before we optimized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4707" target="_blank">01:18:27.280</a></span> | <span class="t">before 2.81 because we've got the same numbers as before and so this is mathematically identical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4713" target="_blank">01:18:33.760</a></span> | <span class="t">so what's this weird word up here embedding you've probably heard it before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4721" target="_blank">01:18:41.200</a></span> | <span class="t">and you might have come across the impression it's some very complex fancy mathematical thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4727" target="_blank">01:18:47.760</a></span> | <span class="t">but actually it turns out that it is just looking something up in an array that is what an embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4734" target="_blank">01:18:54.720</a></span> | <span class="t">is so we call this an embedding matrix and these are our user embeddings and our movie embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4751" target="_blank">01:19:11.440</a></span> | <span class="t">so let's take a look at that in pytorch and you know at this point if you've heard about embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4757" target="_blank">01:19:17.920</a></span> | <span class="t">before you might be thinking that can't be it and yeah it's just as complex as the rectified</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4765" target="_blank">01:19:25.520</a></span> | <span class="t">linear unit which turned out to be replaced negatives with zeros embedding actually means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4771" target="_blank">01:19:31.600</a></span> | <span class="t">look something up in an array so there's a lot of things that we use as deep learning practitioners</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4777" target="_blank">01:19:37.520</a></span> | <span class="t">to try to make you as intimidated as possible so that you don't wander into our territory and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4785" target="_blank">01:19:45.200</a></span> | <span class="t">start winning our kaggle competitions and unfortunately once you discover the simplicity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4789" target="_blank">01:19:49.920</a></span> | <span class="t">of it you might start to think that you can do it yourself and then it turns out you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4794" target="_blank">01:19:54.240</a></span> | <span class="t">so yeah that's what basically it turns out pretty much all of this jargon turns out to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4803" target="_blank">01:20:03.280</a></span> | <span class="t">so we're going to try to learn these latent factors which is exactly what we just did in excel we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4810" target="_blank">01:20:10.560</a></span> | <span class="t">learned the latent factors all right so if we're going to learn things in pytorch we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4818" target="_blank">01:20:18.400</a></span> | <span class="t">need data loaders one thing i did is there is actually a movies table as well with the names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4826" target="_blank">01:20:26.880</a></span> | <span class="t">of the movies so i merged that together with the ratings so that then we've now got the user id and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4833" target="_blank">01:20:33.120</a></span> | <span class="t">the actual name of the movie we don't need that obviously for the model but it's just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4836" target="_blank">01:20:36.880</a></span> | <span class="t">make it a bit more fun to interpret later so this is called ratings we have something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4846" target="_blank">01:20:46.080</a></span> | <span class="t">collaborative data loaders so collaborative filtering data loaders and we can get that from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4850" target="_blank">01:20:50.560</a></span> | <span class="t">a data frame by passing in the data frame and it expects a user column and an item column so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4858" target="_blank">01:20:58.960</a></span> | <span class="t">user column is what it sounds like the the person that is rating this thing and the item column is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4864" target="_blank">01:21:04.880</a></span> | <span class="t">the product or service that they're rating in our case the user column is called user so we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4869" target="_blank">01:21:09.680</a></span> | <span class="t">have to pass that in and the item column is called title so we do have to pass this in because by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4876" target="_blank">01:21:16.000</a></span> | <span class="t">default the user column should be called user and the item column will be called item give it a batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4882" target="_blank">01:21:22.560</a></span> | <span class="t">size and as usual we can call show batch and so here's our data loaders a batch of data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4892" target="_blank">01:21:32.240</a></span> | <span class="t">or at least a bit of it and so now that since we talk about the names we actually get to see the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4900" target="_blank">01:21:40.000</a></span> | <span class="t">names which is nice all right so now we're going to create the user factors and movie factors i.e.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4914" target="_blank">01:21:54.400</a></span> | <span class="t">this one and this one so the number of rows of the movie factors will be equal to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4924" target="_blank">01:22:04.800</a></span> | <span class="t">number of movies and the number of rows of the user factors will be equal to the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4929" target="_blank">01:22:09.120</a></span> | <span class="t">users and the number of columns will be whatever we want however many factors we want to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4934" target="_blank">01:22:14.800</a></span> | <span class="t">john this might be a pertinent time to jump in with a question any comments about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4942" target="_blank">01:22:22.960</a></span> | <span class="t">choosing the number of factors um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4945" target="_blank">01:22:25.200</a></span> | <span class="t">um not really um we um we have defaults that we use for embeddings in fastai</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4958" target="_blank">01:22:38.160</a></span> | <span class="t">um it's a very obscure formula and people often ask me for like the mathematical derivation of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4964" target="_blank">01:22:44.880</a></span> | <span class="t">where it came from but what actually happened is it's i wrote down how many factors i think is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4970" target="_blank">01:22:50.240</a></span> | <span class="t">appropriate for different size categories on a piece of paper in a table well actually in excel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4975" target="_blank">01:22:55.520</a></span> | <span class="t">and then i fitted a function to that and that's the function so it's basically a mathematical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4980" target="_blank">01:23:00.480</a></span> | <span class="t">function that fits my intuition about what works well um but it seems to work pretty well i said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4986" target="_blank">01:23:06.000</a></span> | <span class="t">it used in lots of other places now lots of papers will be like using fastai's rule of thumb for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=4991" target="_blank">01:23:11.840</a></span> | <span class="t">embedding sizes here's the formula cool thank you um it's pretty fast to train these things so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5000" target="_blank">01:23:20.880</a></span> | <span class="t">can try a few so we're going to create um so the number of users is just the length of how many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5008" target="_blank">01:23:28.400</a></span> | <span class="t">users there are number of movies is the length of how many titles there are so create a matrix of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5013" target="_blank">01:23:33.200</a></span> | <span class="t">random numbers of users by five and movies of movies by five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5019" target="_blank">01:23:39.600</a></span> | <span class="t">and now we need to look up the index of the movie in our movie latent factor matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5028" target="_blank">01:23:48.240</a></span> | <span class="t">um the thing is when we've learned about deep learning we learned that we do matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5036" target="_blank">01:23:56.160</a></span> | <span class="t">multiplications not look something up in a matrix in an array so in excel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5044" target="_blank">01:24:04.240</a></span> | <span class="t">we were saying offset which is to say find element number 14 and the table which that's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5055" target="_blank">01:24:15.600</a></span> | <span class="t">a matrix multiply how does that work well actually it is um it actually is for the same reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5066" target="_blank">01:24:26.400</a></span> | <span class="t">that we talked about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5068" target="_blank">01:24:28.560</a></span> | <span class="t">here which is we can represent find the element number one thing in this list is actually the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5081" target="_blank">01:24:41.920</a></span> | <span class="t">same as multiplying by a one hot encoded matrix so remember how if we let's just take off the log</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5092" target="_blank">01:24:52.240</a></span> | <span class="t">for a moment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5098" target="_blank">01:24:58.560</a></span> | <span class="t">look this is returned 0.87 um and particularly if i take the negative off here if i add this up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5105" target="_blank">01:25:05.680</a></span> | <span class="t">this is 0.87 which is the result of finding the index number one thing in this list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5112" target="_blank">01:25:12.880</a></span> | <span class="t">but we didn't do it that way we did this by taking the dot product of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5120" target="_blank">01:25:20.240</a></span> | <span class="t">sorry of this and this but that's actually the same thing taking the dot product of a one hot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5128" target="_blank">01:25:28.480</a></span> | <span class="t">encoded vector with something is the same as looking up this index in the vector so that means that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5139" target="_blank">01:25:39.280</a></span> | <span class="t">this exercise here of looking up the 14th thing is the same as doing a matrix multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5148" target="_blank">01:25:48.800</a></span> | <span class="t">with a one hot encoded vector and we can see that here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5153" target="_blank">01:25:53.120</a></span> | <span class="t">this is how we create a one hot encoded vector of length and users in which the third element is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5163" target="_blank">01:26:03.760</a></span> | <span class="t">set to one and everything else is zero and if we multiply that so at means do you remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5171" target="_blank">01:26:11.200</a></span> | <span class="t">matrix multiply in python so if we multiply that by our user factors we get back this answer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5178" target="_blank">01:26:18.640</a></span> | <span class="t">and if we just ask for user factors number three we get back the exact same answer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5183" target="_blank">01:26:23.840</a></span> | <span class="t">they're the same thing so you can think of an embedding as being a computational shortcut</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5193" target="_blank">01:26:33.680</a></span> | <span class="t">for multiplying something by a one hot encoded vector and so if you think back to what we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5200" target="_blank">01:26:40.400</a></span> | <span class="t">with dummy variables right this basically means embeddings are like a cool math trick for speeding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5210" target="_blank">01:26:50.320</a></span> | <span class="t">up doing matrix multipliers with dummy variables not just speeding up we never even have to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5214" target="_blank">01:26:54.880</a></span> | <span class="t">the dummy variables we never have to create the one hot encoded vectors we can just look up in an array</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5222" target="_blank">01:27:02.480</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5228" target="_blank">01:27:08.480</a></span> | <span class="t">all right so we're now ready to build a collaborative filtering model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5237" target="_blank">01:27:17.440</a></span> | <span class="t">and we're going to create one from scratch and as we've discussed before in PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5249" target="_blank">01:27:29.120</a></span> | <span class="t">a model is a class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5252" target="_blank">01:27:32.880</a></span> | <span class="t">and so we briefly touched on this but i've got to touch on it again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5259" target="_blank">01:27:39.040</a></span> | <span class="t">this is how we create a class in python you give it a name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5266" target="_blank">01:27:46.080</a></span> | <span class="t">and then you say how to initialize it how to construct it so in python remember they call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5273" target="_blank">01:27:53.280</a></span> | <span class="t">these things dunder whatever this is dunder edit these are magic methods that python will call for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5280" target="_blank">01:28:00.400</a></span> | <span class="t">you at certain times the the method called dunder edit is called when you create an object of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5290" target="_blank">01:28:10.400</a></span> | <span class="t">class so we could pass it a value and so now we set the attribute called a equal to that value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5300" target="_blank">01:28:20.240</a></span> | <span class="t">and so then later on we could call a method called say that will say hello to whatever you passed in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5307" target="_blank">01:28:27.600</a></span> | <span class="t">here and this is what it will say so for example if you construct an object of type example passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5315" target="_blank">01:28:35.600</a></span> | <span class="t">in silver self.a now equals silver so if you say use the dot method the dot say method nice to meet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5324" target="_blank">01:28:44.400</a></span> | <span class="t">you x is now nice to meet you so it will say hello silver nice to meet you so that's that's kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5334" target="_blank">01:28:54.480</a></span> | <span class="t">all you need to know about object-oriented programming in PyTorch to create a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5340" target="_blank">01:29:00.640</a></span> | <span class="t">oh there is one more thing we need to know sorry which is you can put something in parentheses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5348" target="_blank">01:29:08.560</a></span> | <span class="t">after your class name and that's called the superclass it's basically gonna give you some stuff for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5356" target="_blank">01:29:16.080</a></span> | <span class="t">free give you some functionality for free and if you create a model in PyTorch you have to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5364" target="_blank">01:29:24.320</a></span> | <span class="t">module your superclass this is actually fastai's version of module but it's nearly the same as PyTorches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5373" target="_blank">01:29:33.520</a></span> | <span class="t">so when we create this dot product object it's going to call dunder in it and we have to say well how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5379" target="_blank">01:29:39.600</a></span> | <span class="t">many users are going to be in our model and how many movies and how many factors and so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5385" target="_blank">01:29:45.920</a></span> | <span class="t">now create an embedding of users by factors for users and an embedding of movies by factors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5393" target="_blank">01:29:53.120</a></span> | <span class="t">for movies and so then PyTorch does something quite magic which is that if you create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5403" target="_blank">01:30:03.120</a></span> | <span class="t">dot product object like so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5407" target="_blank">01:30:07.200</a></span> | <span class="t">it then you can treat it like a function you can call it and I can calculate values on it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5414" target="_blank">01:30:14.560</a></span> | <span class="t">and when you do that it's really important to know PyTorch is going to call a method called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5421" target="_blank">01:30:21.360</a></span> | <span class="t">forward in your class so this is where you put your calculation of your model it has to be called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5426" target="_blank">01:30:26.400</a></span> | <span class="t">forward and it's going to be past the object itself and the thing you're calculating on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5433" target="_blank">01:30:33.520</a></span> | <span class="t">in this case the user and movie for a batch so this is your batch of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5444" target="_blank">01:30:44.800</a></span> | <span class="t">each row will be one user and movie combination and the columns will be users and movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5453" target="_blank">01:30:53.440</a></span> | <span class="t">so we can grab the first column right so this is every row of the first column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5460" target="_blank">01:31:00.240</a></span> | <span class="t">and look it up in the user factors embedding to get our users embeddings so that is the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5469" target="_blank">01:31:09.120</a></span> | <span class="t">as doing this let's say this is one mini batch and then we do exactly the same thing for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5476" target="_blank">01:31:16.960</a></span> | <span class="t">second column passing it into our movie factors to look up the movie embeddings and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5485" target="_blank">01:31:25.120</a></span> | <span class="t">take the dot product them equals one because we're summing across the columns for each row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5494" target="_blank">01:31:34.160</a></span> | <span class="t">we're calculating a prediction for each row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5499" target="_blank">01:31:39.360</a></span> | <span class="t">so once we've got that we can pass it to a learner passing in our data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5507" target="_blank">01:31:47.760</a></span> | <span class="t">and our model and our loss function means squared error and we can call fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5514" target="_blank">01:31:54.400</a></span> | <span class="t">and away it goes and this by the way is running on cpu now these are very fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5526" target="_blank">01:32:06.160</a></span> | <span class="t">to run so this is doing 100 000 rows in 10 seconds which is a whole lot faster than our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5532" target="_blank">01:32:12.880</a></span> | <span class="t">few dozen rows in excel and so you can see the loss going down and so we've trained a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5549" target="_blank">01:32:29.840</a></span> | <span class="t">it's not going to be a great model and one of the problems is that let's see if we can see this in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5557" target="_blank">01:32:37.200</a></span> | <span class="t">eric cell one look at this one here this prediction is bigger than five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5565" target="_blank">01:32:45.280</a></span> | <span class="t">but nothing's bigger than five so that seems like a problem we're predicting things that are bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5573" target="_blank">01:32:53.200</a></span> | <span class="t">than the highest possible number and in fact these are very much movie enthusiasts that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5581" target="_blank">01:33:01.040</a></span> | <span class="t">nobody gave anything a one yeah nobody even gave anything a one here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5587" target="_blank">01:33:07.840</a></span> | <span class="t">do you remember when we learned about sigmoid the idea of squishing things between zero and one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5596" target="_blank">01:33:16.080</a></span> | <span class="t">we could do stuff still without a sigmoid but when we added a sigmoid it trained better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5601" target="_blank">01:33:21.600</a></span> | <span class="t">because the model didn't have to work so hard to get it kind of into the right zone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5604" target="_blank">01:33:24.960</a></span> | <span class="t">now if you think about it if you take something and put it through a sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5609" target="_blank">01:33:29.600</a></span> | <span class="t">and then multiply it by five now you've got something that's going to be between zero and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5614" target="_blank">01:33:34.800</a></span> | <span class="t">five used to have something which is between zero and one so we could do that in fact we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5621" target="_blank">01:33:41.280</a></span> | <span class="t">that in excel i'll leave that as an exercise to the reader let's do it over here in pytorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5630" target="_blank">01:33:50.080</a></span> | <span class="t">so if we take the exact same class as before and this time we call sigmoid range and so sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5639" target="_blank">01:33:59.920</a></span> | <span class="t">range is something which will take our prediction and then squash it into our range and by default</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5649" target="_blank">01:34:09.280</a></span> | <span class="t">we'll use a range of zero through to 5.5 so it can't be smaller than zero it can't be bigger than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5654" target="_blank">01:34:14.880</a></span> | <span class="t">5.5 why don't i use five that's because a sigmoid can never hit one right and a sigmoid times five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5663" target="_blank">01:34:23.760</a></span> | <span class="t">can never hit five but some people do give things movies five so you want to make it a bit bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5669" target="_blank">01:34:29.040</a></span> | <span class="t">than our highest so this one got a loss of 0.8628 86 oh it's not better isn't that always the way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5683" target="_blank">01:34:43.120</a></span> | <span class="t">all right didn't actually help doesn't always so be it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5685" target="_blank">01:34:45.760</a></span> | <span class="t">um let's keep trying to improve it um let me show you something i noticed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5693" target="_blank">01:34:53.840</a></span> | <span class="t">um some of the users like this one this person here just loved movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5706" target="_blank">01:35:06.320</a></span> | <span class="t">they give nearly everything a four or five their worst score is a three all right this person oh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5713" target="_blank">01:35:13.040</a></span> | <span class="t">here's a one this person's got much more range some things are twos some ones some fives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5718" target="_blank">01:35:18.640</a></span> | <span class="t">um this person doesn't seem to like movies very much considering how many they watch nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5725" target="_blank">01:35:25.280</a></span> | <span class="t">gets a five they've got discerning tastes i guess at the moment we don't have any way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5733" target="_blank">01:35:33.520</a></span> | <span class="t">in our kind of formulation of this model to say this user tends to give low scores and this user</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5741" target="_blank">01:35:41.840</a></span> | <span class="t">tends to give high scores there's just nothing like that right but that would be very easy to add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5747" target="_blank">01:35:47.600</a></span> | <span class="t">let's add one more number to our five factors just here for each user</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5760" target="_blank">01:36:00.000</a></span> | <span class="t">and now rather than doing just the matrix multiply let's add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5765" target="_blank">01:36:05.920</a></span> | <span class="t">oh it's actually the top one let's add this number to it h19</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5776" target="_blank">01:36:16.000</a></span> | <span class="t">and so for this one let's add i19 to it yeah so i've got it wrong this one here so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5784" target="_blank">01:36:24.800</a></span> | <span class="t">this row here we're going to add to each rating and then we're going to do the same thing here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5794" target="_blank">01:36:34.480</a></span> | <span class="t">each movie's now got an extra number here that again we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5802" target="_blank">01:36:42.640</a></span> | <span class="t">add a26 so it's our matrix multiplication plus we call it the bias the user bias plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5813" target="_blank">01:36:53.600</a></span> | <span class="t">the movie bias so effectively that's like making it so we don't have an intercept of zero anymore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5819" target="_blank">01:36:59.120</a></span> | <span class="t">and so if we now train this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5824" target="_blank">01:37:04.080</a></span> | <span class="t">data solver solve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5832" target="_blank">01:37:12.640</a></span> | <span class="t">so previously we got to 0.42 okay and so we're going to let that go along for a while</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5841" target="_blank">01:37:21.840</a></span> | <span class="t">and then let's also go back and look at the pytorch version so for pytorch now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5847" target="_blank">01:37:27.280</a></span> | <span class="t">we're going to have a user bias which is an embedding of n users by one right remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5854" target="_blank">01:37:34.960</a></span> | <span class="t">there was just one number for each user and movie bias is an embedding of n movies also by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5863" target="_blank">01:37:43.120</a></span> | <span class="t">and so we can now look up the user embedding the movie embedding do the dot product and then look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5873" target="_blank">01:37:53.120</a></span> | <span class="t">up the user bias and the movie bias and add them chuck that through the sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5881" target="_blank">01:38:01.200</a></span> | <span class="t">let's train that so if we beat 0.865</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5891" target="_blank">01:38:11.280</a></span> | <span class="t">wow we're not training very well are we still not too great 0.894</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5895" target="_blank">01:38:15.520</a></span> | <span class="t">i think excel normally does do better though let's see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5898" target="_blank">01:38:18.480</a></span> | <span class="t">okay excel oh excel's done a lot better it's going from 0.42 to 0.35</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5906" target="_blank">01:38:26.320</a></span> | <span class="t">okay so what happened here why did it get worse well look at this the valid loss got better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5921" target="_blank">01:38:41.600</a></span> | <span class="t">and then it started getting worse again so we think we might be overfitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5926" target="_blank">01:38:46.880</a></span> | <span class="t">which you know we have got a lot of parameters in our embeddings so how do we avoid overfitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5938" target="_blank">01:38:58.720</a></span> | <span class="t">so a classic way to avoid overfitting is to use something called wait decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5947" target="_blank">01:39:07.680</a></span> | <span class="t">also known as l2 regularization which sounds much more fancy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5952" target="_blank">01:39:12.960</a></span> | <span class="t">what we're going to do is when we can compute the gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5960" target="_blank">01:39:20.560</a></span> | <span class="t">we're going to first add to our loss function the sum of the weights squared this is something you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5970" target="_blank">01:39:30.000</a></span> | <span class="t">should go back and add to your titanic model not that it's overfitting but just to try it right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5974" target="_blank">01:39:34.960</a></span> | <span class="t">so previously our gradients have just been and our loss function has just been about the difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5983" target="_blank">01:39:43.360</a></span> | <span class="t">between our predictions and our actuals right and so our gradients were based on the derivative of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5989" target="_blank">01:39:49.040</a></span> | <span class="t">that with respect to the derivative of that with respect to the coefficients but we're saying now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=5996" target="_blank">01:39:56.400</a></span> | <span class="t">let's add the sum of the square of the weights times some small number so what would make that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6006" target="_blank">01:40:06.880</a></span> | <span class="t">loss function go down that loss function would go down if we reduce our weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6012" target="_blank">01:40:12.240</a></span> | <span class="t">for example if we reduce all of our weights to zero i should say we reduce the magnitude of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6021" target="_blank">01:40:21.440</a></span> | <span class="t">weights if we reduce the amount of zero that part of the loss function will be zero because the sum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6028" target="_blank">01:40:28.000</a></span> | <span class="t">of zero squared is zero now problem is if our weights are all zero our model doesn't do anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6034" target="_blank">01:40:34.480</a></span> | <span class="t">right so we'd have crappy predictions so it would want to increase the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6040" target="_blank">01:40:40.240</a></span> | <span class="t">so that's actually predicting something useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6047" target="_blank">01:40:47.200</a></span> | <span class="t">but if it increases the weights too much then it starts overfitting so how is it going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6053" target="_blank">01:40:53.680</a></span> | <span class="t">actually get the lowest possible value of the loss function by finding the right mix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6058" target="_blank">01:40:58.800</a></span> | <span class="t">weights not too high right but high enough to be useful at predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6064" target="_blank">01:41:04.000</a></span> | <span class="t">if there's some parameter that's not useful for example say we asked for five factors and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6073" target="_blank">01:41:13.600</a></span> | <span class="t">only need four it can just set the weights for the fifth factor to zero right and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6080" target="_blank">01:41:20.000</a></span> | <span class="t">problem solved right it won't be used to predict anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6085" target="_blank">01:41:25.120</a></span> | <span class="t">but it also won't contribute to our weight decay part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6089" target="_blank">01:41:29.840</a></span> | <span class="t">so previously we had something calculating the loss function so now we're going to do exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6101" target="_blank">01:41:41.920</a></span> | <span class="t">the same thing but we're going to square the parameters we're going to sum them up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6106" target="_blank">01:41:46.480</a></span> | <span class="t">and we're going to multiply them by some small number like 0.01 or 0.001</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6112" target="_blank">01:41:52.560</a></span> | <span class="t">um and in fact we don't even need to do this because remember the whole purpose of the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6123" target="_blank">01:42:03.200</a></span> | <span class="t">is to take its gradient right and to print it out um the gradient of parameters squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6132" target="_blank">01:42:12.480</a></span> | <span class="t">is two times parameters it's okay if you don't remember that from high school but the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6137" target="_blank">01:42:17.120</a></span> | <span class="t">you can take my word for it the gradient of y equals x squared is 2x so actually all we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6145" target="_blank">01:42:25.920</a></span> | <span class="t">to do is take our gradient and add the weight decay coefficient 0.01 or whatever times two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6153" target="_blank">01:42:33.680</a></span> | <span class="t">times parameters and given this is just number some number we get to pick we might as well fold</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6158" target="_blank">01:42:38.880</a></span> | <span class="t">the two into it and just get rid of it so when you call fit you can pass in a wd parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6168" target="_blank">01:42:48.000</a></span> | <span class="t">which does adds this times the parameters to the gradient for you and so that's going to ask the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6177" target="_blank">01:42:57.040</a></span> | <span class="t">model it's going to say to the model please don't make the the weights any bigger than they have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6181" target="_blank">01:43:01.440</a></span> | <span class="t">be and yay finally our loss actually improved okay you can see getting better and better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6196" target="_blank">01:43:16.320</a></span> | <span class="t">in fastai applications like vision we try to set this for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6201" target="_blank">01:43:21.120</a></span> | <span class="t">appropriately and we generally do a reasonably good job just the defaults are normally fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6206" target="_blank">01:43:26.640</a></span> | <span class="t">um but in things like tabular and collaborative filtering we don't really know enough about your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6212" target="_blank">01:43:32.640</a></span> | <span class="t">data to know what to use here so you should just try a few things let's try a few multiples of 10</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6219" target="_blank">01:43:39.120</a></span> | <span class="t">start at point one and then divide by 10 a few times you know and just see which one gives you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6225" target="_blank">01:43:45.200</a></span> | <span class="t">the best result so this is called regularization so regularization is about making your bottle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6234" target="_blank">01:43:54.400</a></span> | <span class="t">model no more complex than it has to be right it has a lower capacity and so the higher the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6242" target="_blank">01:44:02.480</a></span> | <span class="t">the more they're moving the model around right so we want to keep the weights down but not so far</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6249" target="_blank">01:44:09.120</a></span> | <span class="t">down that they don't make good predictions and so the value of this if it's higher will keep the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6254" target="_blank">01:44:14.160</a></span> | <span class="t">weights down more it will reduce overfitting but it will also reduce the capacity of your model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6259" target="_blank">01:44:19.920</a></span> | <span class="t">to make good predictions and if it's lower it increases the capacity of model and increases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6265" target="_blank">01:44:25.840</a></span> | <span class="t">overfitting all right i'm going to take this bit for next time before we wrap up john are there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6278" target="_blank">01:44:38.800</a></span> | <span class="t">any more questions uh yeah there are there's some from from back at the start of the collaborative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6291" target="_blank">01:44:51.360</a></span> | <span class="t">filtering so um we had a bit of a conversation a while back about this the size of the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6299" target="_blank">01:44:59.680</a></span> | <span class="t">vectors um and you talked about your your fast ai rule of thumb so there was a question if anyone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6305" target="_blank">01:45:05.120</a></span> | <span class="t">has ever done a kind of a hyper parameter search an exploration um for i mean people often will do a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6311" target="_blank">01:45:11.280</a></span> | <span class="t">hyper parameter search for sure a bigger problem people will often do a hyper parameter search for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6316" target="_blank">01:45:16.000</a></span> | <span class="t">their model but i haven't seen a i haven't seen any other rules other than my rule of thumb</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6322" target="_blank">01:45:22.160</a></span> | <span class="t">right so not not productively to your knowledge oh productively for an individual model that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6328" target="_blank">01:45:28.240</a></span> | <span class="t">somebody's building right um and then there's a there's a question here from zaki which i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6336" target="_blank">01:45:36.720</a></span> | <span class="t">didn't quite wrap my head around so zaki if you want to maybe clarify in the in the chat as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6341" target="_blank">01:45:41.760</a></span> | <span class="t">but can recommendation systems be built based on average ratings of users experience rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6348" target="_blank">01:45:48.480</a></span> | <span class="t">collaborative filtering not really right i mean if you've got lots of metadata you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6354" target="_blank">01:45:54.480</a></span> | <span class="t">right so if you've got a lot you know like lots of information about demographic data about where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6359" target="_blank">01:45:59.360</a></span> | <span class="t">the user's from and you know what loyalty scheme results they've had and blah blah blah and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6366" target="_blank">01:46:06.320</a></span> | <span class="t">for products there's metadata about that as well then sure averages would be fine but if all you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6372" target="_blank">01:46:12.880</a></span> | <span class="t">got is kind of purchasing history then you really want the granular data otherwise how could you say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6380" target="_blank">01:46:20.400</a></span> | <span class="t">like they like this movie this movie in this movie therefore my they might also like that movie or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6385" target="_blank">01:46:25.360</a></span> | <span class="t">you've got it's like oh they kind of like movies there's just not enough information there yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6390" target="_blank">01:46:30.080</a></span> | <span class="t">great that's about it thanks okay great all right thanks everybody see you next time for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p4ZZq0736Po&t=6396" target="_blank">01:46:36.640</a></span> | <span class="t">last lesson</span></div></div></body></html>