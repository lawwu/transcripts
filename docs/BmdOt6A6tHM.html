<html><head><title>llm.c's Origin and the Future of LLM Compilers - Andrej Karpathy at CUDA MODE</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>llm.c's Origin and the Future of LLM Compilers - Andrej Karpathy at CUDA MODE</h2><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM"><img src="https://i.ytimg.com/vi/BmdOt6A6tHM/maxresdefault.jpg" style="width:50%;"></a><div><br></div><div style="text-align: left;"><a href="./BmdOt6A6tHM.html">Whisper Transcript</a> | <a href="./transcript_BmdOt6A6tHM.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">to introduce to you a legendary person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=3" target="_blank">00:00:03.000</a></span> | <span class="t">Someone who has been packing and educating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=5" target="_blank">00:00:05.880</a></span> | <span class="t">at the forefront of AI for over a decade.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=9" target="_blank">00:00:09.640</a></span> | <span class="t">From neural networks to computer vision,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=12" target="_blank">00:00:12.120</a></span> | <span class="t">from vector learning processing to reinforcement learning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=15" target="_blank">00:00:15.120</a></span> | <span class="t">he has pushed the boundaries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=16" target="_blank">00:00:16.940</a></span> | <span class="t">and inspired millions all over the world,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=19" target="_blank">00:00:19.560</a></span> | <span class="t">including, I think, all of us here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=21" target="_blank">00:00:21.360</a></span> | <span class="t">He's a distinguished machine learning superstar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=28" target="_blank">00:00:28.600</a></span> | <span class="t">A founding member of OpenAI,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=30" target="_blank">00:00:30.880</a></span> | <span class="t">the reference human for ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=33" target="_blank">00:00:33.360</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=36" target="_blank">00:00:36.560</a></span> | <span class="t">An ex-Google brain, ex-DeepMind, ex-Tesla, Mr. Autopilot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=41" target="_blank">00:00:41.560</a></span> | <span class="t">Here's where we see it all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=44" target="_blank">00:00:44.500</a></span> | <span class="t">And some months ago, on a memorable day,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=48" target="_blank">00:00:48.080</a></span> | <span class="t">this special person joined the CudaMode Discord</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=51" target="_blank">00:00:51.680</a></span> | <span class="t">to start hacking with others on LLM.C,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=55" target="_blank">00:00:55.400</a></span> | <span class="t">which became one of the greatest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=56" target="_blank">00:00:56.960</a></span> | <span class="t">and most active community projects on our server.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=59" target="_blank">00:00:59.900</a></span> | <span class="t">But I guess it's best if he tells the story himself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=64" target="_blank">00:01:04.680</a></span> | <span class="t">So please join me in welcoming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=66" target="_blank">00:01:06.760</a></span> | <span class="t">the incredible one and only Andrej Karpathy!</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=70" target="_blank">00:01:10.740</a></span> | <span class="t">(audience applauding)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=73" target="_blank">00:01:13.900</a></span> | <span class="t">- Wow, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=80" target="_blank">00:01:20.420</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=85" target="_blank">00:01:25.760</a></span> | <span class="t">Okay, I'm very excited to be here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=87" target="_blank">00:01:27.000</a></span> | <span class="t">This is my favorite kind of event to present at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=89" target="_blank">00:01:29.040</a></span> | <span class="t">So yeah, thank you for the invitation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=90" target="_blank">00:01:30.640</a></span> | <span class="t">and thank you for running CudaMode and putting this on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=93" target="_blank">00:01:33.040</a></span> | <span class="t">This is a wonderful event.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=94" target="_blank">00:01:34.920</a></span> | <span class="t">Okay, so I'll tell you a bit about LLM.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=97" target="_blank">00:01:37.440</a></span> | <span class="t">So what are we doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=98" target="_blank">00:01:38.400</a></span> | <span class="t">We're training transformers in C in a pinch of C++.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=102" target="_blank">00:01:42.060</a></span> | <span class="t">How do I go next here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=103" target="_blank">00:01:43.700</a></span> | <span class="t">Okay, so I'd like to tell the story</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=107" target="_blank">00:01:47.600</a></span> | <span class="t">a little bit of how this project came about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=109" target="_blank">00:01:49.360</a></span> | <span class="t">and what this looked like from my perspective.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=111" target="_blank">00:01:51.180</a></span> | <span class="t">So roughly a year ago,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=112" target="_blank">00:01:52.120</a></span> | <span class="t">I was trying to add a video to my YouTube series</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=114" target="_blank">00:01:54.400</a></span> | <span class="t">and I was trying to teach people LLM training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=117" target="_blank">00:01:57.040</a></span> | <span class="t">GPD training, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=118" target="_blank">00:01:58.320</a></span> | <span class="t">And I was basically hacking on that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=119" target="_blank">00:01:59.520</a></span> | <span class="t">and GPD trying to get it to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=121" target="_blank">00:02:01.120</a></span> | <span class="t">So that was me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=122" target="_blank">00:02:02.920</a></span> | <span class="t">And then you've all worked with PyTorch, of course, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=125" target="_blank">00:02:05.840</a></span> | <span class="t">So the trickiness comes that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=127" target="_blank">00:02:07.760</a></span> | <span class="t">okay, you have your model, which you've written.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=129" target="_blank">00:02:09.440</a></span> | <span class="t">That makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=130" target="_blank">00:02:10.280</a></span> | <span class="t">But now you have to keep track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=131" target="_blank">00:02:11.680</a></span> | <span class="t">of a number of abstractions here at the same time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=134" target="_blank">00:02:14.200</a></span> | <span class="t">So you have to put it to a device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=135" target="_blank">00:02:15.680</a></span> | <span class="t">You want to compile it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=136" target="_blank">00:02:16.720</a></span> | <span class="t">You want to wrap it in DDP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=138" target="_blank">00:02:18.300</a></span> | <span class="t">And suddenly things start to be a little bit more complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=141" target="_blank">00:02:21.120</a></span> | <span class="t">because I'm not even sure in what order you do these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=143" target="_blank">00:02:23.640</a></span> | <span class="t">what exactly happens?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=144" target="_blank">00:02:24.640</a></span> | <span class="t">What are these abstractions?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=145" target="_blank">00:02:25.560</a></span> | <span class="t">What do they do to your model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=146" target="_blank">00:02:26.920</a></span> | <span class="t">So I don't fully understand how any of this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=149" target="_blank">00:02:29.180</a></span> | <span class="t">And then what happens is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=150" target="_blank">00:02:30.960</a></span> | <span class="t">you want to use your model in different ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=152" target="_blank">00:02:32.560</a></span> | <span class="t">So you want to use it in evaluation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=154" target="_blank">00:02:34.040</a></span> | <span class="t">in training, or model inference, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=156" target="_blank">00:02:36.600</a></span> | <span class="t">And what happens to me is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=158" target="_blank">00:02:38.600</a></span> | <span class="t">I was able to train the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=160" target="_blank">00:02:40.200</a></span> | <span class="t">but for some reason eval and inference was not working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=163" target="_blank">00:02:43.640</a></span> | <span class="t">And what happened was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=164" target="_blank">00:02:44.600</a></span> | <span class="t">I was getting some kind of a Torch compile error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=166" target="_blank">00:02:46.600</a></span> | <span class="t">when I was trying to run my eval and my inference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=169" target="_blank">00:02:49.440</a></span> | <span class="t">And this is just an illustrative example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=170" target="_blank">00:02:50.760</a></span> | <span class="t">of a Torch compile error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=171" target="_blank">00:02:51.680</a></span> | <span class="t">It was something else I didn't remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=172" target="_blank">00:02:52.920</a></span> | <span class="t">I couldn't capture it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=174" target="_blank">00:02:54.080</a></span> | <span class="t">But both of them were giving me error,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=175" target="_blank">00:02:55.560</a></span> | <span class="t">inference and eval, and a different error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=177" target="_blank">00:02:57.520</a></span> | <span class="t">And I had no idea what was going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=179" target="_blank">00:02:59.480</a></span> | <span class="t">So I did what anyone would do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=180" target="_blank">00:03:00.640</a></span> | <span class="t">and then in my position, I went to discuss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=182" target="_blank">00:03:02.820</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=185" target="_blank">00:03:05.820</a></span> | <span class="t">(audience applauding)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=189" target="_blank">00:03:09.340</a></span> | <span class="t">I was looking for a PTR VLCK to solve my issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=193" target="_blank">00:03:13.160</a></span> | <span class="t">And fortunately, PTR VLCK did not have any guidance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=195" target="_blank">00:03:15.760</a></span> | <span class="t">that I could see on that specific error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=197" target="_blank">00:03:17.720</a></span> | <span class="t">So I was kind of stuck, honestly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=198" target="_blank">00:03:18.960</a></span> | <span class="t">So two hours later, I'm finding a Torch compile</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=201" target="_blank">00:03:21.680</a></span> | <span class="t">and I'm trying to figure out what the hell is going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=203" target="_blank">00:03:23.240</a></span> | <span class="t">I'm kind of a sad, I don't know exactly how to solve this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=206" target="_blank">00:03:26.800</a></span> | <span class="t">And so I felt like I was going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=208" target="_blank">00:03:28.680</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=211" target="_blank">00:03:31.000</a></span> | <span class="t">In the beginning, I was in denial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=212" target="_blank">00:03:32.080</a></span> | <span class="t">I was like, this can't be happening to me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=213" target="_blank">00:03:33.400</a></span> | <span class="t">I'm not doing anything crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=214" target="_blank">00:03:34.640</a></span> | <span class="t">I'm just training a little GPT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=216" target="_blank">00:03:36.360</a></span> | <span class="t">Like, why is this not working?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=217" target="_blank">00:03:37.760</a></span> | <span class="t">This seems really simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=218" target="_blank">00:03:38.880</a></span> | <span class="t">I'm not doing anything crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=220" target="_blank">00:03:40.360</a></span> | <span class="t">And then eventually I entered into a state of anger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=222" target="_blank">00:03:42.600</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=223" target="_blank">00:03:43.680</a></span> | <span class="t">And I was like, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=225" target="_blank">00:03:45.320</a></span> | <span class="t">You know what, I'm just gonna write the whole thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=226" target="_blank">00:03:46.640</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=227" target="_blank">00:03:47.480</a></span> | <span class="t">I understand in my mind that what I'm trying to do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=229" target="_blank">00:03:49.800</a></span> | <span class="t">like the computation itself, the algorithm itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=231" target="_blank">00:03:51.520</a></span> | <span class="t">is totally clear in my mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=233" target="_blank">00:03:53.080</a></span> | <span class="t">And for some reason, Torch compile doesn't let me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=235" target="_blank">00:03:55.240</a></span> | <span class="t">use it, run it, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=236" target="_blank">00:03:56.440</a></span> | <span class="t">So I felt a little bit powerless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=238" target="_blank">00:03:58.160</a></span> | <span class="t">And I was like, okay, I'm gonna take life into my own hands</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=240" target="_blank">00:04:00.640</a></span> | <span class="t">and be in control of my destiny.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=242" target="_blank">00:04:02.320</a></span> | <span class="t">I'm gonna just write this and see how bad could it be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=245" target="_blank">00:04:05.120</a></span> | <span class="t">So let's think about what is PyTorch offering you, really?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=249" target="_blank">00:04:09.880</a></span> | <span class="t">And there's many things, but maybe some of the things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=251" target="_blank">00:04:11.400</a></span> | <span class="t">that are relevant here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=252" target="_blank">00:04:12.800</a></span> | <span class="t">I don't know why there's bullet points everywhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=254" target="_blank">00:04:14.320</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=257" target="_blank">00:04:17.640</a></span> | <span class="t">Well, my slides is too many points,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=258" target="_blank">00:04:18.760</a></span> | <span class="t">so I don't know how to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=260" target="_blank">00:04:20.880</a></span> | <span class="t">Okay, but number one, we're getting an array, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=263" target="_blank">00:04:23.400</a></span> | <span class="t">So a very useful and dimensional array</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=265" target="_blank">00:04:25.240</a></span> | <span class="t">that we can manipulate the operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=266" target="_blank">00:04:26.880</a></span> | <span class="t">If we're gonna abandon this, then we're gonna have to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=268" target="_blank">00:04:28.560</a></span> | <span class="t">a lot of counter-arithmetic, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=270" target="_blank">00:04:30.520</a></span> | <span class="t">making sure that we rattle and unravel indices correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=273" target="_blank">00:04:33.520</a></span> | <span class="t">Second, we're getting autograph for free.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=274" target="_blank">00:04:34.960</a></span> | <span class="t">So if we don't have autograph, we need to do forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=277" target="_blank">00:04:37.240</a></span> | <span class="t">and backward passes of all the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=279" target="_blank">00:04:39.760</a></span> | <span class="t">We don't have devices, so we have to worry about memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=281" target="_blank">00:04:41.880</a></span> | <span class="t">being on the host or on the device and shuttling memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=284" target="_blank">00:04:44.160</a></span> | <span class="t">around different devices between CPU and GPU and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=287" target="_blank">00:04:47.760</a></span> | <span class="t">We don't have simple DTAP conversions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=289" target="_blank">00:04:49.560</a></span> | <span class="t">so we have to be very mindful what tensors are stored</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=292" target="_blank">00:04:52.280</a></span> | <span class="t">and what precisions and convert explicitly between them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=294" target="_blank">00:04:54.880</a></span> | <span class="t">We don't have Torch Compile, so we're gonna have to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=296" target="_blank">00:04:56.880</a></span> | <span class="t">all the kernel fusions that we want manually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=299" target="_blank">00:04:59.200</a></span> | <span class="t">and we're gonna have to optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=300" target="_blank">00:05:00.360</a></span> | <span class="t">for space-time performance manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=302" target="_blank">00:05:02.280</a></span> | <span class="t">And finally, we don't have distributives,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=303" target="_blank">00:05:03.760</a></span> | <span class="t">so we're gonna have to manually spin up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=305" target="_blank">00:05:05.040</a></span> | <span class="t">all of our processes, make sure that they can find each other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=307" target="_blank">00:05:07.120</a></span> | <span class="t">communicate with Nicol, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=308" target="_blank">00:05:08.960</a></span> | <span class="t">So PyTorch is really, really nice,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=310" target="_blank">00:05:10.560</a></span> | <span class="t">and this is just some of the things that PyTorch offers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=312" target="_blank">00:05:12.560</a></span> | <span class="t">So without PyTorch, we're kind of naked in the world, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=314" target="_blank">00:05:14.800</a></span> | <span class="t">But maybe it's okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=316" target="_blank">00:05:16.760</a></span> | <span class="t">So, yeah, how bad can it be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=319" target="_blank">00:05:19.320</a></span> | <span class="t">So, step one, we have our PyTorch code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=322" target="_blank">00:05:22.180</a></span> | <span class="t">which now isn't the primary thing we're working with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=324" target="_blank">00:05:24.140</a></span> | <span class="t">It's only a reference that we check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=325" target="_blank">00:05:25.920</a></span> | <span class="t">for correctness with respect to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=327" target="_blank">00:05:27.920</a></span> | <span class="t">And so we're in PyTorch land, everything is nice and clean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=330" target="_blank">00:05:30.080</a></span> | <span class="t">We have a little transformer, a few modules,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=331" target="_blank">00:05:31.960</a></span> | <span class="t">and we're just calling them, so everything is great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=333" target="_blank">00:05:33.720</a></span> | <span class="t">And that now becomes our reference in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=336" target="_blank">00:05:36.840</a></span> | <span class="t">I'd love to just take you through one example of a layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=338" target="_blank">00:05:38.880</a></span> | <span class="t">So for example, layer norm here is like a PyTorch layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=341" target="_blank">00:05:41.960</a></span> | <span class="t">and we'd like to basically port this over to C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=345" target="_blank">00:05:45.040</a></span> | <span class="t">So what kind of process do we go through?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=346" target="_blank">00:05:46.760</a></span> | <span class="t">Well, we're gonna iterate through all the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=348" target="_blank">00:05:48.240</a></span> | <span class="t">Number one, we need the forward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=350" target="_blank">00:05:50.560</a></span> | <span class="t">And actually, I had to write a forward pass of layer norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=353" target="_blank">00:05:53.360</a></span> | <span class="t">because PyTorch doesn't just have this kind of implementation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=356" target="_blank">00:05:56.960</a></span> | <span class="t">in PyTorch of layer norm, because it's kind of like a block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=359" target="_blank">00:05:59.240</a></span> | <span class="t">and eventually pulls into some CUDA kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=361" target="_blank">00:06:01.520</a></span> | <span class="t">So I had to write a forward pass of layer norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=363" target="_blank">00:06:03.400</a></span> | <span class="t">and make sure it's equivalent to the layer norm in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=366" target="_blank">00:06:06.300</a></span> | <span class="t">And then, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=367" target="_blank">00:06:07.140</a></span> | <span class="t">I had to write the backward pass of layer norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=369" target="_blank">00:06:09.320</a></span> | <span class="t">This is where you kind of take out your pen and paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=371" target="_blank">00:06:11.080</a></span> | <span class="t">do some backdrop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=372" target="_blank">00:06:12.600</a></span> | <span class="t">This is for batch norm, but layer norm would be similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=375" target="_blank">00:06:15.720</a></span> | <span class="t">And yeah, we had to write the backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=377" target="_blank">00:06:17.720</a></span> | <span class="t">And again, this is all still in PyTorch, but it's explicit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=380" target="_blank">00:06:20.680</a></span> | <span class="t">And you're just making sure that the layer norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=382" target="_blank">00:06:22.280</a></span> | <span class="t">of PyTorch, forward and backward,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=383" target="_blank">00:06:23.560</a></span> | <span class="t">matches this basically manual tensor-based implementation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=388" target="_blank">00:06:28.560</a></span> | <span class="t">So now we have PyTorch code forward and backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=394" target="_blank">00:06:34.000</a></span> | <span class="t">So the next thing we do is we try to port it to C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=396" target="_blank">00:06:36.360</a></span> | <span class="t">And this is actually a lot simpler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=397" target="_blank">00:06:37.720</a></span> | <span class="t">in many cases than you might think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=398" target="_blank">00:06:38.980</a></span> | <span class="t">So on the left, we have the PyTorch code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=400" target="_blank">00:06:40.280</a></span> | <span class="t">on the right, we basically have the equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=402" target="_blank">00:06:42.000</a></span> | <span class="t">of layer norm forward in C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=404" target="_blank">00:06:44.000</a></span> | <span class="t">And it's not that crazy, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=405" target="_blank">00:06:45.600</a></span> | <span class="t">So unlike in PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=407" target="_blank">00:06:47.680</a></span> | <span class="t">we just have a bunch of float star arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=410" target="_blank">00:06:50.880</a></span> | <span class="t">So we have a float star out, float star inputs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=413" target="_blank">00:06:53.440</a></span> | <span class="t">outputs, means, standard deviations, weights,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=415" target="_blank">00:06:55.760</a></span> | <span class="t">and biases, and some type of headers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=417" target="_blank">00:06:57.540</a></span> | <span class="t">And one thing I really like to do in LL.C</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=420" target="_blank">00:07:00.080</a></span> | <span class="t">is I just want to keep things simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=421" target="_blank">00:07:01.560</a></span> | <span class="t">I don't want to create a tensor abstraction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=423" target="_blank">00:07:03.400</a></span> | <span class="t">I don't want to create any abstraction, really.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=425" target="_blank">00:07:05.620</a></span> | <span class="t">It's just float arrays and operations on float arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=428" target="_blank">00:07:08.560</a></span> | <span class="t">Like, why should it be a lot more complicated than that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=430" target="_blank">00:07:10.720</a></span> | <span class="t">So everything is just float arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=432" target="_blank">00:07:12.560</a></span> | <span class="t">Everything is fully self-contained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=433" target="_blank">00:07:13.840</a></span> | <span class="t">There's no underlying representations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=436" target="_blank">00:07:16.040</a></span> | <span class="t">abstractions to call, import, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=438" target="_blank">00:07:18.060</a></span> | <span class="t">This is the layer norm forward on float arrays,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=440" target="_blank">00:07:20.080</a></span> | <span class="t">and that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=441" target="_blank">00:07:21.160</a></span> | <span class="t">So that's the forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=442" target="_blank">00:07:22.960</a></span> | <span class="t">And then you also do the backward for all the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=445" target="_blank">00:07:25.820</a></span> | <span class="t">Once we've done that for all the layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=447" target="_blank">00:07:27.280</a></span> | <span class="t">and converted everything to C</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=448" target="_blank">00:07:28.120</a></span> | <span class="t">to make sure that everything matches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=449" target="_blank">00:07:29.740</a></span> | <span class="t">our reference implementation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=451" target="_blank">00:07:31.520</a></span> | <span class="t">we have to start to string it together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=454" target="_blank">00:07:34.000</a></span> | <span class="t">So we go into our C code in the main,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=457" target="_blank">00:07:37.600</a></span> | <span class="t">and we have to allocate all of the memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=459" target="_blank">00:07:39.440</a></span> | <span class="t">that we're going to be using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=460" target="_blank">00:07:40.520</a></span> | <span class="t">In LL.C, all of the allocation happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=463" target="_blank">00:07:43.400</a></span> | <span class="t">a single time at the beginning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=464" target="_blank">00:07:44.800</a></span> | <span class="t">So we pre-plan all of the memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=466" target="_blank">00:07:46.320</a></span> | <span class="t">that we're going to ever use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=467" target="_blank">00:07:47.800</a></span> | <span class="t">Then it's fixed, and from then on it's just dynamics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=470" target="_blank">00:07:50.320</a></span> | <span class="t">of just feeding data through it and training the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=473" target="_blank">00:07:53.160</a></span> | <span class="t">So we have to pre-plan all the tensors, their sizes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=476" target="_blank">00:07:56.080</a></span> | <span class="t">and we have to do that for the parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=477" target="_blank">00:07:57.940</a></span> | <span class="t">And we have the data_grad and the mnb</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=480" target="_blank">00:08:00.040</a></span> | <span class="t">for the @mw buffers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=482" target="_blank">00:08:02.320</a></span> | <span class="t">And then for the activations as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=483" target="_blank">00:08:03.760</a></span> | <span class="t">and we need space for both data and grad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=485" target="_blank">00:08:05.880</a></span> | <span class="t">And so you just pre-plan all the memory,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=487" target="_blank">00:08:07.720</a></span> | <span class="t">you allocate all of it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=488" target="_blank">00:08:08.680</a></span> | <span class="t">and then we just stitch it all up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=490" target="_blank">00:08:10.880</a></span> | <span class="t">So we have all these layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=492" target="_blank">00:08:12.420</a></span> | <span class="t">and they have a forward and a backward pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=494" target="_blank">00:08:14.340</a></span> | <span class="t">in backpropagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=495" target="_blank">00:08:15.800</a></span> | <span class="t">And so on the forward pass,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=497" target="_blank">00:08:17.800</a></span> | <span class="t">just kind of like you allocate all these tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=499" target="_blank">00:08:19.680</a></span> | <span class="t">and you're very careful,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=500" target="_blank">00:08:20.520</a></span> | <span class="t">and you index into them properly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=501" target="_blank">00:08:21.720</a></span> | <span class="t">and you make sure everything flows correctly through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=504" target="_blank">00:08:24.020</a></span> | <span class="t">And you just call the forwards and then all the backwards,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=506" target="_blank">00:08:26.320</a></span> | <span class="t">and then you're kind of done,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=508" target="_blank">00:08:28.000</a></span> | <span class="t">and you're left with gradient and you can do an update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=509" target="_blank">00:08:29.820</a></span> | <span class="t">So stringing that together is the second piece of work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=512" target="_blank">00:08:32.940</a></span> | <span class="t">And then once we sort of like strung it together,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=514" target="_blank">00:08:34.720</a></span> | <span class="t">you get something that you can just compile and run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=516" target="_blank">00:08:36.940</a></span> | <span class="t">So we, on the top left is everything that's required.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=520" target="_blank">00:08:40.480</a></span> | <span class="t">We download a starter pack,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=521" target="_blank">00:08:41.880</a></span> | <span class="t">which is really just a GPT-2 weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=523" target="_blank">00:08:43.500</a></span> | <span class="t">in a single binary file, very simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=525" target="_blank">00:08:45.920</a></span> | <span class="t">And also we need the data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=527" target="_blank">00:08:47.480</a></span> | <span class="t">in this case TinyShakespeare,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=528" target="_blank">00:08:48.720</a></span> | <span class="t">and the tokenizer and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=530" target="_blank">00:08:50.720</a></span> | <span class="t">And then we just compile and run this little C code file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=533" target="_blank">00:08:53.960</a></span> | <span class="t">It's a single file of C at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=536" target="_blank">00:08:56.720</a></span> | <span class="t">And I think it's like 2000 lines or something like that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=539" target="_blank">00:08:59.120</a></span> | <span class="t">if I remember correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=540" target="_blank">00:09:00.240</a></span> | <span class="t">And you run that program and it like does a little training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=543" target="_blank">00:09:03.000</a></span> | <span class="t">and outputs on Shakespeare again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=545" target="_blank">00:09:05.000</a></span> | <span class="t">And then we can verify that the package code is identical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=548" target="_blank">00:09:08.120</a></span> | <span class="t">to the C code and everything is great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=549" target="_blank">00:09:09.920</a></span> | <span class="t">And we're just running on C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=551" target="_blank">00:09:11.280</a></span> | <span class="t">And at this point, I'm actually feeling quite great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=554" target="_blank">00:09:14.080</a></span> | <span class="t">because this is amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=556" target="_blank">00:09:16.240</a></span> | <span class="t">So we have a single file C,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=557" target="_blank">00:09:17.880</a></span> | <span class="t">there's no dependencies whatsoever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=559" target="_blank">00:09:19.800</a></span> | <span class="t">It compiles instantly, it runs instantly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=562" target="_blank">00:09:22.040</a></span> | <span class="t">All the memory is just allocated in a single block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=565" target="_blank">00:09:25.400</a></span> | <span class="t">So if you start stepping,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=566" target="_blank">00:09:26.600</a></span> | <span class="t">there's no way you're gonna boom later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=568" target="_blank">00:09:28.180</a></span> | <span class="t">It's all pre-planned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=569" target="_blank">00:09:29.300</a></span> | <span class="t">It's fully deterministic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=570" target="_blank">00:09:30.880</a></span> | <span class="t">It, in principle, can train GPT-2, it's complete.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=573" target="_blank">00:09:33.280</a></span> | <span class="t">It will train GPT-2, you just have to wait for one time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=576" target="_blank">00:09:36.160</a></span> | <span class="t">And it can run on a potato.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=577" target="_blank">00:09:37.520</a></span> | <span class="t">It can just run on anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=578" target="_blank">00:09:38.360</a></span> | <span class="t">It's just a single file of C with no dependencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=580" target="_blank">00:09:40.840</a></span> | <span class="t">And in principle, this could run,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=582" target="_blank">00:09:42.080</a></span> | <span class="t">this would be a great candidate to run on a moment probe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=585" target="_blank">00:09:45.160</a></span> | <span class="t">because in space, if we just harden it a little bit more,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=588" target="_blank">00:09:48.240</a></span> | <span class="t">because you're not gonna ship high-torch code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=590" target="_blank">00:09:50.520</a></span> | <span class="t">on a one-moment probe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=591" target="_blank">00:09:51.680</a></span> | <span class="t">But I think LMC is great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=593" target="_blank">00:09:53.320</a></span> | <span class="t">(all laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=596" target="_blank">00:09:56.520</a></span> | <span class="t">So I was feeling great at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=598" target="_blank">00:09:58.440</a></span> | <span class="t">Fun side note, by the way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=599" target="_blank">00:09:59.680</a></span> | <span class="t">all of this work that I described so far</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=600" target="_blank">00:10:00.960</a></span> | <span class="t">- Whoa. - Whoa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=601" target="_blank">00:10:01.800</a></span> | <span class="t">- While I was on vacation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=603" target="_blank">00:10:03.640</a></span> | <span class="t">and while I was jet-lagged in Maldives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=605" target="_blank">00:10:05.680</a></span> | <span class="t">So basically it's perfect because you wake up at 1 a.m.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=609" target="_blank">00:10:09.400</a></span> | <span class="t">and there's nothing to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=611" target="_blank">00:10:11.000</a></span> | <span class="t">So you write stuff like LLM.C,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=612" target="_blank">00:10:12.960</a></span> | <span class="t">and then in sunrise, you go do all the weather activities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=615" target="_blank">00:10:15.400</a></span> | <span class="t">So that is the villa where most of LLM.C was trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=619" target="_blank">00:10:19.240</a></span> | <span class="t">So that was perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=620" target="_blank">00:10:20.200</a></span> | <span class="t">This is a picture of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=621" target="_blank">00:10:21.560</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=622" target="_blank">00:10:22.400</a></span> | <span class="t">And this is a, I think the moon is about to set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=625" target="_blank">00:10:25.200</a></span> | <span class="t">and the sunrise is about to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=626" target="_blank">00:10:26.680</a></span> | <span class="t">This is a recommended way to do software development.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=629" target="_blank">00:10:29.160</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=632" target="_blank">00:10:32.360</a></span> | <span class="t">Okay, so now we have C code, but it's inefficient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=634" target="_blank">00:10:34.480</a></span> | <span class="t">So we'd like to run it faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=635" target="_blank">00:10:35.680</a></span> | <span class="t">For that, we need four GPUs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=637" target="_blank">00:10:37.200</a></span> | <span class="t">So we need to convert all of our C code to GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=639" target="_blank">00:10:39.440</a></span> | <span class="t">So this is where we go to the dev CUDA part of the repo</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=642" target="_blank">00:10:42.240</a></span> | <span class="t">and we start to develop all the kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=643" target="_blank">00:10:43.920</a></span> | <span class="t">So here's the layer of forward pass, as I mentioned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=646" target="_blank">00:10:46.120</a></span> | <span class="t">And now we're gonna develop a number of kernels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=647" target="_blank">00:10:47.760</a></span> | <span class="t">that have the identical functionality,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=649" target="_blank">00:10:49.280</a></span> | <span class="t">but now run on the GPU and they're gonna be faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=651" target="_blank">00:10:51.760</a></span> | <span class="t">And so usually we have versions one, two, three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=653" target="_blank">00:10:53.960</a></span> | <span class="t">four, five, six, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=655" target="_blank">00:10:55.240</a></span> | <span class="t">And these are all different kernel implementations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=656" target="_blank">00:10:56.640</a></span> | <span class="t">They're a bit faster usually over time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=658" target="_blank">00:10:58.160</a></span> | <span class="t">but they match the specification exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=660" target="_blank">00:11:00.920</a></span> | <span class="t">and give the exact same numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=662" target="_blank">00:11:02.720</a></span> | <span class="t">So we develop all those layers and port them to CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=665" target="_blank">00:11:05.760</a></span> | <span class="t">And this is, I don't know what this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=668" target="_blank">00:11:08.000</a></span> | <span class="t">I'm gonna skip that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=668" target="_blank">00:11:08.840</a></span> | <span class="t">(audience laughing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=669" target="_blank">00:11:09.680</a></span> | <span class="t">I need to look at one of the kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=670" target="_blank">00:11:10.960</a></span> | <span class="t">Basically, the point here is the first kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=673" target="_blank">00:11:13.000</a></span> | <span class="t">is trivial to do usually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=674" target="_blank">00:11:14.040</a></span> | <span class="t">because you're paralyzing over batch and time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=677" target="_blank">00:11:17.760</a></span> | <span class="t">And then you're basically copy pasting the C code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=680" target="_blank">00:11:20.120</a></span> | <span class="t">into your CUDA kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=681" target="_blank">00:11:21.320</a></span> | <span class="t">And you're already getting speed ups</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=682" target="_blank">00:11:22.400</a></span> | <span class="t">because you're paralyzing over the batch time tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=684" target="_blank">00:11:24.440</a></span> | <span class="t">and each thread just handles a single output element.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=686" target="_blank">00:11:26.920</a></span> | <span class="t">So the first kernel is usually trivial,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=688" target="_blank">00:11:28.720</a></span> | <span class="t">but then optimization is gonna be pretty elaborate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=691" target="_blank">00:11:31.920</a></span> | <span class="t">So by the end, we get to kernel six, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=693" target="_blank">00:11:33.920</a></span> | <span class="t">in layer norm, and we're doing a lot of things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=695" target="_blank">00:11:35.480</a></span> | <span class="t">that are a bit more complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=696" target="_blank">00:11:36.400</a></span> | <span class="t">So we have some, you know, more produce operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=700" target="_blank">00:11:40.680</a></span> | <span class="t">We have some, we also probably get through shared memory,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=702" target="_blank">00:11:42.880</a></span> | <span class="t">through Google memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=703" target="_blank">00:11:43.720</a></span> | <span class="t">We're orchestrating it correctly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=705" target="_blank">00:11:45.280</a></span> | <span class="t">cache screening hints,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=707" target="_blank">00:11:47.560</a></span> | <span class="t">and a bunch of little tips and tricks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=709" target="_blank">00:11:49.720</a></span> | <span class="t">for dealing with everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=712" target="_blank">00:11:52.200</a></span> | <span class="t">And I'm gonna go into a bit more detail later,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=713" target="_blank">00:11:53.800</a></span> | <span class="t">but you can get arbitrarily complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=715" target="_blank">00:11:55.800</a></span> | <span class="t">if you're writing the CUDA code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=718" target="_blank">00:11:58.120</a></span> | <span class="t">One thing that I sort of found in this project</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=719" target="_blank">00:11:59.840</a></span> | <span class="t">is that it's not exactly trivial to learn CUDA,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=722" target="_blank">00:12:02.840</a></span> | <span class="t">unfortunately, and it was like a little bit harder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=724" target="_blank">00:12:04.680</a></span> | <span class="t">than I expected.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=725" target="_blank">00:12:05.960</a></span> | <span class="t">I mean, I knew some CUDA going in,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=727" target="_blank">00:12:07.400</a></span> | <span class="t">but getting better at it, I think, is not trivial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=729" target="_blank">00:12:09.760</a></span> | <span class="t">I think some of these books, unfortunately,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=731" target="_blank">00:12:11.320</a></span> | <span class="t">are a bit out of date, as you might know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=733" target="_blank">00:12:13.320</a></span> | <span class="t">PMDP is actually quite good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=735" target="_blank">00:12:15.200</a></span> | <span class="t">But also, I think still kind of like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=737" target="_blank">00:12:17.880</a></span> | <span class="t">mostly on the beginner level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=739" target="_blank">00:12:19.080</a></span> | <span class="t">because a lot of the CUDA code that we ended up developing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=741" target="_blank">00:12:21.600</a></span> | <span class="t">in the lifetime of the LLMC project,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=743" target="_blank">00:12:23.400</a></span> | <span class="t">you would not find those things in this book, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=746" target="_blank">00:12:26.000</a></span> | <span class="t">So a lot of the kernels that we ended up adding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=749" target="_blank">00:12:29.480</a></span> | <span class="t">would just not be covered.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=751" target="_blank">00:12:31.000</a></span> | <span class="t">And then on top of that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=751" target="_blank">00:12:31.840</a></span> | <span class="t">you have this CUDA C++ programming guide,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=753" target="_blank">00:12:33.600</a></span> | <span class="t">which, frankly, is not exactly readable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=755" target="_blank">00:12:35.700</a></span> | <span class="t">for someone who is a bit new to CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=759" target="_blank">00:12:39.440</a></span> | <span class="t">And then you have this amazing blog post from Simon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=761" target="_blank">00:12:41.640</a></span> | <span class="t">Yeah, is that in Tropic?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=762" target="_blank">00:12:42.880</a></span> | <span class="t">That is like way better than anything we deserve,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=764" target="_blank">00:12:44.800</a></span> | <span class="t">just like randomly on the internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=766" target="_blank">00:12:46.280</a></span> | <span class="t">So that was incredible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=767" target="_blank">00:12:47.280</a></span> | <span class="t">And if there was just more of that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=768" target="_blank">00:12:48.120</a></span> | <span class="t">that would be so amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=769" target="_blank">00:12:49.280</a></span> | <span class="t">But yeah, so I think I found it a little bit difficult.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=773" target="_blank">00:12:53.520</a></span> | <span class="t">But I mean, I'm hoping that things like CUDA mode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=775" target="_blank">00:12:55.880</a></span> | <span class="t">can definitely speed up the availability of writing CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=780" target="_blank">00:13:00.880</a></span> | <span class="t">Okay, so next what happened is I was basically struggling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=786" target="_blank">00:13:06.280</a></span> | <span class="t">with the CUDA code a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=788" target="_blank">00:13:08.160</a></span> | <span class="t">And I was reading through the book</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=789" target="_blank">00:13:09.460</a></span> | <span class="t">and I was implementing all these CUDA kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=791" target="_blank">00:13:11.000</a></span> | <span class="t">And they're like okay CUDA kernels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=792" target="_blank">00:13:12.400</a></span> | <span class="t">but they're not great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=794" target="_blank">00:13:14.760</a></span> | <span class="t">And so a team of Avengers assembled from the internet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=798" target="_blank">00:13:18.280</a></span> | <span class="t">and what they saw, and that's how you start contributing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=799" target="_blank">00:13:19.960</a></span> | <span class="t">So specifically, Eric, Arun, Aleksar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=802" target="_blank">00:13:22.640</a></span> | <span class="t">like I would say core devs of LLM.C</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=804" target="_blank">00:13:24.760</a></span> | <span class="t">and contributed a ton of work to LLM.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=807" target="_blank">00:13:27.280</a></span> | <span class="t">And they started to like really optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=809" target="_blank">00:13:29.640</a></span> | <span class="t">and write all these kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=810" target="_blank">00:13:30.600</a></span> | <span class="t">And this was incredible to watch and learn a lot from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=813" target="_blank">00:13:33.200</a></span> | <span class="t">And there's many more, Ross Wheeler and Chen Hsiao</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=816" target="_blank">00:13:36.160</a></span> | <span class="t">and a few others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=817" target="_blank">00:13:37.600</a></span> | <span class="t">But over time, we have 60 contributors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=819" target="_blank">00:13:39.440</a></span> | <span class="t">to the LLM.C project.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=820" target="_blank">00:13:40.840</a></span> | <span class="t">Shout out to LLM.Dev for sponsoring LLM.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=823" target="_blank">00:13:43.440</a></span> | <span class="t">They can contribute to compute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=824" target="_blank">00:13:44.600</a></span> | <span class="t">so that we can run and optimize all these kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=827" target="_blank">00:13:47.120</a></span> | <span class="t">So it was amazing for me that people just came</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=828" target="_blank">00:13:48.880</a></span> | <span class="t">from the internet and helped out on the project.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=830" target="_blank">00:13:50.360</a></span> | <span class="t">And you know, this is one of the favorite things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=831" target="_blank">00:13:51.920</a></span> | <span class="t">that can happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=832" target="_blank">00:13:52.880</a></span> | <span class="t">My favorite things that can happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=834" target="_blank">00:13:54.200</a></span> | <span class="t">within an open source MIT licensed repo,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=836" target="_blank">00:13:56.440</a></span> | <span class="t">people just come from the internet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=838" target="_blank">00:13:58.160</a></span> | <span class="t">and help contribute, it's amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=839" target="_blank">00:13:59.960</a></span> | <span class="t">Okay, so we've converted all the layers to CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=843" target="_blank">00:14:03.640</a></span> | <span class="t">We have now all the kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=844" target="_blank">00:14:04.760</a></span> | <span class="t">And we can now train on a single GPU in FB32 so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=848" target="_blank">00:14:08.560</a></span> | <span class="t">So that's great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=850" target="_blank">00:14:10.000</a></span> | <span class="t">So from then on, we start to make more and more optimizations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=852" target="_blank">00:14:12.480</a></span> | <span class="t">So number one, we don't want to have mammals in FB32</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=855" target="_blank">00:14:15.480</a></span> | <span class="t">when you roll your own code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=857" target="_blank">00:14:17.520</a></span> | <span class="t">We actually switched to Kubas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=860" target="_blank">00:14:20.040</a></span> | <span class="t">Step two, we don't want to write our own flash attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=863" target="_blank">00:14:23.000</a></span> | <span class="t">I think that would be pretty complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=864" target="_blank">00:14:24.360</a></span> | <span class="t">Turns out Codium has a very good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=865" target="_blank">00:14:25.960</a></span> | <span class="t">flash attention implementation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=867" target="_blank">00:14:27.320</a></span> | <span class="t">So we switched to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=868" target="_blank">00:14:28.800</a></span> | <span class="t">Next, you want to definitely reach for base precision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=873" target="_blank">00:14:33.560</a></span> | <span class="t">so that to speed up the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=876" target="_blank">00:14:36.320</a></span> | <span class="t">So you want to go over all your testers for parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=879" target="_blank">00:14:39.520</a></span> | <span class="t">and also for activations and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=881" target="_blank">00:14:41.080</a></span> | <span class="t">And you have to start to think about,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=882" target="_blank">00:14:42.120</a></span> | <span class="t">okay, which ones are in float 32,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=883" target="_blank">00:14:43.480</a></span> | <span class="t">which ones are in float 16,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=885" target="_blank">00:14:45.080</a></span> | <span class="t">and what precision are they in?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=886" target="_blank">00:14:46.560</a></span> | <span class="t">And then do all the conversions automatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=888" target="_blank">00:14:48.840</a></span> | <span class="t">So we reached for that and implemented that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=891" target="_blank">00:14:51.600</a></span> | <span class="t">There's many, many other optimizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=892" target="_blank">00:14:52.960</a></span> | <span class="t">that we've been implementing over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=894" target="_blank">00:14:54.560</a></span> | <span class="t">So as an example, we did all the kernel fusions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=897" target="_blank">00:14:57.400</a></span> | <span class="t">different recompute settings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=898" target="_blank">00:14:58.880</a></span> | <span class="t">to recompute a piece of the forward pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=900" target="_blank">00:15:00.280</a></span> | <span class="t">during the backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=901" target="_blank">00:15:01.280</a></span> | <span class="t">There's been a lot of optimizations from Eric,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=904" target="_blank">00:15:04.520</a></span> | <span class="t">especially on minimizing the amount of memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=906" target="_blank">00:15:06.520</a></span> | <span class="t">that you need during the backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=908" target="_blank">00:15:08.960</a></span> | <span class="t">We have this packed 128 data structure,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=911" target="_blank">00:15:11.160</a></span> | <span class="t">which basically, in our experience,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=913" target="_blank">00:15:13.000</a></span> | <span class="t">forces the compiler to use the 128-bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=915" target="_blank">00:15:15.800</a></span> | <span class="t">load and store instructions that are available,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=917" target="_blank">00:15:17.640</a></span> | <span class="t">but somehow the compiler is unwilling to use in many cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=921" target="_blank">00:15:21.000</a></span> | <span class="t">So I think Arun did a lot of work here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=923" target="_blank">00:15:23.800</a></span> | <span class="t">where you just look at the SAS,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=925" target="_blank">00:15:25.560</a></span> | <span class="t">and you look at the SAS as the assembly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=928" target="_blank">00:15:28.760</a></span> | <span class="t">and you are looking at what the instructions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=930" target="_blank">00:15:30.520</a></span> | <span class="t">are being used for your loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=931" target="_blank">00:15:31.480</a></span> | <span class="t">and you figure out that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=932" target="_blank">00:15:32.320</a></span> | <span class="t">okay, there should be a 128-bit load and store,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=934" target="_blank">00:15:34.440</a></span> | <span class="t">but it happens to be a 32-bit or something else</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=936" target="_blank">00:15:36.360</a></span> | <span class="t">because something in the MSCC compiler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=938" target="_blank">00:15:38.400</a></span> | <span class="t">is not going very well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=939" target="_blank">00:15:39.280</a></span> | <span class="t">So we found that this data structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=941" target="_blank">00:15:41.320</a></span> | <span class="t">kind of forces the compiler's hand a bit more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=943" target="_blank">00:15:43.960</a></span> | <span class="t">We implemented all kinds of CUDA streams to overlap</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=946" target="_blank">00:15:46.360</a></span> | <span class="t">at the heart of the computation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=947" target="_blank">00:15:47.680</a></span> | <span class="t">and this ended up creating a total disaster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=951" target="_blank">00:15:51.080</a></span> | <span class="t">And so that's why I scratched it out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=952" target="_blank">00:15:52.320</a></span> | <span class="t">because at one point of LLM.c, as Arun would say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=955" target="_blank">00:15:55.480</a></span> | <span class="t">I basically went in and I looped it from orbit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=958" target="_blank">00:15:58.000</a></span> | <span class="t">I just went in, I controlled that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=960" target="_blank">00:16:00.280</a></span> | <span class="t">for all dimensions of stream,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=961" target="_blank">00:16:01.520</a></span> | <span class="t">and I just delete, delete, delete.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=963" target="_blank">00:16:03.160</a></span> | <span class="t">And basically I deleted all the streams,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=964" target="_blank">00:16:04.560</a></span> | <span class="t">made everything single-threaded,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=965" target="_blank">00:16:05.920</a></span> | <span class="t">because we ended up getting all kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=967" target="_blank">00:16:07.160</a></span> | <span class="t">of really weird race conditions and errors and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=969" target="_blank">00:16:09.160</a></span> | <span class="t">I just didn't want to deal with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=970" target="_blank">00:16:10.120</a></span> | <span class="t">So LLM.c is not actually as overlapped as it could be,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=973" target="_blank">00:16:13.960</a></span> | <span class="t">but it's just like, it's too much complexity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=976" target="_blank">00:16:16.280</a></span> | <span class="t">for me not to have gained at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=978" target="_blank">00:16:18.720</a></span> | <span class="t">But maybe we can slowly reintroduce some of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=981" target="_blank">00:16:21.760</a></span> | <span class="t">We have stochastic grounding, we have full determinism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=983" target="_blank">00:16:23.920</a></span> | <span class="t">Full determinism turns out to be pretty hard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=985" target="_blank">00:16:25.760</a></span> | <span class="t">because some of the kernels complexify a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=987" target="_blank">00:16:27.800</a></span> | <span class="t">because you can't use atomics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=989" target="_blank">00:16:29.120</a></span> | <span class="t">Like the encoder backward was especially crazy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=991" target="_blank">00:16:31.440</a></span> | <span class="t">because the encoder backward is trivial with atomics,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=994" target="_blank">00:16:34.720</a></span> | <span class="t">but non-trivial without it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=996" target="_blank">00:16:36.440</a></span> | <span class="t">Anyway, so a lot of the optimizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=997" target="_blank">00:16:37.960</a></span> | <span class="t">went into with a lot of efficiency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1000" target="_blank">00:16:40.920</a></span> | <span class="t">and determinism in mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1002" target="_blank">00:16:42.120</a></span> | <span class="t">And accuracy, like stochastic grounding and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1006" target="_blank">00:16:46.220</a></span> | <span class="t">Next, you want to use multiple GPUs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1007" target="_blank">00:16:47.640</a></span> | <span class="t">not just a single GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1008" target="_blank">00:16:48.800</a></span> | <span class="t">So this is where you bring in the nickel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1010" target="_blank">00:16:50.960</a></span> | <span class="t">you start to do overduce between all the different workers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1015" target="_blank">00:16:55.280</a></span> | <span class="t">And this is where you also start to reach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1016" target="_blank">00:16:56.800</a></span> | <span class="t">for like sharded optimizer state zero one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1019" target="_blank">00:16:59.600</a></span> | <span class="t">For basically, take your optimizer states,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1021" target="_blank">00:17:01.000</a></span> | <span class="t">which are in float, and these are really large buffers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1024" target="_blank">00:17:04.320</a></span> | <span class="t">for atom W, and you can actually spread out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1026" target="_blank">00:17:06.320</a></span> | <span class="t">a lot of the stuff across all the GPUs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1027" target="_blank">00:17:07.800</a></span> | <span class="t">and it really helps to keep your requirements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1029" target="_blank">00:17:09.920</a></span> | <span class="t">down per GPU in terms of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1031" target="_blank">00:17:11.600</a></span> | <span class="t">So very helpful to reach for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1034" target="_blank">00:17:14.000</a></span> | <span class="t">So currently, LLNC uses zero one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1036" target="_blank">00:17:16.280</a></span> | <span class="t">which is a sharded optimizer state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1037" target="_blank">00:17:17.760</a></span> | <span class="t">There's a PR for zero two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1039" target="_blank">00:17:19.000</a></span> | <span class="t">but I don't believe I merged that yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1041" target="_blank">00:17:21.000</a></span> | <span class="t">because it gets a little bit messy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1042" target="_blank">00:17:22.800</a></span> | <span class="t">but might be merged eventually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1045" target="_blank">00:17:25.000</a></span> | <span class="t">A lot of LLNC is just kind of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1046" target="_blank">00:17:26.720</a></span> | <span class="t">balancing the improvement and speed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1050" target="_blank">00:17:30.280</a></span> | <span class="t">with the complexity of what you're actually introducing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1052" target="_blank">00:17:32.680</a></span> | <span class="t">And so I actually rejected a lot of PRs because of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1055" target="_blank">00:17:35.200</a></span> | <span class="t">because the code starts to get crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1057" target="_blank">00:17:37.380</a></span> | <span class="t">And I think that decreases the amount of people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1058" target="_blank">00:17:38.760</a></span> | <span class="t">that can be onboarded.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1059" target="_blank">00:17:39.860</a></span> | <span class="t">And then after your multi-GP, you hold the node.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1063" target="_blank">00:17:43.960</a></span> | <span class="t">So now you are running across multiple machines here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1066" target="_blank">00:17:46.160</a></span> | <span class="t">to make sure that you synchronize all of them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1068" target="_blank">00:17:48.320</a></span> | <span class="t">that they can find each other and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1069" target="_blank">00:17:49.600</a></span> | <span class="t">So we implemented all that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1071" target="_blank">00:17:51.560</a></span> | <span class="t">And where that leads us to is that we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1073" target="_blank">00:17:53.960</a></span> | <span class="t">actually train GPT-2, and we can actually reproduce it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1076" target="_blank">00:17:56.120</a></span> | <span class="t">after all of that work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1077" target="_blank">00:17:57.320</a></span> | <span class="t">So there's a post in the discussions of LLNC.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1079" target="_blank">00:17:59.960</a></span> | <span class="t">We can train the 1.6 billion GPT-2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1082" target="_blank">00:18:02.080</a></span> | <span class="t">which was state of the art LLN as of 2019 or so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1085" target="_blank">00:18:05.320</a></span> | <span class="t">And you can train it on a single node,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1086" target="_blank">00:18:06.980</a></span> | <span class="t">H100, in about 24 hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1089" target="_blank">00:18:09.260</a></span> | <span class="t">And that costs roughly $600.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1092" target="_blank">00:18:12.020</a></span> | <span class="t">And the way you do that is it's extremely dependency free.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1094" target="_blank">00:18:14.300</a></span> | <span class="t">There's no need for Python, no need for PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1096" target="_blank">00:18:16.860</a></span> | <span class="t">So you do need CUDNN, which is the most heavy dependency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1100" target="_blank">00:18:20.540</a></span> | <span class="t">But CUDNN is optional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1101" target="_blank">00:18:21.820</a></span> | <span class="t">So if you'd like to roll your own manual attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1103" target="_blank">00:18:23.900</a></span> | <span class="t">that is possible in LLN.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1105" target="_blank">00:18:25.580</a></span> | <span class="t">But CUDNN is kind of like the hairiest dependency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1107" target="_blank">00:18:27.540</a></span> | <span class="t">But after that, it's just a bunch of C code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1109" target="_blank">00:18:29.260</a></span> | <span class="t">You compile it and you run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1110" target="_blank">00:18:30.380</a></span> | <span class="t">There's no need for really anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1112" target="_blank">00:18:32.460</a></span> | <span class="t">So there's no need for conda environments,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1114" target="_blank">00:18:34.060</a></span> | <span class="t">as it installs, there's just nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1115" target="_blank">00:18:35.640</a></span> | <span class="t">It's just amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1116" target="_blank">00:18:36.720</a></span> | <span class="t">And then you compile your code and you run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1118" target="_blank">00:18:38.640</a></span> | <span class="t">And it starts stepping and you wait 24 hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1121" target="_blank">00:18:41.360</a></span> | <span class="t">And then it's stepping, doing some diagnostics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1124" target="_blank">00:18:44.920</a></span> | <span class="t">We have almost a 50% MFU here on one node, which is quite good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1130" target="_blank">00:18:50.880</a></span> | <span class="t">And you get really nice plots.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1132" target="_blank">00:18:52.160</a></span> | <span class="t">And you beat the GPT-2 on Hellaswag.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1134" target="_blank">00:18:54.400</a></span> | <span class="t">And basically, that's just the case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1135" target="_blank">00:18:55.920</a></span> | <span class="t">that the optimization went well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1137" target="_blank">00:18:57.400</a></span> | <span class="t">No crazy numerical issues, lost bytes or anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1139" target="_blank">00:18:59.480</a></span> | <span class="t">like that for this size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1141" target="_blank">00:19:01.360</a></span> | <span class="t">And yeah, it should be a nearly good model in LLN.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1147" target="_blank">00:19:07.500</a></span> | <span class="t">We can still compare to PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1148" target="_blank">00:19:08.860</a></span> | <span class="t">Because remember, we have PyTorch implementation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1150" target="_blank">00:19:10.900</a></span> | <span class="t">for all this stuff in parallel on the side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1152" target="_blank">00:19:12.980</a></span> | <span class="t">And so you can run the whole untrained almost in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1156" target="_blank">00:19:16.460</a></span> | <span class="t">And we can compare the two implementations side-by-side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1159" target="_blank">00:19:19.060</a></span> | <span class="t">And in particular, at the time of writing that post--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1161" target="_blank">00:19:21.740</a></span> | <span class="t">and I don't know if this has changed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1163" target="_blank">00:19:23.280</a></span> | <span class="t">because the PyTorch team continues</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1164" target="_blank">00:19:24.700</a></span> | <span class="t">to optimize things over time-- but at the time of that post,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1167" target="_blank">00:19:27.940</a></span> | <span class="t">we were using, in LLN.C, 30% less memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1170" target="_blank">00:19:30.660</a></span> | <span class="t">And we were 20% faster in training just the throughput.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1173" target="_blank">00:19:33.700</a></span> | <span class="t">And I don't know if I fully super duper optimized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1175" target="_blank">00:19:35.860</a></span> | <span class="t">the PyTorch implementation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1176" target="_blank">00:19:36.980</a></span> | <span class="t">I did my personal best.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1178" target="_blank">00:19:38.360</a></span> | <span class="t">But we were able to, I think, beat PyTorch in training mode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1181" target="_blank">00:19:41.540</a></span> | <span class="t">specifically GPT-2 in LLN.C. If you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1184" target="_blank">00:19:44.880</a></span> | <span class="t">want to train anything else, you're in a lot of trouble.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1187" target="_blank">00:19:47.220</a></span> | <span class="t">[LAUGHTER]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1188" target="_blank">00:19:48.300</a></span> | <span class="t">You have to change your code a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1189" target="_blank">00:19:49.780</a></span> | <span class="t">And when I'm doing that, I won't come back to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1191" target="_blank">00:19:51.820</a></span> | <span class="t">But for GPT-2 training, we're better after all that work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1195" target="_blank">00:19:55.620</a></span> | <span class="t">And it also compiles and runs much faster,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1197" target="_blank">00:19:57.380</a></span> | <span class="t">which is beautiful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1198" target="_blank">00:19:58.220</a></span> | <span class="t">Torch compile actually takes quite a bit of time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1199" target="_blank">00:19:59.840</a></span> | <span class="t">like a minute or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1200" target="_blank">00:20:00.880</a></span> | <span class="t">You're just waiting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1201" target="_blank">00:20:01.780</a></span> | <span class="t">So that's also something that I personally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1203" target="_blank">00:20:03.780</a></span> | <span class="t">don't like to work with usually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1205" target="_blank">00:20:05.460</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1206" target="_blank">00:20:06.500</a></span> | <span class="t">So looping back around, turns out it wasn't all that simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1209" target="_blank">00:20:09.220</a></span> | <span class="t">[LAUGHTER]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1209" target="_blank">00:20:09.720</a></span> | <span class="t">I mean, there was a lot of stuff involved.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1211" target="_blank">00:20:11.460</a></span> | <span class="t">And it took a few months for a few people.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1213" target="_blank">00:20:13.420</a></span> | <span class="t">But it was fun.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1216" target="_blank">00:20:16.460</a></span> | <span class="t">We learned a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1217" target="_blank">00:20:17.340</a></span> | <span class="t">And we were friends along the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1218" target="_blank">00:20:18.780</a></span> | <span class="t">This is the LLN.C core devs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1220" target="_blank">00:20:20.300</a></span> | <span class="t">[LAUGHTER]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1222" target="_blank">00:20:22.620</a></span> | <span class="t">So it was great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1224" target="_blank">00:20:24.860</a></span> | <span class="t">Ongoing work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1226" target="_blank">00:20:26.020</a></span> | <span class="t">We are adding a lot of free support.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1227" target="_blank">00:20:27.540</a></span> | <span class="t">We actually thought maybe we would have it done by today.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1229" target="_blank">00:20:29.960</a></span> | <span class="t">But there's a little bit more work to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1233" target="_blank">00:20:33.880</a></span> | <span class="t">But we will have LLNA 3.1 training in LLN.C very, very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1237" target="_blank">00:20:37.040</a></span> | <span class="t">soon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1238" target="_blank">00:20:38.240</a></span> | <span class="t">We will have FP8 support.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1240" target="_blank">00:20:40.280</a></span> | <span class="t">So everyone has been working on this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1242" target="_blank">00:20:42.920</a></span> | <span class="t">And there's a big PR that's coming for FP8 support,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1245" target="_blank">00:20:45.840</a></span> | <span class="t">which is also interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1247" target="_blank">00:20:47.840</a></span> | <span class="t">And there's a lot of notable forks in LLN.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1250" target="_blank">00:20:50.160</a></span> | <span class="t">They're all listed on the GitHub repo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1252" target="_blank">00:20:52.240</a></span> | <span class="t">The AMP fork is very active, as far as I understand it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1255" target="_blank">00:20:55.360</a></span> | <span class="t">and quite good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1256" target="_blank">00:20:56.480</a></span> | <span class="t">I think also the C++ CUDA fork is quite nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1260" target="_blank">00:21:00.340</a></span> | <span class="t">And so a lot of folks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1262" target="_blank">00:21:02.940</a></span> | <span class="t">So I encourage you to also work LLN.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1265" target="_blank">00:21:05.420</a></span> | <span class="t">It's fairly readable, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1266" target="_blank">00:21:06.740</a></span> | <span class="t">I try to keep it clean, well-documented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1268" target="_blank">00:21:08.420</a></span> | <span class="t">I think it's pretty well understood what's in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1270" target="_blank">00:21:10.580</a></span> | <span class="t">It's only maybe like, I think, 3,000 lines of code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1273" target="_blank">00:21:13.340</a></span> | <span class="t">basically C mostly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1275" target="_blank">00:21:15.700</a></span> | <span class="t">And one more thought, I think, that I wanted to get across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1278" target="_blank">00:21:18.120</a></span> | <span class="t">is it wasn't all that haphazard to start the project.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1282" target="_blank">00:21:22.220</a></span> | <span class="t">I had another motivation for starting the project.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1286" target="_blank">00:21:26.100</a></span> | <span class="t">And that's that I think, I mean, what is LLN.C like?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1288" target="_blank">00:21:28.980</a></span> | <span class="t">PyTorch is, especially when you push compilers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1291" target="_blank">00:21:31.380</a></span> | <span class="t">a bit like TCC for software 2.0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1293" target="_blank">00:21:33.180</a></span> | <span class="t">It's a compiler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1294" target="_blank">00:21:34.240</a></span> | <span class="t">But LLN.C is a bit like writing assembly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1296" target="_blank">00:21:36.260</a></span> | <span class="t">where you're doing everything manually, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1298" target="_blank">00:21:38.820</a></span> | <span class="t">And basically I think we wrote LLN.C as multiple people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1303" target="_blank">00:21:43.820</a></span> | <span class="t">over a duration of three months,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1305" target="_blank">00:21:45.860</a></span> | <span class="t">and got something that was faster than PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1307" target="_blank">00:21:47.860</a></span> | <span class="t">in a specific setting of GPT-3 training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1310" target="_blank">00:21:50.500</a></span> | <span class="t">And so this exercise basically proves that this is possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1313" target="_blank">00:21:53.860</a></span> | <span class="t">Now the problem is you need to spend multiple people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1316" target="_blank">00:21:56.040</a></span> | <span class="t">several months.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1317" target="_blank">00:21:57.100</a></span> | <span class="t">But if LLNs are about to become much better at coding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1319" target="_blank">00:21:59.980</a></span> | <span class="t">over time, then I think you can expect that the LLN</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1322" target="_blank">00:22:02.900</a></span> | <span class="t">could actually do this for any custom application over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1325" target="_blank">00:22:05.540</a></span> | <span class="t">And so the LLNs could act as a kind of compiler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1328" target="_blank">00:22:08.540</a></span> | <span class="t">for any custom application you're interested in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1330" target="_blank">00:22:10.340</a></span> | <span class="t">They're gonna do all the LLN.C work,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1332" target="_blank">00:22:12.180</a></span> | <span class="t">and they're gonna output the binary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1333" target="_blank">00:22:13.940</a></span> | <span class="t">that you can compile and run for your specific applications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1336" target="_blank">00:22:16.460</a></span> | <span class="t">So I don't actually know if we,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1337" target="_blank">00:22:17.820</a></span> | <span class="t">like the use of Python and PyTorch and everything else,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1340" target="_blank">00:22:20.500</a></span> | <span class="t">it's just a crutch because we humans are finite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1342" target="_blank">00:22:22.860</a></span> | <span class="t">We have finite knowledge, intelligence, and potential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1345" target="_blank">00:22:25.340</a></span> | <span class="t">But actually, don't you wanna write all code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1347" target="_blank">00:22:27.180</a></span> | <span class="t">in custom CUDA kernels and so on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1349" target="_blank">00:22:29.500</a></span> | <span class="t">Like, maybe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1350" target="_blank">00:22:30.660</a></span> | <span class="t">And so the other thing that I think is interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1353" target="_blank">00:22:33.100</a></span> | <span class="t">is the LLN.C repo might be useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1355" target="_blank">00:22:35.620</a></span> | <span class="t">because in the early stages of these LLNs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1357" target="_blank">00:22:37.940</a></span> | <span class="t">and their intelligence, they might not be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1359" target="_blank">00:22:39.820</a></span> | <span class="t">to write this code from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1360" target="_blank">00:22:40.980</a></span> | <span class="t">You just prompted them, "Write GPT-2 on C."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1363" target="_blank">00:22:43.060</a></span> | <span class="t">You probably won't get LLN.C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1364" target="_blank">00:22:44.800</a></span> | <span class="t">But you're a lot more likely to get it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1366" target="_blank">00:22:46.260</a></span> | <span class="t">if you put LLN.C in the context of a session LLN,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1369" target="_blank">00:22:49.740</a></span> | <span class="t">and you can expect that the few-shot learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1371" target="_blank">00:22:51.180</a></span> | <span class="t">would be very helpful for the LLN</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1372" target="_blank">00:22:52.580</a></span> | <span class="t">to basically get an example code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1374" target="_blank">00:22:54.180</a></span> | <span class="t">And so I think LLN.C could be very useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1376" target="_blank">00:22:56.060</a></span> | <span class="t">for this example code to get to the LLNs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1377" target="_blank">00:22:57.820</a></span> | <span class="t">'cause they're about to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1378" target="_blank">00:22:58.660</a></span> | <span class="t">all of our custom applications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1380" target="_blank">00:23:00.260</a></span> | <span class="t">And so I think this is actually not unlikely to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1383" target="_blank">00:23:03.520</a></span> | <span class="t">Yeah, this is kind of likely to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1384" target="_blank">00:23:04.820</a></span> | <span class="t">So I think software development in general</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1386" target="_blank">00:23:06.580</a></span> | <span class="t">will probably change a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1387" target="_blank">00:23:07.420</a></span> | <span class="t">And to me, LLN.C is an exploration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1389" target="_blank">00:23:09.260</a></span> | <span class="t">of whether this is even possible,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1390" target="_blank">00:23:10.740</a></span> | <span class="t">because if it is possible,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1391" target="_blank">00:23:11.660</a></span> | <span class="t">then maybe this is what's gonna happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1393" target="_blank">00:23:13.380</a></span> | <span class="t">So, yeah, that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1395" target="_blank">00:23:15.260</a></span> | <span class="t">Thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1396" target="_blank">00:23:16.100</a></span> | <span class="t">(audience applauding)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1399" target="_blank">00:23:19.260</a></span> | <span class="t">(audience cheering)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=BmdOt6A6tHM&t=1402" target="_blank">00:23:22.260</a></span> | <span class="t">- All right, well, the morning session talks.</span></div></div></body></html>