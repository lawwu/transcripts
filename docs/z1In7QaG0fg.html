<html><head><title>Lesson 23: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 23: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=z1In7QaG0fg"><img src="https://i.ytimg.com/vi/z1In7QaG0fg/maxresdefault.jpg" style="width:50%;"></a><div><br></div><div style="text-align: left;"><a href="./z1In7QaG0fg.html">Whisper Transcript</a> | <a href="./transcript_z1In7QaG0fg.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=0" target="_blank">00:00:00.640</a></span> | <span class="t">Hi everybody, today we are covering lesson 23 and we're here with Jono and Tanishk. How are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=7" target="_blank">00:00:07.360</a></span> | <span class="t">you guys both doing? Doing well, excited for another lesson. Yeah likewise. Great, I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=18" target="_blank">00:00:18.720</a></span> | <span class="t">shamefully have to start with admitting to a bug which actually is rather, well I don't know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=28" target="_blank">00:00:28.320</a></span> | <span class="t">it kind of messed up things in a sense but I kind of I think it's really interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=32" target="_blank">00:00:32.240</a></span> | <span class="t">actually what happened. The bug, it was in notebook 23, the Keras notebook and it's about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=40" target="_blank">00:00:40.480</a></span> | <span class="t">the measure measuring the FID. So to recall FID measures how similar a bunch of samples are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=52" target="_blank">00:00:52.960</a></span> | <span class="t">from a model to a bunch of samples of real images and that similarity is defined in this kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=59" target="_blank">00:00:59.600</a></span> | <span class="t">like some kind of distance between the distributions of the features in a classifier or some kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=67" target="_blank">00:01:07.120</a></span> | <span class="t">model. So that means that to get FID we have to load a model and we have to pass it some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=78" target="_blank">00:01:18.960</a></span> | <span class="t">data loaders so that it can calculate what the samples look like from real images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=84" target="_blank">00:01:24.240</a></span> | <span class="t">Now the problem is that the data loaders I was passing actually had images that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=91" target="_blank">00:01:31.920</a></span> | <span class="t">the pixels were between negative 0.5 and positive 0.5 but you might recall this model that I trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=101" target="_blank">00:01:41.600</a></span> | <span class="t">has pixels between negative 1 and 1. So what this image eval class would have seen and specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=110" target="_blank">00:01:50.480</a></span> | <span class="t">this this C model which we are putting which we are getting the features from is it would have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=114" target="_blank">00:01:54.480</a></span> | <span class="t">seen a whole bunch of unusually low contrast images so they wouldn't really have looked like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=122" target="_blank">00:02:02.000</a></span> | <span class="t">many things in the data set because in fact in the data set I think particularly for fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=127" target="_blank">00:02:07.120</a></span> | <span class="t">MNIST things are pretty consistently you know normalized in terms of going all the way from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=134" target="_blank">00:02:14.320</a></span> | <span class="t">0 to 1 or negative 1 to 1 I guess 0 to 255 in the original. And so as a result I think what would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=142" target="_blank">00:02:22.560</a></span> | <span class="t">have happened is that the features that came out of this would have been kind of weird and they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=149" target="_blank">00:02:29.680</a></span> | <span class="t">might not have necessarily consistently said oh these are t-shirt features and these are shoe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=154" target="_blank">00:02:34.880</a></span> | <span class="t">features but they would have said oh this is a weird low contrast low contrast image feature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=159" target="_blank">00:02:39.760</a></span> | <span class="t">And so then the shame continues in that I added another bug on top of this bug which is when I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=169" target="_blank">00:02:49.520</a></span> | <span class="t">then did the sampling I didn't I didn't multiply by two and the data that I trained it on was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=183" target="_blank">00:03:03.200</a></span> | <span class="t">actually the same data loaders or that well the specifically the same transform the same Noisify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=188" target="_blank">00:03:08.400</a></span> | <span class="t">transform well where did it come from it's the same yeah the same transform I not Noisify the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=198" target="_blank">00:03:18.160</a></span> | <span class="t">same transform I which yeah previously was point from negative 0.5 to 0.5 so I trained the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=204" target="_blank">00:03:24.720</a></span> | <span class="t">using this restricted input space as well and therefore it was spitting out things that were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=211" target="_blank">00:03:31.200</a></span> | <span class="t">between negative 0.5 and 0.5. And so the FID then said wow these are so similar the samples are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=220" target="_blank">00:03:40.880</a></span> | <span class="t">consistently spitting out features of low contrast things and all of the real samples are low</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=225" target="_blank">00:03:45.600</a></span> | <span class="t">contrast things so those are really similar and that's how we got really low numbers. So those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=231" target="_blank">00:03:51.280</a></span> | <span class="t">low numbers are wrong so I was a bit surprised I guess that that the Keras model was doing so much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=236" target="_blank">00:03:56.720</a></span> | <span class="t">better and it certainly it made me a big believer in the Keras model but actually it's not doing so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=242" target="_blank">00:04:02.960</a></span> | <span class="t">much better so once we fix that the FID's are actually around five six five and the reals are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=254" target="_blank">00:04:14.720</a></span> | <span class="t">two and a half. So to compare</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=264" target="_blank">00:04:24.000</a></span> | <span class="t">we were getting some pretty good results in cosine. So cosine yeah we were getting three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=268" target="_blank">00:04:28.480</a></span> | <span class="t">to four depending on how many steps we were doing DDIM. So the result of this is that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=277" target="_blank">00:04:37.840</a></span> | <span class="t">somewhat odd situation where the cosine model where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=288" target="_blank">00:04:48.720</a></span> | <span class="t">scaled it accidentally to be negative 0.5 to 0.5 and then post sampling multiplied by two so we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=298" target="_blank">00:04:58.160</a></span> | <span class="t">not cheating like the Keras one used to be is working better than Keras which yeah it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=304" target="_blank">00:05:04.000</a></span> | <span class="t">surprise to me because I was thinking Keras was kind of like in theory optimally scaling things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=312" target="_blank">00:05:12.160</a></span> | <span class="t">but I guess the truth is it was scaling things to unit variance but there's nothing particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=317" target="_blank">00:05:17.760</a></span> | <span class="t">to say that's optimally scaling things and so empirically we've found kind of accidentally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=323" target="_blank">00:05:23.040</a></span> | <span class="t">a better way to scale things and also our dependent variable is different you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=332" target="_blank">00:05:32.320</a></span> | <span class="t">our dependent variable is not that Keras you know C-mix combination but our dependent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=338" target="_blank">00:05:38.400</a></span> | <span class="t">is just the noise the zero one noise you know the noise before it's multiplied by alpha.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=346" target="_blank">00:05:46.800</a></span> | <span class="t">Okay so that's that's the bug. Anyway I promised last time we would stop looking at fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=354" target="_blank">00:05:54.880</a></span> | <span class="t">MNIST for a while so let's move on to tiny image net. So and the reason we're going to do this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=364" target="_blank">00:06:04.720</a></span> | <span class="t">because we want to I want to show an example of we're going to try and create units today and I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=371" target="_blank">00:06:11.360</a></span> | <span class="t">wanted to show an example of a of a nice unit we can create that combines a lot of the ideas we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=376" target="_blank">00:06:16.640</a></span> | <span class="t">been looking at it's going to be a super resolution unit and doing super resolution on fashion MNIST</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=383" target="_blank">00:06:23.120</a></span> | <span class="t">isn't going to be very interesting because the maximum training size we have is 28 by 28. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=388" target="_blank">00:06:28.320</a></span> | <span class="t">so I thought we'd go a little bit bigger than that to tiny image net which is 64 by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=398" target="_blank">00:06:38.080</a></span> | <span class="t">I found it quite difficult actually to find tiny image net data but eventually I discovered that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=404" target="_blank">00:06:44.480</a></span> | <span class="t">it's still on the Stanford servers where it was originally created it's just not linked to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=408" target="_blank">00:06:48.880</a></span> | <span class="t">anywhere. So we'll try to if this disappears we will we will keep our forum and website up to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=415" target="_blank">00:06:55.680</a></span> | <span class="t">date with other places to find it. Anyway so for now we can grab the URL from there and unpack it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=428" target="_blank">00:07:08.560</a></span> | <span class="t">So SHUtil is a very handy little library inside the Python standard library and one of the things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=433" target="_blank">00:07:13.360</a></span> | <span class="t">it has is a very handy unpack archives which can handle zip files and it's going to put it in our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=438" target="_blank">00:07:18.640</a></span> | <span class="t">data directory. So I yeah just you know there's a few different ways we could process this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=447" target="_blank">00:07:27.120</a></span> | <span class="t">and I thought we might experiment some things but I thought yeah it wouldn't be a bad idea to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=452" target="_blank">00:07:32.160</a></span> | <span class="t">try doing things the reasonably kind of manual way just to see you know what that looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=459" target="_blank">00:07:39.680</a></span> | <span class="t">and often this is the easiest way to do things because you know that's a very well-defined set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=465" target="_blank">00:07:45.280</a></span> | <span class="t">of steps right. So step one is to create a data set. So a data set is just literally something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=471" target="_blank">00:07:51.200</a></span> | <span class="t">that has a length and that you can index into it so it has to have these two things to find.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=476" target="_blank">00:07:56.800</a></span> | <span class="t">You don't have to inherit from anything you just have to define these two things. Broadly speaking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=484" target="_blank">00:08:04.320</a></span> | <span class="t">in Python you generally don't have to inherit from things you just have to provide the methods that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=489" target="_blank">00:08:09.440</a></span> | <span class="t">are expected. So our data set is in a directory called tiny image net 200 and then there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=501" target="_blank">00:08:21.520</a></span> | <span class="t">train directory and a val directory for the training and the validation set and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=505" target="_blank">00:08:25.520</a></span> | <span class="t">train directory this is pretty classic normal thing each category so this is a category</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=513" target="_blank">00:08:33.120</a></span> | <span class="t">has images in a separate folder and specifically they're in images subfolder. So what I wanted to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=521" target="_blank">00:08:41.200</a></span> | <span class="t">do was to just grab start with grab all of the files in path slash train or the image files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=528" target="_blank">00:08:48.640</a></span> | <span class="t">so the python standard library has a glob function which searches recursively if asked to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=538" target="_blank">00:08:58.240</a></span> | <span class="t">for everything that matches this well this specification. So this specification is path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=547" target="_blank">00:09:07.200</a></span> | <span class="t">slash star dot jpeg and then this star star here I don't know why we need to do it twice it's a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=553" target="_blank">00:09:13.200</a></span> | <span class="t">weird it also that you also need that to be recursive. So to be recursive you both have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=557" target="_blank">00:09:17.760</a></span> | <span class="t">to say recursive true here and also put star star before the slash here. So that's going to give us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=564" target="_blank">00:09:24.160</a></span> | <span class="t">a list of all files inside path train and so then if we index into that training data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=574" target="_blank">00:09:34.480</a></span> | <span class="t">with zero that will call get item passing an i of zero and so we will then return a tuple. One is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=582" target="_blank">00:09:42.080</a></span> | <span class="t">the thing in self dot files i which is this file and then the label for it and the label is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=592" target="_blank">00:09:52.560</a></span> | <span class="t">that so it's the parent's parent's name parent's parent's name and so that's the name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=602" target="_blank">00:10:02.160</a></span> | <span class="t">Okay so there's a data set that returns two strings when you index into it a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=607" target="_blank">00:10:07.920</a></span> | <span class="t">two strings the first is the name of the image file the so the path of the image file and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=613" target="_blank">00:10:13.200</a></span> | <span class="t">second is the name of the category it's in. These weird names are called wordnet categories they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=621" target="_blank">00:10:21.040</a></span> | <span class="t">like codes that indicate concepts basically in English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=625" target="_blank">00:10:25.920</a></span> | <span class="t">So one of the reasons I actually used this particular data set is because it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=634" target="_blank">00:10:34.320</a></span> | <span class="t">force us to do some more data processing which I think is good practice and that's because weirdly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=642" target="_blank">00:10:42.000</a></span> | <span class="t">in the validation set although it's in tiny image net 200 slash val which is the not weird part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=648" target="_blank">00:10:48.480</a></span> | <span class="t">the weird part is that they are not then in subdirectories organized by label instead there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=658" target="_blank">00:10:58.080</a></span> | <span class="t">is a separate val annotations dot text file which looks like this so it says for each file name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=672" target="_blank">00:11:12.640</a></span> | <span class="t">what category is it it's also got the like the bounding box of whereabouts that is but we're not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=678" target="_blank">00:11:18.880</a></span> | <span class="t">going to be using that today. So I decided to create a dictionary that would tell us for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=688" target="_blank">00:11:28.000</a></span> | <span class="t">file what category is it in so that means that I want to create a in this case here I'm doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=697" target="_blank">00:11:37.360</a></span> | <span class="t">something exactly like a list comprehension but because it's not in square brackets it's a generator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=701" target="_blank">00:11:41.440</a></span> | <span class="t">comprehension so it'll generate it kind of stream out the the results and we're going to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=708" target="_blank">00:11:48.480</a></span> | <span class="t">each line in this file and we're going to split on tab so that's going to give us this and then this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=721" target="_blank">00:12:01.920</a></span> | <span class="t">and then this and then we're going to grab the first two and if you basically pass a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=729" target="_blank">00:12:09.760</a></span> | <span class="t">list of lists or list of tuples or whatever to dict it will create a dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=735" target="_blank">00:12:15.280</a></span> | <span class="t">using these pairs as key values so if we have a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=741" target="_blank">00:12:21.440</a></span> | <span class="t">there it is that's quite a nice neat way to do it and if you're not sure you can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=752" target="_blank">00:12:32.720</a></span> | <span class="t">click type dict type open brackets and then hit shift tab a couple of times and it'll show you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=757" target="_blank">00:12:37.520</a></span> | <span class="t">the various options and you can see here I'm doing dict iterable because my generator it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=763" target="_blank">00:12:43.360</a></span> | <span class="t">iterable and it says oh that's exactly as if you created a dictionary and then gone 4 kv in iterable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=769" target="_blank">00:12:49.120</a></span> | <span class="t">dk equals v so there's a nice little trick okay now we need a data set that works just like tiny</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=784" target="_blank">00:13:04.800</a></span> | <span class="t">data set but the get items are going to label things differently so I just inherited from tiny</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=790" target="_blank">00:13:10.720</a></span> | <span class="t">data set so that means we don't need to do init or len again and then get item again it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=795" target="_blank">00:13:15.840</a></span> | <span class="t">turn the i-th file this time the label will not be the parent parent name but we will look up in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=802" target="_blank">00:13:22.400</a></span> | <span class="t">the annotations dictionary the name of the file and so that works we can check the length works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=813" target="_blank">00:13:33.600</a></span> | <span class="t">so then um a fairly generally useful thing that I thought we'll then create is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=821" target="_blank">00:13:41.440</a></span> | <span class="t">that lets us transform any data set so here's a class you can pass it a data set and you can pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=831" target="_blank">00:13:51.440</a></span> | <span class="t">it a transformation for the x or the independent variable and you can pass the transformation from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=836" target="_blank">00:13:56.880</a></span> | <span class="t">the y and both of them default to no op that is no operation so it just doesn't change it at all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=844" target="_blank">00:14:04.240</a></span> | <span class="t">so a transform data set the length of it is just the length of the original data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=850" target="_blank">00:14:10.080</a></span> | <span class="t">but when we call get item it'll grab the tuple from the data set we passed in and it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=858" target="_blank">00:14:18.640</a></span> | <span class="t">return that tuple but with transform x and transform y applied to it does that make sense so far</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=869" target="_blank">00:14:29.520</a></span> | <span class="t">great okay so I don't like working with these n 0 3 0 things but the data set luckily has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=881" target="_blank">00:14:41.680</a></span> | <span class="t">word net ids file in it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=884" target="_blank">00:14:44.320</a></span> | <span class="t">so if I just open it up oh sorry this one actually is not quite going to help us this is just a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=897" target="_blank">00:14:57.120</a></span> | <span class="t">of all of the word net ids that they have images for we could have actually got this by simply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=904" target="_blank">00:15:04.080</a></span> | <span class="t">grabbing um by listing this directory it would have told us all the ids but they've got they've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=910" target="_blank">00:15:10.640</a></span> | <span class="t">also got just a the text file containing all of them so we can see that there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=916" target="_blank">00:15:16.160</a></span> | <span class="t">200 categories</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=923" target="_blank">00:15:23.520</a></span> | <span class="t">okay um and that's useful because we're going to want to change n 0 3 0 etc into an int</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=933" target="_blank">00:15:33.600</a></span> | <span class="t">and the way we can change it into an int is by simply saying oh we'll call we'll call this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=939" target="_blank">00:15:39.360</a></span> | <span class="t">zero and this one one and so forth right so the kind of the int to string or id to string version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=947" target="_blank">00:15:47.920</a></span> | <span class="t">of this is literally this list so zero will be there that but the string to int version where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=954" target="_blank">00:15:54.320</a></span> | <span class="t">you do this all the time is basically enumerate so that gives us the index and the value for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=961" target="_blank">00:16:01.120</a></span> | <span class="t">everything in the list so those are going to be our keys and values but actually we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=966" target="_blank">00:16:06.160</a></span> | <span class="t">invert it to become value colon key and that's what's true to id will be so note here that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=974" target="_blank">00:16:14.480</a></span> | <span class="t">have a dictionary comprehension you can tell because it's got curly brackets and a colon and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=980" target="_blank">00:16:20.800</a></span> | <span class="t">so here's our dictionary comprehension so we could have used that uh for this as well we could have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=988" target="_blank">00:16:28.320</a></span> | <span class="t">done a dictionary comprehension instead but um yeah so there's lots of ways of doing things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=994" target="_blank">00:16:34.880</a></span> | <span class="t">none of them's any better or worse than any other um okay so that's the uh the one those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1002" target="_blank">00:16:42.320</a></span> | <span class="t">word tags whatever do we have the the names for them or is that something yes the names i'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1009" target="_blank">00:16:49.360</a></span> | <span class="t">to get to yes shortly there's a word dot text so yeah all right i grabbed one batch of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1017" target="_blank">00:16:57.840</a></span> | <span class="t">and grabbed its main and standard deviation and so then i've just copied and pasted them in here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1022" target="_blank">00:17:02.480</a></span> | <span class="t">for normalizing um so my my transform x is going to be i'm going to read the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1031" target="_blank">00:17:11.920</a></span> | <span class="t">um if you read it as RGB that's going to force it to be three channels because actually some of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1037" target="_blank">00:17:17.680</a></span> | <span class="t">are only one channel uh divided by 255 so it'll be between zero and one and then we will normalize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1044" target="_blank">00:17:24.560</a></span> | <span class="t">and then for our y's we will go through strata id to get the id and just use that as our tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1054" target="_blank">00:17:34.640</a></span> | <span class="t">so it's you know doing it manually is actually pretty straightforward right because now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1061" target="_blank">00:17:41.920</a></span> | <span class="t">we just pass those to our tufim ds our transformed data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1065" target="_blank">00:17:45.680</a></span> | <span class="t">and we can check that you know you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1071" target="_blank">00:17:51.120</a></span> | <span class="t">yi is a tensor but we can look it up to get its value and xi is an image tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1089" target="_blank">00:18:09.920</a></span> | <span class="t">with three channels so channel by height by width has is normal for pytorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1095" target="_blank">00:18:15.920</a></span> | <span class="t">um so for showing images it's nice to denormalize them so that's just denormalizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1102" target="_blank">00:18:22.320</a></span> | <span class="t">and so if we show the image that we just grabbed it's a water jug i guess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1116" target="_blank">00:18:36.160</a></span> | <span class="t">all right so now we can create a data loader for our training set so it's going to contain our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1120" target="_blank">00:18:40.960</a></span> | <span class="t">transformed training data set and pass in a batch size this one has to be shuffled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1127" target="_blank">00:18:47.920</a></span> | <span class="t">not sure why i put num workers equals zero there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1133" target="_blank">00:18:53.440</a></span> | <span class="t">generally eight's pretty good if you've got at least eight cores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1140" target="_blank">00:19:00.800</a></span> | <span class="t">yeah so we can now grab an x batch and a y batch and take a look at a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1146" target="_blank">00:19:06.800</a></span> | <span class="t">denormalized image from there so there we've got a nice little kitty cat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1149" target="_blank">00:19:09.840</a></span> | <span class="t">so i think this is already looking better than fashion emnest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1155" target="_blank">00:19:15.200</a></span> | <span class="t">yeah so there's this thing words.txt that they've also provided and this is actually a list of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1165" target="_blank">00:19:25.520</a></span> | <span class="t">entire wordnet hierarchy so the top of the hierarchy is entity and one of the entity types</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1175" target="_blank">00:19:35.360</a></span> | <span class="t">is a physical entity or an abstract entity entities can be things and so forth so this is how wordnet is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1185" target="_blank">00:19:45.520</a></span> | <span class="t">yeah handled so this is quite a big file actually so if we go through each item of that file and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1196" target="_blank">00:19:56.240</a></span> | <span class="t">again split on tabs because split on tabs that's what backslash t means is going to give us the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1206" target="_blank">00:20:06.320</a></span> | <span class="t">wordnet id and then the name of it so now we can go through all of those they call them sin sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1216" target="_blank">00:20:16.400</a></span> | <span class="t">and if the key is in our list of the 200 that we want we'll keep it and we don't really want like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1227" target="_blank">00:20:27.280</a></span> | <span class="t">causal agent comma cause comma causal agency the first one generally seems to be the most normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1234" target="_blank">00:20:34.720</a></span> | <span class="t">so i just split on comma and grab the first one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1239" target="_blank">00:20:39.520</a></span> | <span class="t">um all right so that's um so we could then go through our y batch and just turn each of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1251" target="_blank">00:20:51.200</a></span> | <span class="t">numbers into strings and then look at each of those up in our sin sets and join them up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1255" target="_blank">00:20:55.680</a></span> | <span class="t">and then use those as titles to see our Egyptian cat and our cliff and our guacamole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1264" target="_blank">00:21:04.400</a></span> | <span class="t">it's a monarch butterfly and so forth and you can see that this is going to be quite tricky</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1270" target="_blank">00:21:10.480</a></span> | <span class="t">because like a cliff this is a cliff dwelling for instance could be quite you know complicated um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1277" target="_blank">00:21:17.200</a></span> | <span class="t">i have a feeling for this they intentionally like a hundred of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1281" target="_blank">00:21:21.600</a></span> | <span class="t">categories might have come from the normal image net and i think they might have then picked a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1286" target="_blank">00:21:26.800</a></span> | <span class="t">hundred that are designed to be particularly difficult or something if memory serves correctly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1293" target="_blank">00:21:33.280</a></span> | <span class="t">um all right so then we could define a transform batch function with the same basic idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1300" target="_blank">00:21:40.880</a></span> | <span class="t">and that's just gonna yeah transform the x and the y in a batch um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1308" target="_blank">00:21:48.960</a></span> | <span class="t">oh yes we're about to use that i should move that down a bit because we're not quite there yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1317" target="_blank">00:21:57.280</a></span> | <span class="t">okay so before that we can create our data loaders we created a get dls back in an earlier lesson</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1323" target="_blank">00:22:03.920</a></span> | <span class="t">which simply turns that into a data loader and that into a data loader and this one gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1328" target="_blank">00:22:08.480</a></span> | <span class="t">shuffled and that one doesn't and so forth um oh i see this is where we do our num workers cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1334" target="_blank">00:22:14.240</a></span> | <span class="t">um all right so then oh yeah so then we want to add um our data augmentation so i i noticed that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1347" target="_blank">00:22:27.120</a></span> | <span class="t">um training a tiny image net model i mean it's it's a much harder thing to do than fashion feminist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1355" target="_blank">00:22:35.920</a></span> | <span class="t">um and um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1359" target="_blank">00:22:39.040</a></span> | <span class="t">overfitting was actually a real challenge um and i guess it's because 64 by 64 isn't that many pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1370" target="_blank">00:22:50.640</a></span> | <span class="t">um um so yeah so i found i really needed data augmentation to make much progress at all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1377" target="_blank">00:22:57.520</a></span> | <span class="t">now um very common data augmentation is called random resource crop which is basically to pick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1386" target="_blank">00:23:06.160</a></span> | <span class="t">like one area inside and then zoom into it and make that your image but for such low resolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1393" target="_blank">00:23:13.120</a></span> | <span class="t">images that tends to work really poorly because it's going to introduce a lot of kind of blurring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1398" target="_blank">00:23:18.960</a></span> | <span class="t">artifacts so instead for small images i think it's better to add a bit of padding around them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1405" target="_blank">00:23:25.360</a></span> | <span class="t">and then randomly pick a 64 by 64 area from that padded area so it's just going to shift them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1412" target="_blank">00:23:32.640</a></span> | <span class="t">slightly it's not a lot of augmentation but it's something and then we do our random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1417" target="_blank">00:23:37.520</a></span> | <span class="t">horizontal flips and then we'll use that random arrays thing that we created earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1423" target="_blank">00:23:43.200</a></span> | <span class="t">um this is just something i was experimenting with so yeah so now we can use that batch transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1430" target="_blank">00:23:50.800</a></span> | <span class="t">callback using transform batch passing in those transforms so um with um torch vision transforms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1441" target="_blank">00:24:01.360</a></span> | <span class="t">so this capital t is torch vision transforms um yeah because these are all um nn dot modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1449" target="_blank">00:24:09.760</a></span> | <span class="t">you can pass them to nn dot sequential to just have each of them called one at a time in a row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1454" target="_blank">00:24:14.880</a></span> | <span class="t">there's nothing magic about this it's just doing function composition we could easily create our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1462" target="_blank">00:24:22.480</a></span> | <span class="t">own um in fact they're also the transforms.compose that does the same thing yeah i was going to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1472" target="_blank">00:24:32.640</a></span> | <span class="t">so we've got a fast um uh fast core dot compose which uh as you can see basically it just says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1481" target="_blank">00:24:41.920</a></span> | <span class="t">for f in funcs x equals f of x um yeah i don't know is there is there's a yeah torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1490" target="_blank">00:24:50.160</a></span> | <span class="t">torch vision compose i think might be the kind of the old way to do it is that right i'm not sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1497" target="_blank">00:24:57.120</a></span> | <span class="t">i have a feeling maybe this is considered the better way now because it's kind of scriptable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1502" target="_blank">00:25:02.000</a></span> | <span class="t">i'm not promising that though um but yeah it does basically the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1507" target="_blank">00:25:07.360</a></span> | <span class="t">okay so yeah we can now create um a model as usual um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1516" target="_blank">00:25:16.400</a></span> | <span class="t">okay so basically um i copied the get model with dropout get drop model from our earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1528" target="_blank">00:25:28.400</a></span> | <span class="t">tiny sorry our earlier fashion emnist um stuff um and i yeah started with uh kernel size five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1539" target="_blank">00:25:39.120</a></span> | <span class="t">convolution and then yeah a bunch of res blocks um um yeah so this is um oh what we've used to seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1553" target="_blank">00:25:53.440</a></span> | <span class="t">before um and so we can take a look in this case as it quite often seems to be the case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1560" target="_blank">00:26:00.640</a></span> | <span class="t">we accidentally end up with no random erasing let's just run it again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1564" target="_blank">00:26:04.640</a></span> | <span class="t">really doesn't want to do random erasing here we go so we can see it so um yeah there's this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1573" target="_blank">00:26:13.120</a></span> | <span class="t">very small border you can hardly see sometimes and a bit of random erasing and it's been done um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1579" target="_blank">00:26:19.760</a></span> | <span class="t">you know all of the batch is being transformed or augmented in the same way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1583" target="_blank">00:26:23.680</a></span> | <span class="t">which is kind of okay um it's certainly faster um it can be a bit of a problem if you have like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1593" target="_blank">00:26:33.440</a></span> | <span class="t">one batch that has lots and lots and lots of augmentation being done to it and it could be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1598" target="_blank">00:26:38.560</a></span> | <span class="t">like really hard to recognize and that could cause the loss to be a lot in that batch and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1605" target="_blank">00:26:45.200</a></span> | <span class="t">if you're like been training for ages that could kind of jump you out of the um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1612" target="_blank">00:26:52.080</a></span> | <span class="t">you know the smooth part of the of the lost surface um that's that's the one downside of this so i'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1619" target="_blank">00:26:59.360</a></span> | <span class="t">not going to say it's always a good idea to do augmentation at batch level but it can certainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1623" target="_blank">00:27:03.280</a></span> | <span class="t">speed things up a lot if you don't have heaps of cpus um all right so you can use that summary thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1633" target="_blank">00:27:13.760</a></span> | <span class="t">we created there's our model um and yeah because we're increasing the doubling the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1643" target="_blank">00:27:23.280</a></span> | <span class="t">channels as we're decreasing the grid size our number of mega flops per layer is constant so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1647" target="_blank">00:27:27.760</a></span> | <span class="t">that's a pretty good sign that we're using compute throughout um so yeah then we can train it with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1653" target="_blank">00:27:33.760</a></span> | <span class="t">adam w mixed precision um and our um augmentations so i then did the learning rate finder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1663" target="_blank">00:27:43.600</a></span> | <span class="t">and trained it for 25 epochs and got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1671" target="_blank">00:27:51.280</a></span> | <span class="t">nearly 60 59 percent and um yeah this took quite a while actually to get close to 60 percent i got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1681" target="_blank">00:28:01.680</a></span> | <span class="t">to admit um it uh and you can see that the training sets already up to 91 so we're kind of on the verge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1690" target="_blank">00:28:10.080</a></span> | <span class="t">of overfitting um um okay so then i thought all right um how do we do better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1706" target="_blank">00:28:26.560</a></span> | <span class="t">and i wanted to have a sense of like how much better could we get and i kind of tend to like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1712" target="_blank">00:28:32.160</a></span> | <span class="t">to look at papers with code which is a site that shows papers with their code and also like how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1718" target="_blank">00:28:38.960</a></span> | <span class="t">good results did they get so this is the image classification on tiny image net um and at first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1724" target="_blank">00:28:44.640</a></span> | <span class="t">i was like pretty disheartened to see all these like 90 plus things um but as i looked at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1734" target="_blank">00:28:54.320</a></span> | <span class="t">papers i realized something well the first thing is i noticed that these ticks here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1737" target="_blank">00:28:57.600</a></span> | <span class="t">represent extra training data so these are actually pre-trained models that are only fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1744" target="_blank">00:29:04.800</a></span> | <span class="t">tuned on tiny image net so that's a total cheat and then i looked more closely at this one and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1749" target="_blank">00:29:09.680</a></span> | <span class="t">actually these are also using pre-trained data so papers with code is actually incorrect um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1754" target="_blank">00:29:14.160</a></span> | <span class="t">and so the first ones i could see which i could clearly kind of replicate and made sense of was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1762" target="_blank">00:29:22.560</a></span> | <span class="t">this one so the the highest one that i'm confident of is this 72 um and so then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1770" target="_blank">00:29:30.560</a></span> | <span class="t">i kind of wanted to get a sense of right how you know how how much work is there to get from like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1780" target="_blank">00:29:40.880</a></span> | <span class="t">60 to 70 and how good is this um so i opened up the paper and so here's tiny image net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1794" target="_blank">00:29:54.320</a></span> | <span class="t">um and they've got like they're basically this paper turns out to be about a new type of mix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1801" target="_blank">00:30:01.040</a></span> | <span class="t">up data augmentation this is the normal kind of mix up and this is their special kind of mix up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1805" target="_blank">00:30:05.680</a></span> | <span class="t">and on a resnet 18 yeah i see they're getting like 63 64 65 with various different types of mix up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1812" target="_blank">00:30:12.880</a></span> | <span class="t">uh and kind of 64 or 65 for their special one and then if they use much bigger models than we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1819" target="_blank">00:30:19.120</a></span> | <span class="t">using um they can get up to 66 ish so that kind of made me think okay this classifier is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1825" target="_blank">00:30:25.120</a></span> | <span class="t">not not bad um but there's clearly room to improve it um and i can't help myself i always have to try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1833" target="_blank">00:30:33.680</a></span> | <span class="t">to do better so this is a good opportunity to learn about a trick that is used in um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1841" target="_blank">00:30:41.040</a></span> | <span class="t">real resnets which is in a real resnet we don't just say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1846" target="_blank">00:30:46.800</a></span> | <span class="t">how many filters or channels or activations per layer and then just go through and do a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1859" target="_blank">00:30:59.520</a></span> | <span class="t">you know try to conv each time um but instead um you can also say the number of res blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1871" target="_blank">00:31:11.760</a></span> | <span class="t">per her kind of down sampling layer so this would say do three res blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1878" target="_blank">00:31:18.000</a></span> | <span class="t">and you know then down sample or down sample and then do three res blocks or something like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1883" target="_blank">00:31:23.760</a></span> | <span class="t">or do three res blocks the first of which or the last of which is a down sample and then two res</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1888" target="_blank">00:31:28.000</a></span> | <span class="t">blocks uh with a down sample and then two res blocks with a down sample so this has got a total</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1893" target="_blank">00:31:33.040</a></span> | <span class="t">of one two three four five down samples but it's got it's rather than having one two three four five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1900" target="_blank">00:31:40.800</a></span> | <span class="t">res blocks it's going to have three four five six seven eight nine res blocks so it's nearly twice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1907" target="_blank">00:31:47.840</a></span> | <span class="t">as deep and so the way we do that is we just replace the places it was saying res block with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1914" target="_blank">00:31:54.080</a></span> | <span class="t">res underscore blocks and that's just a sequential which goes through the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1921" target="_blank">00:32:01.040</a></span> | <span class="t">blocks and creates a res block and you can do it a couple of ways in this case um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1928" target="_blank">00:32:08.400</a></span> | <span class="t">I said if it's the last one then make it stride two otherwise stride one so it's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1938" target="_blank">00:32:18.720</a></span> | <span class="t">down sampling at the end of each set of res blocks um so that's the only thing I changed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1944" target="_blank">00:32:24.320</a></span> | <span class="t">I changed res block to res blocks and passed in the number of blocks which is this okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1954" target="_blank">00:32:34.000</a></span> | <span class="t">um so the number of megaflops is now 7 10 ish which is more than double right so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1966" target="_blank">00:32:46.320</a></span> | <span class="t">should give should have more opportunity to learn stuff which also it could be more opportunity to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1970" target="_blank">00:32:50.400</a></span> | <span class="t">overfit um so again we do our lr find and uh yeah so let's do 25 epox and I didn't actually add more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1982" target="_blank">00:33:02.240</a></span> | <span class="t">augmentation um okay and that got up to nearly 62 so that was a good improvement um and you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=1993" target="_blank">00:33:13.920</a></span> | <span class="t">interestingly it's not overfitting more it's actually if anything less which you know there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2000" target="_blank">00:33:20.400</a></span> | <span class="t">something about its ability to actually learn um this which is slowing it down or something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2007" target="_blank">00:33:27.920</a></span> | <span class="t">um so I thought yeah it'd be nice to train it for longer so I decided to add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2019" target="_blank">00:33:39.920</a></span> | <span class="t">more augmentation um and uh to do that um I decided to use something called trivial augment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2031" target="_blank">00:33:51.120</a></span> | <span class="t">which is not a very well known approach but it deserves to be um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2039" target="_blank">00:33:59.040</a></span> | <span class="t">and it comes from Frank Hutter's lab he's he's Frank Hutter is somebody who consistently creates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2047" target="_blank">00:34:07.840</a></span> | <span class="t">extremely practical useful improvements um with much less of the nonsense that we often see from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2056" target="_blank">00:34:16.720</a></span> | <span class="t">the some of the huge well-funded labs um and so this one's kind of a bit of a reaction to some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2063" target="_blank">00:34:23.920</a></span> | <span class="t">previous approaches such as one called auto augment one called rand augment they might have both come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2071" target="_blank">00:34:31.920</a></span> | <span class="t">from google brain I'm not quite sure where they kind of used lots of like you know many many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2079" target="_blank">00:34:39.040</a></span> | <span class="t">thousands of tpu hours um to like optimize how every image is you know or how how each set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2086" target="_blank">00:34:46.720</a></span> | <span class="t">images is is augmented and um yeah what these guys did is they said well what if we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2092" target="_blank">00:34:52.000</a></span> | <span class="t">do that but we just randomly pick a different augmentation for each image um and that's what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2100" target="_blank">00:35:00.000</a></span> | <span class="t">they did they just uh they just said algorithm one is the procedure pick an augmentation pick an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2108" target="_blank">00:35:08.080</a></span> | <span class="t">amount do it um I feel like they're almost kind of like trying to make a point about writing this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2117" target="_blank">00:35:17.200</a></span> | <span class="t">algorithm here um um yeah and they basically find this is at least as good or often better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2126" target="_blank">00:35:26.720</a></span> | <span class="t">actually than the incredibly resource intensive ones the incredibly resource intensive ones also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2131" target="_blank">00:35:31.680</a></span> | <span class="t">kind of require a different version for every data set um which is why they describe this as a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2137" target="_blank">00:35:37.600</a></span> | <span class="t">tuning free um so rather nicely and surprisingly for me it's actually built into pytorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2144" target="_blank">00:35:44.080</a></span> | <span class="t">so if we go to pytorch's website and go to trivial augment wide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2154" target="_blank">00:35:54.000</a></span> | <span class="t">um yeah they show you some examples of trivial augment wide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2159" target="_blank">00:35:59.280</a></span> | <span class="t">we can create our own as well now the thing is um I found um that doing this at a batch level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2171" target="_blank">00:36:11.120</a></span> | <span class="t">worked poorly and I think the reason is what I described earlier I think sometimes it will pick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2178" target="_blank">00:36:18.400</a></span> | <span class="t">a really challenging augmentation to see on you know and it all totally don't mess up the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2184" target="_blank">00:36:24.080</a></span> | <span class="t">loss function and if every single image in the batch is like that then it'll shoot it off into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2189" target="_blank">00:36:29.520</a></span> | <span class="t">the distant parts of the of the um weight area um which is a good excuse for me to show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2200" target="_blank">00:36:40.320</a></span> | <span class="t">how to do augmentations um on a per item level um now um these actually require or some of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2214" target="_blank">00:36:54.640</a></span> | <span class="t">require um having a pil image the python imaging library image not a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2224" target="_blank">00:37:04.720</a></span> | <span class="t">so I had to change things around so we have to import image from pil um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2231" target="_blank">00:37:11.760</a></span> | <span class="t">and we have to change our tofum x now and we're going to do the augmentations in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2240" target="_blank">00:37:20.720</a></span> | <span class="t">instead um for the training set um so for the training set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2246" target="_blank">00:37:26.720</a></span> | <span class="t">we're going to set one fact for both so we're going to pass in something is just do you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2252" target="_blank">00:37:32.800</a></span> | <span class="t">to do augmentations so for the training set we're going to pass org equals true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2259" target="_blank">00:37:39.280</a></span> | <span class="t">and for the validation set we won't um so yeah so we so image.open is how you create a pil image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2267" target="_blank">00:37:47.680</a></span> | <span class="t">object um and then if we wanted augmentations then do these augmentations and then convert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2277" target="_blank">00:37:57.680</a></span> | <span class="t">it into a tensor so a torch vision has a dot to tensor we can then call and then we can normalize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2286" target="_blank">00:38:06.560</a></span> | <span class="t">it and actually I decided just to use torch visions normalize um I mean either is fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2292" target="_blank">00:38:12.320</a></span> | <span class="t">or this one works well and then again if you want augmentation then do your rand arrays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2298" target="_blank">00:38:18.560</a></span> | <span class="t">and if you remember our rand arrays was designed to kind of use um zero one distributed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2306" target="_blank">00:38:26.960</a></span> | <span class="t">gaussian noise so you want that to happen after normalization so that's why do this order so yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2314" target="_blank">00:38:34.560</a></span> | <span class="t">so now we don't need to use the batch tofum thing we're just doing it all directly in the data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2324" target="_blank">00:38:44.000</a></span> | <span class="t">so you can see you know you can do data augmentation in very simple ways without almost any framework</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2333" target="_blank">00:38:53.920</a></span> | <span class="t">help here in fact we're really not we're not doing any and nothing's coming from a framework really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2338" target="_blank">00:38:58.800</a></span> | <span class="t">it's just yeah it's just this little tofum ds we made um and so now yeah we just pass that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2346" target="_blank">00:39:06.640</a></span> | <span class="t">into our data loaders get deals um and we don't need any augmentation callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2353" target="_blank">00:39:13.360</a></span> | <span class="t">um all right so now we can keep improving things by doing something called pre-activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2366" target="_blank">00:39:26.160</a></span> | <span class="t">resnets so if we go back to our original resnet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2374" target="_blank">00:39:34.800</a></span> | <span class="t">you might recall that the way we did it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2378" target="_blank">00:39:38.560</a></span> | <span class="t">we have this conv block which consists two convolutions in a row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2388" target="_blank">00:39:48.880</a></span> | <span class="t">the second one has no activation and to remind you what conv is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2399" target="_blank">00:39:59.600</a></span> | <span class="t">is that we first of all do a conv and then optionally we do a normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2407" target="_blank">00:40:07.360</a></span> | <span class="t">and then optionally we do our activation function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2409" target="_blank">00:40:09.680</a></span> | <span class="t">so we end up and then the second of those has act equals none so basically what this is saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2419" target="_blank">00:40:19.120</a></span> | <span class="t">is go convolution norm activation convolution norm that's what self.com is and then this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2429" target="_blank">00:40:29.840</a></span> | <span class="t">the identity path so this does nothing at all if there's no downsampling or no change of channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2435" target="_blank">00:40:35.120</a></span> | <span class="t">and then we apply the activation function the final activation function to the whole thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2445" target="_blank">00:40:45.440</a></span> | <span class="t">so that was how the um original res block was designed which is kind of a bit of an accident</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2451" target="_blank">00:40:51.520</a></span> | <span class="t">because i to be honest when i wrote that i didn't bother looking at the paper i just did whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2455" target="_blank">00:40:55.840</a></span> | <span class="t">seemed reasonable in my head um but yeah then looking into it further i looked at this this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2462" target="_blank">00:41:02.800</a></span> | <span class="t">slightly later paper by the same author as of the resnet paper chiming her um and um um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2471" target="_blank">00:41:11.520</a></span> | <span class="t">timing her uh al drew um you know this uh this version here on the left as you can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2482" target="_blank">00:41:22.240</a></span> | <span class="t">conv norm relu conv norm add relu and um yeah he basically pointed out yeah you know what maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2493" target="_blank">00:41:33.920</a></span> | <span class="t">that's not great because the relu is being applied to the addition so there isn't actually a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2499" target="_blank">00:41:39.360</a></span> | <span class="t">an identity path at all so wouldn't it be nice if we could have a pure identity path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2503" target="_blank">00:41:43.680</a></span> | <span class="t">and so to do that he proposed reordering things to go norm relu conv norm relu conv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2512" target="_blank">00:41:52.000</a></span> | <span class="t">add and so this is called a pre-act or pre-activation res block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2521" target="_blank">00:42:01.600</a></span> | <span class="t">so that means i had to redefine conv to do norm then act and then conv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2528" target="_blank">00:42:08.880</a></span> | <span class="t">so my sequential now has the activation in both places</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2534" target="_blank">00:42:14.320</a></span> | <span class="t">and so yeah other than that um oh and then of course there's no activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2545" target="_blank">00:42:25.760</a></span> | <span class="t">happening in the res block because it's all happening in the cons</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2551" target="_blank">00:42:31.040</a></span> | <span class="t">does that make sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2553" target="_blank">00:42:33.840</a></span> | <span class="t">yeah makes sense yeah cool um so this is now the site this is exactly the same except we now need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2565" target="_blank">00:42:45.920</a></span> | <span class="t">to have an activation and a batch norm after all those blocks because previously it finished with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2572" target="_blank">00:42:52.640</a></span> | <span class="t">an activation norm and activation now it starts with them so we have to put these at the end it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2578" target="_blank">00:42:58.960</a></span> | <span class="t">also means we can't start with a res block anymore because if we started with a res block then it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2582" target="_blank">00:43:02.480</a></span> | <span class="t">would have an activation function at the start which would throw away half of our data which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2586" target="_blank">00:43:06.400</a></span> | <span class="t">would be a bad idea um so you've got to be a bit careful with some of the details um but yeah so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2595" target="_blank">00:43:15.120</a></span> | <span class="t">now you can see that each image is getting its own augmentation and so this one's been shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2602" target="_blank">00:43:22.320</a></span> | <span class="t">looks like it's a door or something because it's really hard to tell what the hell it is it's been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2605" target="_blank">00:43:25.680</a></span> | <span class="t">shared this one's been moved uh it looks like this one's also been shared um and you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2613" target="_blank">00:43:33.680</a></span> | <span class="t">also see they've got different amounts of random arrays on them um so yeah so i thought i'd try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2619" target="_blank">00:43:39.280</a></span> | <span class="t">change training that for 50 epochs and that got us to 65 percent which um is you know as good as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2639" target="_blank">00:43:59.440</a></span> | <span class="t">nearly as good as the you know normal mix up things that are getting even on a resonant 50s</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2645" target="_blank">00:44:05.360</a></span> | <span class="t">this is looking really good um so i won't spend time on this but i'll just mention i was kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2653" target="_blank">00:44:13.440</a></span> | <span class="t">curious like i mean one of the things i should mention also is they trained all these for 400 epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2657" target="_blank">00:44:17.760</a></span> | <span class="t">so i was kind of curious what would happen if we trained it a bit longer i wasn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2661" target="_blank">00:44:21.520</a></span> | <span class="t">patient enough to train it for 400 epochs but i thought i could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2668" target="_blank">00:44:28.000</a></span> | <span class="t">200 epochs so i just duplicated that last one um um that made it 200 epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2676" target="_blank">00:44:36.080</a></span> | <span class="t">and that got us to 67 and a half</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2683" target="_blank">00:44:43.520</a></span> | <span class="t">which yeah is better than any of their non-special mix ups so i think it just goes to show you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2697" target="_blank">00:44:57.120</a></span> | <span class="t">get you know genuinely state-of-the-art results so if we use their special mix up that would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2702" target="_blank">00:45:02.400</a></span> | <span class="t">interesting to try as well see if we can match their results there but you know we've we've built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2707" target="_blank">00:45:07.520</a></span> | <span class="t">all this from scratch um we didn't do the data augmentation from scratch because it's not very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2713" target="_blank">00:45:13.280</a></span> | <span class="t">interesting but uh yeah other than that um so i think that's really cool so i know that you did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2721" target="_blank">00:45:21.440</a></span> | <span class="t">some other experiments with the the pre-activation oh right yeah um right when i saw that when i saw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2731" target="_blank">00:45:31.280</a></span> | <span class="t">the pre-activation success i was quite enthusiastic about it so i actually thought like oh maybe you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2738" target="_blank">00:45:38.080</a></span> | <span class="t">should go back and actually use it everywhere um but for but weirdly enough i think it's weird</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2744" target="_blank">00:45:44.480</a></span> | <span class="t">like it it was worse for fashion MNIST and worse for like less data augmentation um i mean maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2752" target="_blank">00:45:52.720</a></span> | <span class="t">it's not that weird but because the idea of when et al introduced it they said this is to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2759" target="_blank">00:45:59.520</a></span> | <span class="t">deeper models you know there's a there's a more pure identity path um and so with that more pure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2765" target="_blank">00:46:05.920</a></span> | <span class="t">identity path um that that should kind of let the gradients flow through it more easily and so there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2772" target="_blank">00:46:12.560</a></span> | <span class="t">should be a smoother surface weight surface loss surface um so yeah i guess it makes sense that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2781" target="_blank">00:46:21.120</a></span> | <span class="t">you don't really see the benefits on less deep models um the bit i'm surprised you elaborate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2787" target="_blank">00:46:27.440</a></span> | <span class="t">because like it seems like that should be that that sort of uh justification should be true for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2792" target="_blank">00:46:32.480</a></span> | <span class="t">smaller models right or well yeah it does but smaller models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2799" target="_blank">00:46:39.840</a></span> | <span class="t">um are going to have a less bumpy surface anyway they've just got less dimensions to be bumpy on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2806" target="_blank">00:46:46.400</a></span> | <span class="t">and um there's less more importantly they're less deep so there's less room for gradients to explode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2813" target="_blank">00:46:53.920</a></span> | <span class="t">exponentially um so they're not as sensitive um but yeah i mean i can see why they don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2822" target="_blank">00:47:02.800</a></span> | <span class="t">necessarily help as much but i don't have any idea why they were worse and they were quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2827" target="_blank">00:47:07.520</a></span> | <span class="t">consistently worse yeah yeah i find it quite interesting too yeah yeah it's quite curious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2836" target="_blank">00:47:16.240</a></span> | <span class="t">and it's interesting that when we do these like experiments on things that nowadays are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2843" target="_blank">00:47:23.360</a></span> | <span class="t">considered pretty fundamental and foundational you kind of all the time discover things that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2849" target="_blank">00:47:29.120</a></span> | <span class="t">nobody seems to have noticed or written about or there's plenty of room to as a kind of a more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2854" target="_blank">00:47:34.720</a></span> | <span class="t">experimental researcher to do experiments and then go like oh that's interesting and then try and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2860" target="_blank">00:47:40.080</a></span> | <span class="t">figure out what's going on yeah um i think a lot of researchers go in the opposite direction and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2866" target="_blank">00:47:46.720</a></span> | <span class="t">they try to start with like theoretical assumptions and then test them um when i think about it i feel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2872" target="_blank">00:47:52.480</a></span> | <span class="t">like uh maybe a lot of the more successful folks in terms of people who build stuff that actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2877" target="_blank">00:47:57.920</a></span> | <span class="t">get used a more experimental first maybe um okay so um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2887" target="_blank">00:48:07.200</a></span> | <span class="t">shall we have a five minute break since we're kind of on the hour sure all right so let's now look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2898" target="_blank">00:48:18.720</a></span> | <span class="t">um notebook 25 super res uh i've just um copied a few things in the previous notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2907" target="_blank">00:48:27.680</a></span> | <span class="t">some transforms and our data sets and our dnorm and our trifim batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2914" target="_blank">00:48:34.880</a></span> | <span class="t">and our trifim x let me show you we're using trifim batch here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2921" target="_blank">00:48:41.520</a></span> | <span class="t">we're not even using trifim batch let's get rid of that because that's just confusing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2927" target="_blank">00:48:47.680</a></span> | <span class="t">okay so it looks like we're doing the per uh let's figure this out so what are we doing here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2934" target="_blank">00:48:54.000</a></span> | <span class="t">we've got um what our two data sets all right so the goal of this is we're going to do super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2940" target="_blank">00:49:00.800</a></span> | <span class="t">resolution not um classification so let's talk about what that means what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2948" target="_blank">00:49:08.240</a></span> | <span class="t">is the independent variable will be scaled down to a 32 by 32 pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2956" target="_blank">00:49:16.560</a></span> | <span class="t">image and the dependent variable will be the original image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2961" target="_blank">00:49:21.760</a></span> | <span class="t">and so to do random crop within a padded image and random flips both the independent and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2974" target="_blank">00:49:34.880</a></span> | <span class="t">dependent variable needs to have had exactly the same random cropping and exactly the same flipping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2978" target="_blank">00:49:38.880</a></span> | <span class="t">otherwise you can't say oh this is how you do super res to go from the 32 by 32 to the 64 by 64</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2986" target="_blank">00:49:46.240</a></span> | <span class="t">because it might be like oh it has to be flipped around and moved around so yes so for this kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=2990" target="_blank">00:49:50.640</a></span> | <span class="t">image reconstruction task um it's important to make sure that your um augmentation is done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3000" target="_blank">00:50:00.000</a></span> | <span class="t">the same way on the independent the dependent variable so that's why we've put it into our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3006" target="_blank">00:50:06.640</a></span> | <span class="t">data set um and so this is something people often get confused about and they don't know how to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3011" target="_blank">00:50:11.120</a></span> | <span class="t">it but it's actually pretty straightforward if we do it this way we just put it straight in the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3014" target="_blank">00:50:14.560</a></span> | <span class="t">set um and it doesn't require any framework fanciness um now then what i did do is i then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3025" target="_blank">00:50:25.760</a></span> | <span class="t">added random erasing just to the training set and the reason for that is i wanted to make the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3035" target="_blank">00:50:35.360</a></span> | <span class="t">super resolution task a bit more difficult which means sometimes it doesn't just do super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3041" target="_blank">00:50:41.040</a></span> | <span class="t">resolution but it also has to like replace some of the deleted pixels with proper pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3045" target="_blank">00:50:45.520</a></span> | <span class="t">and so it gives it a little bit more to do you know which um can be quite helpful it's kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3051" target="_blank">00:50:51.680</a></span> | <span class="t">it's it's a it's a data augmentation technique and also something to give it like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3055" target="_blank">00:50:55.680</a></span> | <span class="t">more of an opportunity to learn what the pictures really look like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3059" target="_blank">00:50:59.840</a></span> | <span class="t">um okay so with that in case that though these are going to do the padding random cropping and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3067" target="_blank">00:51:07.760</a></span> | <span class="t">flipping um the training set will also add random erasing and then we create data loaders from those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3073" target="_blank">00:51:13.360</a></span> | <span class="t">would it make sense to use the trivial augment here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3080" target="_blank">00:51:20.080</a></span> | <span class="t">the trivial augment did you say yeah um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3084" target="_blank">00:51:24.480</a></span> | <span class="t">maybe yeah i don't particularly see a reason not to if um if if well only if you found that uh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3097" target="_blank">00:51:37.120</a></span> | <span class="t">overfitting was a problem and if you did do it you would do it to both independent and dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3105" target="_blank">00:51:45.760</a></span> | <span class="t">variables um so yeah here you can see an example the independent variables some of the in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3111" target="_blank">00:51:51.680</a></span> | <span class="t">all of them actually have some random arrays the dependent doesn't so it has to figure out how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3115" target="_blank">00:51:55.680</a></span> | <span class="t">replace that with that and you can also see that this is very blocky and this is less blocky that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3126" target="_blank">00:52:06.080</a></span> | <span class="t">because this has been gone down to 32 by 32 pixels and this one's still at the 64 by 64</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3132" target="_blank">00:52:12.320</a></span> | <span class="t">so in fact once you go down that far the cat's lost its eyes entirely so it's going to be quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3136" target="_blank">00:52:16.800</a></span> | <span class="t">challenging it's lost its lines entirely um so super resolution is quite a good task to try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3143" target="_blank">00:52:23.680</a></span> | <span class="t">get a model to learn what pictures look like because it has to yeah figure out like how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3149" target="_blank">00:52:29.280</a></span> | <span class="t">draw an eye and how to draw cat's whiskers and things like that um were you going to say something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3156" target="_blank">00:52:36.000</a></span> | <span class="t">jon i'm sorry oh i was just going to point out that the um data sets are also simpler because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3161" target="_blank">00:52:41.840</a></span> | <span class="t">you don't have to load the labels um so there's no difference between the train and the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3166" target="_blank">00:52:46.160</a></span> | <span class="t">now it's just finding the images good point yeah because the the label you know is actually a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3171" target="_blank">00:52:51.200</a></span> | <span class="t">dependent variable is just the picture um and so okay so because um turfum ds turfum ds has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3183" target="_blank">00:53:03.840</a></span> | <span class="t">turfum x which is only applied to the independent variable um the independent variable has applied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3191" target="_blank">00:53:11.360</a></span> | <span class="t">to it this pair of resize to 32 by 32 and then interpolate and what that actually does is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3200" target="_blank">00:53:20.000</a></span> | <span class="t">ends up still with a 64 by 64 image but the the pixels in that image are all like doubled up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3208" target="_blank">00:53:28.240</a></span> | <span class="t">and so that means that it's still doing super resolution but it's not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3212" target="_blank">00:53:32.720</a></span> | <span class="t">going from 32 by 32 to by 64 by 64 but it's just going from the 64 by 64 where all of the pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3218" target="_blank">00:53:38.880</a></span> | <span class="t">are like two by two pixels and it's just a little bit easier because that way um we could certainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3224" target="_blank">00:53:44.720</a></span> | <span class="t">create a unit that goes from 32 to 64 but if you have the input and output image the same size it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3231" target="_blank">00:53:51.840</a></span> | <span class="t">can make code a little bit simpler um i originally started doing it by not doing this interpolate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3238" target="_blank">00:53:58.000</a></span> | <span class="t">thing and then i decided i was just getting a little bit confusing and there's no reason not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3242" target="_blank">00:54:02.080</a></span> | <span class="t">to do it this way frankly um okay so that's our task um and the idea is that then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3249" target="_blank">00:54:09.920</a></span> | <span class="t">if it does a good job of this you know you could pass 64 by 64 images into it and hopefully it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3256" target="_blank">00:54:16.800</a></span> | <span class="t">might turn them into 128 by 128 images um particularly if you trained it on a few different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3261" target="_blank">00:54:21.760</a></span> | <span class="t">resolutions you'd expect it to get pretty good at you know resizing things to a bunch of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3267" target="_blank">00:54:27.600</a></span> | <span class="t">resolutions you could even call it multiple times um uh but anyway for this i was just kind of doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3274" target="_blank">00:54:34.000</a></span> | <span class="t">it to to demonstrate um but we have in previous courses trained you know bigger ones for longer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3281" target="_blank">00:54:41.200</a></span> | <span class="t">with larger images and they actually do one of the interesting things is they tend to not only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3285" target="_blank">00:54:45.680</a></span> | <span class="t">do super resolution but they often make the images look better because the kind of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3292" target="_blank">00:54:52.160</a></span> | <span class="t">pixels it fills in it kind of fills in with like what that image looks like on average which tends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3300" target="_blank">00:55:00.480</a></span> | <span class="t">to kind of like average out imperfections so often these super resolution models actually improve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3306" target="_blank">00:55:06.320</a></span> | <span class="t">image quality as well funnily enough okay so let's consider the dumb way to do things we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3313" target="_blank">00:55:13.200</a></span> | <span class="t">seen a kind of a dumb way to do things before which is an autoencoder so go in with low expectations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3318" target="_blank">00:55:18.400</a></span> | <span class="t">here because we've done an autoencoder before it was so bad it actually inspired us to create the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3322" target="_blank">00:55:22.400</a></span> | <span class="t">learner if you remember so that was back in notebook eight um and so basically what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3328" target="_blank">00:55:28.480</a></span> | <span class="t">going to do is we're going to have a model which looks a lot like previous models it starts with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3334" target="_blank">00:55:34.880</a></span> | <span class="t">a res block kernel size five and then it's got a bunch of res blocks of stride two um but then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3344" target="_blank">00:55:44.640</a></span> | <span class="t">we're going to have an equal number of up blocks and what an up block is going to do is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3352" target="_blank">00:55:52.480</a></span> | <span class="t">going to sequentially first of all it's going to do an up sampling nearest 2d which is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3357" target="_blank">00:55:57.120</a></span> | <span class="t">identical to this right so it's going to just double all the pixels and then we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3367" target="_blank">00:56:07.040</a></span> | <span class="t">pass that through a res block so it's basically a res block with like a stride of a half if you like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3376" target="_blank">00:56:16.080</a></span> | <span class="t">you know it's it's it's it's undoing a stride to it's up sampling rather than down sampling um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3382" target="_blank">00:56:22.880</a></span> | <span class="t">okay so and then we'll have an extra res block at the end to get it down to three channels which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3389" target="_blank">00:56:29.520</a></span> | <span class="t">is what we need um okay so we can do our learning learning uh learning rate finder on that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3398" target="_blank">00:56:38.560</a></span> | <span class="t">and i just train it pretty briefly for five epochs um so so this model is basically um trying to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3408" target="_blank">00:56:48.240</a></span> | <span class="t">the image that we start up then kind of really squeeze it into i guess a small representation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3413" target="_blank">00:56:53.600</a></span> | <span class="t">and then try to bring that small representation back up to then the full super res yeah exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3419" target="_blank">00:56:59.440</a></span> | <span class="t">right tanish can and we could have done it without any of the stride too you know i guess we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3425" target="_blank">00:57:05.440</a></span> | <span class="t">have just had a whole bunch of stride one layers there's a few reasons not to do it that way though</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3431" target="_blank">00:57:11.280</a></span> | <span class="t">one is obviously just the computation requirements are very high because the convolution has to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3435" target="_blank">00:57:15.440</a></span> | <span class="t">scan over the image and so when you keep it at 64 by 64 that's a lot of scanning um another is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3444" target="_blank">00:57:24.400</a></span> | <span class="t">um you're never kind of forcing it to learn higher level abstractions by recognizing how to kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3451" target="_blank">00:57:31.520</a></span> | <span class="t">like you know use more channels on a smaller grid size to represent it um so yeah it's like the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3460" target="_blank">00:57:40.400</a></span> | <span class="t">same reason that we in in classifiers we don't leave it it's tried one the whole time you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3466" target="_blank">00:57:46.160</a></span> | <span class="t">you end up with something that's inefficient and generally not as good um exactly yeah thanks for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3472" target="_blank">00:57:52.000</a></span> | <span class="t">clarifying tanish um okay so the loss goes down and the loss function i'm using is just msc here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3478" target="_blank">00:57:58.880</a></span> | <span class="t">right so it's how similar is each pixel to the pixel it's meant to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3482" target="_blank">00:58:02.480</a></span> | <span class="t">and so then i can call capture preds um to get their predictions and the targets and the inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3491" target="_blank">00:58:11.200</a></span> | <span class="t">or probabilities targets and inputs i can't quite remember now uh so here's our input images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3499" target="_blank">00:58:19.120</a></span> | <span class="t">so they're pretty low resolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3500" target="_blank">00:58:20.720</a></span> | <span class="t">and oh dear here's our predicted images so pretty terrible um so why is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3512" target="_blank">00:58:32.320</a></span> | <span class="t">well basically it's kind of like the problem we had with our earlier auto encoder it's really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3519" target="_blank">00:58:39.280</a></span> | <span class="t">difficult to go from a like a two by two or four by four or whatever image into a 64 by 64 image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3529" target="_blank">00:58:49.360</a></span> | <span class="t">you know um we're asking it to do something that's just really challenging and so that would require</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3534" target="_blank">00:58:54.240</a></span> | <span class="t">a much bigger model trained for a much longer amount of time i'm sure it's possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3540" target="_blank">00:59:00.160</a></span> | <span class="t">um and in fact you know latent diffusion as we've talked about has a model that kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3548" target="_blank">00:59:08.640</a></span> | <span class="t">does exactly that um um but in our case there's no need to make it so complicated we can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3555" target="_blank">00:59:15.600</a></span> | <span class="t">do something dramatically easier um which is um we can um create a a unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3566" target="_blank">00:59:26.080</a></span> | <span class="t">so units were originally developed in 2015 and they originally developed for medical imaging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3578" target="_blank">00:59:38.000</a></span> | <span class="t">um but they've been used very very widely since um and i was involved in medical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3585" target="_blank">00:59:45.280</a></span> | <span class="t">imaging at the time they came out and certainly they quite quickly got recognized in medical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3589" target="_blank">00:59:49.200</a></span> | <span class="t">imaging they took a little bit longer to get recognized elsewhere but nowadays they're pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3593" target="_blank">00:59:53.280</a></span> | <span class="t">universal and they are used in stable diffusion and basically um some of the details don't matter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3601" target="_blank">01:00:01.600</a></span> | <span class="t">here this is like the original paper um so let's focus on the kind of the broad idea this thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3608" target="_blank">01:00:08.000</a></span> | <span class="t">here is called that we're going to call it the downsampling path so in this case they started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3612" target="_blank">01:00:12.080</a></span> | <span class="t">with 572 by 572 images it looks like they started with one channel images and then they you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3621" target="_blank">01:00:21.200</a></span> | <span class="t">as we've seen then they took them down to 284 by 284 by 128 and then down to 140 by 140 by 256</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3628" target="_blank">01:00:28.400</a></span> | <span class="t">and then down to 68 by 68 by 512 32 by 32 by 1024 so here's this downsampling path right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3636" target="_blank">01:00:36.000</a></span> | <span class="t">and then the upsampling path is exactly what we've seen before right so we up sample and have some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3642" target="_blank">01:00:42.800</a></span> | <span class="t">i mean in the original thing they didn't use res nets or res blocks um they just use comms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3648" target="_blank">01:00:48.800</a></span> | <span class="t">but the idea is the same um but the trick is these extra things across here these arrows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3658" target="_blank">01:00:58.400</a></span> | <span class="t">um which is copy and crop what we can do is we can take so during the upsampling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3666" target="_blank">01:01:06.960</a></span> | <span class="t">we've got a 512 by 512 here sorry a 512 channel thing here we can up sample to a 512 channel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3677" target="_blank">01:01:17.440</a></span> | <span class="t">thing we can then put it through a conf to make it into a 256 channel thing and then what we can do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3691" target="_blank">01:01:31.200</a></span> | <span class="t">is we can copy across the activations from here now they actually do things in a slightly weird</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3699" target="_blank">01:01:39.040</a></span> | <span class="t">way where they're downsampling they had 136 pixels by 136 and over here they have 104 by 104 so they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3706" target="_blank">01:01:46.400</a></span> | <span class="t">crop out the center bit that's because of just kind of like the slightly weird way they did uh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3711" target="_blank">01:01:51.600</a></span> | <span class="t">they basically weren't padding things nowadays we don't have to worry about that that cropping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3717" target="_blank">01:01:57.280</a></span> | <span class="t">so what we do is we literally copy over this these activations and we then either concatenate or add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3726" target="_blank">01:02:06.400</a></span> | <span class="t">and you can see in this case they're concatenating see how there's the white bit and the blue bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3729" target="_blank">01:02:09.840</a></span> | <span class="t">so they have concatenated the two lots together so actually i think what they did here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3736" target="_blank">01:02:16.320</a></span> | <span class="t">they went from a 52 by 52 by 512 to a 104 by 104 by 256 and i think that's what this little blue</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3745" target="_blank">01:02:25.840</a></span> | <span class="t">rectangle here is and then they had another uh copied copied out the 104 by 104 by 256 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3754" target="_blank">01:02:34.000</a></span> | <span class="t">then put the two together to get a 104 by 104 by 512 and so this these activations half are from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3767" target="_blank">01:02:47.120</a></span> | <span class="t">the upsampling and half are from the downsampling from earlier in this whole process and it might be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3776" target="_blank">01:02:56.880</a></span> | <span class="t">easiest to understand why that's interesting when we get all the way back up to the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3782" target="_blank">01:03:02.000</a></span> | <span class="t">where we've got this uh 392 by 392 thing the thing we're copying across now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3789" target="_blank">01:03:09.040</a></span> | <span class="t">is just two convolutions away from the original image so like for super resolution for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3797" target="_blank">01:03:17.920</a></span> | <span class="t">we want it to look a lot like the original image so in this case we're actually going to have an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3804" target="_blank">01:03:24.240</a></span> | <span class="t">entire copy of almost something very much like the original image that we can include in these final</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3810" target="_blank">01:03:30.960</a></span> | <span class="t">convolutions and so ditto here we have you know something that's kind of like the somewhat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3817" target="_blank">01:03:37.120</a></span> | <span class="t">downsampled version we can use here and the more downsampled version we can use here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3821" target="_blank">01:03:41.520</a></span> | <span class="t">yeah that's that's how the u-net works do either of you guys have anything to add like things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3827" target="_blank">01:03:47.920</a></span> | <span class="t">that you found this helpful to understand or anything surprising i guess it's a fascinating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3835" target="_blank">01:03:55.440</a></span> | <span class="t">thing these days a lot of people tend to just add so you've got the you know the outputs from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3841" target="_blank">01:04:01.440</a></span> | <span class="t">down layer are the same shape the inputs fully corresponding like up block and then they just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3845" target="_blank">01:04:05.680</a></span> | <span class="t">kind of add the yeah particularly for super resolution adding might make more sense than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3850" target="_blank">01:04:10.320</a></span> | <span class="t">concatenating because you're like literally saying like oh this little two by two bit is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3855" target="_blank">01:04:15.200</a></span> | <span class="t">basically the right pixel but it just have to be slightly modified on the edges yeah it also makes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3862" target="_blank">01:04:22.320</a></span> | <span class="t">me think of like a boosting sort of thing where if you think about like the fact that a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3868" target="_blank">01:04:28.560</a></span> | <span class="t">information from the original image is being passed all the way across at that highest skip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3872" target="_blank">01:04:32.240</a></span> | <span class="t">connection then the rest of the network can be effectively producing an update to that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3878" target="_blank">01:04:38.240</a></span> | <span class="t">rather than having to recreate the whole image or to put it another way it's like a resnet but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3885" target="_blank">01:04:45.280</a></span> | <span class="t">there's a skip connections right but the skip connections are like jumping from the start to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3890" target="_blank">01:04:50.400</a></span> | <span class="t">the end and a bit after the start to a bit before the end and i guess a resonance a bit like boosting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3896" target="_blank">01:04:56.000</a></span> | <span class="t">too hmm yeah yeah i mean i was kind of going to say the same thing so yeah but basically like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3905" target="_blank">01:05:05.520</a></span> | <span class="t">i think uh in compared to like the the noising on encoder where like we saw like the results from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3910" target="_blank">01:05:10.080</a></span> | <span class="t">like even worse than i guess the original image here i guess the the worst it could be is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3916" target="_blank">01:05:16.160</a></span> | <span class="t">the original image so you know i guess it's it's just like a similar sort of uh kind of intuition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3921" target="_blank">01:05:21.760</a></span> | <span class="t">behind the the the result the resnet uh and how that works so yeah i mean it could be worse if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3929" target="_blank">01:05:29.120</a></span> | <span class="t">these comms at the end are incapable of undoing what these comms did um which is like one argument</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3936" target="_blank">01:05:36.240</a></span> | <span class="t">for maybe why there should also be a connection from here over to here and maybe a few more comms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3941" target="_blank">01:05:41.920</a></span> | <span class="t">after that which is something i'm kind of interested in and not enough people do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3946" target="_blank">01:05:46.480</a></span> | <span class="t">in my opinion um another thing to consider is that they've only got two comms down here but at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3953" target="_blank">01:05:53.280</a></span> | <span class="t">point you have the benefit of only being a 28 by 28 you know why not do more computation at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3961" target="_blank">01:06:01.120</a></span> | <span class="t">point you know um so there's a couple of things that sometimes people consider but maybe not enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3969" target="_blank">01:06:09.600</a></span> | <span class="t">um uh so let me try to remember what i did um so in my unit here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3978" target="_blank">01:06:18.320</a></span> | <span class="t">so um we've got the down sampling path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3983" target="_blank">01:06:23.360</a></span> | <span class="t">which is a list of res blocks now a module list is just like a sequential except it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=3993" target="_blank">01:06:33.520</a></span> | <span class="t">actually do anything so then in the forward we have to go through the down path and x equals lx</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4001" target="_blank">01:06:41.760</a></span> | <span class="t">each time so it's basically yeah a sequential that doesn't actually do anything um and so the up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4009" target="_blank">01:06:49.200</a></span> | <span class="t">path is exactly the same as we saw before it's a bunch of up blocks um and then like we saw before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4015" target="_blank">01:06:55.680</a></span> | <span class="t">the final one's going to have to go to three channel um but now for our forward what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4023" target="_blank">01:07:03.680</a></span> | <span class="t">going to do is we're going to keep track of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4026" target="_blank">01:07:06.480</a></span> | <span class="t">since we're going to be copying this over here and copying this over here we have to save it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4034" target="_blank">01:07:14.880</a></span> | <span class="t">during the down sampling path so we're going to save it in a something called layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4044" target="_blank">01:07:24.800</a></span> | <span class="t">so i actually decided to do the little trick i mentioned which is to save the very first input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4050" target="_blank">01:07:30.000</a></span> | <span class="t">um so i saved the very first input i then put it through the very first res block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4056" target="_blank">01:07:36.880</a></span> | <span class="t">and then we go through each in the downward path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4063" target="_blank">01:07:43.200</a></span> | <span class="t">there's actually no need at all for there to be an i l here doesn't have to be enumerated because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4071" target="_blank">01:07:51.840</a></span> | <span class="t">we don't use i okay so we go through the downward path so for this l for layer so for each layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4078" target="_blank">01:07:58.160</a></span> | <span class="t">in the downward path append the activations so that again as we go through each one we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4084" target="_blank">01:08:04.880</a></span> | <span class="t">to be able to copy them over by saving them for later and then call the layer okay so how many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4092" target="_blank">01:08:12.560</a></span> | <span class="t">layers have we got there's n layers that we stored away so now we're going to go through the up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4098" target="_blank">01:08:18.480</a></span> | <span class="t">sampling path and again we're going to call call each one but before we do we're going to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4103" target="_blank">01:08:23.760</a></span> | <span class="t">do the thing that john i mentioned which is rather than concatenating unless we're back um at unless</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4109" target="_blank">01:08:29.280</a></span> | <span class="t">with this is the very first layer because the very first up sampling layer there's nothing to copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4114" target="_blank">01:08:34.160</a></span> | <span class="t">right so this is the very first up sampling layer let's just add the saved activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4123" target="_blank">01:08:43.440</a></span> | <span class="t">and then call the layer um and then right at the very end we'll add back the very first layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4131" target="_blank">01:08:51.760</a></span> | <span class="t">and then pass it through the very fine last res block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4137" target="_blank">01:08:57.760</a></span> | <span class="t">all right maybe that last one should be concatenated i'm not sure anyhow um this is what i did um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4152" target="_blank">01:09:12.960</a></span> | <span class="t">now the next thing that i wondered about was like how to um initialize this and basically what i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4162" target="_blank">01:09:22.480</a></span> | <span class="t">wanted to do is i wanted to initialize this so that when it's when it's untrained it would um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4168" target="_blank">01:09:28.240</a></span> | <span class="t">the output of the model would be identical to the input because like a reasonable starting point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4174" target="_blank">01:09:34.480</a></span> | <span class="t">for like what does this look like so yeah what does this look like following super resolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4180" target="_blank">01:09:40.000</a></span> | <span class="t">would be this you know that's a reasonable starting point so um i just created this little zero weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4186" target="_blank">01:09:46.960</a></span> | <span class="t">thing which zeros out the weights and biases of a layer right so i created the model and then i said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4194" target="_blank">01:09:54.720</a></span> | <span class="t">okay um let's look at the very end of the up sampling path and we'll call that the last res net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4206" target="_blank">01:10:06.240</a></span> | <span class="t">and so let's zero out the very last convolutions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4211" target="_blank">01:10:11.840</a></span> | <span class="t">and also the id connection and so that means that whatever it does for all this at the very end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4222" target="_blank">01:10:22.720</a></span> | <span class="t">it's going to have um nothing in there this will be zero so that means that this will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4232" target="_blank">01:10:32.240</a></span> | <span class="t">equal to layer zero um and then that means we also want to make sure that this doesn't change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4238" target="_blank">01:10:38.400</a></span> | <span class="t">anything so then we can just zero out the weights there um that's probably not quite right is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4247" target="_blank">01:10:47.760</a></span> | <span class="t">i guess i should have actually set those to like an identity matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4253" target="_blank">01:10:53.200</a></span> | <span class="t">maybe i'll try to do that later um but at least it's something that would be very easy for it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4259" target="_blank">01:10:59.920</a></span> | <span class="t">i have a question germane yeah this this zero weights i see a lot of people do a thing where they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4265" target="_blank">01:11:05.360</a></span> | <span class="t">instead like multiply by one e minus three or one e minus four to make the weights really small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4271" target="_blank">01:11:11.360</a></span> | <span class="t">but not completely zero and i don't have a good intuition whether it's like you know in some sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4277" target="_blank">01:11:17.600</a></span> | <span class="t">having everything set to zero fires off some warnings that maybe this is going to be like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4282" target="_blank">01:11:22.320</a></span> | <span class="t">perfectly balanced on some saddle point or it's not going to have any signal to work with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4286" target="_blank">01:11:26.400</a></span> | <span class="t">yeah it's very small but not quite zero random weights might be better yeah do you have an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4290" target="_blank">01:11:30.560</a></span> | <span class="t">individual that i think so or not so much intuition but more empirical like or both um i don't i don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4298" target="_blank">01:11:38.320</a></span> | <span class="t">think it's an issue um and i think it comes from like a lot of people's phd supervisors and stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4303" target="_blank">01:11:43.200</a></span> | <span class="t">you know come from back in an era when they were doing like linear regression with one layer or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4307" target="_blank">01:11:47.440</a></span> | <span class="t">whatever and in those cases yeah if all the weights are the same then no learning can happen because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4314" target="_blank">01:11:54.160</a></span> | <span class="t">every weight update is identical but in this case all the previous weights are different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4319" target="_blank">01:11:59.040</a></span> | <span class="t">so there's they all have different gradients and there's definitely nothing to worry about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4324" target="_blank">01:12:04.160</a></span> | <span class="t">i mean multiplying it by a small number would work too like it's not a problem but um yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4332" target="_blank">01:12:12.400</a></span> | <span class="t">setting it to zeros i and honestly i um i have to stop myself from i mean not that's a problem but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4340" target="_blank">01:12:20.000</a></span> | <span class="t">i just i always have this natural incarnation to not want to set them to zeros because of years</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4346" target="_blank">01:12:26.320</a></span> | <span class="t">of being told not to but there's no reason that should be a problem um all right so i just would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4357" target="_blank">01:12:37.680</a></span> | <span class="t">i was just like again like that unit code is very concise and it's very very interesting to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4365" target="_blank">01:12:45.920</a></span> | <span class="t">the basic ideas you know very simple and oh yeah to see that i guess yeah yeah it's helpful i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4372" target="_blank">01:12:52.800</a></span> | <span class="t">to just get it into a little bit of code isn't it yeah thanks um that's very simple code too</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4379" target="_blank">01:12:59.760</a></span> | <span class="t">okay so we do a lot of find and then we train and you can see but previously our loss even after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4391" target="_blank">01:13:11.440</a></span> | <span class="t">five epochs there's 207 and in this case our loss after one epoch is oh wait six so it's obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4401" target="_blank">01:13:21.840</a></span> | <span class="t">much easier and we end up at 073 okay so we can take a look there's our inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4412" target="_blank">01:13:32.880</a></span> | <span class="t">and there's our outputs so it's actually better rather than dramatically worse now so that's good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4419" target="_blank">01:13:39.760</a></span> | <span class="t">um yeah some of it's actually not bad at all i would say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4425" target="_blank">01:13:45.600</a></span> | <span class="t">this car definitely looks like i think it's like a little over smoothed you know i think you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4436" target="_blank">01:13:56.240</a></span> | <span class="t">say so if we look at the other guy's eyes kids eyes still aren't great like in the original he's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4442" target="_blank">01:14:02.160</a></span> | <span class="t">actually got proper pupils um so yeah it's definitely not recreated the original but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4449" target="_blank">01:14:09.520</a></span> | <span class="t">you know given limited compute and limited data like the basic idea is not bad um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4458" target="_blank">01:14:18.880</a></span> | <span class="t">i do worry that the poor koala like it it didn't have eyes here but like it ought to have known</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4466" target="_blank">01:14:26.240</a></span> | <span class="t">there should be eyes in a sense and it didn't create any and maybe it should have done a better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4470" target="_blank">01:14:30.800</a></span> | <span class="t">job on the eyes so um my feeling is um and this is pretty common way of thinking about this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4478" target="_blank">01:14:38.320</a></span> | <span class="t">that when you use mean squared error msc as your loss function on these kinds of models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4482" target="_blank">01:14:42.960</a></span> | <span class="t">you tend to get rather blurry results because if the model's not sure what to do it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4489" target="_blank">01:14:49.200</a></span> | <span class="t">going to predict kind of the average you know um so one good way to fix that is to use perceptual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4496" target="_blank">01:14:56.880</a></span> | <span class="t">loss and um i think it was johnno who taught us about perceptual loss wasn't it when we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4503" target="_blank">01:15:03.440</a></span> | <span class="t">the style transfer stuff um so perceptual loss is this idea that we could look it's kind of similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4511" target="_blank">01:15:11.120</a></span> | <span class="t">as well to the the fit idea um we could look at the some intermediate layer of a pre-trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4520" target="_blank">01:15:20.080</a></span> | <span class="t">and try to make sure that our output images have the same features as the real images and in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4531" target="_blank">01:15:31.680</a></span> | <span class="t">case it ought to be saying like the real image you know if we went to kind of midway through a resnet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4537" target="_blank">01:15:37.440</a></span> | <span class="t">it should be saying like there should be an eye here you know and in this case this would not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4542" target="_blank">01:15:42.720</a></span> | <span class="t">represent an eye very well so that would should give it some useful feedback to improve how it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4549" target="_blank">01:15:49.440</a></span> | <span class="t">draws an eye here um so that's the basic idea um so to do perceptual loss we need to classify a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4557" target="_blank">01:15:57.600</a></span> | <span class="t">so i just used the little i don't know why i use little 25 epoch one i guess maybe that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4563" target="_blank">01:16:03.200</a></span> | <span class="t">all i had trained when at that time um so let's use little 25 epoch model um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4573" target="_blank">01:16:13.520</a></span> | <span class="t">so then um yeah just grab a batch of validation set and then we can just try it out by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4580" target="_blank">01:16:20.320</a></span> | <span class="t">calling the classifier model um and here i'm doing it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4587" target="_blank">01:16:27.680</a></span> | <span class="t">in fp16 just keeping my memory use down um um i don't think this dot half would be necessary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4600" target="_blank">01:16:40.000</a></span> | <span class="t">since i've got autocast anyway never mind um okay this is the same code we had before for the sin</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4606" target="_blank">01:16:46.480</a></span> | <span class="t">sets um so here is our images um so what we've got here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4627" target="_blank">01:17:07.120</a></span> | <span class="t">huh i'm just looking at some of them they're a bit weird aren't they i mean koalas are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4631" target="_blank">01:17:11.280</a></span> | <span class="t">fine you know i wouldn't have picked this as a parking meter i wouldn't have picked this as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4635" target="_blank">01:17:15.200</a></span> | <span class="t">a bow tie um so yeah so basically what this is doing here is it's um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4640" target="_blank">01:17:20.960</a></span> | <span class="t">showing us the predictions so the predictions are not amazing um trolley bus that looks right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4655" target="_blank">01:17:35.760</a></span> | <span class="t">um this is weird it's called this one a neck brace and this one a basketball that looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4660" target="_blank">01:17:40.720</a></span> | <span class="t">more like a neck brace the labrador retriever it's got right the tractor it's got right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4664" target="_blank">01:17:44.240</a></span> | <span class="t">centerpiece right mushrooms right those probably aren't bunching bags okay so you know you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4669" target="_blank">01:17:49.520</a></span> | <span class="t">our classifier it's okay but it's not amazing i think this was one with like a 60 accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4674" target="_blank">01:17:54.240</a></span> | <span class="t">um but the important thing is it's like it's got enough features to be able to like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4680" target="_blank">01:18:00.640</a></span> | <span class="t">do an okay job i have no idea what this is so i'm pretty sure it's not a goose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4686" target="_blank">01:18:06.480</a></span> | <span class="t">um okay so the model um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4689" target="_blank">01:18:09.440</a></span> | <span class="t">the model is a very simple just a bunch of res blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4698" target="_blank">01:18:18.800</a></span> | <span class="t">um three four five and then at the end we've got our pooling flatten dropout linear batch note</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4710" target="_blank">01:18:30.720</a></span> | <span class="t">um so we don't need yeah so what we're going to do is just to keep things simple we're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4720" target="_blank">01:18:40.960</a></span> | <span class="t">going to grab um i think the end of the three res block and so a simple way to do that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4732" target="_blank">01:18:52.080</a></span> | <span class="t">we'll just go from range four to the end of the model and delete those layers so if we do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4739" target="_blank">01:18:59.600</a></span> | <span class="t">and then look at the model again you can now see i've got zero one two three and that's it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4749" target="_blank">01:19:09.920</a></span> | <span class="t">so this model um is going to yeah return the kind of the activations after the fourth res block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4760" target="_blank">01:19:20.720</a></span> | <span class="t">um so for perceptual losses i think we talked about you could like pick a couple of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4767" target="_blank">01:19:27.680</a></span> | <span class="t">places like there's various ways to do it this is just the simplest i didn't even have to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4772" target="_blank">01:19:32.960</a></span> | <span class="t">hooks or anything we can just call c model and um in fact if we do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4778" target="_blank">01:19:38.960</a></span> | <span class="t">um so just to take a look at this looks like and again we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4784" target="_blank">01:19:44.800</a></span> | <span class="t">mixed precision here um we can grab our y batch as before put it through our classifier model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4796" target="_blank">01:19:56.320</a></span> | <span class="t">and so now that we've done this this is now going to give us those intermediate level features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4802" target="_blank">01:20:02.320</a></span> | <span class="t">so the features what's the shape of them it's batch size 1024 by the number of channels of that layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4810" target="_blank">01:20:10.720</a></span> | <span class="t">by the height and width of that layer so these are 8 by 8 by 256 features we're going to be using for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4817" target="_blank">01:20:17.040</a></span> | <span class="t">the perceptual loss um and so when i was doing this i kind of wanted to like check with things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4823" target="_blank">01:20:23.600</a></span> | <span class="t">were vaguely looking reasonable um so i would have expected that these features um from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4833" target="_blank">01:20:33.440</a></span> | <span class="t">actual y should be similar to if i um use our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4848" target="_blank">01:20:48.240</a></span> | <span class="t">so something then i did i thought okay if we if we took that model that we trained then we would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4855" target="_blank">01:20:55.280</a></span> | <span class="t">hope that the features were at least of the same sign um from you know from the result of the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4864" target="_blank">01:21:04.720</a></span> | <span class="t">than they are in the real images um so this is just me comparing that and it's like oh yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4870" target="_blank">01:21:10.320</a></span> | <span class="t">they are generally the same sign so this is just little checks that i was doing along the way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4874" target="_blank">01:21:14.640</a></span> | <span class="t">and then i also thought i kind of look at the msc loss along the way um yeah so there's no need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4882" target="_blank">01:21:22.800</a></span> | <span class="t">keep all those in there it was just stuff i was kind of doing to like debug as i went well not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4887" target="_blank">01:21:27.600</a></span> | <span class="t">even debug to like identify ahead of time as of any problems um so now we can calculate create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4893" target="_blank">01:21:33.440</a></span> | <span class="t">our loss function so our loss function is going to be the um the msc loss just like before between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4901" target="_blank">01:21:41.920</a></span> | <span class="t">the input and the target which is just all that's being passed in here plus the msc loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4907" target="_blank">01:21:47.200</a></span> | <span class="t">between the features we get out of c model and the features we get from the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4914" target="_blank">01:21:54.880</a></span> | <span class="t">and the features we get from the actual target image and so the features um we can calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4927" target="_blank">01:22:07.840</a></span> | <span class="t">for the target image now the target image we're not going to be modifying that at all so we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4935" target="_blank">01:22:15.360</a></span> | <span class="t">that bit with no gradient um but we do want to be able to modify the thing that's generating our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4942" target="_blank">01:22:22.080</a></span> | <span class="t">input that's the model we're trying to actually optimize so we do have gradient for that so in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4946" target="_blank">01:22:26.400</a></span> | <span class="t">each case we're calling the classifier model one on the target and one on the input and so those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4952" target="_blank">01:22:32.720</a></span> | <span class="t">are giving us our features now then we add them together but they're not particularly similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4960" target="_blank">01:22:40.960</a></span> | <span class="t">numerically like they're very different scales and we wouldn't want it to focus entirely on one or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4967" target="_blank">01:22:47.200</a></span> | <span class="t">the other so i just ran it um for epoch or two checked what the losses were looked like and i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4973" target="_blank">01:22:53.200</a></span> | <span class="t">noticed that the feature loss was about 10 times bigger so my very hacky way was just to divide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4978" target="_blank">01:22:58.080</a></span> | <span class="t">it by 10 um but honestly like that detail doesn't tend to matter very much in my opinion which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4984" target="_blank">01:23:04.960</a></span> | <span class="t">there's nothing wrong with doing it in a rather hacky way um there are papers which suggest more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4993" target="_blank">01:23:13.120</a></span> | <span class="t">elegant ways to handle it um which isn't a bad idea to save you a bit of time if you're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=4998" target="_blank">01:23:18.560</a></span> | <span class="t">a lot of messing around with this jimmy i don't know if you know it but the um the new vae decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5008" target="_blank">01:23:28.160</a></span> | <span class="t">from stability ai for the stable diffusion auto encoder they trained it some with just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5014" target="_blank">01:23:34.320</a></span> | <span class="t">mean squared error and some with mean squared error combined with the perceptual loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5017" target="_blank">01:23:37.680</a></span> | <span class="t">and they had a scaling factor of you know times 0.1 so exactly there you go so the answer is 0.1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5024" target="_blank">01:23:44.960</a></span> | <span class="t">that's that's the official and and drake apathy says that the correct learning rate to use is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5030" target="_blank">01:23:50.560</a></span> | <span class="t">always 4e neg 3 so we're getting all this sorted out now that's good all right so for my unit we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5037" target="_blank">01:23:57.440</a></span> | <span class="t">going to do the same stuff as before in terms of initializing it do our lr find train it for 20 epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5047" target="_blank">01:24:07.280</a></span> | <span class="t">and obviously the loss is not comparable because this is lost now incorporates the perceptual loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5051" target="_blank">01:24:11.760</a></span> | <span class="t">as well and so this is one of the challenges with these things it's like is it better or worse well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5056" target="_blank">01:24:16.400</a></span> | <span class="t">we just tend to have to take a look and compare i guess and maybe i should copy over our previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5062" target="_blank">01:24:22.000</a></span> | <span class="t">models images so we can compare okay there's our inputs there's our outputs and yeah look he's got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5071" target="_blank">01:24:31.760</a></span> | <span class="t">pupils now which he didn't used to have koala still doesn't quite have eyeballs but i'd like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5079" target="_blank">01:24:39.680</a></span> | <span class="t">it's definitely less you know out of focus looking um so yeah flipping that's going on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5090" target="_blank">01:24:50.720</a></span> | <span class="t">yeah so there's some of them are going to be flipped because this is copied from earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5094" target="_blank">01:24:54.480</a></span> | <span class="t">so yeah there's clipping and cropping going on so they won't be identical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5105" target="_blank">01:25:05.520</a></span> | <span class="t">yeah you can also see like the background like was all just blurred before where else now it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5111" target="_blank">01:25:11.200</a></span> | <span class="t">got texture which if we look at the real the real has texture you know so yeah clearly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5120" target="_blank">01:25:20.320</a></span> | <span class="t">perceptual loss has improved matters quite significantly there's an interesting thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5127" target="_blank">01:25:27.680</a></span> | <span class="t">here which is that there's not really any metric we can use now right because if we did mean square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5131" target="_blank">01:25:31.040</a></span> | <span class="t">error the one that's trained means good error would probably do better but visually it looks worse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5135" target="_blank">01:25:35.920</a></span> | <span class="t">yeah and if we use like an fid well that's based on the features of the pre-trained network so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5140" target="_blank">01:25:40.400</a></span> | <span class="t">that would probably be biased by the one that's trained using those features the perceptual loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5144" target="_blank">01:25:44.560</a></span> | <span class="t">and so you get back to this very old school thing of like well actually how we're choosing is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5148" target="_blank">01:25:48.320</a></span> | <span class="t">looking and evaluating right um and when you speak to someone like jason antich who's made a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5153" target="_blank">01:25:53.040</a></span> | <span class="t">career out of you know image restoration and super resolution and colorization that is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5158" target="_blank">01:25:58.160</a></span> | <span class="t">a big part of his process even now is still like looking at a bunch of images to decide whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5164" target="_blank">01:26:04.720</a></span> | <span class="t">something is better rather than relying on these yeah some phd student yelled at me on twitter a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5170" target="_blank">01:26:10.560</a></span> | <span class="t">few weeks ago for like saying like look at this cool thing our student made look how don't they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5174" target="_blank">01:26:14.480</a></span> | <span class="t">look better and he was like don't you know there's rigorous ways to measure these things this is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5179" target="_blank">01:26:19.120</a></span> | <span class="t">a rigorous approach at all it's like phd students man they got all the answers can't have a human</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5187" target="_blank">01:26:27.200</a></span> | <span class="t">looking at a picture and deciding if they like it or not that's insane well i'm a pc student i agree</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5193" target="_blank">01:26:33.120</a></span> | <span class="t">though that we should be with me so yeah okay some phd students are better than others that's that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5198" target="_blank">01:26:38.080</a></span> | <span class="t">fair enough um what's this oh right okay so talking of cheating let's do that um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5215" target="_blank">01:26:55.360</a></span> | <span class="t">um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5217" target="_blank">01:26:57.360</a></span> | <span class="t">so we're going to do something which is kind of fast ai's favorite trick and has been since we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5227" target="_blank">01:27:07.920</a></span> | <span class="t">first launched which is gradually unfreezing pre-trained networks um so in a sense it seems</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5236" target="_blank">01:27:16.960</a></span> | <span class="t">a bit funny to initialize all of this downpath randomly because we already have a model that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5248" target="_blank">01:27:28.240</a></span> | <span class="t">perfectly capable of doing something useful on tiny image net images which is this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5256" target="_blank">01:27:36.160</a></span> | <span class="t">so yeah what if we um took our unit right and for the model dot start which to remind you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5271" target="_blank">01:27:51.360</a></span> | <span class="t">is the res block right at the front why don't we use the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5282" target="_blank">01:28:02.320</a></span> | <span class="t">weights of the pre-trained model and then for each of the bits in the down sampling path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5289" target="_blank">01:28:09.280</a></span> | <span class="t">why don't we use the actual weights that we used from that as well and so this is a useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5296" target="_blank">01:28:16.000</a></span> | <span class="t">way to understand how we can um copy over weights which is that any part of a module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5308" target="_blank">01:28:28.160</a></span> | <span class="t">an nn dot module is itself an nn dot module an nn dot module has a state dict which is a thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5315" target="_blank">01:28:35.520</a></span> | <span class="t">you can then call load state dict to put it somewhere else so this is going to fill in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5320" target="_blank">01:28:40.560</a></span> | <span class="t">whole res block called model dot start with the whole res block which is p model zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5326" target="_blank">01:28:46.400</a></span> | <span class="t">so here's how we can copy across yeah that starting one and then all the down blocks are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5332" target="_blank">01:28:52.320</a></span> | <span class="t">going to have the rest of it so this is basically going to copy into our model rather than having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5337" target="_blank">01:28:57.280</a></span> | <span class="t">random weights we're going to have all the weights from our pre-trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5341" target="_blank">01:29:01.680</a></span> | <span class="t">um and then since they're they're good at doing something they're not good at doing super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5351" target="_blank">01:29:11.040</a></span> | <span class="t">resolution but they're good at doing something why don't we assume that they're good at doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5356" target="_blank">01:29:16.400</a></span> | <span class="t">super resolution so turn off requires grad and so what that means if we now train it's not going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5363" target="_blank">01:29:23.600</a></span> | <span class="t">update any of the parameters in the down block i guess i should have actually done model dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5368" target="_blank">01:29:28.880</a></span> | <span class="t">start requires grad as false two now think about it um and so this is uh the the classic uh fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5376" target="_blank">01:29:36.320</a></span> | <span class="t">tune approach from fastai the library um we're going to do one epoch of just the up sampling path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5389" target="_blank">01:29:49.120</a></span> | <span class="t">and that gets us to a loss of 255 now our um loss function hasn't changed that's totally comparable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5395" target="_blank">01:29:55.760</a></span> | <span class="t">so previously our one epoch was 385 and in fact after one epoch with frozen weights for the down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5404" target="_blank">01:30:04.960</a></span> | <span class="t">path we've beaten this now this is in a sense totally cheating but in a sense it's totally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5413" target="_blank">01:30:13.840</a></span> | <span class="t">not it's totally cheating because the thing we're trying to do is to generate for the perceptual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5422" target="_blank">01:30:22.240</a></span> | <span class="t">loss intermediate layer activations which are the same as this and so we're literally using that to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5432" target="_blank">01:30:32.880</a></span> | <span class="t">create intermediate layer activations so obviously that's going to work but why is it okay to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5441" target="_blank">01:30:41.200</a></span> | <span class="t">cheating well because that's actually what we want like to be able to do super resolution we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5447" target="_blank">01:30:47.360</a></span> | <span class="t">something that can like recognize there's an eye here so we already has something that know that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5453" target="_blank">01:30:53.520</a></span> | <span class="t">there's an eye there and in fact interestingly this thing trained a lot more quickly than this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5460" target="_blank">01:31:00.800</a></span> | <span class="t">thing and it turns out it's better at super resolution than that thing even though it wasn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5467" target="_blank">01:31:07.040</a></span> | <span class="t">trained to do super resolution and I think that's because that the signal which is just like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5471" target="_blank">01:31:11.840</a></span> | <span class="t">what is this is a really simple signal to use so yeah so we do that and then we can basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5482" target="_blank">01:31:22.080</a></span> | <span class="t">go through and set requires grad equals true again and so the basic idea being here that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5486" target="_blank">01:31:26.960</a></span> | <span class="t">yeah when you've got a bunch of random weights which is the whole up sampling path and a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5494" target="_blank">01:31:34.160</a></span> | <span class="t">of pre-trained weights the down sampling path don't start then fine-tuning the whole thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5499" target="_blank">01:31:39.280</a></span> | <span class="t">because at the start it's going to be crap you know so and so just train the random weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5504" target="_blank">01:31:44.960</a></span> | <span class="t">for at least an epoch and then set everything to unfrozen and then we'll do our 20 epochs on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5512" target="_blank">01:31:52.160</a></span> | <span class="t">whole thing and so we go from 255 to 249 207 198 so it's improved a lot so to verify with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5528" target="_blank">01:32:08.240</a></span> | <span class="t">with using these weights and comparing that to the perceptual loss the perceptual loss is looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5535" target="_blank">01:32:15.600</a></span> | <span class="t">at the up sample data the super resolution images as well as incorporating the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5542" target="_blank">01:32:22.240</a></span> | <span class="t">that's for the down sampling path and so that's looking at I guess the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5546" target="_blank">01:32:26.560</a></span> | <span class="t">downgraded right although we are just adding them so if you have zeros in the up sampling path that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5554" target="_blank">01:32:34.160</a></span> | <span class="t">it's going to be the same so it is very easy for it to get the correct activations in the up sampling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5562" target="_blank">01:32:42.000</a></span> | <span class="t">path and then yeah I mean then it's kind of a bit weird because it goes all the way back to the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5569" target="_blank">01:32:49.440</a></span> | <span class="t">creates the image and then goes into the class of C model the classifier again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5573" target="_blank">01:32:53.440</a></span> | <span class="t">but I think it's going to create basically the same activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5579" target="_blank">01:32:59.520</a></span> | <span class="t">it's a bit confusing and weird so yeah I mean it's not totally cheating but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5587" target="_blank">01:33:07.520</a></span> | <span class="t">it's certainly a much easier problem to solve yeah okay so let's get our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5595" target="_blank">01:33:15.280</a></span> | <span class="t">results again so there's our inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5598" target="_blank">01:33:18.640</a></span> | <span class="t">yeah so that's looking pretty impressive so the kid has a you know yeah definitely looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5610" target="_blank">01:33:30.400</a></span> | <span class="t">pretty reasonable now car looks pretty reasonable we still don't have eyes for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5618" target="_blank">01:33:38.880</a></span> | <span class="t">the koala such as life but definitely the background textures look way better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5623" target="_blank">01:33:43.120</a></span> | <span class="t">the candy store looks less much better than it did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5628" target="_blank">01:33:48.640</a></span> | <span class="t">medicine looks a lot better than it did so yeah it's really I think it looks great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5639" target="_blank">01:33:59.360</a></span> | <span class="t">okay so then we can get better still this is not part of the original unet but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5644" target="_blank">01:34:04.800</a></span> | <span class="t">you know making better models is often about like where can we squeeze in more computation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5652" target="_blank">01:34:12.720</a></span> | <span class="t">give it opportunities to do things and like there's nothing particularly that says that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5657" target="_blank">01:34:17.760</a></span> | <span class="t">down sampling thing is exactly the right thing you need here right it's being used for two things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5663" target="_blank">01:34:23.040</a></span> | <span class="t">one is this conv and one is this conv but those are two different things and so it's kind of having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5669" target="_blank">01:34:29.280</a></span> | <span class="t">to like learn to squeeze both purposes into one thing so I had this idea probably I'm sure lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5675" target="_blank">01:34:35.520</a></span> | <span class="t">of people have had this idea but whatever I had this idea which is why don't we put some res blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5680" target="_blank">01:34:40.560</a></span> | <span class="t">in here which I called cross connections or cross cons so I decided that a cross conv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5689" target="_blank">01:34:49.040</a></span> | <span class="t">is going to be just a res block followed by a conv and so the unit I just copied and pasted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5698" target="_blank">01:34:58.800</a></span> | <span class="t">but now as well as the downs I've also got crosses and so the crosses are cross cons</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5704" target="_blank">01:35:04.400</a></span> | <span class="t">so now rather than just adding the layer I add the cross conv applied to the layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5714" target="_blank">01:35:14.640</a></span> | <span class="t">yeah I really should have added a cross con for this one as well now I think about it this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5722" target="_blank">01:35:22.320</a></span> | <span class="t">is the probably the one that wants it the most oh well never mind another time um okay so now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5729" target="_blank">01:35:29.840</a></span> | <span class="t">yeah again we can definitely compare loss functions so this is one nine eight so everything else was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5736" target="_blank">01:35:36.960</a></span> | <span class="t">the same so I did the same thing of because you know the down sampling is the same so we can still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5743" target="_blank">01:35:43.040</a></span> | <span class="t">copy in the state dict requires grad and it's better one eight nine quite a lot better really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5753" target="_blank">01:35:53.200</a></span> | <span class="t">because you know this is these are hard to get improvements uh let's see if we can notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5757" target="_blank">01:35:57.840</a></span> | <span class="t">anything hey look it's got an i just yeah so how about that um at this point it's almost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5770" target="_blank">01:36:10.720</a></span> | <span class="t">quite difficult to see whether it's an improvement or not but I think there's a bit of an eye on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5775" target="_blank">01:36:15.280</a></span> | <span class="t">koala I think is encouraging yeah so that's uh super res uh oh man the bad news is we're out of time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5797" target="_blank">01:36:37.040</a></span> | <span class="t">okay we didn't promise to do diffusion unit this lesson so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5802" target="_blank">01:36:42.960</a></span> | <span class="t">we built a unit we built a unit yes we did and it's and we did super resolution with it and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5812" target="_blank">01:36:52.960</a></span> | <span class="t">looks pretty good so um I gotta admit I haven't thought about like exercises for people to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5820" target="_blank">01:37:00.800</a></span> | <span class="t">what would be useful things for people to try with like maybe they could create a unit they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5826" target="_blank">01:37:06.960</a></span> | <span class="t">could learn about segmentation create a unit for segmentation or oh you know there are a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5833" target="_blank">01:37:13.760</a></span> | <span class="t">points where you well I was just gonna say there were a couple of ways we said oh I should have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5838" target="_blank">01:37:18.880</a></span> | <span class="t">tried this and should have tried that I think that's obviously yeah basically yeah I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5844" target="_blank">01:37:24.560</a></span> | <span class="t">that's obviously a good next step I was gonna say um style transfer is a good idea to do I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5850" target="_blank">01:37:30.560</a></span> | <span class="t">think with a unit so style transfer you can actually set up a loss function so that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5856" target="_blank">01:37:36.400</a></span> | <span class="t">can create a unit that learns to create images that look like van Gogh you know for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5861" target="_blank">01:37:41.840</a></span> | <span class="t">um it's a totally different approach it's a it's a tricky one I think I think when I was playing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5869" target="_blank">01:37:49.280</a></span> | <span class="t">with that it almost helped to not have the skip connections at the highest resolutions otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5877" target="_blank">01:37:57.040</a></span> | <span class="t">it just really wants to copy the input and modify it slightly interesting um maybe doing um whereas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5883" target="_blank">01:38:03.760</a></span> | <span class="t">which one would be better there too oh yes that's a good point yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5890" target="_blank">01:38:10.400</a></span> | <span class="t">oh well we'll put some stuff up on the website about yeah you know ideas and I'm sure some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5897" target="_blank">01:38:17.920</a></span> | <span class="t">students hopefully by the time you watch this will have some ideas on the forum or things they've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5902" target="_blank">01:38:22.480</a></span> | <span class="t">tried to yeah all right yeah the colorization is nice because it's um so colorization right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5910" target="_blank">01:38:30.480</a></span> | <span class="t">the transform is just to grayscale and back oh yes and then that's yeah that's already actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5916" target="_blank">01:38:36.640</a></span> | <span class="t">okay so there's all kinds of decrapification you could do isn't there so if you want to keep it a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5920" target="_blank">01:38:40.880</a></span> | <span class="t">bit more simple yes rather than doing these two lines of code you could um um yeah just turn it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5933" target="_blank">01:38:53.200</a></span> | <span class="t">into black and white that's a great point um or um you could delete the center every time you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5944" target="_blank">01:39:04.720</a></span> | <span class="t">to create like a something that learns how to fill in or maybe delete the left hand side</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5950" target="_blank">01:39:10.880</a></span> | <span class="t">and that way that would lay that something that you can give it a photo in it all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5953" target="_blank">01:39:13.920</a></span> | <span class="t">invent a little bit more to the left yeah and then you could keep running it to generator panorama</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5961" target="_blank">01:39:21.120</a></span> | <span class="t">another one you could do would be to like um in memory or something save it as a really uh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5970" target="_blank">01:39:30.400</a></span> | <span class="t">highly compressed jpeg and so then you would it would be something that would learn to remove jpeg</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5976" target="_blank">01:39:36.160</a></span> | <span class="t">artifacts which then for your like old photos that you saved with crappy jpeg compression you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5983" target="_blank">01:39:43.760</a></span> | <span class="t">bring them back to life uh you could probably do like yeah you could do like i guess drawing to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5991" target="_blank">01:39:51.840</a></span> | <span class="t">painting or something like this by taking some paintings and then like passing it through such</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=5995" target="_blank">01:39:55.600</a></span> | <span class="t">an edge detection and using that as your starting point sounds interesting oh uh what about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6001" target="_blank">01:40:01.760</a></span> | <span class="t">watermark removal you could um you know use pil or whatever to draw watermarks text whatever over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6009" target="_blank">01:40:09.760</a></span> | <span class="t">the top which is quite useful for like you know radiology images and stuff sometimes have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6015" target="_blank">01:40:15.440</a></span> | <span class="t">personally identifiable information written on them and you can just like learn to delete it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6020" target="_blank">01:40:20.720</a></span> | <span class="t">yeah okay so lots of things people can do that's awesome thanks for your ideas basically any image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6027" target="_blank">01:40:27.680</a></span> | <span class="t">to image nets super all right um or just make the super res better um try it on full image net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6038" target="_blank">01:40:38.640</a></span> | <span class="t">if you like um if you've got lots of hard drive space thanks jonno thanks to nish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6047" target="_blank">01:40:47.600</a></span> | <span class="t">see you next time we'll see you in a minute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6052" target="_blank">01:40:52.080</a></span> | <span class="t">- Bye. - Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6052" target="_blank">01:40:52.920</a></span> | <span class="t">- See you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=z1In7QaG0fg&t=6053" target="_blank">01:40:53.740</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>